var N2=Object.defineProperty;var n_=i=>{throw TypeError(i)};var j2=(i,n,o)=>n in i?N2(i,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[n]=o;var lr=(i,n,o)=>j2(i,typeof n!="symbol"?n+"":n,o),am=(i,n,o)=>n.has(i)||n_("Cannot "+o);var hs=(i,n,o)=>(am(i,n,"read from private field"),o?o.call(i):n.get(i)),Ou=(i,n,o)=>n.has(i)?n_("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(i):n.set(i,o),sm=(i,n,o,h)=>(am(i,n,"write to private field"),h?h.call(i,o):n.set(i,o),o),r_=(i,n,o)=>(am(i,n,"access private method"),o);import{d as sg,e as V2,a as rt,n as Jv,c as vi,t as Ht}from"../chunks/disclose-version.ACRLTizX.js";import{i as cn}from"../chunks/legacy.BGH10gZZ.js";import{B as Qv,k as Fg,ax as e1,p as gn,H as cc,G as gc,j as t1,av as i1,Z as $2,_ as a_,$ as Yu,q as Na,ay as qd,a0 as Ng,m as vf,a1 as n1,a4 as r1,D as nh,az as jg,aA as s_,aB as Vg,aC as U2,au as W2,aD as H2,o as $g,C as Ug,ar as q2,al as a1,aE as G2,M as Z2,R as o_,aF as X2,ao as s1,as as Y2,aq as K2,E as o1,aG as l1,a2 as Lt,b as bf,a3 as c1,e as Ai,s as J2,Y as Q2,aH as eT,aI as tT,aJ as iT,aK as nT,aL as rT,aM as aT,ab as sT,n as Fu,aN as oT,aO as lT,ak as l_,ae as c_,aP as cT,t as un,x as Mi,w as hn,y as pt,v as ni,A as Wt,z as ut,g as De,N as xf,aQ as u1,aR as Wg,aS as ei,aT as Or,I as di,aU as Hi,ai as ur,aV as uT,aW as om,aX as yc}from"../chunks/runtime.DUsw9IWs.js";import{l as Ji,p as tt,s as $r,d as Ma,e as kn,i as Vi,b as Rr,m as h1,f as rh,c as hT}from"../chunks/props.nERTz99S.js";import{c as cl,a as d1,o as ph}from"../chunks/index-client.gyh0nVrW.js";import{w as vn,d as Vr,g as ot,r as ro,a as u_}from"../chunks/index.BFxcx_la.js";import{i as dT,a as h_,b as fT,c as pT,d as mT,e as gT,f as yT,n as _T,g as vT,j as bT,l as xT,k as Ct,s as no,o as wT}from"../chunks/render.BNjvO54e.js";function _c(i,n){return n}function TT(i,n,o,h){for(var p=[],b=n.length,_=0;_<b;_++)U2(n[_].e,p,!0);var c=b>0&&p.length===0&&o!==null;if(c){var M=o.parentNode;W2(M),M.append(o),h.clear(),Qs(i,n[0].prev,n[b-1].next)}H2(p,()=>{for(var B=0;B<b;B++){var O=n[B];c||(h.delete(O.k),Qs(i,O.prev,O.next)),$g(O.e,!c)}})}function vc(i,n,o,h,p,b=null){var _=i,c={flags:n,items:new Map,first:null},M=(n&e1)!==0;if(M){var B=i;_=gn?cc(Ug(B)):B.appendChild(Qv())}gn&&gc();var O=null,R=!1;Fg(()=>{var C=o(),Y=t1(C)?C:C==null?[]:i1(C),X=Y.length;if(R&&X===0)return;R=X===0;let Z=!1;if(gn){var se=_.data===$2;se!==(X===0)&&(_=a_(),cc(_),Yu(!1),Z=!0)}if(gn){for(var q=null,te,ne=0;ne<X;ne++){if(Na.nodeType===8&&Na.data===q2){_=Na,Z=!0,Yu(!1);break}var _e=Y[ne],be=h(_e,ne);te=f1(Na,c,q,null,_e,be,ne,p,n),c.items.set(be,te),q=te}X>0&&cc(a_())}if(!gn){var Ae=a1;ST(Y,c,_,p,n,(Ae.f&qd)!==0,h)}b!==null&&(X===0?O?Ng(O):O=vf(()=>b(_)):O!==null&&n1(O,()=>{O=null})),Z&&Yu(!0),o()}),gn&&(_=Na)}function ST(i,n,o,h,p,b,_,c){var Ee,$e,He,Ge;var M=(p&G2)!==0,B=(p&(jg|Vg))!==0,O=i.length,R=n.items,C=n.first,Y=C,X,Z=null,se,q=[],te=[],ne,_e,be,Ae;if(M)for(Ae=0;Ae<O;Ae+=1)ne=i[Ae],_e=_(ne,Ae),be=R.get(_e),be!==void 0&&((Ee=be.a)==null||Ee.measure(),(se??(se=new Set)).add(be));for(Ae=0;Ae<O;Ae+=1){if(ne=i[Ae],_e=_(ne,Ae),be=R.get(_e),be===void 0){var de=Y?Y.e.nodes_start:o;Z=f1(de,n,Z,Z===null?n.first:Z.next,ne,_e,Ae,h,p),R.set(_e,Z),q=[],te=[],Y=Z.next;continue}if(B&&kT(be,ne,Ae,p),be.e.f&qd&&(Ng(be.e),M&&(($e=be.a)==null||$e.unfix(),(se??(se=new Set)).delete(be))),be!==Y){if(X!==void 0&&X.has(be)){if(q.length<te.length){var Be=te[0],Fe;Z=Be.prev;var Le=q[0],we=q[q.length-1];for(Fe=0;Fe<q.length;Fe+=1)d_(q[Fe],Be,o);for(Fe=0;Fe<te.length;Fe+=1)X.delete(te[Fe]);Qs(n,Le.prev,we.next),Qs(n,Z,Le),Qs(n,we,Be),Y=Be,Z=we,Ae-=1,q=[],te=[]}else X.delete(be),d_(be,Y,o),Qs(n,be.prev,be.next),Qs(n,be,Z===null?n.first:Z.next),Qs(n,Z,be),Z=be;continue}for(q=[],te=[];Y!==null&&Y.k!==_e;)(b||!(Y.e.f&qd))&&(X??(X=new Set)).add(Y),te.push(Y),Y=Y.next;if(Y===null)continue;be=Y}q.push(be),Z=be,Y=be.next}if(Y!==null||X!==void 0){for(var Te=X===void 0?[]:i1(X);Y!==null;)(b||!(Y.e.f&qd))&&Te.push(Y),Y=Y.next;var fe=Te.length;if(fe>0){var Me=p&e1&&O===0?o:null;if(M){for(Ae=0;Ae<fe;Ae+=1)(He=Te[Ae].a)==null||He.measure();for(Ae=0;Ae<fe;Ae+=1)(Ge=Te[Ae].a)==null||Ge.fix()}TT(n,Te,Me,R)}}M&&r1(()=>{var Re;if(se!==void 0)for(be of se)(Re=be.a)==null||Re.apply()}),nh.first=n.first&&n.first.e,nh.last=Z&&Z.e}function kT(i,n,o,h){h&jg&&s_(i.v,n),h&Vg?s_(i.i,o):i.i=o}function f1(i,n,o,h,p,b,_,c,M,B){var O=(M&jg)!==0,R=(M&X2)===0,C=O?R?Z2(p):o_(p):p,Y=M&Vg?o_(_):_,X={i:Y,v:C,k:b,a:null,e:null,prev:o,next:h};try{return X.e=vf(()=>c(i,C,Y),gn),X.e.prev=o&&o.e,X.e.next=h&&h.e,o===null?n.first=X:(o.next=X,o.e.next=X.e),h!==null&&(h.prev=X,h.e.prev=X.e),X}finally{}}function d_(i,n,o){for(var h=i.next?i.next.e.nodes_start:o,p=n?n.e.nodes_start:o,b=i.e.nodes_start;b!==h;){var _=s1(b);p.before(b),b=_}}function Qs(i,n,o){n===null?i.first=o:(n.next=o,n.e.next=o&&o.e),o!==null&&(o.prev=n,o.e.prev=n&&n.e)}function AT(i,n,o,h,p){var b=i,_="",c;Fg(()=>{if(_===(_=n()??"")){gn&&gc();return}c!==void 0&&($g(c),c=void 0),_!==""&&(c=vf(()=>{if(gn){Na.data;for(var M=gc(),B=M;M!==null&&(M.nodeType!==8||M.data!=="");)B=M,M=s1(M);if(M===null)throw Y2(),K2;sg(Na,B),b=cc(M);return}var O=_+"",R=V2(O);sg(Ug(R),R.lastChild),b.before(R)}))})}function zi(i,n,o,h,p){var c;gn&&gc();var b=(c=n.$$slots)==null?void 0:c[o],_=!1;b===!0&&(b=n[o==="default"?"children":o],_=!0),b===void 0?p!==null&&p(i):b(i,_?()=>h:h)}function MT(i){const n={};i.children&&(n.default=!0);for(const o in i.$$slots)n[o]=!0;return n}function IT(i,n,o,h,p,b){let _=gn;gn&&gc();var c,M,B=null;gn&&Na.nodeType===1&&(B=Na,gc());var O=gn?Na:i,R;Fg(()=>{const C=n()||null;var Y=l1;C!==c&&(R&&(C===null?n1(R,()=>{R=null,M=null}):C===M?Ng(R):($g(R),h_(!1))),C&&C!==M&&(R=vf(()=>{B=gn?B:document.createElementNS(Y,C),sg(B,B);{gn&&dT(C)&&B.append(document.createComment(""));var X=gn?Ug(B):B.appendChild(Qv());gn&&(X===null?Yu(!1):cc(X)),h(B,X)}nh.nodes_end=B,O.before(B)})),c=C,c&&(M=c),h_(!0))},o1),_&&(Yu(!0),cc(O))}function Tr(i,n,o){Lt(()=>{var h=bf(()=>n(i,o==null?void 0:o())||{});if(o&&(h!=null&&h.update)){var p=!1,b={};c1(()=>{var _=o();Ai(_),p&&J2(b,_)&&(b=_,h.update(_))}),p=!0}if(h!=null&&h.destroy)return()=>h.destroy()})}function p1(i){var n,o,h="";if(typeof i=="string"||typeof i=="number")h+=i;else if(typeof i=="object")if(Array.isArray(i)){var p=i.length;for(n=0;n<p;n++)i[n]&&(o=p1(i[n]))&&(h&&(h+=" "),h+=o)}else for(o in i)i[o]&&(h&&(h+=" "),h+=o);return h}function m1(){for(var i,n,o=0,h="",p=arguments.length;o<p;o++)(i=arguments[o])&&(n=p1(i))&&(h&&(h+=" "),h+=n);return h}function el(i){return typeof i=="object"?m1(i):i??""}function ET(i){if(gn){var n=!1,o=()=>{if(!n){if(n=!0,i.hasAttribute("value")){var h=i.value;Ti(i,"value",null),i.value=h}if(i.hasAttribute("checked")){var p=i.checked;Ti(i,"checked",null),i.checked=p}}};i.__on_r=o,iT(o),fT()}}function CT(i,n){n?i.hasAttribute("selected")||i.setAttribute("selected",""):i.removeAttribute("selected")}function Ti(i,n,o,h){var p=i.__attributes??(i.__attributes={});gn&&(p[n]=i.getAttribute(n),n==="src"||n==="srcset"||n==="href"&&i.nodeName==="LINK")||p[n]!==(p[n]=o)&&(n==="style"&&"__styles"in i&&(i.__styles={}),n==="loading"&&(i[eT]=o),o==null?i.removeAttribute(n):typeof o!="string"&&g1(i).includes(n)?i[n]=o:i.setAttribute(n,o))}function Br(i,n,o,h,p=!1,b=!1,_=!1){var c=n||{},M=i.tagName==="OPTION";for(var B in n)B in o||(o[B]=null);o.class&&(o.class=el(o.class)),h!==void 0&&(o.class=o.class?o.class+" "+h:h);var O=g1(i),R=i.__attributes??(i.__attributes={});for(const q in o){let te=o[q];if(M&&q==="value"&&te==null){i.value=i.__value="",c[q]=te;continue}var C=c[q];if(te!==C){c[q]=te;var Y=q[0]+q[1];if(Y!=="$$"){if(Y==="on"){const ne={},_e="$$"+q;let be=q.slice(2);var X=vT(be);if(pT(be)&&(be=be.slice(0,-7),ne.capture=!0),!X&&C){if(te!=null)continue;i.removeEventListener(be,c[_e],ne),c[_e]=null}if(te!=null)if(X)i[`__${be}`]=te,gT([be]);else{let Ae=function(de){c[q].call(this,de)};c[_e]=mT(be,i,Ae,ne)}else X&&(i[`__${be}`]=void 0)}else if(q==="style"&&te!=null)i.style.cssText=te+"";else if(q==="autofocus")yT(i,!!te);else if(q==="__value"||q==="value"&&te!=null)i.value=i[q]=i.__value=te;else if(q==="selected"&&M)CT(i,te);else{var Z=q;p||(Z=_T(Z));var se=Z==="defaultValue"||Z==="defaultChecked";if(te==null&&!b&&!se)if(R[q]=null,Z==="value"||Z==="checked"){let ne=i;if(Z==="value"){let _e=ne.defaultValue;ne.removeAttribute(Z),ne.defaultValue=_e}else{let _e=ne.defaultChecked;ne.removeAttribute(Z),ne.defaultChecked=_e}}else i.removeAttribute(q);else se||O.includes(Z)&&(b||typeof te!="string")?i[Z]=te:typeof te!="function"&&(gn&&(Z==="src"||Z==="href"||Z==="srcset")||Ti(i,Z,te))}q==="style"&&"__styles"in i&&(i.__styles={})}}}return c}var f_=new Map;function g1(i){var n=f_.get(i.nodeName);if(n)return n;f_.set(i.nodeName,n=[]);for(var o,h=i,p=Element.prototype;p!==h;){o=tT(h);for(var b in o)o[b].set&&n.push(b);h=Q2(h)}return n}function lc(i,n,o){var h=i.__className,p=PT(n);gn&&i.className===p?i.__className=p:(h!==p||gn&&i.className!==p)&&(n==null&&!o?i.removeAttribute("class"):i.className=p,i.__className=p)}function PT(i,n){return(i??"")+""}function zT(i,n,o){if(o){if(i.classList.contains(n))return;i.classList.add(n)}else{if(!i.classList.contains(n))return;i.classList.remove(n)}}const DT=()=>performance.now(),ys={tick:i=>requestAnimationFrame(i),now:()=>DT(),tasks:new Set};function y1(){const i=ys.now();ys.tasks.forEach(n=>{n.c(i)||(ys.tasks.delete(n),n.f())}),ys.tasks.size!==0&&ys.tick(y1)}function LT(i){let n;return ys.tasks.size===0&&ys.tick(y1),{promise:new Promise(o=>{ys.tasks.add(n={c:i,f:o})}),abort(){ys.tasks.delete(n)}}}function zd(i,n){i.dispatchEvent(new CustomEvent(n))}function RT(i){if(i==="float")return"cssFloat";if(i==="offset")return"cssOffset";if(i.startsWith("--"))return i;const n=i.split("-");return n.length===1?n[0]:n[0]+n.slice(1).map(o=>o[0].toUpperCase()+o.slice(1)).join("")}function p_(i){const n={},o=i.split(";");for(const h of o){const[p,b]=h.split(":");if(!p||b===void 0)break;const _=RT(p.trim());n[_]=b.trim()}return n}const BT=i=>i;function $n(i,n,o,h){var p=(i&aT)!==0,b=(i&oT)!==0,_=p&&b,c=(i&lT)!==0,M=_?"both":p?"in":"out",B,O=n.inert,R,C;function Y(){var te=a1,ne=nh;l_(null),c_(null);try{return B??(B=o()(n,(h==null?void 0:h())??{},{direction:M}))}finally{l_(te),c_(ne)}}var X={is_global:c,in(){var te;if(n.inert=O,!p){C==null||C.abort(),(te=C==null?void 0:C.reset)==null||te.call(C);return}b||R==null||R.abort(),zd(n,"introstart"),R=og(n,Y(),C,1,()=>{zd(n,"introend"),R==null||R.abort(),R=B=void 0})},out(te){if(!b){te==null||te(),B=void 0;return}n.inert=!0,zd(n,"outrostart"),C=og(n,Y(),R,0,()=>{zd(n,"outroend"),te==null||te()})},stop:()=>{R==null||R.abort(),C==null||C.abort()}},Z=nh;if((Z.transitions??(Z.transitions=[])).push(X),p&&bT){var se=c;if(!se){for(var q=Z.parent;q&&q.f&o1;)for(;(q=q.parent)&&!(q.f&nT););se=!q||(q.f&rT)!==0}se&&Lt(()=>{bf(()=>X.in())})}}function og(i,n,o,h,p){var b=h===1;if(sT(n)){var _,c=!1;return r1(()=>{if(!c){var se=n({direction:b?"in":"out"});_=og(i,se,o,h,p)}}),{abort:()=>{c=!0,_==null||_.abort()},deactivate:()=>_.deactivate(),reset:()=>_.reset(),t:()=>_.t()}}if(o==null||o.deactivate(),!(n!=null&&n.duration))return p(),{abort:Fu,deactivate:Fu,reset:Fu,t:()=>h};const{delay:M=0,css:B,tick:O,easing:R=BT}=n;var C=[];if(b&&o===void 0&&(O&&O(0,1),B)){var Y=p_(B(0,1));C.push(Y,Y)}var X=()=>1-h,Z=i.animate(C,{duration:M});return Z.onfinish=()=>{var se=(o==null?void 0:o.t())??1-h;o==null||o.abort();var q=h-se,te=n.duration*Math.abs(q),ne=[];if(te>0){if(B)for(var _e=Math.ceil(te/16.666666666666668),be=0;be<=_e;be+=1){var Ae=se+q*R(be/_e),de=B(Ae,1-Ae);ne.push(p_(de))}X=()=>{var Be=Z.currentTime;return se+q*R(Be/te)},O&&LT(()=>{if(Z.playState!=="running")return!1;var Be=X();return O(Be,1-Be),!0})}Z=i.animate(ne,{duration:te,fill:"forwards"}),Z.onfinish=()=>{X=()=>h,O==null||O(h,1-h),p()}},{abort:()=>{Z&&(Z.cancel(),Z.effect=null,Z.onfinish=Fu)},deactivate:()=>{p=Fu},reset:()=>{h===0&&(O==null||O(1,0))},t:()=>X()}}function OT(i,n,o=n){var h=cT();xT(i,"input",p=>{var b=p?i.defaultValue:i.value;if(b=lm(i)?cm(b):b,o(b),h&&b!==(b=n())){var _=i.selectionStart,c=i.selectionEnd;i.value=b??"",c!==null&&(i.selectionStart=_,i.selectionEnd=Math.min(c,i.value.length))}}),(gn&&i.defaultValue!==i.value||bf(n)==null&&i.value)&&o(lm(i)?cm(i.value):i.value),c1(()=>{var p=n();lm(i)&&p===cm(i.value)||i.type==="date"&&!p&&!i.value||p!==i.value&&(i.value=p??"")})}function lm(i){var n=i.type;return n==="number"||n==="range"}function cm(i){return i===""?null:+i}var io,mc,fh,yf,_1;const _f=class _f{constructor(n){Ou(this,yf);Ou(this,io,new WeakMap);Ou(this,mc);Ou(this,fh);sm(this,fh,n)}observe(n,o){var h=hs(this,io).get(n)||new Set;return h.add(o),hs(this,io).set(n,h),r_(this,yf,_1).call(this).observe(n,hs(this,fh)),()=>{var p=hs(this,io).get(n);p.delete(o),p.size===0&&(hs(this,io).delete(n),hs(this,mc).unobserve(n))}}};io=new WeakMap,mc=new WeakMap,fh=new WeakMap,yf=new WeakSet,_1=function(){return hs(this,mc)??sm(this,mc,new ResizeObserver(n=>{for(var o of n){_f.entries.set(o.target,o);for(var h of hs(this,io).get(o.target)||[])h(o)}}))},lr(_f,"entries",new WeakMap);let lg=_f;var FT=new lg({box:"border-box"});function NT(i,n,o){var h=FT.observe(i,()=>o(i[n]));Lt(()=>(bf(()=>o(i[n])),h))}function Nt(i,n){var b;var o=(b=i.$$events)==null?void 0:b[n.type],h=t1(o)?o.slice():o==null?[]:[o];for(var p of h)p.call(this,n)}const jT="FeatureCollection",VT=[{type:"Feature",properties:{name:"Old City",date:"Oct 19, 2020",url:"https://www.thehindu.com/news/cities/Hyderabad/a-choked-gurram-cheruvu-leaves-old-city-flooded/article32887896.ece"},geometry:{type:"Point",coordinates:[78.433,17.385]}},{type:"Feature",properties:{name:"Old City",date:"Oct 19, 2020",url:"https://telanganatoday.com/hyderabads-old-city-flooded-yet-again"},geometry:{type:"Point",coordinates:[78.433,17.385]}},{type:"Feature",properties:{name:"Old City",date:"Oct 20, 2020",url:"https://www.thehansindia.com/news/cities/hyderabad/hyderabad-gurram-cheruvu-breach-triggers-flood-of-woes-652074"},geometry:{type:"Point",coordinates:[78.433,17.385]}},{type:"Feature",properties:{name:"Madhapur",date:"Oct 11, 2017",url:"https://www.newindianexpress.com/hyderabad/2017/Oct/11/traffic-thrown-out-of-gear-in-madhapur-techies-bear-the-brunt-1670596.html"},geometry:{type:"Point",coordinates:[78.393,17.448]}},{type:"Feature",properties:{name:"Madhapur",date:"Oct 19, 2020",url:"https://timesofindia.indiatimes.com/city/hyderabad/hyderabad-flash-floods-damage-to-hundreds-of-homes/articleshow/78656057.cms"},geometry:{type:"Point",coordinates:[78.456,17.44]}},{type:"Feature",properties:{name:"Gachibowli",date:"Sep 2, 2024",url:"https://telanganatoday.com/hyderabad-drenched-after-overnight-downpour-gachibowli-records-97-mm-of-rainfall"},geometry:{type:"Point",coordinates:[78.395,17.41]}},{type:"Feature",properties:{name:"Anjaiah Nagar",date:"June 14, 2021",url:"https://www.thehansindia.com/news/cities/hyderabad/secunderabad-flood-fear-stalks-dwellers-near-hasmathpet-lake-690729"},geometry:{type:"Point",coordinates:[78.49,17.47]}},{type:"Feature",properties:{name:"Kukatpally",date:"Sep 1, 2024",url:"https://www.deccanchronicle.com/videos/kukatpally-roads-were-flooded-following-heavy-rains-in-hyderabad-1820660"},geometry:{type:"Point",coordinates:[78.5,17.45]}},{type:"Feature",properties:{name:"LB Nagar",date:"Jul 16, 2021",url:"https://timesofindia.indiatimes.com/city/hyderabad/2020-rerun-hyd-wakes-up-to-deluge-many-streets-sink/articleshow/84458414.cms"},geometry:{type:"Point",coordinates:[78.57,17.43]}},{type:"Feature",properties:{name:"Begumpet",date:"Nov 8, 2020",url:"https://timesofindia.indiatimes.com/city/hyderabad/begumpet-residents-flood-ready-plan-fails/articleshow/79105817.cms"},geometry:{type:"Point",coordinates:[78.465,17.387]}},{type:"Feature",properties:{name:"Somajiguda",date:"Aug 16, 2024",url:"https://timesofindia.indiatimes.com/city/hyderabad/imd-issues-yellow-alert-for-next-2-days-in-hyderabad/articleshow/112553832.cms"},geometry:{type:"Point",coordinates:[78.43,17.417]}},{type:"Feature",properties:{name:"Musi River (Central Hyderabad)",date:"Sep 28, 1908",url:"https://www.thehindu.com/news/cities/Hyderabad/watch-remembering-the-destructive-hyderabad-flood-of-september-1908/article68817255.ece"},geometry:{type:"Point",coordinates:[78.45,17.38]}},{type:"Feature",properties:{name:"Yousufguda",date:"July 21, 2023",url:"https://www.thehindu.com/news/national/telangana/heavy-rain-floods-city-roads-creates-traffic-mayhem/article67102423.ece"},geometry:{type:"Point",coordinates:[78.427,17.438]}},{type:"Feature",properties:{name:"Masab Tank",date:"Aug 20, 2024",url:"https://www.deccanchronicle.com/southern-states/telangana/heavy-rainfall-drenches-hyderabad-following-early-morning-cloudburst-1817655"},geometry:{type:"Point",coordinates:[78.45,17.4]}},{type:"Feature",properties:{name:"Ameerpet",date:"Aug 31, 2024",url:"https://www.thehindu.com/news/cities/Hyderabad/non-stop-rain-causes-water-stagnation-and-traffic-disruption-in-hyderabad/article68590479.ece"},geometry:{type:"Point",coordinates:[78.447,17.421]}},{type:"Feature",properties:{name:"Lingampally",date:"May 19, 2024",url:"https://www.thehindu.com/news/national/telangana/an-hours-rain-floods-the-city-creates-mayhem/article68190809.ece"},geometry:{type:"Point",coordinates:[78.315,17.493]}}],v1={type:jT,features:VT},$T=!0,UT=async()=>({pois:v1.features.reduce((n,o)=>{const{name:h,date:p,url:b}=o.properties;return n[h]||(n[h]={links:{},coordinates:o.geometry.coordinates,neighborhood:o.properties.neighbourhood}),n[h].links[p]||(n[h].links[p]=[]),n[h].links[p].push(b),n},{})}),hD=Object.freeze(Object.defineProperty({__proto__:null,load:UT,prerender:$T},Symbol.toStringTag,{value:"Module"}));var WT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function HT(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var b1={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(i,n){(function(o,h){i.exports=h()})(WT,function(){var o={},h={};function p(_,c,M){if(h[_]=M,_==="index"){var B="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",O={};return h.shared(O),h.index(o,O),typeof window<"u"&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([B],{type:"text/javascript"}))),o}}p("shared",["exports"],function(_){function c(r,t,a,l){return new(a||(a=Promise))(function(f,y){function v(A){try{T(l.next(A))}catch(I){y(I)}}function x(A){try{T(l.throw(A))}catch(I){y(I)}}function T(A){var I;A.done?f(A.value):(I=A.value,I instanceof a?I:new a(function(P){P(I)})).then(v,x)}T((l=l.apply(r,t||[])).next())})}function M(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var B=O;function O(r,t){this.x=r,this.y=t}O.prototype={clone:function(){return new O(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,a=r.y-this.y;return t*t+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),a=Math.sin(r),l=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=l,this},_rotateAround:function(r,t){var a=Math.cos(r),l=Math.sin(r),f=t.y+l*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-l*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},O.convert=function(r){return r instanceof O?r:Array.isArray(r)?new O(r[0],r[1]):r};var R=M(B),C=Y;function Y(r,t,a,l){this.cx=3*r,this.bx=3*(a-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=a,this.p2y=l}Y.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var a=r,l=0;l<8;l++){var f=this.sampleCurveX(a)-r;if(Math.abs(f)<t)return a;var y=this.sampleCurveDerivativeX(a);if(Math.abs(y)<1e-6)break;a-=f/y}var v=0,x=1;for(a=r,l=0;l<20&&(f=this.sampleCurveX(a),!(Math.abs(f-r)<t));l++)r>f?v=a:x=a,a=.5*(x-v)+v;return a},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var X=M(C);let Z,se;function q(){return Z==null&&(Z=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Z}function te(){if(se==null&&(se=!1,q())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){const f=4*l;t.fillStyle=`rgb(${f},${f+1},${f+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&a[l]!==l){se=!0;break}}}return se||!1}function ne(r,t,a,l){const f=new X(r,t,a,l);return y=>f.solve(y)}const _e=ne(.25,.1,.25,1);function be(r,t,a){return Math.min(a,Math.max(t,r))}function Ae(r,t,a){const l=a-t,f=((r-t)%l+l)%l+t;return f===t?a:f}function de(r,...t){for(const a of t)for(const l in a)r[l]=a[l];return r}let Be=1;function Fe(r,t,a){const l={};for(const f in r)l[f]=t.call(this,r[f],f,r);return l}function Le(r,t,a){const l={};for(const f in r)t.call(this,r[f],f,r)&&(l[f]=r[f]);return l}function we(r){return Array.isArray(r)?r.map(we):typeof r=="object"&&r?Fe(r,we):r}const Te={};function fe(r){Te[r]||(typeof console<"u"&&console.warn(r),Te[r]=!0)}function Me(r,t,a){return(a.y-r.y)*(t.x-r.x)>(t.y-r.y)*(a.x-r.x)}function Ee(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let $e=null;function He(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Re(r,t,a,l,f){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(r,{timestamp:0});try{const v=y==null?void 0:y.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const x=v.startsWith("BGR"),T=new Uint8ClampedArray(l*f*4);if(yield y.copyTo(T,function(A,I,P,L,j){const $=4*Math.max(-I,0),U=(Math.max(0,P)-P)*L*4+$,J=4*L,re=Math.max(0,I),xe=Math.max(0,P);return{rect:{x:re,y:xe,width:Math.min(A.width,I+L)-re,height:Math.min(A.height,P+j)-xe},layout:[{offset:U,stride:J}]}}(r,t,a,l,f)),x)for(let A=0;A<T.length;A+=4){const I=T[A];T[A]=T[A+2],T[A+2]=I}return T}finally{y.close()}})}let Xe,Ue;const Mt="AbortError";function Rt(){return new Error(Mt)}const _t={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Xt(r){return _t.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const jt="global-dispatcher";class si extends Error{constructor(t,a,l,f){super(`AJAXError: ${a} (${t}): ${l}`),this.status=t,this.statusText=a,this.url=l,this.body=f}}const fi=()=>Ee(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,qt=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const l=Xt(r.url);if(l)return l(r,t);if(Ee(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:jt},t)}if(!(/^file:/.test(a=r.url)||/^file:/.test(fi())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,f){return c(this,void 0,void 0,function*(){const y=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:fi(),signal:f.signal});l.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const v=yield fetch(y);if(!v.ok){const A=yield v.blob();throw new si(v.status,v.statusText,l.url,A)}let x;x=l.type==="arrayBuffer"||l.type==="image"?v.arrayBuffer():l.type==="json"?v.json():v.text();const T=yield x;if(f.signal.aborted)throw Rt();return{data:T,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}})}(r,t);if(Ee(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:jt},t)}var a;return function(l,f){return new Promise((y,v)=>{var x;const T=new XMLHttpRequest;T.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(T.responseType="arraybuffer");for(const A in l.headers)T.setRequestHeader(A,l.headers[A]);l.type==="json"&&(T.responseType="text",!((x=l.headers)===null||x===void 0)&&x.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=l.credentials==="include",T.onerror=()=>{v(new Error(T.statusText))},T.onload=()=>{if(!f.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let A=T.response;if(l.type==="json")try{A=JSON.parse(T.response)}catch(I){return void v(I)}y({data:A,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const A=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});v(new si(T.status,T.statusText,l.url,A))}},f.signal.addEventListener("abort",()=>{T.abort(),v(Rt())}),T.send(l.body)})}(r,t)};function bi(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function Yt(r,t,a){a[r]&&a[r].indexOf(t)!==-1||(a[r]=a[r]||[],a[r].push(t))}function Bi(r,t,a){if(a&&a[r]){const l=a[r].indexOf(t);l!==-1&&a[r].splice(l,1)}}class Qi{constructor(t,a={}){de(this,a),this.type=t}}class hi extends Qi{constructor(t,a={}){super("error",de({error:t},a))}}class xi{on(t,a){return this._listeners=this._listeners||{},Yt(t,a,this._listeners),this}off(t,a){return Bi(t,a,this._listeners),Bi(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Yt(t,a,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,a){typeof t=="string"&&(t=new Qi(t,a||{}));const l=t.type;if(this.listens(l)){t.target=this;const f=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const x of f)x.call(this,t);const y=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const x of y)Bi(l,x,this._oneTimeListeners),x.call(this,t);const v=this._eventedParent;v&&(de(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof hi&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var ke={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const dn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ii(r,t){const a={};for(const l in r)l!=="ref"&&(a[l]=r[l]);return dn.forEach(l=>{l in t&&(a[l]=t[l])}),a}function Kt(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let a=0;a<r.length;a++)if(!Kt(r[a],t[a]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const a in r)if(!Kt(r[a],t[a]))return!1;return!0}return r===t}function Ei(r,t){r.push(t)}function dr(r,t,a){Ei(a,{command:"addSource",args:[r,t[r]]})}function bn(r,t,a){Ei(t,{command:"removeSource",args:[r]}),a[r]=!0}function Jn(r,t,a,l){bn(r,a,l),dr(r,t,a)}function Ia(r,t,a){let l;for(l in r[a])if(Object.prototype.hasOwnProperty.call(r[a],l)&&l!=="data"&&!Kt(r[a][l],t[a][l]))return!1;for(l in t[a])if(Object.prototype.hasOwnProperty.call(t[a],l)&&l!=="data"&&!Kt(r[a][l],t[a][l]))return!1;return!0}function Qn(r,t,a,l,f,y){r=r||{},t=t||{};for(const v in r)Object.prototype.hasOwnProperty.call(r,v)&&(Kt(r[v],t[v])||a.push({command:y,args:[l,v,t[v],f]}));for(const v in t)Object.prototype.hasOwnProperty.call(t,v)&&!Object.prototype.hasOwnProperty.call(r,v)&&(Kt(r[v],t[v])||a.push({command:y,args:[l,v,t[v],f]}))}function xt(r){return r.id}function Tt(r,t){return r[t.id]=t,r}class ze{constructor(t,a,l,f){this.message=(t?`${t}: `:"")+l,f&&(this.identifier=f),a!=null&&a.__line__&&(this.line=a.__line__)}}function Vt(r,...t){for(const a of t)for(const l in a)r[l]=a[l];return r}class Ut extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class Qt{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[l,f]of a)this.bindings[l]=f}concat(t){return new Qt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Oi={kind:"null"},qe={kind:"number"},Dt={kind:"string"},kt={kind:"boolean"},Di={kind:"color"},Fn={kind:"object"},Bt={kind:"value"},An={kind:"collator"},Ar={kind:"formatted"},Ur={kind:"padding"},En={kind:"resolvedImage"},ie={kind:"variableAnchorOffsetCollection"};function F(r,t){return{kind:"array",itemType:r,N:t}}function N(r){if(r.kind==="array"){const t=N(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const W=[Oi,qe,Dt,kt,Di,Ar,Fn,F(Bt),Ur,En,ie];function Q(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Q(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const a of W)if(!Q(a,t))return null}}return`Expected ${N(r)} but found ${N(t)} instead.`}function he(r,t){return t.some(a=>a.kind===r.kind)}function me(r,t){return t.some(a=>a==="null"?r===null:a==="array"?Array.isArray(r):a==="object"?r&&!Array.isArray(r)&&typeof r=="object":a===typeof r)}function ve(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const le=.96422,Pe=.82521,Ve=4/29,Ie=6/29,Ke=3*Ie*Ie,It=Ie*Ie*Ie,Pt=Math.PI/180,mi=180/Math.PI;function Gt(r){return(r%=360)<0&&(r+=360),r}function gi([r,t,a,l]){let f,y;const v=xn((.2225045*(r=oi(r))+.7168786*(t=oi(t))+.0606169*(a=oi(a)))/1);r===t&&t===a?f=y=v:(f=xn((.4360747*r+.3850649*t+.1430804*a)/le),y=xn((.0139322*r+.0971045*t+.7141733*a)/Pe));const x=116*v-16;return[x<0?0:x,500*(f-v),200*(v-y),l]}function oi(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function xn(r){return r>It?Math.pow(r,1/3):r/Ke+Ve}function nn([r,t,a,l]){let f=(r+16)/116,y=isNaN(t)?f:f+t/500,v=isNaN(a)?f:f-a/200;return f=1*Li(f),y=le*Li(y),v=Pe*Li(v),[ti(3.1338561*y-1.6168667*f-.4906146*v),ti(-.9787684*y+1.9161415*f+.033454*v),ti(.0719453*y-.2289914*f+1.4052427*v),l]}function ti(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function Li(r){return r>Ie?r*r*r:Ke*(r-Ve)}function en(r){return parseInt(r.padEnd(2,r),16)/255}function Cn(r,t){return Nn(t?r/100:r,0,1)}function Nn(r,t,a){return Math.min(Math.max(t,r),a)}function er(r){return!r.some(Number.isNaN)}const Ss={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ri{constructor(t,a,l,f=1,y=!0){this.r=t,this.g=a,this.b=l,this.a=f,y||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[t,a,l,f]))}static parse(t){if(t instanceof Ri)return t;if(typeof t!="string")return;const a=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=Ss[l];if(f){const[v,x,T]=f;return[v/255,x/255,T/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const v=l.length<6?1:2;let x=1;return[en(l.slice(x,x+=v)),en(l.slice(x,x+=v)),en(l.slice(x,x+=v)),en(l.slice(x,x+v)||"ff")]}if(l.startsWith("rgb")){const v=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,T,A,I,P,L,j,$,U,J,re,xe]=v,ue=[I||" ",j||" ",J].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const ye=[A,L,U].join(""),Ce=ye==="%%%"?100:ye===""?255:0;if(Ce){const We=[Nn(+T/Ce,0,1),Nn(+P/Ce,0,1),Nn(+$/Ce,0,1),re?Cn(+re,xe):1];if(er(We))return We}}return}}const y=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,x,T,A,I,P,L,j,$]=y,U=[T||" ",I||" ",L].join("");if(U==="  "||U==="  /"||U===",,"||U===",,,"){const J=[+x,Nn(+A,0,100),Nn(+P,0,100),j?Cn(+j,$):1];if(er(J))return function([re,xe,ue,ye]){function Ce(We){const ct=(We+re/30)%12,zt=xe*Math.min(ue,1-ue);return ue-zt*Math.max(-1,Math.min(ct-3,9-ct,1))}return re=Gt(re),xe/=100,ue/=100,[Ce(0),Ce(8),Ce(4),ye]}(J)}}}(t);return a?new Ri(...a,!1):void 0}get rgb(){const{r:t,g:a,b:l,a:f}=this,y=f||1/0;return this.overwriteGetter("rgb",[t/y,a/y,l/y,f])}get hcl(){return this.overwriteGetter("hcl",function(t){const[a,l,f,y]=gi(t),v=Math.sqrt(l*l+f*f);return[Math.round(1e4*v)?Gt(Math.atan2(f,l)*mi):NaN,v,a,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",gi(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,l,f]=this.rgb;return`rgba(${[t,a,l].map(y=>Math.round(255*y)).join(",")},${f})`}}Ri.black=new Ri(0,0,0,1),Ri.white=new Ri(1,1,1,1),Ri.transparent=new Ri(0,0,0,0),Ri.red=new Ri(1,0,0,1);class Rc{constructor(t,a,l){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Bc{constructor(t,a,l,f,y){this.text=t,this.image=a,this.scale=l,this.fontStack=f,this.textColor=y}}class Mr{constructor(t){this.sections=t}static fromString(t){return new Mr([new Bc(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Mr?t:Mr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Ir{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ir)return t;if(typeof t=="number")return new Ir([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Ir(t)}}toString(){return JSON.stringify(this.values)}}const Uf=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Fr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Fr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const l=t[a],f=t[a+1];if(typeof l!="string"||!Uf.has(l)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new Fr(t)}}toString(){return JSON.stringify(this.values)}}class Er{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Er({name:t,available:!1}):null}}function ks(r,t,a,l){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,t,a,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,t,a,l]:[r,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ua(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Ri||r instanceof Rc||r instanceof Mr||r instanceof Ir||r instanceof Fr||r instanceof Er)return!0;if(Array.isArray(r)){for(const t of r)if(!Ua(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Ua(r[t]))return!1;return!0}return!1}function wn(r){if(r===null)return Oi;if(typeof r=="string")return Dt;if(typeof r=="boolean")return kt;if(typeof r=="number")return qe;if(r instanceof Ri)return Di;if(r instanceof Rc)return An;if(r instanceof Mr)return Ar;if(r instanceof Ir)return Ur;if(r instanceof Fr)return ie;if(r instanceof Er)return En;if(Array.isArray(r)){const t=r.length;let a;for(const l of r){const f=wn(l);if(a){if(a===f)continue;a=Bt;break}a=f}return F(a||Bt,t)}return Fn}function go(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Ri||r instanceof Mr||r instanceof Ir||r instanceof Fr||r instanceof Er?r.toString():JSON.stringify(r)}class Wr{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ua(t[1]))return a.error("invalid value");const l=t[1];let f=wn(l);const y=a.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new Wr(f,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class yn{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const dl={string:Dt,number:qe,boolean:kt,object:Fn};class Hr{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let l,f=1;const y=t[0];if(y==="array"){let x,T;if(t.length>2){const A=t[1];if(typeof A!="string"||!(A in dl)||A==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);x=dl[A],f++}else x=Bt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);T=t[2],f++}l=F(x,T)}else{if(!dl[y])throw new Error(`Types doesn't contain name = ${y}`);l=dl[y]}const v=[];for(;f<t.length;f++){const x=a.parse(t[f],f,Bt);if(!x)return null;v.push(x)}return new Hr(l,v)}evaluate(t){for(let a=0;a<this.args.length;a++){const l=this.args[a].evaluate(t);if(!Q(this.type,wn(l)))return l;if(a===this.args.length-1)throw new yn(`Expected value to be of type ${N(this.type)}, but found ${N(wn(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Oc={"to-boolean":kt,"to-color":Di,"to-number":qe,"to-string":Dt};class qr{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const l=t[0];if(!Oc[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return a.error("Expected one argument.");const f=Oc[l],y=[];for(let v=1;v<t.length;v++){const x=a.parse(t[v],v,Bt);if(!x)return null;y.push(x)}return new qr(f,y)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,l;for(const f of this.args){if(a=f.evaluate(t),l=null,a instanceof Ri)return a;if(typeof a=="string"){const y=t.parseColor(a);if(y)return y}else if(Array.isArray(a)&&(l=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:ks(a[0],a[1],a[2],a[3]),!l))return new Ri(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new yn(l||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const l of this.args){a=l.evaluate(t);const f=Ir.parse(a);if(f)return f}throw new yn(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const l of this.args){a=l.evaluate(t);const f=Fr.parse(a);if(f)return f}throw new yn(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const l of this.args){if(a=l.evaluate(t),a===null)return 0;const f=Number(a);if(!isNaN(f))return f}throw new yn(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return Mr.fromString(go(this.args[0].evaluate(t)));case"resolvedImage":return Er.fromString(go(this.args[0].evaluate(t)));default:return go(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Wf=["Unknown","Point","LineString","Polygon"];class fl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Wf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache[t];return a||(a=this._parseColorCache[t]=Ri.parse(t)),a}}class Wa{constructor(t,a,l=[],f,y=new Qt,v=[]){this.registry=t,this.path=l,this.key=l.map(x=>`[${x}]`).join(""),this.scope=y,this.errors=v,this.expectedType=f,this._isConstant=a}parse(t,a,l,f,y={}){return a?this.concat(a,l,f)._parse(t,y):this._parse(t,y)}_parse(t,a){function l(f,y,v){return v==="assert"?new Hr(y,[f]):v==="coerce"?new qr(y,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let v=y.parse(t,this);if(!v)return null;if(this.expectedType){const x=this.expectedType,T=v.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||T.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(x.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(x.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(x,T))return null}else v=l(v,x,a.typeAnnotation||"coerce");else v=l(v,x,a.typeAnnotation||"coerce");else v=l(v,x,a.typeAnnotation||"coerce");else v=l(v,x,a.typeAnnotation||"assert")}if(!(v instanceof Wr)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const x=new fl;try{v=new Wr(v.type,v.evaluate(x))}catch(T){return this.error(T.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,l){const f=typeof t=="number"?this.path.concat(t):this.path,y=l?this.scope.concat(l):this.scope;return new Wa(this.registry,this._isConstant,f,a||null,y,this.errors)}error(t,...a){const l=`${this.key}${a.map(f=>`[${f}]`).join("")}`;this.errors.push(new Ut(l,t))}checkSubtype(t,a){const l=Q(t,a);return l&&this.error(l),l}}class Ea{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let y=1;y<t.length-1;y+=2){const v=t[y];if(typeof v!="string")return a.error(`Expected string, but found ${typeof v} instead.`,y);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",y);const x=a.parse(t[y+1],y+1);if(!x)return null;l.push([v,x])}const f=a.parse(t[t.length-1],t.length-1,a.expectedType,l);return f?new Ea(l,f):null}outputDefined(){return this.result.outputDefined()}}class wi{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const l=t[1];return a.scope.has(l)?new wi(l,a.scope.get(l)):a.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Fc{constructor(t,a,l){this.type=t,this.index=a,this.input=l}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=a.parse(t[1],1,qe),f=a.parse(t[2],2,F(a.expectedType||Bt));return l&&f?new Fc(f.type.itemType,l,f):null}evaluate(t){const a=this.index.evaluate(t),l=this.input.evaluate(t);if(a<0)throw new yn(`Array index out of bounds: ${a} < 0.`);if(a>=l.length)throw new yn(`Array index out of bounds: ${a} > ${l.length-1}.`);if(a!==Math.floor(a))throw new yn(`Array index must be an integer, but found ${a} instead.`);return l[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Nc{constructor(t,a){this.type=kt,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=a.parse(t[1],1,Bt),f=a.parse(t[2],2,Bt);return l&&f?he(l.type,[kt,Dt,qe,Oi,Bt])?new Nc(l,f):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${N(l.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!me(a,["boolean","string","number","null"]))throw new yn(`Expected first argument to be of type boolean, string, number or null, but found ${N(wn(a))} instead.`);if(!me(l,["string","array"]))throw new yn(`Expected second argument to be of type array or string, but found ${N(wn(l))} instead.`);return l.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class As{constructor(t,a,l){this.type=qe,this.needle=t,this.haystack=a,this.fromIndex=l}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=a.parse(t[1],1,Bt),f=a.parse(t[2],2,Bt);if(!l||!f)return null;if(!he(l.type,[kt,Dt,qe,Oi,Bt]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${N(l.type)} instead`);if(t.length===4){const y=a.parse(t[3],3,qe);return y?new As(l,f,y):null}return new As(l,f)}evaluate(t){const a=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!me(a,["boolean","string","number","null"]))throw new yn(`Expected first argument to be of type boolean, string, number or null, but found ${N(wn(a))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(t)),me(l,["string"])){const y=l.indexOf(a,f);return y===-1?-1:[...l.slice(0,y)].length}if(me(l,["array"]))return l.indexOf(a,f);throw new yn(`Expected second argument to be of type array or string, but found ${N(wn(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class jc{constructor(t,a,l,f,y,v){this.inputType=t,this.type=a,this.input=l,this.cases=f,this.outputs=y,this.otherwise=v}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let l,f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);const y={},v=[];for(let A=2;A<t.length-1;A+=2){let I=t[A];const P=t[A+1];Array.isArray(I)||(I=[I]);const L=a.concat(A);if(I.length===0)return L.error("Expected at least one branch label.");for(const $ of I){if(typeof $!="number"&&typeof $!="string")return L.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return L.error("Numeric branch labels must be integer values.");if(l){if(L.checkSubtype(l,wn($)))return null}else l=wn($);if(y[String($)]!==void 0)return L.error("Branch labels must be unique.");y[String($)]=v.length}const j=a.parse(P,A,f);if(!j)return null;f=f||j.type,v.push(j)}const x=a.parse(t[1],1,Bt);if(!x)return null;const T=a.parse(t[t.length-1],t.length-1,f);return T?x.type.kind!=="value"&&a.concat(1).checkSubtype(l,x.type)?null:new jc(l,f,x,y,v,T):null}evaluate(t){const a=this.input.evaluate(t);return(wn(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class pl{constructor(t,a,l){this.type=t,this.branches=a,this.otherwise=l}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let l;a.expectedType&&a.expectedType.kind!=="value"&&(l=a.expectedType);const f=[];for(let v=1;v<t.length-1;v+=2){const x=a.parse(t[v],v,kt);if(!x)return null;const T=a.parse(t[v+1],v+1,l);if(!T)return null;f.push([x,T]),l=l||T.type}const y=a.parse(t[t.length-1],t.length-1,l);if(!y)return null;if(!l)throw new Error("Can't infer output type");return new pl(l,f,y)}evaluate(t){for(const[a,l]of this.branches)if(a.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,l]of this.branches)t(a),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class yo{constructor(t,a,l,f){this.type=t,this.input=a,this.beginIndex=l,this.endIndex=f}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=a.parse(t[1],1,Bt),f=a.parse(t[2],2,qe);if(!l||!f)return null;if(!he(l.type,[F(Bt),Dt,Bt]))return a.error(`Expected first argument to be of type array or string, but found ${N(l.type)} instead`);if(t.length===4){const y=a.parse(t[3],3,qe);return y?new yo(l.type,l,f,y):null}return new yo(l.type,l,f)}evaluate(t){const a=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let f;if(this.endIndex&&(f=this.endIndex.evaluate(t)),me(a,["string"]))return[...a].slice(l,f).join("");if(me(a,["array"]))return a.slice(l,f);throw new yn(`Expected first argument to be of type array or string, but found ${N(wn(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ml(r,t){const a=r.length-1;let l,f,y=0,v=a,x=0;for(;y<=v;)if(x=Math.floor((y+v)/2),l=r[x],f=r[x+1],l<=t){if(x===a||t<f)return x;y=x+1}else{if(!(l>t))throw new yn("Input is not a number.");v=x-1}return 0}class Ms{constructor(t,a,l){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[f,y]of l)this.labels.push(f),this.outputs.push(y)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const l=a.parse(t[1],1,qe);if(!l)return null;const f=[];let y=null;a.expectedType&&a.expectedType.kind!=="value"&&(y=a.expectedType);for(let v=1;v<t.length;v+=2){const x=v===1?-1/0:t[v],T=t[v+1],A=v,I=v+1;if(typeof x!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(f.length&&f[f.length-1][0]>=x)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const P=a.parse(T,I,y);if(!P)return null;y=y||P.type,f.push([x,P])}return new Ms(y,l,f)}evaluate(t){const a=this.labels,l=this.outputs;if(a.length===1)return l[0].evaluate(t);const f=this.input.evaluate(t);if(f<=a[0])return l[0].evaluate(t);const y=a.length;return f>=a[y-1]?l[y-1].evaluate(t):l[ml(a,f)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function kh(r){return r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Hf=Ah;function Ah(r,t,a,l){this.cx=3*r,this.bx=3*(a-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=a,this.p2y=l}Ah.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var a=r,l=0;l<8;l++){var f=this.sampleCurveX(a)-r;if(Math.abs(f)<t)return a;var y=this.sampleCurveDerivativeX(a);if(Math.abs(y)<1e-6)break;a-=f/y}var v=0,x=1;for(a=r,l=0;l<20&&(f=this.sampleCurveX(a),!(Math.abs(f-r)<t));l++)r>f?v=a:x=a,a=.5*(x-v)+v;return a},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var qf=kh(Hf);function Ha(r,t,a){return r+a*(t-r)}function _o(r,t,a){return r.map((l,f)=>Ha(l,t[f],a))}const fr={number:Ha,color:function(r,t,a,l="rgb"){switch(l){case"rgb":{const[f,y,v,x]=_o(r.rgb,t.rgb,a);return new Ri(f,y,v,x,!1)}case"hcl":{const[f,y,v,x]=r.hcl,[T,A,I,P]=t.hcl;let L,j;if(isNaN(f)||isNaN(T))isNaN(f)?isNaN(T)?L=NaN:(L=T,v!==1&&v!==0||(j=A)):(L=f,I!==1&&I!==0||(j=y));else{let xe=T-f;T>f&&xe>180?xe-=360:T<f&&f-T>180&&(xe+=360),L=f+a*xe}const[$,U,J,re]=function([xe,ue,ye,Ce]){return xe=isNaN(xe)?0:xe*Pt,nn([ye,Math.cos(xe)*ue,Math.sin(xe)*ue,Ce])}([L,j??Ha(y,A,a),Ha(v,I,a),Ha(x,P,a)]);return new Ri($,U,J,re,!1)}case"lab":{const[f,y,v,x]=nn(_o(r.lab,t.lab,a));return new Ri(f,y,v,x,!1)}}},array:_o,padding:function(r,t,a){return new Ir(_o(r.values,t.values,a))},variableAnchorOffsetCollection:function(r,t,a){const l=r.values,f=t.values;if(l.length!==f.length)throw new yn(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${t.toString()}`);const y=[];for(let v=0;v<l.length;v+=2){if(l[v]!==f[v])throw new yn(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${l[v]}, to[${v}]: ${f[v]}`);y.push(l[v]);const[x,T]=l[v+1],[A,I]=f[v+1];y.push([Ha(x,A,a),Ha(T,I,a)])}return new Fr(y)}};class pr{constructor(t,a,l,f,y){this.type=t,this.operator=a,this.interpolation=l,this.input=f,this.labels=[],this.outputs=[];for(const[v,x]of y)this.labels.push(v),this.outputs.push(x)}static interpolationFactor(t,a,l,f){let y=0;if(t.name==="exponential")y=gl(a,t.base,l,f);else if(t.name==="linear")y=gl(a,1,l,f);else if(t.name==="cubic-bezier"){const v=t.controlPoints;y=new qf(v[0],v[1],v[2],v[3]).solve(gl(a,1,l,f))}return y}static parse(t,a){let[l,f,y,...v]=t;if(!Array.isArray(f)||f.length===0)return a.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const A=f[1];if(typeof A!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:A}}else{if(f[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const A=f.slice(1);if(A.length!==4||A.some(I=>typeof I!="number"||I<0||I>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:A}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(y=a.parse(y,2,qe),!y)return null;const x=[];let T=null;l==="interpolate-hcl"||l==="interpolate-lab"?T=Di:a.expectedType&&a.expectedType.kind!=="value"&&(T=a.expectedType);for(let A=0;A<v.length;A+=2){const I=v[A],P=v[A+1],L=A+3,j=A+4;if(typeof I!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(x.length&&x[x.length-1][0]>=I)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const $=a.parse(P,j,T);if(!$)return null;T=T||$.type,x.push([I,$])}return ve(T,qe)||ve(T,Di)||ve(T,Ur)||ve(T,ie)||ve(T,F(qe))?new pr(T,l,f,y,x):a.error(`Type ${N(T)} is not interpolatable.`)}evaluate(t){const a=this.labels,l=this.outputs;if(a.length===1)return l[0].evaluate(t);const f=this.input.evaluate(t);if(f<=a[0])return l[0].evaluate(t);const y=a.length;if(f>=a[y-1])return l[y-1].evaluate(t);const v=ml(a,f),x=pr.interpolationFactor(this.interpolation,f,a[v],a[v+1]),T=l[v].evaluate(t),A=l[v+1].evaluate(t);switch(this.operator){case"interpolate":return fr[this.type.kind](T,A,x);case"interpolate-hcl":return fr.color(T,A,x,"hcl");case"interpolate-lab":return fr.color(T,A,x,"lab")}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function gl(r,t,a,l){const f=l-a,y=r-a;return f===0?0:t===1?y/f:(Math.pow(t,y)-1)/(Math.pow(t,f)-1)}class yl{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expectected at least one argument.");let l=null;const f=a.expectedType;f&&f.kind!=="value"&&(l=f);const y=[];for(const x of t.slice(1)){const T=a.parse(x,1+y.length,l,void 0,{typeAnnotation:"omit"});if(!T)return null;l=l||T.type,y.push(T)}if(!l)throw new Error("No output type");const v=f&&y.some(x=>Q(f,x.type));return new yl(v?Bt:l,y)}evaluate(t){let a,l=null,f=0;for(const y of this.args)if(f++,l=y.evaluate(t),l&&l instanceof Er&&!l.available&&(a||(a=l.name),l=null,f===this.args.length&&(l=a)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function _l(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Mh(r,t,a,l){return l.compare(t,a)===0}function Is(r,t,a){const l=r!=="=="&&r!=="!=";return class x1{constructor(y,v,x){this.type=kt,this.lhs=y,this.rhs=v,this.collator=x,this.hasUntypedArgument=y.type.kind==="value"||v.type.kind==="value"}static parse(y,v){if(y.length!==3&&y.length!==4)return v.error("Expected two or three arguments.");const x=y[0];let T=v.parse(y[1],1,Bt);if(!T)return null;if(!_l(x,T.type))return v.concat(1).error(`"${x}" comparisons are not supported for type '${N(T.type)}'.`);let A=v.parse(y[2],2,Bt);if(!A)return null;if(!_l(x,A.type))return v.concat(2).error(`"${x}" comparisons are not supported for type '${N(A.type)}'.`);if(T.type.kind!==A.type.kind&&T.type.kind!=="value"&&A.type.kind!=="value")return v.error(`Cannot compare types '${N(T.type)}' and '${N(A.type)}'.`);l&&(T.type.kind==="value"&&A.type.kind!=="value"?T=new Hr(A.type,[T]):T.type.kind!=="value"&&A.type.kind==="value"&&(A=new Hr(T.type,[A])));let I=null;if(y.length===4){if(T.type.kind!=="string"&&A.type.kind!=="string"&&T.type.kind!=="value"&&A.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(I=v.parse(y[3],3,An),!I)return null}return new x1(T,A,I)}evaluate(y){const v=this.lhs.evaluate(y),x=this.rhs.evaluate(y);if(l&&this.hasUntypedArgument){const T=wn(v),A=wn(x);if(T.kind!==A.kind||T.kind!=="string"&&T.kind!=="number")throw new yn(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${T.kind}, ${A.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const T=wn(v),A=wn(x);if(T.kind!=="string"||A.kind!=="string")return t(y,v,x)}return this.collator?a(y,v,x,this.collator.evaluate(y)):t(y,v,x)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Gf=Is("==",function(r,t,a){return t===a},Mh),Ih=Is("!=",function(r,t,a){return t!==a},function(r,t,a,l){return!Mh(0,t,a,l)}),Eh=Is("<",function(r,t,a){return t<a},function(r,t,a,l){return l.compare(t,a)<0}),Zf=Is(">",function(r,t,a){return t>a},function(r,t,a,l){return l.compare(t,a)>0}),Xf=Is("<=",function(r,t,a){return t<=a},function(r,t,a,l){return l.compare(t,a)<=0}),Ch=Is(">=",function(r,t,a){return t>=a},function(r,t,a,l){return l.compare(t,a)>=0});class vo{constructor(t,a,l){this.type=An,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return a.error("Collator options argument must be an object.");const f=a.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,kt);if(!f)return null;const y=a.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,kt);if(!y)return null;let v=null;return l.locale&&(v=a.parse(l.locale,1,Dt),!v)?null:new vo(f,y,v)}evaluate(t){return new Rc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Vc{constructor(t,a,l,f,y){this.type=Dt,this.number=t,this.locale=a,this.currency=l,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const l=a.parse(t[1],1,qe);if(!l)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=a.parse(f.locale,1,Dt),!y))return null;let v=null;if(f.currency&&(v=a.parse(f.currency,1,Dt),!v))return null;let x=null;if(f["min-fraction-digits"]&&(x=a.parse(f["min-fraction-digits"],1,qe),!x))return null;let T=null;return f["max-fraction-digits"]&&(T=a.parse(f["max-fraction-digits"],1,qe),!T)?null:new Vc(l,y,v,x,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class vl{constructor(t){this.type=Ar,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return a.error("First argument must be an image or text section.");const f=[];let y=!1;for(let v=1;v<=t.length-1;++v){const x=t[v];if(y&&typeof x=="object"&&!Array.isArray(x)){y=!1;let T=null;if(x["font-scale"]&&(T=a.parse(x["font-scale"],1,qe),!T))return null;let A=null;if(x["text-font"]&&(A=a.parse(x["text-font"],1,F(Dt)),!A))return null;let I=null;if(x["text-color"]&&(I=a.parse(x["text-color"],1,Di),!I))return null;const P=f[f.length-1];P.scale=T,P.font=A,P.textColor=I}else{const T=a.parse(t[v],1,Bt);if(!T)return null;const A=T.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:T,scale:null,font:null,textColor:null})}}return new vl(f)}evaluate(t){return new Mr(this.sections.map(a=>{const l=a.content.evaluate(t);return wn(l)===En?new Bc("",l,null,null,null):new Bc(go(l),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor)}outputDefined(){return!1}}class $c{constructor(t){this.type=En,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const l=a.parse(t[1],1,Dt);return l?new $c(l):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),l=Er.fromString(a);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(a)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Uc{constructor(t){this.type=qe,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=a.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${N(l.type)} instead.`):new Uc(l):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new yn(`Expected value to be of type string or array, but found ${N(wn(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const la=8192;function Yf(r,t){const a=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(a*f*la),Math.round(l*f*la)]}function Wc(r,t){const a=Math.pow(2,t.z);return[(f=(r[0]/la+t.x)/a,360*f-180),(l=(r[1]/la+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,f}function qa(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function Ca(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function ki(r,t,a){const l=r[0]-t[0],f=r[1]-t[1],y=r[0]-a[0],v=r[1]-a[1];return l*v-y*f==0&&l*y<=0&&f*v<=0}function bl(r,t,a,l){return(f=[l[0]-a[0],l[1]-a[1]])[0]*(y=[t[0]-r[0],t[1]-r[1]])[1]-f[1]*y[0]!=0&&!(!zh(r,t,a,l)||!zh(a,l,r,t));var f,y}function Kf(r,t,a){for(const l of a)for(let f=0;f<l.length-1;++f)if(bl(r,t,l[f],l[f+1]))return!0;return!1}function Es(r,t,a=!1){let l=!1;for(const x of t)for(let T=0;T<x.length-1;T++){if(ki(r,x[T],x[T+1]))return a;(y=x[T])[1]>(f=r)[1]!=(v=x[T+1])[1]>f[1]&&f[0]<(v[0]-y[0])*(f[1]-y[1])/(v[1]-y[1])+y[0]&&(l=!l)}var f,y,v;return l}function Jf(r,t){for(const a of t)if(Es(r,a))return!0;return!1}function Ph(r,t){for(const a of r)if(!Es(a,t))return!1;for(let a=0;a<r.length-1;++a)if(Kf(r[a],r[a+1],t))return!1;return!0}function Qf(r,t){for(const a of t)if(Ph(r,a))return!0;return!1}function zh(r,t,a,l){const f=l[0]-a[0],y=l[1]-a[1],v=(r[0]-a[0])*y-f*(r[1]-a[1]),x=(t[0]-a[0])*y-f*(t[1]-a[1]);return v>0&&x<0||v<0&&x>0}function Hc(r,t,a){const l=[];for(let f=0;f<r.length;f++){const y=[];for(let v=0;v<r[f].length;v++){const x=Yf(r[f][v],a);qa(t,x),y.push(x)}l.push(y)}return l}function Dh(r,t,a){const l=[];for(let f=0;f<r.length;f++){const y=Hc(r[f],t,a);l.push(y)}return l}function Lh(r,t,a,l){if(r[0]<a[0]||r[0]>a[2]){const f=.5*l;let y=r[0]-a[0]>f?-l:a[0]-r[0]>f?l:0;y===0&&(y=r[0]-a[2]>f?-l:a[2]-r[0]>f?l:0),r[0]+=y}qa(t,r)}function Rh(r,t,a,l){const f=Math.pow(2,l.z)*la,y=[l.x*la,l.y*la],v=[];for(const x of r)for(const T of x){const A=[T.x+y[0],T.y+y[1]];Lh(A,t,a,f),v.push(A)}return v}function Bh(r,t,a,l){const f=Math.pow(2,l.z)*la,y=[l.x*la,l.y*la],v=[];for(const T of r){const A=[];for(const I of T){const P=[I.x+y[0],I.y+y[1]];qa(t,P),A.push(P)}v.push(A)}if(t[2]-t[0]<=f/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const T of v)for(const A of T)Lh(A,t,a,f)}var x;return v}class Ga{constructor(t,a){this.type=kt,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ua(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const f=[];for(const y of l.features){const{type:v,coordinates:x}=y.geometry;v==="Polygon"&&f.push(x),v==="MultiPolygon"&&f.push(...x)}if(f.length)return new Ga(l,{type:"MultiPolygon",coordinates:f})}else if(l.type==="Feature"){const f=l.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Ga(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ga(l,l)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,l){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(l.type==="Polygon"){const x=Hc(l.coordinates,y,v),T=Rh(a.geometry(),f,y,v);if(!Ca(f,y))return!1;for(const A of T)if(!Es(A,x))return!1}if(l.type==="MultiPolygon"){const x=Dh(l.coordinates,y,v),T=Rh(a.geometry(),f,y,v);if(!Ca(f,y))return!1;for(const A of T)if(!Jf(A,x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,l){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(l.type==="Polygon"){const x=Hc(l.coordinates,y,v),T=Bh(a.geometry(),f,y,v);if(!Ca(f,y))return!1;for(const A of T)if(!Ph(A,x))return!1}if(l.type==="MultiPolygon"){const x=Dh(l.coordinates,y,v),T=Bh(a.geometry(),f,y,v);if(!Ca(f,y))return!1;for(const A of T)if(!Qf(A,x))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Oh=class{constructor(r=[],t=(a,l)=>a<l?-1:a>l?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:a}=this,l=t[r];for(;r>0;){const f=r-1>>1,y=t[f];if(a(l,y)>=0)break;t[r]=y,r=f}t[r]=l}_down(r){const{data:t,compare:a}=this,l=this.length>>1,f=t[r];for(;r<l;){let y=1+(r<<1);const v=y+1;if(v<this.length&&a(t[v],t[y])<0&&(y=v),a(t[y],f)>=0)break;t[r]=t[y],r=y}t[r]=f}};function ep(r,t,a,l,f){Fh(r,t,a,l||r.length-1,f)}function Fh(r,t,a,l,f){for(;l>a;){if(l-a>600){var y=l-a+1,v=t-a+1,x=Math.log(y),T=.5*Math.exp(2*x/3),A=.5*Math.sqrt(x*T*(y-T)/y)*(v-y/2<0?-1:1);Fh(r,t,Math.max(a,Math.floor(t-v*T/y+A)),Math.min(l,Math.floor(t+(y-v)*T/y+A)),f)}var I=r[t],P=a,L=l;for(bo(r,a,t),f(r[l],I)>0&&bo(r,a,l);P<L;){for(bo(r,P,L),P++,L--;f(r[P],I)<0;)P++;for(;f(r[L],I)>0;)L--}f(r[a],I)===0?bo(r,a,L):bo(r,++L,l),L<=t&&(a=L+1),t<=L&&(l=L-1)}}function bo(r,t,a){var l=r[t];r[t]=r[a],r[a]=l}function xl(r,t){if(r.length<=1)return[r];const a=[];let l,f;for(const y of r){const v=ip(y);v!==0&&(y.area=Math.abs(v),f===void 0&&(f=v<0),f===v<0?(l&&a.push(l),l=[y]):l.push(y))}if(l&&a.push(l),t>1)for(let y=0;y<a.length;y++)a[y].length<=t||(ep(a[y],t,1,a[y].length-1,tp),a[y]=a[y].slice(0,t));return a}function tp(r,t){return t.area-r.area}function ip(r){let t=0;for(let a,l,f=0,y=r.length,v=y-1;f<y;v=f++)a=r[f],l=r[v],t+=(l.x-a.x)*(a.y+l.y);return t}const Nh=1/298.257223563,jh=Nh*(2-Nh),Vh=Math.PI/180;class qc{constructor(t){const a=6378.137*Vh*1e3,l=Math.cos(t*Vh),f=1/(1-jh*(1-l*l)),y=Math.sqrt(f);this.kx=a*y*l,this.ky=a*y*f*(1-jh)}distance(t,a){const l=this.wrap(t[0]-a[0])*this.kx,f=(t[1]-a[1])*this.ky;return Math.sqrt(l*l+f*f)}pointOnLine(t,a){let l,f,y,v,x=1/0;for(let T=0;T<t.length-1;T++){let A=t[T][0],I=t[T][1],P=this.wrap(t[T+1][0]-A)*this.kx,L=(t[T+1][1]-I)*this.ky,j=0;P===0&&L===0||(j=(this.wrap(a[0]-A)*this.kx*P+(a[1]-I)*this.ky*L)/(P*P+L*L),j>1?(A=t[T+1][0],I=t[T+1][1]):j>0&&(A+=P/this.kx*j,I+=L/this.ky*j)),P=this.wrap(a[0]-A)*this.kx,L=(a[1]-I)*this.ky;const $=P*P+L*L;$<x&&(x=$,l=A,f=I,y=T,v=j)}return{point:[l,f],index:y,t:Math.max(0,Math.min(1,v))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function $h(r,t){return t[0]-r[0]}function wl(r){return r[1]-r[0]+1}function ga(r,t){return r[1]>=r[0]&&r[1]<t}function Gc(r,t){if(r[0]>r[1])return[null,null];const a=wl(r);if(t){if(a===2)return[r,null];const f=Math.floor(a/2);return[[r[0],r[0]+f],[r[0]+f,r[1]]]}if(a===1)return[r,null];const l=Math.floor(a/2)-1;return[[r[0],r[0]+l],[r[0]+l+1,r[1]]]}function Zc(r,t){if(!ga(t,r.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)qa(a,r[l]);return a}function Xc(r){const t=[1/0,1/0,-1/0,-1/0];for(const a of r)for(const l of a)qa(t,l);return t}function Uh(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function xo(r,t,a){if(!Uh(r)||!Uh(t))return NaN;let l=0,f=0;return r[2]<t[0]&&(l=t[0]-r[2]),r[0]>t[2]&&(l=r[0]-t[2]),r[1]>t[3]&&(f=r[1]-t[3]),r[3]<t[1]&&(f=t[1]-r[3]),a.distance([0,0],[l,f])}function Za(r,t,a){const l=a.pointOnLine(t,r);return a.distance(r,l.point)}function Yc(r,t,a,l,f){const y=Math.min(Za(r,[a,l],f),Za(t,[a,l],f)),v=Math.min(Za(a,[r,t],f),Za(l,[r,t],f));return Math.min(y,v)}function np(r,t,a,l,f){if(!ga(t,r.length)||!ga(l,a.length))return 1/0;let y=1/0;for(let v=t[0];v<t[1];++v){const x=r[v],T=r[v+1];for(let A=l[0];A<l[1];++A){const I=a[A],P=a[A+1];if(bl(x,T,I,P))return 0;y=Math.min(y,Yc(x,T,I,P,f))}}return y}function rp(r,t,a,l,f){if(!ga(t,r.length)||!ga(l,a.length))return NaN;let y=1/0;for(let v=t[0];v<=t[1];++v)for(let x=l[0];x<=l[1];++x)if(y=Math.min(y,f.distance(r[v],a[x])),y===0)return y;return y}function fn(r,t,a){if(Es(r,t,!0))return 0;let l=1/0;for(const f of t){const y=f[0],v=f[f.length-1];if(y!==v&&(l=Math.min(l,Za(r,[v,y],a)),l===0))return l;const x=a.pointOnLine(f,r);if(l=Math.min(l,a.distance(r,x.point)),l===0)return l}return l}function ap(r,t,a,l){if(!ga(t,r.length))return NaN;for(let y=t[0];y<=t[1];++y)if(Es(r[y],a,!0))return 0;let f=1/0;for(let y=t[0];y<t[1];++y){const v=r[y],x=r[y+1];for(const T of a)for(let A=0,I=T.length,P=I-1;A<I;P=A++){const L=T[P],j=T[A];if(bl(v,x,L,j))return 0;f=Math.min(f,Yc(v,x,L,j,l))}}return f}function ii(r,t){for(const a of r)for(const l of a)if(Es(l,t,!0))return!0;return!1}function Kc(r,t,a,l=1/0){const f=Xc(r),y=Xc(t);if(l!==1/0&&xo(f,y,a)>=l)return l;if(Ca(f,y)){if(ii(r,t))return 0}else if(ii(t,r))return 0;let v=1/0;for(const x of r)for(let T=0,A=x.length,I=A-1;T<A;I=T++){const P=x[I],L=x[T];for(const j of t)for(let $=0,U=j.length,J=U-1;$<U;J=$++){const re=j[J],xe=j[$];if(bl(P,L,re,xe))return 0;v=Math.min(v,Yc(P,L,re,xe,a))}}return v}function Ui(r,t,a,l,f,y){if(!y)return;const v=xo(Zc(l,y),f,a);v<t&&r.push([v,y,[0,0]])}function Ci(r,t,a,l,f,y,v){if(!y||!v)return;const x=xo(Zc(l,y),Zc(f,v),a);x<t&&r.push([x,y,v])}function Xa(r,t,a,l,f=1/0){let y=Math.min(l.distance(r[0],a[0][0]),f);if(y===0)return y;const v=new Oh([[0,[0,r.length-1],[0,0]]],$h),x=Xc(a);for(;v.length>0;){const T=v.pop();if(T[0]>=y)continue;const A=T[1],I=t?50:100;if(wl(A)<=I){if(!ga(A,r.length))return NaN;if(t){const P=ap(r,A,a,l);if(isNaN(P)||P===0)return P;y=Math.min(y,P)}else for(let P=A[0];P<=A[1];++P){const L=fn(r[P],a,l);if(y=Math.min(y,L),y===0)return 0}}else{const P=Gc(A,t);Ui(v,y,l,r,x,P[0]),Ui(v,y,l,r,x,P[1])}}return y}function wo(r,t,a,l,f,y=1/0){let v=Math.min(y,f.distance(r[0],a[0]));if(v===0)return v;const x=new Oh([[0,[0,r.length-1],[0,a.length-1]]],$h);for(;x.length>0;){const T=x.pop();if(T[0]>=v)continue;const A=T[1],I=T[2],P=t?50:100,L=l?50:100;if(wl(A)<=P&&wl(I)<=L){if(!ga(A,r.length)&&ga(I,a.length))return NaN;let j;if(t&&l)j=np(r,A,a,I,f),v=Math.min(v,j);else if(t&&!l){const $=r.slice(A[0],A[1]+1);for(let U=I[0];U<=I[1];++U)if(j=Za(a[U],$,f),v=Math.min(v,j),v===0)return v}else if(!t&&l){const $=a.slice(I[0],I[1]+1);for(let U=A[0];U<=A[1];++U)if(j=Za(r[U],$,f),v=Math.min(v,j),v===0)return v}else j=rp(r,A,a,I,f),v=Math.min(v,j)}else{const j=Gc(A,t),$=Gc(I,l);Ci(x,v,f,r,a,j[0],$[0]),Ci(x,v,f,r,a,j[0],$[1]),Ci(x,v,f,r,a,j[1],$[0]),Ci(x,v,f,r,a,j[1],$[1])}}return v}function Tl(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class Ya{constructor(t,a){this.type=qe,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ua(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new Ya(l,l.features.map(f=>Tl(f.geometry)).flat());if(l.type==="Feature")return new Ya(l,Tl(l.geometry));if("type"in l&&"coordinates"in l)return new Ya(l,Tl(l))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,l){const f=a.geometry(),y=f.flat().map(T=>Wc([T.x,T.y],a.canonical));if(f.length===0)return NaN;const v=new qc(y[0][1]);let x=1/0;for(const T of l){switch(T.type){case"Point":x=Math.min(x,wo(y,!1,[T.coordinates],!1,v,x));break;case"LineString":x=Math.min(x,wo(y,!1,T.coordinates,!0,v,x));break;case"Polygon":x=Math.min(x,Xa(y,!1,T.coordinates,v,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,l){const f=a.geometry(),y=f.flat().map(T=>Wc([T.x,T.y],a.canonical));if(f.length===0)return NaN;const v=new qc(y[0][1]);let x=1/0;for(const T of l){switch(T.type){case"Point":x=Math.min(x,wo(y,!0,[T.coordinates],!1,v,x));break;case"LineString":x=Math.min(x,wo(y,!0,T.coordinates,!0,v,x));break;case"Polygon":x=Math.min(x,Xa(y,!0,T.coordinates,v,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="Polygon")return function(a,l){const f=a.geometry();if(f.length===0||f[0].length===0)return NaN;const y=xl(f,0).map(T=>T.map(A=>A.map(I=>Wc([I.x,I.y],a.canonical)))),v=new qc(y[0][0][0][1]);let x=1/0;for(const T of l)for(const A of y){switch(T.type){case"Point":x=Math.min(x,Xa([T.coordinates],!1,A,v,x));break;case"LineString":x=Math.min(x,Xa(T.coordinates,!0,A,v,x));break;case"Polygon":x=Math.min(x,Kc(A,T.coordinates,v,x))}if(x===0)return x}return x}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Cs={"==":Gf,"!=":Ih,">":Zf,"<":Eh,">=":Ch,"<=":Xf,array:Hr,at:Fc,boolean:Hr,case:pl,coalesce:yl,collator:vo,format:vl,image:$c,in:Nc,"index-of":As,interpolate:pr,"interpolate-hcl":pr,"interpolate-lab":pr,length:Uc,let:Ea,literal:Wr,match:jc,number:Hr,"number-format":Vc,object:Hr,slice:yo,step:Ms,string:Hr,"to-boolean":qr,"to-color":qr,"to-number":qr,"to-string":qr,var:wi,within:Ga,distance:Ya};class Nr{constructor(t,a,l,f){this.name=t,this.type=a,this._evaluate=l,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const l=t[0],f=Nr.definitions[l];if(!f)return a.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,x=v.filter(([A])=>!Array.isArray(A)||A.length===t.length-1);let T=null;for(const[A,I]of x){T=new Wa(a.registry,kl,a.path,null,a.scope);const P=[];let L=!1;for(let j=1;j<t.length;j++){const $=t[j],U=Array.isArray(A)?A[j-1]:A.type,J=T.parse($,1+P.length,U);if(!J){L=!0;break}P.push(J)}if(!L)if(Array.isArray(A)&&A.length!==P.length)T.error(`Expected ${A.length} arguments, but found ${P.length} instead.`);else{for(let j=0;j<P.length;j++){const $=Array.isArray(A)?A[j]:A.type,U=P[j];T.concat(j+1).checkSubtype($,U.type)}if(T.errors.length===0)return new Nr(l,y,I,P)}}if(x.length===1)a.errors.push(...T.errors);else{const A=(x.length?x:v).map(([P])=>{return L=P,Array.isArray(L)?`(${L.map(N).join(", ")})`:`(${N(L.type)}...)`;var L}).join(" | "),I=[];for(let P=1;P<t.length;P++){const L=a.parse(t[P],1+I.length);if(!L)return null;I.push(N(L.type))}a.error(`Expected arguments of type ${A}, but found (${I.join(", ")}) instead.`)}return null}static register(t,a){Nr.definitions=a;for(const l in a)t[l]=Nr}}function Wh(r,[t,a,l,f]){t=t.evaluate(r),a=a.evaluate(r),l=l.evaluate(r);const y=f?f.evaluate(r):1,v=ks(t,a,l,y);if(v)throw new yn(v);return new Ri(t/255,a/255,l/255,y,!1)}function Jc(r,t){return r in t}function Sl(r,t){const a=t[r];return a===void 0?null:a}function Ka(r){return{type:r}}function kl(r){if(r instanceof wi)return kl(r.boundExpression);if(r instanceof Nr&&r.name==="error"||r instanceof vo||r instanceof Ga||r instanceof Ya)return!1;const t=r instanceof qr||r instanceof Hr;let a=!0;return r.eachChild(l=>{a=t?a&&kl(l):a&&l instanceof Wr}),!!a&&To(r)&&So(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function To(r){if(r instanceof Nr&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Ga||r instanceof Ya)return!1;let t=!0;return r.eachChild(a=>{t&&!To(a)&&(t=!1)}),t}function Ps(r){if(r instanceof Nr&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(a=>{t&&!Ps(a)&&(t=!1)}),t}function So(r,t){if(r instanceof Nr&&t.indexOf(r.name)>=0)return!1;let a=!0;return r.eachChild(l=>{a&&!So(l,t)&&(a=!1)}),a}function Qc(r){return{result:"success",value:r}}function Pa(r){return{result:"error",value:r}}function zs(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Hh(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function eu(r){return!!r.expression&&r.expression.interpolated}function yi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Al(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function sp(r){return r}function qh(r,t){const a=t.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",f=l||!(l||r.property!==void 0),y=r.type||(eu(t)?"exponential":"interval");if(a||t.type==="padding"){const I=a?Ri.parse:Ir.parse;(r=Vt({},r)).stops&&(r.stops=r.stops.map(P=>[P[0],I(P[1])])),r.default=I(r.default?r.default:t.default)}if(r.colorSpace&&(v=r.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var v;let x,T,A;if(y==="exponential")x=Ao;else if(y==="interval")x=Zh;else if(y==="categorical"){x=Gh,T=Object.create(null);for(const I of r.stops)T[I[0]]=I[1];A=typeof r.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);x=op}if(l){const I={},P=[];for(let $=0;$<r.stops.length;$++){const U=r.stops[$],J=U[0].zoom;I[J]===void 0&&(I[J]={zoom:J,type:r.type,property:r.property,default:r.default,stops:[]},P.push(J)),I[J].stops.push([U[0].value,U[1]])}const L=[];for(const $ of P)L.push([I[$].zoom,qh(I[$],t)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:pr.interpolationFactor.bind(void 0,j),zoomStops:L.map($=>$[0]),evaluate:({zoom:$},U)=>Ao({stops:L,base:r.base},t,$).evaluate($,U)}}if(f){const I=y==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:pr.interpolationFactor.bind(void 0,I),zoomStops:r.stops.map(P=>P[0]),evaluate:({zoom:P})=>x(r,t,P,T,A)}}return{kind:"source",evaluate(I,P){const L=P&&P.properties?P.properties[r.property]:void 0;return L===void 0?ko(r.default,t.default):x(r,t,L,T,A)}}}function ko(r,t,a){return r!==void 0?r:t!==void 0?t:a!==void 0?a:void 0}function Gh(r,t,a,l,f){return ko(typeof a===f?l[a]:void 0,r.default,t.default)}function Zh(r,t,a){if(yi(a)!=="number")return ko(r.default,t.default);const l=r.stops.length;if(l===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[l-1][0])return r.stops[l-1][1];const f=ml(r.stops.map(y=>y[0]),a);return r.stops[f][1]}function Ao(r,t,a){const l=r.base!==void 0?r.base:1;if(yi(a)!=="number")return ko(r.default,t.default);const f=r.stops.length;if(f===1||a<=r.stops[0][0])return r.stops[0][1];if(a>=r.stops[f-1][0])return r.stops[f-1][1];const y=ml(r.stops.map(I=>I[0]),a),v=function(I,P,L,j){const $=j-L,U=I-L;return $===0?0:P===1?U/$:(Math.pow(P,U)-1)/(Math.pow(P,$)-1)}(a,l,r.stops[y][0],r.stops[y+1][0]),x=r.stops[y][1],T=r.stops[y+1][1],A=fr[t.type]||sp;return typeof x.evaluate=="function"?{evaluate(...I){const P=x.evaluate.apply(void 0,I),L=T.evaluate.apply(void 0,I);if(P!==void 0&&L!==void 0)return A(P,L,v,r.colorSpace)}}:A(x,T,v,r.colorSpace)}function op(r,t,a){switch(t.type){case"color":a=Ri.parse(a);break;case"formatted":a=Mr.fromString(a.toString());break;case"resolvedImage":a=Er.fromString(a.toString());break;case"padding":a=Ir.parse(a);break;default:yi(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return ko(a,r.default,t.default)}Nr.register(Cs,{error:[{kind:"error"},[Dt],(r,[t])=>{throw new yn(t.evaluate(r))}],typeof:[Dt,[Bt],(r,[t])=>N(wn(t.evaluate(r)))],"to-rgba":[F(qe,4),[Di],(r,[t])=>{const[a,l,f,y]=t.evaluate(r).rgb;return[255*a,255*l,255*f,y]}],rgb:[Di,[qe,qe,qe],Wh],rgba:[Di,[qe,qe,qe,qe],Wh],has:{type:kt,overloads:[[[Dt],(r,[t])=>Jc(t.evaluate(r),r.properties())],[[Dt,Fn],(r,[t,a])=>Jc(t.evaluate(r),a.evaluate(r))]]},get:{type:Bt,overloads:[[[Dt],(r,[t])=>Sl(t.evaluate(r),r.properties())],[[Dt,Fn],(r,[t,a])=>Sl(t.evaluate(r),a.evaluate(r))]]},"feature-state":[Bt,[Dt],(r,[t])=>Sl(t.evaluate(r),r.featureState||{})],properties:[Fn,[],r=>r.properties()],"geometry-type":[Dt,[],r=>r.geometryType()],id:[Bt,[],r=>r.id()],zoom:[qe,[],r=>r.globals.zoom],"heatmap-density":[qe,[],r=>r.globals.heatmapDensity||0],"line-progress":[qe,[],r=>r.globals.lineProgress||0],accumulated:[Bt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[qe,Ka(qe),(r,t)=>{let a=0;for(const l of t)a+=l.evaluate(r);return a}],"*":[qe,Ka(qe),(r,t)=>{let a=1;for(const l of t)a*=l.evaluate(r);return a}],"-":{type:qe,overloads:[[[qe,qe],(r,[t,a])=>t.evaluate(r)-a.evaluate(r)],[[qe],(r,[t])=>-t.evaluate(r)]]},"/":[qe,[qe,qe],(r,[t,a])=>t.evaluate(r)/a.evaluate(r)],"%":[qe,[qe,qe],(r,[t,a])=>t.evaluate(r)%a.evaluate(r)],ln2:[qe,[],()=>Math.LN2],pi:[qe,[],()=>Math.PI],e:[qe,[],()=>Math.E],"^":[qe,[qe,qe],(r,[t,a])=>Math.pow(t.evaluate(r),a.evaluate(r))],sqrt:[qe,[qe],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[qe,[qe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[qe,[qe],(r,[t])=>Math.log(t.evaluate(r))],log2:[qe,[qe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[qe,[qe],(r,[t])=>Math.sin(t.evaluate(r))],cos:[qe,[qe],(r,[t])=>Math.cos(t.evaluate(r))],tan:[qe,[qe],(r,[t])=>Math.tan(t.evaluate(r))],asin:[qe,[qe],(r,[t])=>Math.asin(t.evaluate(r))],acos:[qe,[qe],(r,[t])=>Math.acos(t.evaluate(r))],atan:[qe,[qe],(r,[t])=>Math.atan(t.evaluate(r))],min:[qe,Ka(qe),(r,t)=>Math.min(...t.map(a=>a.evaluate(r)))],max:[qe,Ka(qe),(r,t)=>Math.max(...t.map(a=>a.evaluate(r)))],abs:[qe,[qe],(r,[t])=>Math.abs(t.evaluate(r))],round:[qe,[qe],(r,[t])=>{const a=t.evaluate(r);return a<0?-Math.round(-a):Math.round(a)}],floor:[qe,[qe],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[qe,[qe],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[kt,[Dt,Bt],(r,[t,a])=>r.properties()[t.value]===a.value],"filter-id-==":[kt,[Bt],(r,[t])=>r.id()===t.value],"filter-type-==":[kt,[Dt],(r,[t])=>r.geometryType()===t.value],"filter-<":[kt,[Dt,Bt],(r,[t,a])=>{const l=r.properties()[t.value],f=a.value;return typeof l==typeof f&&l<f}],"filter-id-<":[kt,[Bt],(r,[t])=>{const a=r.id(),l=t.value;return typeof a==typeof l&&a<l}],"filter->":[kt,[Dt,Bt],(r,[t,a])=>{const l=r.properties()[t.value],f=a.value;return typeof l==typeof f&&l>f}],"filter-id->":[kt,[Bt],(r,[t])=>{const a=r.id(),l=t.value;return typeof a==typeof l&&a>l}],"filter-<=":[kt,[Dt,Bt],(r,[t,a])=>{const l=r.properties()[t.value],f=a.value;return typeof l==typeof f&&l<=f}],"filter-id-<=":[kt,[Bt],(r,[t])=>{const a=r.id(),l=t.value;return typeof a==typeof l&&a<=l}],"filter->=":[kt,[Dt,Bt],(r,[t,a])=>{const l=r.properties()[t.value],f=a.value;return typeof l==typeof f&&l>=f}],"filter-id->=":[kt,[Bt],(r,[t])=>{const a=r.id(),l=t.value;return typeof a==typeof l&&a>=l}],"filter-has":[kt,[Bt],(r,[t])=>t.value in r.properties()],"filter-has-id":[kt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[kt,[F(Dt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[kt,[F(Bt)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[kt,[Dt,F(Bt)],(r,[t,a])=>a.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[kt,[Dt,F(Bt)],(r,[t,a])=>function(l,f,y,v){for(;y<=v;){const x=y+v>>1;if(f[x]===l)return!0;f[x]>l?v=x-1:y=x+1}return!1}(r.properties()[t.value],a.value,0,a.value.length-1)],all:{type:kt,overloads:[[[kt,kt],(r,[t,a])=>t.evaluate(r)&&a.evaluate(r)],[Ka(kt),(r,t)=>{for(const a of t)if(!a.evaluate(r))return!1;return!0}]]},any:{type:kt,overloads:[[[kt,kt],(r,[t,a])=>t.evaluate(r)||a.evaluate(r)],[Ka(kt),(r,t)=>{for(const a of t)if(a.evaluate(r))return!0;return!1}]]},"!":[kt,[kt],(r,[t])=>!t.evaluate(r)],"is-supported-script":[kt,[Dt],(r,[t])=>{const a=r.globals&&r.globals.isSupportedScript;return!a||a(t.evaluate(r))}],upcase:[Dt,[Dt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[Dt,[Dt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[Dt,Ka(Bt),(r,t)=>t.map(a=>go(a.evaluate(r))).join("")],"resolved-locale":[Dt,[An],(r,[t])=>t.evaluate(r).resolvedLocale()]});class Ml{constructor(t,a){var l;this.expression=t,this._warningHistory={},this._evaluator=new fl,this._defaultValue=a?(l=a).type==="color"&&Al(l.default)?new Ri(0,0,0,0):l.type==="color"?Ri.parse(l.default)||null:l.type==="padding"?Ir.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Fr.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,l,f,y,v){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=l,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(t,a,l,f,y,v){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=l||null,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new yn(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Mo(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Cs}function Il(r,t){const a=new Wa(Cs,kl,[],t?function(f){const y={color:Di,string:Dt,number:qe,enum:Dt,boolean:kt,formatted:Ar,padding:Ur,resolvedImage:En,variableAnchorOffsetCollection:ie};return f.type==="array"?F(y[f.value]||Bt,f.length):y[f.type]}(t):void 0),l=a.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Qc(new Ml(l,t)):Pa(a.errors)}class Io{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!Ps(a.expression)}evaluateWithoutErrorHandling(t,a,l,f,y,v){return this._styleExpression.evaluateWithoutErrorHandling(t,a,l,f,y,v)}evaluate(t,a,l,f,y,v){return this._styleExpression.evaluate(t,a,l,f,y,v)}}class Ds{constructor(t,a,l,f){this.kind=t,this.zoomStops=l,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!Ps(a.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,a,l,f,y,v){return this._styleExpression.evaluateWithoutErrorHandling(t,a,l,f,y,v)}evaluate(t,a,l,f,y,v){return this._styleExpression.evaluate(t,a,l,f,y,v)}interpolationFactor(t,a,l){return this.interpolationType?pr.interpolationFactor(this.interpolationType,t,a,l):0}}function Eo(r,t){const a=Il(r,t);if(a.result==="error")return a;const l=a.value.expression,f=To(l);if(!f&&!zs(t))return Pa([new Ut("","data expressions not supported")]);const y=So(l,["zoom"]);if(!y&&!Hh(t))return Pa([new Ut("","zoom expressions not supported")]);const v=Ls(l);return v||y?v instanceof Ut?Pa([v]):v instanceof pr&&!eu(t)?Pa([new Ut("",'"interpolate" expressions cannot be used with this property')]):Qc(v?new Ds(f?"camera":"composite",a.value,v.labels,v instanceof pr?v.interpolation:void 0):new Io(f?"constant":"source",a.value)):Pa([new Ut("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Co{constructor(t,a){this._parameters=t,this._specification=a,Vt(this,qh(this._parameters,this._specification))}static deserialize(t){return new Co(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ls(r){let t=null;if(r instanceof Ea)t=Ls(r.result);else if(r instanceof yl){for(const a of r.args)if(t=Ls(a),t)break}else(r instanceof Ms||r instanceof pr)&&r.input instanceof Nr&&r.input.name==="zoom"&&(t=r);return t instanceof Ut||r.eachChild(a=>{const l=Ls(a);l instanceof Ut?t=l:!t&&l?t=new Ut("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new Ut("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function El(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!El(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Xh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Rs(r){if(r==null)return{filter:()=>!0,needGeometry:!1};El(r)||(r=Cl(r));const t=Il(r,Xh);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,l,f)=>t.value.evaluate(a,l,{},f),needGeometry:Yh(r)}}function lp(r,t){return r<t?-1:r>t?1:0}function Yh(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Yh(r[t]))return!0;return!1}function Cl(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?tu(r[1],r[2],"=="):t==="!="?Ja(tu(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?tu(r[1],r[2],t):t==="any"?(a=r.slice(1),["any"].concat(a.map(Cl))):t==="all"?["all"].concat(r.slice(1).map(Cl)):t==="none"?["all"].concat(r.slice(1).map(Cl).map(Ja)):t==="in"?Kh(r[1],r.slice(2)):t==="!in"?Ja(Kh(r[1],r.slice(2))):t==="has"?Po(r[1]):t!=="!has"||Ja(Po(r[1]));var a}function tu(r,t,a){switch(r){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,r,t]}}function Kh(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",r,["literal",t.sort(lp)]]:["filter-in-small",r,["literal",t]]}}function Po(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Ja(r){return["!",r]}function tr(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let f="[";for(const y of r)f+=`${tr(y)},`;return`${f}]`}const a=Object.keys(r).sort();let l="{";for(let f=0;f<a.length;f++)l+=`${JSON.stringify(a[f])}:${tr(r[a[f]])},`;return`${l}}`}function zo(r){let t="";for(const a of dn)t+=`/${tr(r[a])}`;return t}function iu(r){const t=r.value;return t?[new ze(r.key,t,"constants have been deprecated as of v8")]:[]}function pn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Qa(r){if(Array.isArray(r))return r.map(Qa);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const a in r)t[a]=Qa(r[a]);return t}return pn(r)}function Wn(r){const t=r.key,a=r.value,l=r.valueSpec||{},f=r.objectElementValidators||{},y=r.style,v=r.styleSpec,x=r.validateSpec;let T=[];const A=yi(a);if(A!=="object")return[new ze(t,a,`object expected, ${A} found`)];for(const I in a){const P=I.split(".")[0],L=l[P]||l["*"];let j;if(f[P])j=f[P];else if(l[P])j=x;else if(f["*"])j=f["*"];else{if(!l["*"]){T.push(new ze(t,a[I],`unknown property "${I}"`));continue}j=x}T=T.concat(j({key:(t&&`${t}.`)+I,value:a[I],valueSpec:L,style:y,styleSpec:v,object:a,objectKey:I,validateSpec:x},a))}for(const I in l)f[I]||l[I].required&&l[I].default===void 0&&a[I]===void 0&&T.push(new ze(t,a,`missing required property "${I}"`));return T}function Pl(r){const t=r.value,a=r.valueSpec,l=r.style,f=r.styleSpec,y=r.key,v=r.arrayElementValidator||r.validateSpec;if(yi(t)!=="array")return[new ze(y,t,`array expected, ${yi(t)} found`)];if(a.length&&t.length!==a.length)return[new ze(y,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new ze(y,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let x={type:a.value,values:a.values};f.$version<7&&(x.function=a.function),yi(a.value)==="object"&&(x=a.value);let T=[];for(let A=0;A<t.length;A++)T=T.concat(v({array:t,arrayIndex:A,value:t[A],valueSpec:x,validateSpec:r.validateSpec,style:l,styleSpec:f,key:`${y}[${A}]`}));return T}function Do(r){const t=r.key,a=r.value,l=r.valueSpec;let f=yi(a);return f==="number"&&a!=a&&(f="NaN"),f!=="number"?[new ze(t,a,`number expected, ${f} found`)]:"minimum"in l&&a<l.minimum?[new ze(t,a,`${a} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&a>l.maximum?[new ze(t,a,`${a} is greater than the maximum value ${l.maximum}`)]:[]}function Jh(r){const t=r.valueSpec,a=pn(r.value.type);let l,f,y,v={};const x=a!=="categorical"&&r.value.property===void 0,T=!x,A=yi(r.value.stops)==="array"&&yi(r.value.stops[0])==="array"&&yi(r.value.stops[0][0])==="object",I=Wn({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(j){if(a==="identity")return[new ze(j.key,j.value,'identity function may not have a "stops" property')];let $=[];const U=j.value;return $=$.concat(Pl({key:j.key,value:U,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:P})),yi(U)==="array"&&U.length===0&&$.push(new ze(j.key,U,"array must have at least one stop")),$},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:t,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return a==="identity"&&x&&I.push(new ze(r.key,r.value,'missing required property "property"')),a==="identity"||r.value.stops||I.push(new ze(r.key,r.value,'missing required property "stops"')),a==="exponential"&&r.valueSpec.expression&&!eu(r.valueSpec)&&I.push(new ze(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(T&&!zs(r.valueSpec)?I.push(new ze(r.key,r.value,"property functions not supported")):x&&!Hh(r.valueSpec)&&I.push(new ze(r.key,r.value,"zoom functions not supported"))),a!=="categorical"&&!A||r.value.property!==void 0||I.push(new ze(r.key,r.value,'"property" property is required')),I;function P(j){let $=[];const U=j.value,J=j.key;if(yi(U)!=="array")return[new ze(J,U,`array expected, ${yi(U)} found`)];if(U.length!==2)return[new ze(J,U,`array length 2 expected, length ${U.length} found`)];if(A){if(yi(U[0])!=="object")return[new ze(J,U,`object expected, ${yi(U[0])} found`)];if(U[0].zoom===void 0)return[new ze(J,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new ze(J,U,"object stop key must have value")];if(y&&y>pn(U[0].zoom))return[new ze(J,U[0].zoom,"stop zoom values must appear in ascending order")];pn(U[0].zoom)!==y&&(y=pn(U[0].zoom),f=void 0,v={}),$=$.concat(Wn({key:`${J}[0]`,value:U[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:Do,value:L}}))}else $=$.concat(L({key:`${J}[0]`,value:U[0],valueSpec:{},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},U));return Mo(Qa(U[1]))?$.concat([new ze(`${J}[1]`,U[1],"expressions are not allowed in function stops.")]):$.concat(j.validateSpec({key:`${J}[1]`,value:U[1],valueSpec:t,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function L(j,$){const U=yi(j.value),J=pn(j.value),re=j.value!==null?j.value:$;if(l){if(U!==l)return[new ze(j.key,re,`${U} stop domain type must match previous stop domain type ${l}`)]}else l=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new ze(j.key,re,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&a!=="categorical"){let xe=`number expected, ${U} found`;return zs(t)&&a===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ze(j.key,re,xe)]}return a!=="categorical"||U!=="number"||isFinite(J)&&Math.floor(J)===J?a!=="categorical"&&U==="number"&&f!==void 0&&J<f?[new ze(j.key,re,"stop domain values must appear in ascending order")]:(f=J,a==="categorical"&&J in v?[new ze(j.key,re,"stop domain values must be unique")]:(v[J]=!0,[])):[new ze(j.key,re,`integer expected, found ${J}`)]}}function za(r){const t=(r.expressionContext==="property"?Eo:Il)(Qa(r.value),r.valueSpec);if(t.result==="error")return t.value.map(l=>new ze(`${r.key}${l.key}`,r.value,l.message));const a=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!a.outputDefined())return[new ze(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Ps(a))return[new ze(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Ps(a))return[new ze(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!So(a,["zoom","feature-state"]))return[new ze(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!To(a))return[new ze(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Lo(r){const t=r.key,a=r.value,l=r.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(pn(a))===-1&&f.push(new ze(t,a,`expected one of [${l.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(l.values).indexOf(pn(a))===-1&&f.push(new ze(t,a,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(a)} found`)),f}function es(r){return El(Qa(r.value))?za(Vt({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Qh(r)}function Qh(r){const t=r.value,a=r.key;if(yi(t)!=="array")return[new ze(a,t,`array expected, ${yi(t)} found`)];const l=r.styleSpec;let f,y=[];if(t.length<1)return[new ze(a,t,"filter array must have at least 1 element")];switch(y=y.concat(Lo({key:`${a}[0]`,value:t[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),pn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&pn(t[1])==="$type"&&y.push(new ze(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&y.push(new ze(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=yi(t[1]),f!=="string"&&y.push(new ze(`${a}[1]`,t[1],`string expected, ${f} found`)));for(let v=2;v<t.length;v++)f=yi(t[v]),pn(t[1])==="$type"?y=y.concat(Lo({key:`${a}[${v}]`,value:t[v],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new ze(`${a}[${v}]`,t[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)y=y.concat(Qh({key:`${a}[${v}]`,value:t[v],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":f=yi(t[1]),t.length!==2?y.push(new ze(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new ze(`${a}[1]`,t[1],`string expected, ${f} found`))}return y}function zl(r,t){const a=r.key,l=r.validateSpec,f=r.style,y=r.styleSpec,v=r.value,x=r.objectKey,T=y[`${t}_${r.layerType}`];if(!T)return[];const A=x.match(/^(.*)-transition$/);if(t==="paint"&&A&&T[A[1]]&&T[A[1]].transition)return l({key:a,value:v,valueSpec:y.transition,style:f,styleSpec:y});const I=r.valueSpec||T[x];if(!I)return[new ze(a,v,`unknown property "${x}"`)];let P;if(yi(v)==="string"&&zs(I)&&!I.tokens&&(P=/^{([^}]+)}$/.exec(v)))return[new ze(a,v,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(P[1])} }\`.`)];const L=[];return r.layerType==="symbol"&&(x==="text-field"&&f&&!f.glyphs&&L.push(new ze(a,v,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Al(Qa(v))&&pn(v.type)==="identity"&&L.push(new ze(a,v,'"text-font" does not support identity functions'))),L.concat(l({key:r.key,value:v,valueSpec:I,style:f,styleSpec:y,expressionContext:"property",propertyType:t,propertyKey:x}))}function nu(r){return zl(r,"paint")}function Dl(r){return zl(r,"layout")}function ru(r){let t=[];const a=r.value,l=r.key,f=r.style,y=r.styleSpec;a.type||a.ref||t.push(new ze(l,a,'either "type" or "ref" is required'));let v=pn(a.type);const x=pn(a.ref);if(a.id){const T=pn(a.id);for(let A=0;A<r.arrayIndex;A++){const I=f.layers[A];pn(I.id)===T&&t.push(new ze(l,a.id,`duplicate layer id "${a.id}", previously used at line ${I.id.__line__}`))}}if("ref"in a){let T;["type","source","source-layer","filter","layout"].forEach(A=>{A in a&&t.push(new ze(l,a[A],`"${A}" is prohibited for ref layers`))}),f.layers.forEach(A=>{pn(A.id)===x&&(T=A)}),T?T.ref?t.push(new ze(l,a.ref,"ref cannot reference another ref layer")):v=pn(T.type):t.push(new ze(l,a.ref,`ref layer "${x}" not found`))}else if(v!=="background")if(a.source){const T=f.sources&&f.sources[a.source],A=T&&pn(T.type);T?A==="vector"&&v==="raster"?t.push(new ze(l,a.source,`layer "${a.id}" requires a raster source`)):A!=="raster-dem"&&v==="hillshade"?t.push(new ze(l,a.source,`layer "${a.id}" requires a raster-dem source`)):A==="raster"&&v!=="raster"?t.push(new ze(l,a.source,`layer "${a.id}" requires a vector source`)):A!=="vector"||a["source-layer"]?A==="raster-dem"&&v!=="hillshade"?t.push(new ze(l,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!a.paint||!a.paint["line-gradient"]||A==="geojson"&&T.lineMetrics||t.push(new ze(l,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ze(l,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new ze(l,a.source,`source "${a.source}" not found`))}else t.push(new ze(l,a,'missing required property "source"'));return t=t.concat(Wn({key:l,value:a,valueSpec:y.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${l}.type`,value:a.type,valueSpec:y.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:a,objectKey:"type"}),filter:es,layout:T=>Wn({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":A=>Dl(Vt({layerType:v},A))}}),paint:T=>Wn({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":A=>nu(Vt({layerType:v},A))}})}})),t}function Da(r){const t=r.value,a=r.key,l=yi(t);return l!=="string"?[new ze(a,t,`string expected, ${l} found`)]:[]}const ed={promoteId:function({key:r,value:t}){if(yi(t)==="string")return Da({key:r,value:t});{const a=[];for(const l in t)a.push(...Da({key:`${r}.${l}`,value:t[l]}));return a}}};function Ll(r){const t=r.value,a=r.key,l=r.styleSpec,f=r.style,y=r.validateSpec;if(!t.type)return[new ze(a,t,'"type" is required')];const v=pn(t.type);let x;switch(v){case"vector":case"raster":return x=Wn({key:a,value:t,valueSpec:l[`source_${v.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:ed,validateSpec:y}),x;case"raster-dem":return x=function(T){var A;const I=(A=T.sourceName)!==null&&A!==void 0?A:"",P=T.value,L=T.styleSpec,j=L.source_raster_dem,$=T.style;let U=[];const J=yi(P);if(P===void 0)return U;if(J!=="object")return U.push(new ze("source_raster_dem",P,`object expected, ${J} found`)),U;const re=pn(P.encoding)==="custom",xe=["redFactor","greenFactor","blueFactor","baseShift"],ue=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const ye in P)!re&&xe.includes(ye)?U.push(new ze(ye,P[ye],`In "${I}": "${ye}" is only valid when "encoding" is set to "custom". ${ue} encoding found`)):j[ye]?U=U.concat(T.validateSpec({key:ye,value:P[ye],valueSpec:j[ye],validateSpec:T.validateSpec,style:$,styleSpec:L})):U.push(new ze(ye,P[ye],`unknown property "${ye}"`));return U}({sourceName:a,value:t,style:r.style,styleSpec:l,validateSpec:y}),x;case"geojson":if(x=Wn({key:a,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,validateSpec:y,objectElementValidators:ed}),t.cluster)for(const T in t.clusterProperties){const[A,I]=t.clusterProperties[T],P=typeof A=="string"?[A,["accumulated"],["get",T]]:A;x.push(...za({key:`${a}.${T}.map`,value:I,validateSpec:y,expressionContext:"cluster-map"})),x.push(...za({key:`${a}.${T}.reduce`,value:P,validateSpec:y,expressionContext:"cluster-reduce"}))}return x;case"video":return Wn({key:a,value:t,valueSpec:l.source_video,style:f,validateSpec:y,styleSpec:l});case"image":return Wn({key:a,value:t,valueSpec:l.source_image,style:f,validateSpec:y,styleSpec:l});case"canvas":return[new ze(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lo({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,validateSpec:y,styleSpec:l})}}function Ro(r){const t=r.value,a=r.styleSpec,l=a.light,f=r.style;let y=[];const v=yi(t);if(t===void 0)return y;if(v!=="object")return y=y.concat([new ze("light",t,`object expected, ${v} found`)]),y;for(const x in t){const T=x.match(/^(.*)-transition$/);y=y.concat(T&&l[T[1]]&&l[T[1]].transition?r.validateSpec({key:x,value:t[x],valueSpec:a.transition,validateSpec:r.validateSpec,style:f,styleSpec:a}):l[x]?r.validateSpec({key:x,value:t[x],valueSpec:l[x],validateSpec:r.validateSpec,style:f,styleSpec:a}):[new ze(x,t[x],`unknown property "${x}"`)])}return y}function au(r){const t=r.value,a=r.styleSpec,l=a.sky,f=r.style,y=yi(t);if(t===void 0)return[];if(y!=="object")return[new ze("sky",t,`object expected, ${y} found`)];let v=[];for(const x in t)v=v.concat(l[x]?r.validateSpec({key:x,value:t[x],valueSpec:l[x],style:f,styleSpec:a}):[new ze(x,t[x],`unknown property "${x}"`)]);return v}function su(r){const t=r.value,a=r.styleSpec,l=a.terrain,f=r.style;let y=[];const v=yi(t);if(t===void 0)return y;if(v!=="object")return y=y.concat([new ze("terrain",t,`object expected, ${v} found`)]),y;for(const x in t)y=y.concat(l[x]?r.validateSpec({key:x,value:t[x],valueSpec:l[x],validateSpec:r.validateSpec,style:f,styleSpec:a}):[new ze(x,t[x],`unknown property "${x}"`)]);return y}function ou(r){let t=[];const a=r.value,l=r.key;if(Array.isArray(a)){const f=[],y=[];for(const v in a)a[v].id&&f.includes(a[v].id)&&t.push(new ze(l,a,`all the sprites' ids must be unique, but ${a[v].id} is duplicated`)),f.push(a[v].id),a[v].url&&y.includes(a[v].url)&&t.push(new ze(l,a,`all the sprites' URLs must be unique, but ${a[v].url} is duplicated`)),y.push(a[v].url),t=t.concat(Wn({key:`${l}[${v}]`,value:a[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return Da({key:l,value:a})}const lu={"*":()=>[],array:Pl,boolean:function(r){const t=r.value,a=r.key,l=yi(t);return l!=="boolean"?[new ze(a,t,`boolean expected, ${l} found`)]:[]},number:Do,color:function(r){const t=r.key,a=r.value,l=yi(a);return l!=="string"?[new ze(t,a,`color expected, ${l} found`)]:Ri.parse(String(a))?[]:[new ze(t,a,`color expected, "${a}" found`)]},constants:iu,enum:Lo,filter:es,function:Jh,layer:ru,object:Wn,source:Ll,light:Ro,sky:au,terrain:su,projection:function(r){const t=r.value,a=r.styleSpec,l=a.projection,f=r.style,y=yi(t);if(t===void 0)return[];if(y!=="object")return[new ze("projection",t,`object expected, ${y} found`)];let v=[];for(const x in t)v=v.concat(l[x]?r.validateSpec({key:x,value:t[x],valueSpec:l[x],style:f,styleSpec:a}):[new ze(x,t[x],`unknown property "${x}"`)]);return v},string:Da,formatted:function(r){return Da(r).length===0?[]:za(r)},resolvedImage:function(r){return Da(r).length===0?[]:za(r)},padding:function(r){const t=r.key,a=r.value;if(yi(a)==="array"){if(a.length<1||a.length>4)return[new ze(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const l={type:"number"};let f=[];for(let y=0;y<a.length;y++)f=f.concat(r.validateSpec({key:`${t}[${y}]`,value:a[y],validateSpec:r.validateSpec,valueSpec:l}));return f}return Do({key:t,value:a,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const t=r.key,a=r.value,l=yi(a),f=r.styleSpec;if(l!=="array"||a.length<1||a.length%2!=0)return[new ze(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let v=0;v<a.length;v+=2)y=y.concat(Lo({key:`${t}[${v}]`,value:a[v],valueSpec:f.layout_symbol["text-anchor"]})),y=y.concat(Pl({key:`${t}[${v+1}]`,value:a[v+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:f}));return y},sprite:ou};function ts(r){const t=r.value,a=r.valueSpec,l=r.styleSpec;return r.validateSpec=ts,a.expression&&Al(pn(t))?Jh(r):a.expression&&Mo(Qa(t))?za(r):a.type&&lu[a.type]?lu[a.type](r):Wn(Vt({},r,{valueSpec:a.type?l[a.type]:a}))}function cu(r){const t=r.value,a=r.key,l=Da(r);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new ze(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new ze(a,t,'"glyphs" url must include a "{range}" token'))),l}function Gr(r,t=ke){let a=[];return a=a.concat(ts({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:ts,objectElementValidators:{glyphs:cu,"*":()=>[]}})),r.constants&&(a=a.concat(iu({key:"constants",value:r.constants,style:r,styleSpec:t,validateSpec:ts}))),td(a)}function Zr(r){return function(t){return r({...t,validateSpec:ts})}}function td(r){return[].concat(r).sort((t,a)=>t.line-a.line)}function Xr(r){return function(...t){return td(r.apply(this,t))}}Gr.source=Xr(Zr(Ll)),Gr.sprite=Xr(Zr(ou)),Gr.glyphs=Xr(Zr(cu)),Gr.light=Xr(Zr(Ro)),Gr.sky=Xr(Zr(au)),Gr.terrain=Xr(Zr(su)),Gr.layer=Xr(Zr(ru)),Gr.filter=Xr(Zr(es)),Gr.paintProperty=Xr(Zr(nu)),Gr.layoutProperty=Xr(Zr(Dl));const is=Gr,id=is.light,cp=is.sky,up=is.paintProperty,nd=is.layoutProperty;function uu(r,t){let a=!1;if(t&&t.length)for(const l of t)r.fire(new hi(new Error(l.message))),a=!0;return a}class Bs{constructor(t,a,l){const f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const v=new Int32Array(this.arrayBuffer);t=v[0],this.d=(a=v[1])+2*(l=v[2]);for(let T=0;T<this.d*this.d;T++){const A=v[3+T],I=v[3+T+1];f.push(A===I?null:v.subarray(A,I))}const x=v[3+f.length+1];this.keys=v.subarray(v[3+f.length],x),this.bboxes=v.subarray(x),this.insert=this._insertReadonly}else{this.d=a+2*l;for(let v=0;v<this.d*this.d;v++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=l,this.scale=a/t,this.uid=0;const y=l/a*t;this.min=-y,this.max=t+y}insert(t,a,l,f,y){this._forEachCell(a,l,f,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,l,f,y,v){this.cells[y].push(v)}query(t,a,l,f,y){const v=this.min,x=this.max;if(t<=v&&a<=v&&x<=l&&x<=f&&!y)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(t,a,l,f,this._queryCell,T,{},y),T}}_queryCell(t,a,l,f,y,v,x,T){const A=this.cells[y];if(A!==null){const I=this.keys,P=this.bboxes;for(let L=0;L<A.length;L++){const j=A[L];if(x[j]===void 0){const $=4*j;(T?T(P[$+0],P[$+1],P[$+2],P[$+3]):t<=P[$+2]&&a<=P[$+3]&&l>=P[$+0]&&f>=P[$+1])?(x[j]=!0,v.push(I[j])):x[j]=!1}}}}_forEachCell(t,a,l,f,y,v,x,T){const A=this._convertToCellCoord(t),I=this._convertToCellCoord(a),P=this._convertToCellCoord(l),L=this._convertToCellCoord(f);for(let j=A;j<=P;j++)for(let $=I;$<=L;$++){const U=this.d*$+j;if((!T||T(this._convertFromCellCoord(j),this._convertFromCellCoord($),this._convertFromCellCoord(j+1),this._convertFromCellCoord($+1)))&&y.call(this,t,a,l,f,U,v,x,T))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let l=0;for(let v=0;v<this.cells.length;v++)l+=this.cells[v].length;const f=new Int32Array(a+l+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let y=a;for(let v=0;v<t.length;v++){const x=t[v];f[3+v]=y,f.set(x,y),y+=x.length}return f[3+t.length]=y,f.set(this.keys,y),y+=this.keys.length,f[3+t.length+1]=y,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer}static serialize(t,a){const l=t.toArrayBuffer();return a&&a.push(l),{buffer:l}}static deserialize(t){return new Bs(t.buffer)}}const ca={};function ht(r,t,a={}){if(ca[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),ca[r]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}ht("Object",Object),ht("TransferableGridIndex",Bs),ht("Color",Ri),ht("Error",Error),ht("AJAXError",si),ht("ResolvedImage",Er),ht("StylePropertyFunction",Co),ht("StyleExpression",Ml,{omit:["_evaluator"]}),ht("ZoomDependentExpression",Ds),ht("ZoomConstantExpression",Io),ht("CompoundExpression",Nr,{omit:["_evaluate"]});for(const r in Cs)Cs[r]._classRegistryKey||ht(`Expression_${r}`,Cs[r]);function rd(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Bo(r){return r.$name||r.constructor._classRegistryKey}function ad(r){return!function(t){if(t===null||typeof t!="object")return!1;const a=Bo(t);return!(!a||a==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||rd(r)||He(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function Oo(r,t){if(ad(r))return(rd(r)||He(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const y=[];for(const v of r)y.push(Oo(v,t));return y}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const a=Bo(r);if(!a)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!ca[a])throw new Error(`${a} is not registered.`);const{klass:l}=ca[a],f=l.serialize?l.serialize(r,t):{};if(l.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in r){if(!r.hasOwnProperty(y)||ca[a].omit.indexOf(y)>=0)continue;const v=r[y];f[y]=ca[a].shallow.indexOf(y)>=0?v:Oo(v,t)}r instanceof Error&&(f.message=r.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(f.$name=a),f}function Os(r){if(ad(r))return r;if(Array.isArray(r))return r.map(Os);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=Bo(r)||"Object";if(!ca[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=ca[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(r);const l=Object.create(a.prototype);for(const f of Object.keys(r)){if(f==="$name")continue;const y=r[f];l[f]=ca[t].shallow.indexOf(f)>=0?y:Os(y)}return l}class hu{constructor(){this.first=!0}update(t,a){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const li={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function du(r){for(const t of r)if(pu(t.charCodeAt(0)))return!0;return!1}function hp(r){for(const t of r)if(!fp(t.charCodeAt(0)))return!1;return!0}function fu(r){const t=r.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(t.join("|"),"u")}const dp=fu(["Arab","Dupl","Mong","Ougr","Syrc"]);function fp(r){return!dp.test(String.fromCodePoint(r))}const ns=fu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function pu(r){return!(r!==746&&r!==747&&(r<4352||!(li["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||li["CJK Compatibility"](r)||li["CJK Strokes"](r)||!(!li["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||li["Enclosed CJK Letters and Months"](r)||li["Ideographic Description Characters"](r)||li.Kanbun(r)||li.Katakana(r)&&r!==12540||!(!li["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!li["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||li["Vertical Forms"](r)||li["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||ns.test(String.fromCodePoint(r)))))}function sd(r){return!(pu(r)||function(t){return!!(li["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||li["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||li["Letterlike Symbols"](t)||li["Number Forms"](t)||li["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||li["Control Pictures"](t)&&t!==9251||li["Optical Character Recognition"](t)||li["Enclosed Alphanumerics"](t)||li["Geometric Shapes"](t)||li["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||li["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||li["CJK Symbols and Punctuation"](t)||li.Katakana(t)||li["Private Use Area"](t)||li["CJK Compatibility Forms"](t)||li["Small Form Variants"](t)||li["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}const pp=fu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function od(r){return pp.test(String.fromCodePoint(r))}function ld(r,t){return!(!t&&od(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||li.Khmer(r))}function mp(r){for(const t of r)if(od(t.charCodeAt(0)))return!0;return!1}const rs=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Pi{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new hu,this.transition={})}isSupportedScript(t){return function(a,l){for(const f of a)if(!ld(f.charCodeAt(0),l))return!1;return!0}(t,rs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*a}}}class Fo{constructor(t,a){this.property=t,this.value=a,this.expression=function(l,f){if(Al(l))return new Co(l,f);if(Mo(l)){const y=Eo(l,f);if(y.result==="error")throw new Error(y.value.map(v=>`${v.key}: ${v.message}`).join(", "));return y.value}{let y=l;return f.type==="color"&&typeof l=="string"?y=Ri.parse(l):f.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(y=Fr.parse(l)):y=Ir.parse(l),{kind:"constant",evaluate:()=>y}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,l){return this.property.possiblyEvaluate(this,t,a,l)}}class No{constructor(t){this.property=t,this.value=new Fo(t,void 0)}transitioned(t,a){return new Rl(this.property,this.value,a,de({},t.transition,this.transition),t.now)}untransitioned(){return new Rl(this.property,this.value,null,{},0)}}class mu{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return we(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new No(this._values[t].property)),this._values[t].value=new Fo(this._values[t].property,a===null?void 0:we(a))}getTransition(t){return we(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new No(this._values[t].property)),this._values[t].transition=we(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const l=this.getValue(a);l!==void 0&&(t[a]=l);const f=this.getTransition(a);f!==void 0&&(t[`${a}-transition`]=f)}return t}transitioned(t,a){const l=new cd(this._properties);for(const f of Object.keys(this._values))l._values[f]=this._values[f].transitioned(t,a._values[f]);return l}untransitioned(){const t=new cd(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class Rl{constructor(t,a,l,f,y){this.property=t,this.value=a,this.begin=y+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=l)}possiblyEvaluate(t,a,l){const f=t.now||0,y=this.value.possiblyEvaluate(t,a,l),v=this.prior;if(v){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return v.possiblyEvaluate(t,a,l);{const x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,a,l),y,function(T){if(T<=0)return 0;if(T>=1)return 1;const A=T*T,I=A*T;return 4*(T<.5?I:3*(T-A)+I-.75)}(x))}}return y}}class cd{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,l){const f=new Ol(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(t,a,l);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Bl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return we(this._values[t].value)}setValue(t,a){this._values[t]=new Fo(this._values[t].property,a===null?void 0:we(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const l=this.getValue(a);l!==void 0&&(t[a]=l)}return t}possiblyEvaluate(t,a,l){const f=new Ol(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(t,a,l);return f}}class mr{constructor(t,a,l){this.property=t,this.value=a,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,l,f){return this.property.evaluate(this.value,this.parameters,t,a,l,f)}}class Ol{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class St{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,l){const f=fr[this.specification.type];return f?f(t,a,l):t}}class Et{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,l,f){return new mr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},l,f)}:t.expression,a)}interpolate(t,a,l){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new mr(this,{kind:"constant",value:void 0},t.parameters);const f=fr[this.specification.type];if(f){const y=f(t.value.value,a.value.value,l);return new mr(this,{kind:"constant",value:y},t.parameters)}return t}evaluate(t,a,l,f,y,v){return t.kind==="constant"?t.value:t.evaluate(a,l,f,y,v)}}class Fl extends Et{possiblyEvaluate(t,a,l,f){if(t.value===void 0)return new mr(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const y=t.expression.evaluate(a,null,{},l,f),v=t.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,x=this._calculate(v,v,v,a);return new mr(this,{kind:"constant",value:x},a)}if(t.expression.kind==="camera"){const y=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new mr(this,{kind:"constant",value:y},a)}return new mr(this,t.expression,a)}evaluate(t,a,l,f,y,v){if(t.kind==="source"){const x=t.evaluate(a,l,f,y,v);return this._calculate(x,x,x,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},l,f),t.evaluate({zoom:Math.floor(a.zoom)},l,f),t.evaluate({zoom:Math.floor(a.zoom)+1},l,f),a):t.value}_calculate(t,a,l,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:l,to:a}}interpolate(t){return t}}class gu{constructor(t){this.specification=t}possiblyEvaluate(t,a,l,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const y=t.expression.evaluate(a,null,{},l,f);return this._calculate(y,y,y,a)}return this._calculate(t.expression.evaluate(new Pi(Math.floor(a.zoom-1),a)),t.expression.evaluate(new Pi(Math.floor(a.zoom),a)),t.expression.evaluate(new Pi(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,l,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:l,to:a}}interpolate(t){return t}}class Nl{constructor(t){this.specification=t}possiblyEvaluate(t,a,l,f){return!!t.expression.evaluate(a,null,{},l,f)}interpolate(){return!1}}class gr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const l=t[a];l.specification.overridable&&this.overridableProperties.push(a);const f=this.defaultPropertyValues[a]=new Fo(l,void 0),y=this.defaultTransitionablePropertyValues[a]=new No(l);this.defaultTransitioningPropertyValues[a]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=f.possiblyEvaluate({})}}}ht("DataDrivenProperty",Et),ht("DataConstantProperty",St),ht("CrossFadedDataDrivenProperty",Fl),ht("CrossFadedProperty",gu),ht("ColorRampProperty",Nl);const g="-transition";class e extends xi{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new Bl(a.layout)),a.paint)){this._transitionablePaint=new mu(a.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ol(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,l={}){a!=null&&this._validate(nd,`layers.${this.id}.layout.${t}`,t,a,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(g)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,l={}){if(a!=null&&this._validate(up,`layers.${this.id}.paint.${t}`,t,a,l))return!1;if(t.endsWith(g))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const f=this._transitionablePaint._values[t],y=f.property.specification["property-type"]==="cross-faded-data-driven",v=f.value.isDataDriven(),x=f.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||v||y||this._handleOverridablePaintPropertyUpdate(t,x,T)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Le(t,(a,l)=>!(a===void 0||l==="layout"&&!Object.keys(a).length||l==="paint"&&!Object.keys(a).length))}_validate(t,a,l,f,y={}){return(!y||y.validate!==!1)&&uu(this,t.call(is,{key:a,layerType:this.type,objectKey:l,value:f,styleSpec:ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof mr&&zs(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const s={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class u{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class d{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function m(r,t=1){let a=0,l=0;return{members:r.map(f=>{const y=s[f.type].BYTES_PER_ELEMENT,v=a=w(a,Math.max(t,y)),x=f.components||1;return l=Math.max(l,y),a+=y*x,{name:f.name,type:f.type,components:x,offset:v}}),size:w(a,Math.max(l,t)),alignment:t}}function w(r,t){return Math.ceil(r/t)*t}class S extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const l=this.length;return this.resize(l+1),this.emplace(l,t,a)}emplace(t,a,l){const f=2*t;return this.int16[f+0]=a,this.int16[f+1]=l,t}}S.prototype.bytesPerElement=4,ht("StructArrayLayout2i4",S);class k extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,l)}emplace(t,a,l,f){const y=3*t;return this.int16[y+0]=a,this.int16[y+1]=l,this.int16[y+2]=f,t}}k.prototype.bytesPerElement=6,ht("StructArrayLayout3i6",k);class E extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,l,f){const y=this.length;return this.resize(y+1),this.emplace(y,t,a,l,f)}emplace(t,a,l,f,y){const v=4*t;return this.int16[v+0]=a,this.int16[v+1]=l,this.int16[v+2]=f,this.int16[v+3]=y,t}}E.prototype.bytesPerElement=8,ht("StructArrayLayout4i8",E);class z extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,a,l,f,y,v)}emplace(t,a,l,f,y,v,x){const T=6*t;return this.int16[T+0]=a,this.int16[T+1]=l,this.int16[T+2]=f,this.int16[T+3]=y,this.int16[T+4]=v,this.int16[T+5]=x,t}}z.prototype.bytesPerElement=12,ht("StructArrayLayout2i4i12",z);class D extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,a,l,f,y,v)}emplace(t,a,l,f,y,v,x){const T=4*t,A=8*t;return this.int16[T+0]=a,this.int16[T+1]=l,this.uint8[A+4]=f,this.uint8[A+5]=y,this.uint8[A+6]=v,this.uint8[A+7]=x,t}}D.prototype.bytesPerElement=8,ht("StructArrayLayout2i4ub8",D);class V extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const l=this.length;return this.resize(l+1),this.emplace(l,t,a)}emplace(t,a,l){const f=2*t;return this.float32[f+0]=a,this.float32[f+1]=l,t}}V.prototype.bytesPerElement=8,ht("StructArrayLayout2f8",V);class H extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v,x,T,A,I){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,l,f,y,v,x,T,A,I)}emplace(t,a,l,f,y,v,x,T,A,I,P){const L=10*t;return this.uint16[L+0]=a,this.uint16[L+1]=l,this.uint16[L+2]=f,this.uint16[L+3]=y,this.uint16[L+4]=v,this.uint16[L+5]=x,this.uint16[L+6]=T,this.uint16[L+7]=A,this.uint16[L+8]=I,this.uint16[L+9]=P,t}}H.prototype.bytesPerElement=20,ht("StructArrayLayout10ui20",H);class G extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v,x,T,A,I,P,L){const j=this.length;return this.resize(j+1),this.emplace(j,t,a,l,f,y,v,x,T,A,I,P,L)}emplace(t,a,l,f,y,v,x,T,A,I,P,L,j){const $=12*t;return this.int16[$+0]=a,this.int16[$+1]=l,this.int16[$+2]=f,this.int16[$+3]=y,this.uint16[$+4]=v,this.uint16[$+5]=x,this.uint16[$+6]=T,this.uint16[$+7]=A,this.int16[$+8]=I,this.int16[$+9]=P,this.int16[$+10]=L,this.int16[$+11]=j,t}}G.prototype.bytesPerElement=24,ht("StructArrayLayout4i4ui4i24",G);class ee extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,l)}emplace(t,a,l,f){const y=3*t;return this.float32[y+0]=a,this.float32[y+1]=l,this.float32[y+2]=f,t}}ee.prototype.bytesPerElement=12,ht("StructArrayLayout3f12",ee);class ae extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}ae.prototype.bytesPerElement=4,ht("StructArrayLayout1ul4",ae);class oe extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v,x,T,A){const I=this.length;return this.resize(I+1),this.emplace(I,t,a,l,f,y,v,x,T,A)}emplace(t,a,l,f,y,v,x,T,A,I){const P=10*t,L=5*t;return this.int16[P+0]=a,this.int16[P+1]=l,this.int16[P+2]=f,this.int16[P+3]=y,this.int16[P+4]=v,this.int16[P+5]=x,this.uint32[L+3]=T,this.uint16[P+8]=A,this.uint16[P+9]=I,t}}oe.prototype.bytesPerElement=20,ht("StructArrayLayout6i1ul2ui20",oe);class ce extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,a,l,f,y,v)}emplace(t,a,l,f,y,v,x){const T=6*t;return this.int16[T+0]=a,this.int16[T+1]=l,this.int16[T+2]=f,this.int16[T+3]=y,this.int16[T+4]=v,this.int16[T+5]=x,t}}ce.prototype.bytesPerElement=12,ht("StructArrayLayout2i2i2i12",ce);class K extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,l,f,y)}emplace(t,a,l,f,y,v){const x=4*t,T=8*t;return this.float32[x+0]=a,this.float32[x+1]=l,this.float32[x+2]=f,this.int16[T+6]=y,this.int16[T+7]=v,t}}K.prototype.bytesPerElement=16,ht("StructArrayLayout2f1f2i16",K);class pe extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v){const x=this.length;return this.resize(x+1),this.emplace(x,t,a,l,f,y,v)}emplace(t,a,l,f,y,v,x){const T=16*t,A=4*t,I=8*t;return this.uint8[T+0]=a,this.uint8[T+1]=l,this.float32[A+1]=f,this.float32[A+2]=y,this.int16[I+6]=v,this.int16[I+7]=x,t}}pe.prototype.bytesPerElement=16,ht("StructArrayLayout2ub2f2i16",pe);class ge extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,l)}emplace(t,a,l,f){const y=3*t;return this.uint16[y+0]=a,this.uint16[y+1]=l,this.uint16[y+2]=f,t}}ge.prototype.bytesPerElement=6,ht("StructArrayLayout3ui6",ge);class Se extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v,x,T,A,I,P,L,j,$,U,J,re){const xe=this.length;return this.resize(xe+1),this.emplace(xe,t,a,l,f,y,v,x,T,A,I,P,L,j,$,U,J,re)}emplace(t,a,l,f,y,v,x,T,A,I,P,L,j,$,U,J,re,xe){const ue=24*t,ye=12*t,Ce=48*t;return this.int16[ue+0]=a,this.int16[ue+1]=l,this.uint16[ue+2]=f,this.uint16[ue+3]=y,this.uint32[ye+2]=v,this.uint32[ye+3]=x,this.uint32[ye+4]=T,this.uint16[ue+10]=A,this.uint16[ue+11]=I,this.uint16[ue+12]=P,this.float32[ye+7]=L,this.float32[ye+8]=j,this.uint8[Ce+36]=$,this.uint8[Ce+37]=U,this.uint8[Ce+38]=J,this.uint32[ye+10]=re,this.int16[ue+22]=xe,t}}Se.prototype.bytesPerElement=48,ht("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Se);class je extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,l,f,y,v,x,T,A,I,P,L,j,$,U,J,re,xe,ue,ye,Ce,We,ct,zt,st,nt,wt,yt){const ft=this.length;return this.resize(ft+1),this.emplace(ft,t,a,l,f,y,v,x,T,A,I,P,L,j,$,U,J,re,xe,ue,ye,Ce,We,ct,zt,st,nt,wt,yt)}emplace(t,a,l,f,y,v,x,T,A,I,P,L,j,$,U,J,re,xe,ue,ye,Ce,We,ct,zt,st,nt,wt,yt,ft){const Oe=32*t,At=16*t;return this.int16[Oe+0]=a,this.int16[Oe+1]=l,this.int16[Oe+2]=f,this.int16[Oe+3]=y,this.int16[Oe+4]=v,this.int16[Oe+5]=x,this.int16[Oe+6]=T,this.int16[Oe+7]=A,this.uint16[Oe+8]=I,this.uint16[Oe+9]=P,this.uint16[Oe+10]=L,this.uint16[Oe+11]=j,this.uint16[Oe+12]=$,this.uint16[Oe+13]=U,this.uint16[Oe+14]=J,this.uint16[Oe+15]=re,this.uint16[Oe+16]=xe,this.uint16[Oe+17]=ue,this.uint16[Oe+18]=ye,this.uint16[Oe+19]=Ce,this.uint16[Oe+20]=We,this.uint16[Oe+21]=ct,this.uint16[Oe+22]=zt,this.uint32[At+12]=st,this.float32[At+13]=nt,this.float32[At+14]=wt,this.uint16[Oe+30]=yt,this.uint16[Oe+31]=ft,t}}je.prototype.bytesPerElement=64,ht("StructArrayLayout8i15ui1ul2f2ui64",je);class Ze extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}Ze.prototype.bytesPerElement=4,ht("StructArrayLayout1f4",Ze);class at extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,l)}emplace(t,a,l,f){const y=3*t;return this.uint16[6*t+0]=a,this.float32[y+1]=l,this.float32[y+2]=f,t}}at.prototype.bytesPerElement=12,ht("StructArrayLayout1ui2f12",at);class dt extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,l){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,l)}emplace(t,a,l,f){const y=4*t;return this.uint32[2*t+0]=a,this.uint16[y+2]=l,this.uint16[y+3]=f,t}}dt.prototype.bytesPerElement=8,ht("StructArrayLayout1ul2ui8",dt);class Qe extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const l=this.length;return this.resize(l+1),this.emplace(l,t,a)}emplace(t,a,l){const f=2*t;return this.uint16[f+0]=a,this.uint16[f+1]=l,t}}Qe.prototype.bytesPerElement=4,ht("StructArrayLayout2ui4",Qe);class Je extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}Je.prototype.bytesPerElement=2,ht("StructArrayLayout1ui2",Je);class vt extends d{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,l,f){const y=this.length;return this.resize(y+1),this.emplace(y,t,a,l,f)}emplace(t,a,l,f,y){const v=4*t;return this.float32[v+0]=a,this.float32[v+1]=l,this.float32[v+2]=f,this.float32[v+3]=y,t}}vt.prototype.bytesPerElement=16,ht("StructArrayLayout4f16",vt);class $t extends u{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new R(this.anchorPointX,this.anchorPointY)}}$t.prototype.size=20;class it extends oe{get(t){return new $t(this,t)}}ht("CollisionBoxArray",it);class lt extends u{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}lt.prototype.size=48;class Ot extends Se{get(t){return new lt(this,t)}}ht("PlacedSymbolArray",Ot);class Zi extends u{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Zi.prototype.size=64;class Jt extends je{get(t){return new Zi(this,t)}}ht("SymbolInstanceArray",Jt);class ci extends Ze{getoffsetX(t){return this.float32[1*t+0]}}ht("GlyphOffsetArray",ci);class Xi extends k{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}ht("SymbolLineVertexArray",Xi);class Hn extends u{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Hn.prototype.size=12;class Yr extends at{get(t){return new Hn(this,t)}}ht("TextAnchorOffsetArray",Yr);class Yi extends u{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Yi.prototype.size=8;class yr extends dt{get(t){return new Yi(this,t)}}ht("FeatureIndexArray",yr);class ir extends S{}class nr extends S{}class rr extends S{}class ua extends z{}class Fs extends D{}class jl extends V{}class Kr extends H{}class as extends G{}class Vl extends ee{}class yu extends ae{}class Cr extends ce{}class Jr extends pe{}class Pr extends ge{}class La extends Qe{}const ar=m([{name:"a_pos",components:2,type:"Int16"}],4),{members:qn}=ar;class Fi{constructor(t=[]){this.segments=t}prepareSegment(t,a,l,f){let y=this.segments[this.segments.length-1];return t>Fi.MAX_VERTEX_ARRAY_LENGTH&&fe(`Max vertices per segment is ${Fi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!y||y.vertexLength+t>Fi.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:a.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},f!==void 0&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,l,f){return new Fi([{vertexOffset:t,primitiveOffset:a,vertexLength:l,primitiveLength:f,vaos:{},sortKey:0}])}}function rn(r,t){return 256*(r=be(Math.floor(r),0,255))+be(Math.floor(t),0,255)}Fi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ht("SegmentVector",Fi);const ya=m([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ns={exports:{}},$l={exports:{}};$l.exports=function(r,t){var a,l,f,y,v,x,T,A;for(l=r.length-(a=3&r.length),f=t,v=3432918353,x=461845907,A=0;A<l;)T=255&r.charCodeAt(A)|(255&r.charCodeAt(++A))<<8|(255&r.charCodeAt(++A))<<16|(255&r.charCodeAt(++A))<<24,++A,f=27492+(65535&(y=5*(65535&(f=(f^=T=(65535&(T=(T=(65535&T)*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(T=0,a){case 3:T^=(255&r.charCodeAt(A+2))<<16;case 2:T^=(255&r.charCodeAt(A+1))<<8;case 1:f^=T=(65535&(T=(T=(65535&(T^=255&r.charCodeAt(A)))*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*x+(((T>>>16)*x&65535)<<16)&4294967295}return f^=r.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var gp=$l.exports,ud={exports:{}};ud.exports=function(r,t){for(var a,l=r.length,f=t^l,y=0;l>=4;)a=1540483477*(65535&(a=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(a>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),l-=4,++y;switch(l){case 3:f^=(255&r.charCodeAt(y+2))<<16;case 2:f^=(255&r.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&r.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var hd=gp,ss=ud.exports;Ns.exports=hd,Ns.exports.murmur3=hd,Ns.exports.murmur2=ss;var Ul=M(Ns.exports);class jo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,l,f){this.ids.push(_u(t)),this.positions.push(a,l,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=_u(t);let l=0,f=this.ids.length-1;for(;l<f;){const v=l+f>>1;this.ids[v]>=a?f=v:l=v+1}const y=[];for(;this.ids[l]===a;)y.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return y}static serialize(t,a){const l=new Float64Array(t.ids),f=new Uint32Array(t.positions);return Vo(l,f,0,l.length-1),a&&a.push(l.buffer,f.buffer),{ids:l,positions:f}}static deserialize(t){const a=new jo;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function _u(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Ul(String(r))}function Vo(r,t,a,l){for(;a<l;){const f=r[a+l>>1];let y=a-1,v=l+1;for(;;){do y++;while(r[y]<f);do v--;while(r[v]>f);if(y>=v)break;$o(r,y,v),$o(t,3*y,3*v),$o(t,3*y+1,3*v+1),$o(t,3*y+2,3*v+2)}v-a<l-v?(Vo(r,t,a,v),a=v+1):(Vo(r,t,v+1,l),l=v)}}function $o(r,t,a){const l=r[t];r[t]=r[a],r[a]=l}ht("FeaturePositionMap",jo);class _a{constructor(t,a){this.gl=t.gl,this.location=a}}class dd extends _a{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class b0 extends _a{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class x0 extends _a{constructor(t,a){super(t,a),this.current=Ri.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Gx=new Float32Array(16);function yp(r){return[rn(255*r.r,255*r.g),rn(255*r.b,255*r.a)]}class vu{constructor(t,a,l){this.value=t,this.uniformNames=a.map(f=>`u_${f}`),this.type=l}setUniform(t,a,l){t.set(l.constantOr(this.value))}getBinding(t,a,l){return this.type==="color"?new x0(t,a):new dd(t,a)}}class Wl{constructor(t,a){this.uniformNames=a.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,l,f){const y=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&t.set(y)}getBinding(t,a,l){return l.substr(0,9)==="u_pattern"?new b0(t,a):new dd(t,a)}}class os{constructor(t,a,l,f){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=a.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,a,l,f,y){const v=this.paintVertexArray.length,x=this.expression.evaluate(new Pi(0),a,{},f,[],y);this.paintVertexArray.resize(t),this._setPaintValue(v,t,x)}updatePaintArray(t,a,l,f){const y=this.expression.evaluate({zoom:0},l,f);this._setPaintValue(t,a,y)}_setPaintValue(t,a,l){if(this.type==="color"){const f=yp(l);for(let y=t;y<a;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=t;f<a;f++)this.paintVertexArray.emplace(f,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class va{constructor(t,a,l,f,y,v){this.expression=t,this.uniformNames=a.map(x=>`u_${x}_t`),this.type=l,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=a.map(x=>({name:`a_${x}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(t,a,l,f,y){const v=this.expression.evaluate(new Pi(this.zoom),a,{},f,[],y),x=this.expression.evaluate(new Pi(this.zoom+1),a,{},f,[],y),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,v,x)}updatePaintArray(t,a,l,f){const y=this.expression.evaluate({zoom:this.zoom},l,f),v=this.expression.evaluate({zoom:this.zoom+1},l,f);this._setPaintValue(t,a,y,v)}_setPaintValue(t,a,l,f){if(this.type==="color"){const y=yp(l),v=yp(f);for(let x=t;x<a;x++)this.paintVertexArray.emplace(x,y[0],y[1],v[0],v[1])}else{for(let y=t;y<a;y++)this.paintVertexArray.emplace(y,l,f);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const l=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,f=be(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,a,l){return new dd(t,a)}}class js{constructor(t,a,l,f,y,v){this.expression=t,this.type=a,this.useIntegerZoom=l,this.zoom=f,this.layerId=v,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(t,a,l){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,a.patterns&&a.patterns[this.layerId],l)}updatePaintArray(t,a,l,f,y){this._setPaintValues(t,a,l.patterns&&l.patterns[this.layerId],y)}_setPaintValues(t,a,l,f){if(!f||!l)return;const{min:y,mid:v,max:x}=l,T=f[y],A=f[v],I=f[x];if(T&&A&&I)for(let P=t;P<a;P++)this.zoomInPaintVertexArray.emplace(P,A.tl[0],A.tl[1],A.br[0],A.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],A.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,A.tl[0],A.tl[1],A.br[0],A.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],A.pixelRatio,I.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,ya.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,ya.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class w0{constructor(t,a,l){this.binders={},this._buffers=[];const f=[];for(const y in t.paint._values){if(!l(y))continue;const v=t.paint.get(y);if(!(v instanceof mr&&zs(v.property.specification)))continue;const x=Zx(y,t.type),T=v.value,A=v.property.specification.type,I=v.property.useIntegerZoom,P=v.property.specification["property-type"],L=P==="cross-faded"||P==="cross-faded-data-driven";if(T.kind==="constant")this.binders[y]=L?new Wl(T.value,x):new vu(T.value,x,A),f.push(`/u_${y}`);else if(T.kind==="source"||L){const j=T0(y,A,"source");this.binders[y]=L?new js(T,A,I,a,j,t.id):new os(T,x,A,j),f.push(`/a_${y}`)}else{const j=T0(y,A,"composite");this.binders[y]=new va(T,x,A,I,a,j),f.push(`/z_${y}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof os||a instanceof va?a.maxValue:0}populatePaintArrays(t,a,l,f,y){for(const v in this.binders){const x=this.binders[v];(x instanceof os||x instanceof va||x instanceof js)&&x.populatePaintArray(t,a,l,f,y)}}setConstantPatternPositions(t,a){for(const l in this.binders){const f=this.binders[l];f instanceof Wl&&f.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,l,f,y){let v=!1;for(const x in t){const T=a.getPositions(x);for(const A of T){const I=l.feature(A.index);for(const P in this.binders){const L=this.binders[P];if((L instanceof os||L instanceof va||L instanceof js)&&L.expression.isStateDependent===!0){const j=f.paint.get(P);L.expression=j.value,L.updatePaintArray(A.start,A.end,I,t[x],y),v=!0}}}}return v}defines(){const t=[];for(const a in this.binders){const l=this.binders[a];(l instanceof vu||l instanceof Wl)&&t.push(...l.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const l=this.binders[a];if(l instanceof os||l instanceof va)for(let f=0;f<l.paintVertexAttributes.length;f++)t.push(l.paintVertexAttributes[f].name);else if(l instanceof js)for(let f=0;f<ya.members.length;f++)t.push(ya.members[f].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const l=this.binders[a];if(l instanceof vu||l instanceof Wl||l instanceof va)for(const f of l.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const l=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof vu||y instanceof Wl||y instanceof va){for(const v of y.uniformNames)if(a[v]){const x=y.getBinding(t,a[v],v);l.push({name:v,property:f,binding:x})}}}return l}setUniforms(t,a,l,f){for(const{name:y,property:v,binding:x}of a)this.binders[v].setUniform(x,f,l.get(v),y)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const l=this.binders[a];if(t&&l instanceof js){const f=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(l instanceof os||l instanceof va)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const a in this.binders){const l=this.binders[a];(l instanceof os||l instanceof va||l instanceof js)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof os||a instanceof va||a instanceof js)&&a.destroy()}}}class Uo{constructor(t,a,l=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new w0(f,a,l);this.needsUpload=!1,this._featureMap=new jo,this._bufferOffset=0}populatePaintArrays(t,a,l,f,y,v){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(t,a,f,y,v);a.id!==void 0&&this._featureMap.add(a.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,l,f){for(const y of l)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(t,this._featureMap,a,y,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Zx(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function T0(r,t,a){const l={color:{source:V,composite:vt},number:{source:Ze,composite:V}},f=function(y){return{"line-pattern":{source:Kr,composite:Kr},"fill-pattern":{source:Kr,composite:Kr},"fill-extrusion-pattern":{source:Kr,composite:Kr}}[y]}(r);return f&&f[a]||l[t][a]}ht("ConstantBinder",vu),ht("CrossFadedConstantBinder",Wl),ht("SourceExpressionBinder",os),ht("CrossFadedCompositeBinder",js),ht("CompositeExpressionBinder",va),ht("ProgramConfiguration",w0,{omit:["_buffers"]}),ht("ProgramConfigurationSet",Uo);const Tn=8192,_p=Math.pow(2,14)-1,S0=-_p-1;function Wo(r){const t=Tn/r.extent,a=r.loadGeometry();for(let l=0;l<a.length;l++){const f=a[l];for(let y=0;y<f.length;y++){const v=f[y],x=Math.round(v.x*t),T=Math.round(v.y*t);v.x=be(x,S0,_p),v.y=be(T,S0,_p),(x<v.x||x>v.x+1||T<v.y||T>v.y+1)&&fe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function Ho(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Wo(r):[]}}function fd(r,t,a,l,f){r.emplaceBack(2*t+(l+1)/2,2*a+(f+1)/2)}class vp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new nr,this.indexArray=new Pr,this.segments=new Fi,this.programConfigurations=new Uo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,l){const f=this.layers[0],y=[];let v=null,x=!1;f.type==="circle"&&(v=f.layout.get("circle-sort-key"),x=!v.isConstant());for(const{feature:T,id:A,index:I,sourceLayerIndex:P}of t){const L=this.layers[0]._featureFilter.needGeometry,j=Ho(T,L);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),j,l))continue;const $=x?v.evaluate(j,{},l):void 0,U={id:A,properties:T.properties,type:T.type,sourceLayerIndex:P,index:I,geometry:L?j.geometry:Wo(T),patterns:{},sortKey:$};y.push(U)}x&&y.sort((T,A)=>T.sortKey-A.sortKey);for(const T of y){const{geometry:A,index:I,sourceLayerIndex:P}=T,L=t[I].feature;this.addFeature(T,A,I,l),a.featureIndex.insert(L,A,I,P,this.index)}}update(t,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,l,f){for(const y of a)for(const v of y){const x=v.x,T=v.y;if(x<0||x>=Tn||T<0||T>=Tn)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),I=A.vertexLength;fd(this.layoutVertexArray,x,T,-1,-1),fd(this.layoutVertexArray,x,T,1,-1),fd(this.layoutVertexArray,x,T,1,1),fd(this.layoutVertexArray,x,T,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},f)}}function k0(r,t){for(let a=0;a<r.length;a++)if(Hl(t,r[a]))return!0;for(let a=0;a<t.length;a++)if(Hl(r,t[a]))return!0;return!!bp(r,t)}function Xx(r,t,a){return!!Hl(r,t)||!!xp(t,r,a)}function A0(r,t){if(r.length===1)return I0(t,r[0]);for(let a=0;a<t.length;a++){const l=t[a];for(let f=0;f<l.length;f++)if(Hl(r,l[f]))return!0}for(let a=0;a<r.length;a++)if(I0(t,r[a]))return!0;for(let a=0;a<t.length;a++)if(bp(r,t[a]))return!0;return!1}function Yx(r,t,a){if(r.length>1){if(bp(r,t))return!0;for(let l=0;l<t.length;l++)if(xp(t[l],r,a))return!0}for(let l=0;l<r.length;l++)if(xp(r[l],t,a))return!0;return!1}function bp(r,t){if(r.length===0||t.length===0)return!1;for(let a=0;a<r.length-1;a++){const l=r[a],f=r[a+1];for(let y=0;y<t.length-1;y++)if(Kx(l,f,t[y],t[y+1]))return!0}return!1}function Kx(r,t,a,l){return Me(r,a,l)!==Me(t,a,l)&&Me(r,t,a)!==Me(r,t,l)}function xp(r,t,a){const l=a*a;if(t.length===1)return r.distSqr(t[0])<l;for(let f=1;f<t.length;f++)if(M0(r,t[f-1],t[f])<l)return!0;return!1}function M0(r,t,a){const l=t.distSqr(a);if(l===0)return r.distSqr(t);const f=((r.x-t.x)*(a.x-t.x)+(r.y-t.y)*(a.y-t.y))/l;return r.distSqr(f<0?t:f>1?a:a.sub(t)._mult(f)._add(t))}function I0(r,t){let a,l,f,y=!1;for(let v=0;v<r.length;v++){a=r[v];for(let x=0,T=a.length-1;x<a.length;T=x++)l=a[x],f=a[T],l.y>t.y!=f.y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(y=!y)}return y}function Hl(r,t){let a=!1;for(let l=0,f=r.length-1;l<r.length;f=l++){const y=r[l],v=r[f];y.y>t.y!=v.y>t.y&&t.x<(v.x-y.x)*(t.y-y.y)/(v.y-y.y)+y.x&&(a=!a)}return a}function Jx(r,t,a){const l=a[0],f=a[2];if(r.x<l.x&&t.x<l.x||r.x>f.x&&t.x>f.x||r.y<l.y&&t.y<l.y||r.y>f.y&&t.y>f.y)return!1;const y=Me(r,t,a[0]);return y!==Me(r,t,a[1])||y!==Me(r,t,a[2])||y!==Me(r,t,a[3])}function bu(r,t,a){const l=t.paint.get(r).value;return l.kind==="constant"?l.value:a.programConfigurations.get(t.id).getMaxValue(r)}function pd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function md(r,t,a,l,f){if(!t[0]&&!t[1])return r;const y=R.convert(t)._mult(f);a==="viewport"&&y._rotate(-l);const v=[];for(let x=0;x<r.length;x++)v.push(r[x].sub(y));return v}let E0,C0;ht("CircleBucket",vp,{omit:["layers"]});var Qx={get paint(){return C0=C0||new gr({"circle-radius":new Et(ke.paint_circle["circle-radius"]),"circle-color":new Et(ke.paint_circle["circle-color"]),"circle-blur":new Et(ke.paint_circle["circle-blur"]),"circle-opacity":new Et(ke.paint_circle["circle-opacity"]),"circle-translate":new St(ke.paint_circle["circle-translate"]),"circle-translate-anchor":new St(ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new St(ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new St(ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Et(ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Et(ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Et(ke.paint_circle["circle-stroke-opacity"])})},get layout(){return E0=E0||new gr({"circle-sort-key":new Et(ke.layout_circle["circle-sort-key"])})}},_r=1e-6,ql=typeof Float32Array<"u"?Float32Array:Array;function wp(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function P0(r,t,a){var l=t[0],f=t[1],y=t[2],v=t[3],x=t[4],T=t[5],A=t[6],I=t[7],P=t[8],L=t[9],j=t[10],$=t[11],U=t[12],J=t[13],re=t[14],xe=t[15],ue=a[0],ye=a[1],Ce=a[2],We=a[3];return r[0]=ue*l+ye*x+Ce*P+We*U,r[1]=ue*f+ye*T+Ce*L+We*J,r[2]=ue*y+ye*A+Ce*j+We*re,r[3]=ue*v+ye*I+Ce*$+We*xe,r[4]=(ue=a[4])*l+(ye=a[5])*x+(Ce=a[6])*P+(We=a[7])*U,r[5]=ue*f+ye*T+Ce*L+We*J,r[6]=ue*y+ye*A+Ce*j+We*re,r[7]=ue*v+ye*I+Ce*$+We*xe,r[8]=(ue=a[8])*l+(ye=a[9])*x+(Ce=a[10])*P+(We=a[11])*U,r[9]=ue*f+ye*T+Ce*L+We*J,r[10]=ue*y+ye*A+Ce*j+We*re,r[11]=ue*v+ye*I+Ce*$+We*xe,r[12]=(ue=a[12])*l+(ye=a[13])*x+(Ce=a[14])*P+(We=a[15])*U,r[13]=ue*f+ye*T+Ce*L+We*J,r[14]=ue*y+ye*A+Ce*j+We*re,r[15]=ue*v+ye*I+Ce*$+We*xe,r}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var xu,ew=P0;function gd(r,t,a){var l=t[0],f=t[1],y=t[2],v=t[3];return r[0]=a[0]*l+a[4]*f+a[8]*y+a[12]*v,r[1]=a[1]*l+a[5]*f+a[9]*y+a[13]*v,r[2]=a[2]*l+a[6]*f+a[10]*y+a[14]*v,r[3]=a[3]*l+a[7]*f+a[11]*y+a[15]*v,r}xu=new ql(4),ql!=Float32Array&&(xu[0]=0,xu[1]=0,xu[2]=0,xu[3]=0);class tw extends e{constructor(t){super(t,Qx)}createBucket(t){return new vp(t)}queryRadius(t){const a=t;return bu("circle-radius",this,a)+bu("circle-stroke-width",this,a)+pd(this.paint.get("circle-translate"))}queryIntersectsFeature(t,a,l,f,y,v,x,T){const A=md(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,x),I=this.paint.get("circle-radius").evaluate(a,l)+this.paint.get("circle-stroke-width").evaluate(a,l),P=this.paint.get("circle-pitch-alignment")==="map",L=P?A:function($,U){return $.map(J=>z0(J,U))}(A,T),j=P?I*x:I;for(const $ of f)for(const U of $){const J=P?U:z0(U,T);let re=j;const xe=gd([],[U.x,U.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?re*=xe[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(re*=v.cameraToCenterDistance/xe[3]),Xx(L,J,re))return!0}return!1}}function z0(r,t){const a=gd([],[r.x,r.y,0,1],t);return new R(a[0]/a[3],a[1]/a[3])}class D0 extends vp{}let L0;ht("HeatmapBucket",D0,{omit:["layers"]});var iw={get paint(){return L0=L0||new gr({"heatmap-radius":new Et(ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Et(ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new St(ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Nl(ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new St(ke.paint_heatmap["heatmap-opacity"])})}};function Tp(r,{width:t,height:a},l,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*a*l)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*a*l}`)}else f=new Uint8Array(t*a*l);return r.width=t,r.height=a,r.data=f,r}function R0(r,{width:t,height:a},l){if(t===r.width&&a===r.height)return;const f=Tp({},{width:t,height:a},l);Sp(r,f,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,a)},l),r.width=t,r.height=a,r.data=f.data}function Sp(r,t,a,l,f,y){if(f.width===0||f.height===0)return t;if(f.width>r.width||f.height>r.height||a.x>r.width-f.width||a.y>r.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const v=r.data,x=t.data;if(v===x)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<f.height;T++){const A=((a.y+T)*r.width+a.x)*y,I=((l.y+T)*t.width+l.x)*y;for(let P=0;P<f.width*y;P++)x[I+P]=v[A+P]}return t}class wu{constructor(t,a){Tp(this,t,1,a)}resize(t){R0(this,t,1)}clone(){return new wu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,l,f,y){Sp(t,a,l,f,y,1)}}class Qr{constructor(t,a){Tp(this,t,4,a)}resize(t){R0(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Qr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,l,f,y){Sp(t,a,l,f,y,4)}}function B0(r){const t={},a=r.resolution||256,l=r.clips?r.clips.length:1,f=r.image||new Qr({width:a,height:l});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const y=(v,x,T)=>{t[r.evaluationKey]=T;const A=r.expression.evaluate(t);f.data[v+x+0]=Math.floor(255*A.r/A.a),f.data[v+x+1]=Math.floor(255*A.g/A.a),f.data[v+x+2]=Math.floor(255*A.b/A.a),f.data[v+x+3]=Math.floor(255*A.a)};if(r.clips)for(let v=0,x=0;v<l;++v,x+=4*a)for(let T=0,A=0;T<a;T++,A+=4){const I=T/(a-1),{start:P,end:L}=r.clips[v];y(x,A,P*(1-I)+L*I)}else for(let v=0,x=0;v<a;v++,x+=4)y(0,x,v/(a-1));return f}ht("AlphaImage",wu),ht("RGBAImage",Qr);const kp="big-fb";class nw extends e{createBucket(t){return new D0(t)}constructor(t){super(t,iw),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=B0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(kp)&&this.heatmapFbos.delete(kp)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let O0;var rw={get paint(){return O0=O0||new gr({"hillshade-illumination-direction":new St(ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new St(ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new St(ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new St(ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new St(ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new St(ke.paint_hillshade["hillshade-accent-color"])})}};class aw extends e{constructor(t){super(t,rw)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const sw=m([{name:"a_pos",components:2,type:"Int16"}],4),{members:ow}=sw;function F0(r,t,a=2){const l=t&&t.length,f=l?t[0]*a:r.length;let y=N0(r,0,f,a,!0);const v=[];if(!y||y.next===y.prev)return v;let x,T,A;if(l&&(y=function(I,P,L,j){const $=[];for(let U=0,J=P.length;U<J;U++){const re=N0(I,P[U]*j,U<J-1?P[U+1]*j:I.length,j,!1);re===re.next&&(re.steiner=!0),$.push(mw(re))}$.sort(dw);for(let U=0;U<$.length;U++)L=fw($[U],L);return L}(r,t,y,a)),r.length>80*a){x=1/0,T=1/0;let I=-1/0,P=-1/0;for(let L=a;L<f;L+=a){const j=r[L],$=r[L+1];j<x&&(x=j),$<T&&(T=$),j>I&&(I=j),$>P&&(P=$)}A=Math.max(I-x,P-T),A=A!==0?32767/A:0}return Tu(y,v,a,x,T,A,0),v}function N0(r,t,a,l,f){let y;if(f===function(v,x,T,A){let I=0;for(let P=x,L=T-A;P<T;P+=A)I+=(v[L]-v[P])*(v[P+1]+v[L+1]),L=P;return I}(r,t,a,l)>0)for(let v=t;v<a;v+=l)y=$0(v/l|0,r[v],r[v+1],y);else for(let v=a-l;v>=t;v-=l)y=$0(v/l|0,r[v],r[v+1],y);return y&&yd(y,y.next)&&(ku(y),y=y.next),y}function qo(r,t){if(!r)return r;t||(t=r);let a,l=r;do if(a=!1,l.steiner||!yd(l,l.next)&&_n(l.prev,l,l.next)!==0)l=l.next;else{if(ku(l),l=t=l.prev,l===l.next)break;a=!0}while(a||l!==t);return t}function Tu(r,t,a,l,f,y,v){if(!r)return;!v&&y&&function(T,A,I,P){let L=T;do L.z===0&&(L.z=Ap(L.x,L.y,A,I,P)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==T);L.prevZ.nextZ=null,L.prevZ=null,function(j){let $,U=1;do{let J,re=j;j=null;let xe=null;for($=0;re;){$++;let ue=re,ye=0;for(let We=0;We<U&&(ye++,ue=ue.nextZ,ue);We++);let Ce=U;for(;ye>0||Ce>0&&ue;)ye!==0&&(Ce===0||!ue||re.z<=ue.z)?(J=re,re=re.nextZ,ye--):(J=ue,ue=ue.nextZ,Ce--),xe?xe.nextZ=J:j=J,J.prevZ=xe,xe=J;re=ue}xe.nextZ=null,U*=2}while($>1)}(L)}(r,l,f,y);let x=r;for(;r.prev!==r.next;){const T=r.prev,A=r.next;if(y?cw(r,l,f,y):lw(r))t.push(T.i,r.i,A.i),ku(r),r=A.next,x=A.next;else if((r=A)===x){v?v===1?Tu(r=uw(qo(r),t),t,a,l,f,y,2):v===2&&hw(r,t,a,l,f,y):Tu(qo(r),t,a,l,f,y,1);break}}}function lw(r){const t=r.prev,a=r,l=r.next;if(_n(t,a,l)>=0)return!1;const f=t.x,y=a.x,v=l.x,x=t.y,T=a.y,A=l.y,I=f<y?f<v?f:v:y<v?y:v,P=x<T?x<A?x:A:T<A?T:A,L=f>y?f>v?f:v:y>v?y:v,j=x>T?x>A?x:A:T>A?T:A;let $=l.next;for(;$!==t;){if($.x>=I&&$.x<=L&&$.y>=P&&$.y<=j&&Gl(f,x,y,T,v,A,$.x,$.y)&&_n($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function cw(r,t,a,l){const f=r.prev,y=r,v=r.next;if(_n(f,y,v)>=0)return!1;const x=f.x,T=y.x,A=v.x,I=f.y,P=y.y,L=v.y,j=x<T?x<A?x:A:T<A?T:A,$=I<P?I<L?I:L:P<L?P:L,U=x>T?x>A?x:A:T>A?T:A,J=I>P?I>L?I:L:P>L?P:L,re=Ap(j,$,t,a,l),xe=Ap(U,J,t,a,l);let ue=r.prevZ,ye=r.nextZ;for(;ue&&ue.z>=re&&ye&&ye.z<=xe;){if(ue.x>=j&&ue.x<=U&&ue.y>=$&&ue.y<=J&&ue!==f&&ue!==v&&Gl(x,I,T,P,A,L,ue.x,ue.y)&&_n(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,ye.x>=j&&ye.x<=U&&ye.y>=$&&ye.y<=J&&ye!==f&&ye!==v&&Gl(x,I,T,P,A,L,ye.x,ye.y)&&_n(ye.prev,ye,ye.next)>=0))return!1;ye=ye.nextZ}for(;ue&&ue.z>=re;){if(ue.x>=j&&ue.x<=U&&ue.y>=$&&ue.y<=J&&ue!==f&&ue!==v&&Gl(x,I,T,P,A,L,ue.x,ue.y)&&_n(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;ye&&ye.z<=xe;){if(ye.x>=j&&ye.x<=U&&ye.y>=$&&ye.y<=J&&ye!==f&&ye!==v&&Gl(x,I,T,P,A,L,ye.x,ye.y)&&_n(ye.prev,ye,ye.next)>=0)return!1;ye=ye.nextZ}return!0}function uw(r,t){let a=r;do{const l=a.prev,f=a.next.next;!yd(l,f)&&j0(l,a,a.next,f)&&Su(l,f)&&Su(f,l)&&(t.push(l.i,a.i,f.i),ku(a),ku(a.next),a=r=f),a=a.next}while(a!==r);return qo(a)}function hw(r,t,a,l,f,y){let v=r;do{let x=v.next.next;for(;x!==v.prev;){if(v.i!==x.i&&gw(v,x)){let T=V0(v,x);return v=qo(v,v.next),T=qo(T,T.next),Tu(v,t,a,l,f,y,0),void Tu(T,t,a,l,f,y,0)}x=x.next}v=v.next}while(v!==r)}function dw(r,t){return r.x-t.x}function fw(r,t){const a=function(f,y){let v=y;const x=f.x,T=f.y;let A,I=-1/0;do{if(T<=v.y&&T>=v.next.y&&v.next.y!==v.y){const U=v.x+(T-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(U<=x&&U>I&&(I=U,A=v.x<v.next.x?v:v.next,U===x))return A}v=v.next}while(v!==y);if(!A)return null;const P=A,L=A.x,j=A.y;let $=1/0;v=A;do{if(x>=v.x&&v.x>=L&&x!==v.x&&Gl(T<j?x:I,T,L,j,T<j?I:x,T,v.x,v.y)){const U=Math.abs(T-v.y)/(x-v.x);Su(v,f)&&(U<$||U===$&&(v.x>A.x||v.x===A.x&&pw(A,v)))&&(A=v,$=U)}v=v.next}while(v!==P);return A}(r,t);if(!a)return t;const l=V0(a,r);return qo(l,l.next),qo(a,a.next)}function pw(r,t){return _n(r.prev,r,t.prev)<0&&_n(t.next,r,r.next)<0}function Ap(r,t,a,l,f){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-a)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function mw(r){let t=r,a=r;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==r);return a}function Gl(r,t,a,l,f,y,v,x){return(f-v)*(t-x)>=(r-v)*(y-x)&&(r-v)*(l-x)>=(a-v)*(t-x)&&(a-v)*(y-x)>=(f-v)*(l-x)}function gw(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(a,l){let f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==l.i&&f.next.i!==l.i&&j0(f,f.next,a,l))return!0;f=f.next}while(f!==a);return!1}(r,t)&&(Su(r,t)&&Su(t,r)&&function(a,l){let f=a,y=!1;const v=(a.x+l.x)/2,x=(a.y+l.y)/2;do f.y>x!=f.next.y>x&&f.next.y!==f.y&&v<(f.next.x-f.x)*(x-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==a);return y}(r,t)&&(_n(r.prev,r,t.prev)||_n(r,t.prev,t))||yd(r,t)&&_n(r.prev,r,r.next)>0&&_n(t.prev,t,t.next)>0)}function _n(r,t,a){return(t.y-r.y)*(a.x-t.x)-(t.x-r.x)*(a.y-t.y)}function yd(r,t){return r.x===t.x&&r.y===t.y}function j0(r,t,a,l){const f=vd(_n(r,t,a)),y=vd(_n(r,t,l)),v=vd(_n(a,l,r)),x=vd(_n(a,l,t));return f!==y&&v!==x||!(f!==0||!_d(r,a,t))||!(y!==0||!_d(r,l,t))||!(v!==0||!_d(a,r,l))||!(x!==0||!_d(a,t,l))}function _d(r,t,a){return t.x<=Math.max(r.x,a.x)&&t.x>=Math.min(r.x,a.x)&&t.y<=Math.max(r.y,a.y)&&t.y>=Math.min(r.y,a.y)}function vd(r){return r>0?1:r<0?-1:0}function Su(r,t){return _n(r.prev,r,r.next)<0?_n(r,t,r.next)>=0&&_n(r,r.prev,t)>=0:_n(r,t,r.prev)<0||_n(r,r.next,t)<0}function V0(r,t){const a=Mp(r.i,r.x,r.y),l=Mp(t.i,t.x,t.y),f=r.next,y=t.prev;return r.next=t,t.prev=r,a.next=f,f.prev=a,l.next=a,a.prev=l,y.next=l,l.prev=y,l}function $0(r,t,a,l){const f=Mp(r,t,a);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function ku(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Mp(r,t,a){return{i:r,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ip(r,t,a){const l=a.patternDependencies;let f=!1;for(const y of t){const v=y.paint.get(`${r}-pattern`);v.isConstant()||(f=!0);const x=v.constantOr(null);x&&(f=!0,l[x.to]=!0,l[x.from]=!0)}return f}function Ep(r,t,a,l,f){const y=f.patternDependencies;for(const v of t){const x=v.paint.get(`${r}-pattern`).value;if(x.kind!=="constant"){let T=x.evaluate({zoom:l-1},a,{},f.availableImages),A=x.evaluate({zoom:l},a,{},f.availableImages),I=x.evaluate({zoom:l+1},a,{},f.availableImages);T=T&&T.name?T.name:T,A=A&&A.name?A.name:A,I=I&&I.name?I.name:I,y[T]=!0,y[A]=!0,y[I]=!0,a.patterns[v.id]={min:T,mid:A,max:I}}}return a}class Cp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rr,this.indexArray=new Pr,this.indexArray2=new La,this.programConfigurations=new Uo(t.layers,t.zoom),this.segments=new Fi,this.segments2=new Fi,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,l){this.hasPattern=Ip("fill",this.layers,a);const f=this.layers[0].layout.get("fill-sort-key"),y=!f.isConstant(),v=[];for(const{feature:x,id:T,index:A,sourceLayerIndex:I}of t){const P=this.layers[0]._featureFilter.needGeometry,L=Ho(x,P);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),L,l))continue;const j=y?f.evaluate(L,{},l,a.availableImages):void 0,$={id:T,properties:x.properties,type:x.type,sourceLayerIndex:I,index:A,geometry:P?L.geometry:Wo(x),patterns:{},sortKey:j};v.push($)}y&&v.sort((x,T)=>x.sortKey-T.sortKey);for(const x of v){const{geometry:T,index:A,sourceLayerIndex:I}=x;if(this.hasPattern){const P=Ep("fill",this.layers,x,this.zoom,a);this.patternFeatures.push(P)}else this.addFeature(x,T,A,l,{});a.featureIndex.insert(t[A].feature,T,A,I,this.index)}}update(t,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,l)}addFeatures(t,a,l){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ow),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,l,f,y){for(const v of xl(a,500)){let x=0;for(const j of v)x+=j.length;const T=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),A=T.vertexLength,I=[],P=[];for(const j of v){if(j.length===0)continue;j!==v[0]&&P.push(I.length/2);const $=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),U=$.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(U+j.length-1,U),I.push(j[0].x),I.push(j[0].y);for(let J=1;J<j.length;J++)this.layoutVertexArray.emplaceBack(j[J].x,j[J].y),this.indexArray2.emplaceBack(U+J-1,U+J),I.push(j[J].x),I.push(j[J].y);$.vertexLength+=j.length,$.primitiveLength+=j.length}const L=F0(I,P);for(let j=0;j<L.length;j+=3)this.indexArray.emplaceBack(A+L[j],A+L[j+1],A+L[j+2]);T.vertexLength+=x,T.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,f)}}let U0,W0;ht("FillBucket",Cp,{omit:["layers","patternFeatures"]});var yw={get paint(){return W0=W0||new gr({"fill-antialias":new St(ke.paint_fill["fill-antialias"]),"fill-opacity":new Et(ke.paint_fill["fill-opacity"]),"fill-color":new Et(ke.paint_fill["fill-color"]),"fill-outline-color":new Et(ke.paint_fill["fill-outline-color"]),"fill-translate":new St(ke.paint_fill["fill-translate"]),"fill-translate-anchor":new St(ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fl(ke.paint_fill["fill-pattern"])})},get layout(){return U0=U0||new gr({"fill-sort-key":new Et(ke.layout_fill["fill-sort-key"])})}};class _w extends e{constructor(t){super(t,yw)}recalculate(t,a){super.recalculate(t,a);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Cp(t)}queryRadius(){return pd(this.paint.get("fill-translate"))}queryIntersectsFeature(t,a,l,f,y,v,x){return A0(md(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,x),f)}isTileClipped(){return!0}}const vw=m([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),bw=m([{name:"a_centroid",components:2,type:"Int16"}],4),{members:xw}=vw;var Vs={},ww=B,H0=Zl;function Zl(r,t,a,l,f){this.properties={},this.extent=a,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=f,r.readFields(Tw,this,t)}function Tw(r,t,a){r==1?t.id=a.readVarint():r==2?function(l,f){for(var y=l.readVarint()+l.pos;l.pos<y;){var v=f._keys[l.readVarint()],x=f._values[l.readVarint()];f.properties[v]=x}}(a,t):r==3?t.type=a.readVarint():r==4&&(t._geometry=a.pos)}function Sw(r){for(var t,a,l=0,f=0,y=r.length,v=y-1;f<y;v=f++)l+=((a=r[v]).x-(t=r[f]).x)*(t.y+a.y);return l}Zl.types=["Unknown","Point","LineString","Polygon"],Zl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,a=r.readVarint()+r.pos,l=1,f=0,y=0,v=0,x=[];r.pos<a;){if(f<=0){var T=r.readVarint();l=7&T,f=T>>3}if(f--,l===1||l===2)y+=r.readSVarint(),v+=r.readSVarint(),l===1&&(t&&x.push(t),t=[]),t.push(new ww(y,v));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&x.push(t),x},Zl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,a=1,l=0,f=0,y=0,v=1/0,x=-1/0,T=1/0,A=-1/0;r.pos<t;){if(l<=0){var I=r.readVarint();a=7&I,l=I>>3}if(l--,a===1||a===2)(f+=r.readSVarint())<v&&(v=f),f>x&&(x=f),(y+=r.readSVarint())<T&&(T=y),y>A&&(A=y);else if(a!==7)throw new Error("unknown command "+a)}return[v,T,x,A]},Zl.prototype.toGeoJSON=function(r,t,a){var l,f,y=this.extent*Math.pow(2,a),v=this.extent*r,x=this.extent*t,T=this.loadGeometry(),A=Zl.types[this.type];function I(j){for(var $=0;$<j.length;$++){var U=j[$];j[$]=[360*(U.x+v)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+x)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(l=0;l<T.length;l++)P[l]=T[l][0];I(T=P);break;case 2:for(l=0;l<T.length;l++)I(T[l]);break;case 3:for(T=function(j){var $=j.length;if($<=1)return[j];for(var U,J,re=[],xe=0;xe<$;xe++){var ue=Sw(j[xe]);ue!==0&&(J===void 0&&(J=ue<0),J===ue<0?(U&&re.push(U),U=[j[xe]]):U.push(j[xe]))}return U&&re.push(U),re}(T),l=0;l<T.length;l++)for(f=0;f<T[l].length;f++)I(T[l][f])}T.length===1?T=T[0]:A="Multi"+A;var L={type:"Feature",geometry:{type:A,coordinates:T},properties:this.properties};return"id"in this&&(L.id=this.id),L};var kw=H0,q0=G0;function G0(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Aw,this,t),this.length=this._features.length}function Aw(r,t,a){r===15?t.version=a.readVarint():r===1?t.name=a.readString():r===5?t.extent=a.readVarint():r===2?t._features.push(a.pos):r===3?t._keys.push(a.readString()):r===4&&t._values.push(function(l){for(var f=null,y=l.readVarint()+l.pos;l.pos<y;){var v=l.readVarint()>>3;f=v===1?l.readString():v===2?l.readFloat():v===3?l.readDouble():v===4?l.readVarint64():v===5?l.readVarint():v===6?l.readSVarint():v===7?l.readBoolean():null}return f}(a))}G0.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new kw(this._pbf,t,this.extent,this._keys,this._values)};var Mw=q0;function Iw(r,t,a){if(r===3){var l=new Mw(a,a.readVarint()+a.pos);l.length&&(t[l.name]=l)}}Vs.VectorTile=function(r,t){this.layers=r.readFields(Iw,{},t)},Vs.VectorTileFeature=H0,Vs.VectorTileLayer=q0;const Ew=Vs.VectorTileFeature.types,Pp=Math.pow(2,13);function Au(r,t,a,l,f,y,v,x){r.emplaceBack(t,a,2*Math.floor(l*Pp)+v,f*Pp*2,y*Pp*2,Math.round(x))}class zp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ua,this.centroidVertexArray=new ir,this.indexArray=new Pr,this.programConfigurations=new Uo(t.layers,t.zoom),this.segments=new Fi,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,l){this.features=[],this.hasPattern=Ip("fill-extrusion",this.layers,a);for(const{feature:f,id:y,index:v,sourceLayerIndex:x}of t){const T=this.layers[0]._featureFilter.needGeometry,A=Ho(f,T);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),A,l))continue;const I={id:y,sourceLayerIndex:x,index:v,geometry:T?A.geometry:Wo(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Ep("fill-extrusion",this.layers,I,this.zoom,a)):this.addFeature(I,I.geometry,v,l,{}),a.featureIndex.insert(f,I.geometry,v,x,this.index,!0)}}addFeatures(t,a,l){for(const f of this.features){const{geometry:y}=f;this.addFeature(f,y,f.index,a,l)}}update(t,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xw),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,bw.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,l,f,y){for(const v of xl(a,500)){const x={x:0,y:0,vertexCount:0};let T=0;for(const $ of v)T+=$.length;let A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of v){if($.length===0||Pw($))continue;let U=0;for(let J=0;J<$.length;J++){const re=$[J];if(J>=1){const xe=$[J-1];if(!Cw(re,xe)){A.vertexLength+4>Fi.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ue=re.sub(xe)._perp()._unit(),ye=xe.dist(re);U+ye>32768&&(U=0),Au(this.layoutVertexArray,re.x,re.y,ue.x,ue.y,0,0,U),Au(this.layoutVertexArray,re.x,re.y,ue.x,ue.y,0,1,U),x.x+=2*re.x,x.y+=2*re.y,x.vertexCount+=2,U+=ye,Au(this.layoutVertexArray,xe.x,xe.y,ue.x,ue.y,0,0,U),Au(this.layoutVertexArray,xe.x,xe.y,ue.x,ue.y,0,1,U),x.x+=2*xe.x,x.y+=2*xe.y,x.vertexCount+=2;const Ce=A.vertexLength;this.indexArray.emplaceBack(Ce,Ce+2,Ce+1),this.indexArray.emplaceBack(Ce+1,Ce+2,Ce+3),A.vertexLength+=4,A.primitiveLength+=2}}}}if(A.vertexLength+T>Fi.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),Ew[t.type]!=="Polygon")continue;const I=[],P=[],L=A.vertexLength;for(const $ of v)if($.length!==0){$!==v[0]&&P.push(I.length/2);for(let U=0;U<$.length;U++){const J=$[U];Au(this.layoutVertexArray,J.x,J.y,0,0,1,1,0),x.x+=J.x,x.y+=J.y,x.vertexCount+=1,I.push(J.x),I.push(J.y)}}const j=F0(I,P);for(let $=0;$<j.length;$+=3)this.indexArray.emplaceBack(L+j[$],L+j[$+2],L+j[$+1]);A.primitiveLength+=j.length/3,A.vertexLength+=T;for(let $=0;$<x.vertexCount;$++){const U=Math.floor(x.x/x.vertexCount),J=Math.floor(x.y/x.vertexCount);this.centroidVertexArray.emplaceBack(U,J)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,f)}}function Cw(r,t){return r.x===t.x&&(r.x<0||r.x>Tn)||r.y===t.y&&(r.y<0||r.y>Tn)}function Pw(r){return r.every(t=>t.x<0)||r.every(t=>t.x>Tn)||r.every(t=>t.y<0)||r.every(t=>t.y>Tn)}let Z0;ht("FillExtrusionBucket",zp,{omit:["layers","features"]});var zw={get paint(){return Z0=Z0||new gr({"fill-extrusion-opacity":new St(ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Et(ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new St(ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new St(ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fl(ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Et(ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Et(ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new St(ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Dw extends e{constructor(t){super(t,zw)}createBucket(t){return new zp(t)}queryRadius(){return pd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,a,l,f,y,v,x,T){const A=md(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,x),I=this.paint.get("fill-extrusion-height").evaluate(a,l),P=this.paint.get("fill-extrusion-base").evaluate(a,l),L=function($,U,J,re){const xe=[];for(const ue of $){const ye=[ue.x,ue.y,0,1];gd(ye,ye,U),xe.push(new R(ye[0]/ye[3],ye[1]/ye[3]))}return xe}(A,T),j=function($,U,J,re){const xe=[],ue=[],ye=re[8]*U,Ce=re[9]*U,We=re[10]*U,ct=re[11]*U,zt=re[8]*J,st=re[9]*J,nt=re[10]*J,wt=re[11]*J;for(const yt of $){const ft=[],Oe=[];for(const At of yt){const bt=At.x,Ft=At.y,Wi=re[0]*bt+re[4]*Ft+re[12],ji=re[1]*bt+re[5]*Ft+re[13],Pn=re[2]*bt+re[6]*Ft+re[14],ha=re[3]*bt+re[7]*Ft+re[15],Zn=Pn+We,zn=ha+ct,vr=Wi+zt,br=ji+st,xr=Pn+nt,mn=ha+wt,Dn=new R((Wi+ye)/zn,(ji+Ce)/zn);Dn.z=Zn/zn,ft.push(Dn);const sr=new R(vr/mn,br/mn);sr.z=xr/mn,Oe.push(sr)}xe.push(ft),ue.push(Oe)}return[xe,ue]}(f,P,I,T);return function($,U,J){let re=1/0;A0(J,U)&&(re=X0(J,U[0]));for(let xe=0;xe<U.length;xe++){const ue=U[xe],ye=$[xe];for(let Ce=0;Ce<ue.length-1;Ce++){const We=ue[Ce],ct=[We,ue[Ce+1],ye[Ce+1],ye[Ce],We];k0(J,ct)&&(re=Math.min(re,X0(J,ct)))}}return re!==1/0&&re}(j[0],j[1],L)}}function Mu(r,t){return r.x*t.x+r.y*t.y}function X0(r,t){if(r.length===1){let a=0;const l=t[a++];let f;for(;!f||l.equals(f);)if(f=t[a++],!f)return 1/0;for(;a<t.length;a++){const y=t[a],v=r[0],x=f.sub(l),T=y.sub(l),A=v.sub(l),I=Mu(x,x),P=Mu(x,T),L=Mu(T,T),j=Mu(A,x),$=Mu(A,T),U=I*L-P*P,J=(L*j-P*$)/U,re=(I*$-P*j)/U,xe=l.z*(1-J-re)+f.z*J+y.z*re;if(isFinite(xe))return xe}return 1/0}{let a=1/0;for(const l of t)a=Math.min(a,l.z);return a}}const Lw=m([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rw}=Lw,Bw=m([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ow}=Bw,Fw=Vs.VectorTileFeature.types,Nw=Math.cos(Math.PI/180*37.5),Y0=Math.pow(2,14)/.5;class Dp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Fs,this.layoutVertexArray2=new jl,this.indexArray=new Pr,this.programConfigurations=new Uo(t.layers,t.zoom),this.segments=new Fi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,l){this.hasPattern=Ip("line",this.layers,a);const f=this.layers[0].layout.get("line-sort-key"),y=!f.isConstant(),v=[];for(const{feature:x,id:T,index:A,sourceLayerIndex:I}of t){const P=this.layers[0]._featureFilter.needGeometry,L=Ho(x,P);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),L,l))continue;const j=y?f.evaluate(L,{},l):void 0,$={id:T,properties:x.properties,type:x.type,sourceLayerIndex:I,index:A,geometry:P?L.geometry:Wo(x),patterns:{},sortKey:j};v.push($)}y&&v.sort((x,T)=>x.sortKey-T.sortKey);for(const x of v){const{geometry:T,index:A,sourceLayerIndex:I}=x;if(this.hasPattern){const P=Ep("line",this.layers,x,this.zoom,a);this.patternFeatures.push(P)}else this.addFeature(x,T,A,l,{});a.featureIndex.insert(t[A].feature,T,A,I,this.index)}}update(t,a,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,l)}addFeatures(t,a,l){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Ow)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Rw),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,l,f,y){const v=this.layers[0].layout,x=v.get("line-join").evaluate(t,{}),T=v.get("line-cap"),A=v.get("line-miter-limit"),I=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const P of a)this.addLine(P,t,x,T,A,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,f)}addLine(t,a,l,f,y,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<t.length-1;re++)this.totalDistance+=t[re].dist(t[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=Fw[a.type]==="Polygon";let T=t.length;for(;T>=2&&t[T-1].equals(t[T-2]);)T--;let A=0;for(;A<T-1&&t[A].equals(t[A+1]);)A++;if(T<(x?3:2))return;l==="bevel"&&(y=1.05);const I=this.overscaling<=16?15*Tn/(512*this.overscaling):0,P=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let L,j,$,U,J;this.e1=this.e2=-1,x&&(L=t[T-2],J=t[A].sub(L)._unit()._perp());for(let re=A;re<T;re++){if($=re===T-1?x?t[A+1]:void 0:t[re+1],$&&t[re].equals($))continue;J&&(U=J),L&&(j=L),L=t[re],J=$?$.sub(L)._unit()._perp():U,U=U||J;let xe=U.add(J);xe.x===0&&xe.y===0||xe._unit();const ue=U.x*J.x+U.y*J.y,ye=xe.x*J.x+xe.y*J.y,Ce=ye!==0?1/ye:1/0,We=2*Math.sqrt(2-2*ye),ct=ye<Nw&&j&&$,zt=U.x*J.y-U.y*J.x>0;if(ct&&re>A){const wt=L.dist(j);if(wt>2*I){const yt=L.sub(L.sub(j)._mult(I/wt)._round());this.updateDistance(j,yt),this.addCurrentVertex(yt,U,0,0,P),j=yt}}const st=j&&$;let nt=st?l:x?"butt":f;if(st&&nt==="round"&&(Ce<v?nt="miter":Ce<=2&&(nt="fakeround")),nt==="miter"&&Ce>y&&(nt="bevel"),nt==="bevel"&&(Ce>2&&(nt="flipbevel"),Ce<y&&(nt="miter")),j&&this.updateDistance(j,L),nt==="miter")xe._mult(Ce),this.addCurrentVertex(L,xe,0,0,P);else if(nt==="flipbevel"){if(Ce>100)xe=J.mult(-1);else{const wt=Ce*U.add(J).mag()/U.sub(J).mag();xe._perp()._mult(wt*(zt?-1:1))}this.addCurrentVertex(L,xe,0,0,P),this.addCurrentVertex(L,xe.mult(-1),0,0,P)}else if(nt==="bevel"||nt==="fakeround"){const wt=-Math.sqrt(Ce*Ce-1),yt=zt?wt:0,ft=zt?0:wt;if(j&&this.addCurrentVertex(L,U,yt,ft,P),nt==="fakeround"){const Oe=Math.round(180*We/Math.PI/20);for(let At=1;At<Oe;At++){let bt=At/Oe;if(bt!==.5){const Wi=bt-.5;bt+=bt*Wi*(bt-1)*((1.0904+ue*(ue*(3.55645-1.43519*ue)-3.2452))*Wi*Wi+(.848013+ue*(.215638*ue-1.06021)))}const Ft=J.sub(U)._mult(bt)._add(U)._unit()._mult(zt?-1:1);this.addHalfVertex(L,Ft.x,Ft.y,!1,zt,0,P)}}$&&this.addCurrentVertex(L,J,-yt,-ft,P)}else if(nt==="butt")this.addCurrentVertex(L,xe,0,0,P);else if(nt==="square"){const wt=j?1:-1;this.addCurrentVertex(L,xe,wt,wt,P)}else nt==="round"&&(j&&(this.addCurrentVertex(L,U,0,0,P),this.addCurrentVertex(L,U,1,1,P,!0)),$&&(this.addCurrentVertex(L,J,-1,-1,P,!0),this.addCurrentVertex(L,J,0,0,P)));if(ct&&re<T-1){const wt=L.dist($);if(wt>2*I){const yt=L.add($.sub(L)._mult(I/wt)._round());this.updateDistance(L,yt),this.addCurrentVertex(yt,J,0,0,P),L=yt}}}}addCurrentVertex(t,a,l,f,y,v=!1){const x=a.y*f-a.x,T=-a.y-a.x*f;this.addHalfVertex(t,a.x+a.y*l,a.y-a.x*l,v,!1,l,y),this.addHalfVertex(t,x,T,v,!0,-f,y),this.distance>Y0/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,l,f,y,v))}addHalfVertex({x:t,y:a},l,f,y,v,x,T){const A=.5*(this.lineClips?this.scaledDistance*(Y0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(y?1:0),(a<<1)+(v?1:0),Math.round(63*l)+128,Math.round(63*f)+128,1+(x===0?0:x<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),T.primitiveLength++),v?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}let K0,J0;ht("LineBucket",Dp,{omit:["layers","patternFeatures"]});var Q0={get paint(){return J0=J0||new gr({"line-opacity":new Et(ke.paint_line["line-opacity"]),"line-color":new Et(ke.paint_line["line-color"]),"line-translate":new St(ke.paint_line["line-translate"]),"line-translate-anchor":new St(ke.paint_line["line-translate-anchor"]),"line-width":new Et(ke.paint_line["line-width"]),"line-gap-width":new Et(ke.paint_line["line-gap-width"]),"line-offset":new Et(ke.paint_line["line-offset"]),"line-blur":new Et(ke.paint_line["line-blur"]),"line-dasharray":new gu(ke.paint_line["line-dasharray"]),"line-pattern":new Fl(ke.paint_line["line-pattern"]),"line-gradient":new Nl(ke.paint_line["line-gradient"])})},get layout(){return K0=K0||new gr({"line-cap":new St(ke.layout_line["line-cap"]),"line-join":new Et(ke.layout_line["line-join"]),"line-miter-limit":new St(ke.layout_line["line-miter-limit"]),"line-round-limit":new St(ke.layout_line["line-round-limit"]),"line-sort-key":new Et(ke.layout_line["line-sort-key"])})}};class jw extends Et{possiblyEvaluate(t,a){return a=new Pi(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,l,f){return a=de({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,l,f)}}let bd;class Vw extends e{constructor(t){super(t,Q0),this.gradientVersion=0,bd||(bd=new jw(Q0.paint.properties["line-width"].specification),bd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Ms,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=bd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Dp(t)}queryRadius(t){const a=t,l=ey(bu("line-width",this,a),bu("line-gap-width",this,a)),f=bu("line-offset",this,a);return l/2+Math.abs(f)+pd(this.paint.get("line-translate"))}queryIntersectsFeature(t,a,l,f,y,v,x){const T=md(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,x),A=x/2*ey(this.paint.get("line-width").evaluate(a,l),this.paint.get("line-gap-width").evaluate(a,l)),I=this.paint.get("line-offset").evaluate(a,l);return I&&(f=function(P,L){const j=[];for(let $=0;$<P.length;$++){const U=P[$],J=[];for(let re=0;re<U.length;re++){const xe=U[re-1],ue=U[re],ye=U[re+1],Ce=re===0?new R(0,0):ue.sub(xe)._unit()._perp(),We=re===U.length-1?new R(0,0):ye.sub(ue)._unit()._perp(),ct=Ce._add(We)._unit(),zt=ct.x*We.x+ct.y*We.y;zt!==0&&ct._mult(1/zt),J.push(ct._mult(L)._add(ue))}j.push(J)}return j}(f,I*x)),function(P,L,j){for(let $=0;$<L.length;$++){const U=L[$];if(P.length>=3){for(let J=0;J<U.length;J++)if(Hl(P,U[J]))return!0}if(Yx(P,U,j))return!0}return!1}(T,f,A)}isTileClipped(){return!0}}function ey(r,t){return t>0?t+2*r:r}const $w=m([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Uw=m([{name:"a_projected_pos",components:3,type:"Float32"}],4);m([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ww=m([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);m([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ty=m([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Hw=m([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function qw(r,t,a){return r.sections.forEach(l=>{l.text=function(f,y,v){const x=y.layout.get("text-transform").evaluate(v,{});return x==="uppercase"?f=f.toLocaleUpperCase():x==="lowercase"&&(f=f.toLocaleLowerCase()),rs.applyArabicShaping&&(f=rs.applyArabicShaping(f)),f}(l.text,t,a)}),r}m([{name:"triangle",components:3,type:"Uint16"}]),m([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),m([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),m([{type:"Float32",name:"offsetX"}]),m([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),m([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Iu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Mn=24,iy=Ni,ny=function(r,t,a,l,f){var y,v,x=8*f-l-1,T=(1<<x)-1,A=T>>1,I=-7,P=f-1,L=-1,j=r[t+P];for(P+=L,y=j&(1<<-I)-1,j>>=-I,I+=x;I>0;y=256*y+r[t+P],P+=L,I-=8);for(v=y&(1<<-I)-1,y>>=-I,I+=l;I>0;v=256*v+r[t+P],P+=L,I-=8);if(y===0)y=1-A;else{if(y===T)return v?NaN:1/0*(j?-1:1);v+=Math.pow(2,l),y-=A}return(j?-1:1)*v*Math.pow(2,y-l)},ry=function(r,t,a,l,f,y){var v,x,T,A=8*y-f-1,I=(1<<A)-1,P=I>>1,L=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=0,$=1,U=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,v=I):(v=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-v))<1&&(v--,T*=2),(t+=v+P>=1?L/T:L*Math.pow(2,1-P))*T>=2&&(v++,T/=2),v+P>=I?(x=0,v=I):v+P>=1?(x=(t*T-1)*Math.pow(2,f),v+=P):(x=t*Math.pow(2,P-1)*Math.pow(2,f),v=0));f>=8;r[a+j]=255&x,j+=$,x/=256,f-=8);for(v=v<<f|x,A+=f;A>0;r[a+j]=255&v,j+=$,v/=256,A-=8);r[a+j-$]|=128*U};function Ni(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Ni.Varint=0,Ni.Fixed64=1,Ni.Bytes=2,Ni.Fixed32=5;var Lp=4294967296,ay=1/Lp,sy=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function ls(r){return r.type===Ni.Bytes?r.readVarint()+r.pos:r.pos+1}function Xl(r,t,a){return a?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function oy(r,t,a){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(l);for(var f=a.pos-1;f>=r;f--)a.buf[f+l]=a.buf[f]}function Gw(r,t){for(var a=0;a<r.length;a++)t.writeVarint(r[a])}function Zw(r,t){for(var a=0;a<r.length;a++)t.writeSVarint(r[a])}function Xw(r,t){for(var a=0;a<r.length;a++)t.writeFloat(r[a])}function Yw(r,t){for(var a=0;a<r.length;a++)t.writeDouble(r[a])}function Kw(r,t){for(var a=0;a<r.length;a++)t.writeBoolean(r[a])}function Jw(r,t){for(var a=0;a<r.length;a++)t.writeFixed32(r[a])}function Qw(r,t){for(var a=0;a<r.length;a++)t.writeSFixed32(r[a])}function e2(r,t){for(var a=0;a<r.length;a++)t.writeFixed64(r[a])}function t2(r,t){for(var a=0;a<r.length;a++)t.writeSFixed64(r[a])}function xd(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function Yl(r,t,a){r[a]=t,r[a+1]=t>>>8,r[a+2]=t>>>16,r[a+3]=t>>>24}function ly(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}Ni.prototype={destroy:function(){this.buf=null},readFields:function(r,t,a){for(a=a||this.length;this.pos<a;){var l=this.readVarint(),f=l>>3,y=this.pos;this.type=7&l,r(f,t,this),this.pos===y&&this.skip(l)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=xd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=ly(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=xd(this.buf,this.pos)+xd(this.buf,this.pos+4)*Lp;return this.pos+=8,r},readSFixed64:function(){var r=xd(this.buf,this.pos)+ly(this.buf,this.pos+4)*Lp;return this.pos+=8,r},readFloat:function(){var r=ny(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=ny(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,a,l=this.buf;return t=127&(a=l[this.pos++]),a<128?t:(t|=(127&(a=l[this.pos++]))<<7,a<128?t:(t|=(127&(a=l[this.pos++]))<<14,a<128?t:(t|=(127&(a=l[this.pos++]))<<21,a<128?t:function(f,y,v){var x,T,A=v.buf;if(x=(112&(T=A[v.pos++]))>>4,T<128||(x|=(127&(T=A[v.pos++]))<<3,T<128)||(x|=(127&(T=A[v.pos++]))<<10,T<128)||(x|=(127&(T=A[v.pos++]))<<17,T<128)||(x|=(127&(T=A[v.pos++]))<<24,T<128)||(x|=(1&(T=A[v.pos++]))<<31,T<128))return Xl(f,x,y);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(a=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&sy?function(a,l,f){return sy.decode(a.subarray(l,f))}(this.buf,t,r):function(a,l,f){for(var y="",v=l;v<f;){var x,T,A,I=a[v],P=null,L=I>239?4:I>223?3:I>191?2:1;if(v+L>f)break;L===1?I<128&&(P=I):L===2?(192&(x=a[v+1]))==128&&(P=(31&I)<<6|63&x)<=127&&(P=null):L===3?(T=a[v+2],(192&(x=a[v+1]))==128&&(192&T)==128&&((P=(15&I)<<12|(63&x)<<6|63&T)<=2047||P>=55296&&P<=57343)&&(P=null)):L===4&&(T=a[v+2],A=a[v+3],(192&(x=a[v+1]))==128&&(192&T)==128&&(192&A)==128&&((P=(15&I)<<18|(63&x)<<12|(63&T)<<6|63&A)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,L=1):P>65535&&(P-=65536,y+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),y+=String.fromCharCode(P),v+=L}return y}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==Ni.Bytes)return r.push(this.readVarint(t));var a=ls(this);for(r=r||[];this.pos<a;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==Ni.Bytes)return r.push(this.readSVarint());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Ni.Bytes)return r.push(this.readBoolean());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Ni.Bytes)return r.push(this.readFloat());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Ni.Bytes)return r.push(this.readDouble());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Ni.Bytes)return r.push(this.readFixed32());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Ni.Bytes)return r.push(this.readSFixed32());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Ni.Bytes)return r.push(this.readFixed64());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Ni.Bytes)return r.push(this.readSFixed64());var t=ls(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===Ni.Varint)for(;this.buf[this.pos++]>127;);else if(t===Ni.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Ni.Fixed32)this.pos+=4;else{if(t!==Ni.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var a=new Uint8Array(t);a.set(this.buf),this.buf=a,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Yl(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Yl(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Yl(this.buf,-1&r,this.pos),Yl(this.buf,Math.floor(r*ay),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Yl(this.buf,-1&r,this.pos),Yl(this.buf,Math.floor(r*ay),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,a){var l,f;if(t>=0?(l=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(y,v,x){x.buf[x.pos++]=127&y|128,y>>>=7,x.buf[x.pos++]=127&y|128,y>>>=7,x.buf[x.pos++]=127&y|128,y>>>=7,x.buf[x.pos++]=127&y|128,x.buf[x.pos]=127&(y>>>=7)}(l,0,a),function(y,v){var x=(7&y)<<4;v.buf[v.pos++]|=x|((y>>>=3)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y)))))}(f,a)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(l,f,y){for(var v,x,T=0;T<f.length;T++){if((v=f.charCodeAt(T))>55295&&v<57344){if(!x){v>56319||T+1===f.length?(l[y++]=239,l[y++]=191,l[y++]=189):x=v;continue}if(v<56320){l[y++]=239,l[y++]=191,l[y++]=189,x=v;continue}v=x-55296<<10|v-56320|65536,x=null}else x&&(l[y++]=239,l[y++]=191,l[y++]=189,x=null);v<128?l[y++]=v:(v<2048?l[y++]=v>>6|192:(v<65536?l[y++]=v>>12|224:(l[y++]=v>>18|240,l[y++]=v>>12&63|128),l[y++]=v>>6&63|128),l[y++]=63&v|128)}return y}(this.buf,r,this.pos);var a=this.pos-t;a>=128&&oy(t,a,this),this.pos=t-1,this.writeVarint(a),this.pos+=a},writeFloat:function(r){this.realloc(4),ry(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),ry(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var a=0;a<t;a++)this.buf[this.pos++]=r[a]},writeRawMessage:function(r,t){this.pos++;var a=this.pos;r(t,this);var l=this.pos-a;l>=128&&oy(a,l,this),this.pos=a-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,t,a){this.writeTag(r,Ni.Bytes),this.writeRawMessage(t,a)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,Gw,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,Zw,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,Kw,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,Xw,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,Yw,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,Jw,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,Qw,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,e2,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,t2,t)},writeBytesField:function(r,t){this.writeTag(r,Ni.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,Ni.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,Ni.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,Ni.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,Ni.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,Ni.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,Ni.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,Ni.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,Ni.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,Ni.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var Rp=M(iy);const Bp=3;function i2(r,t,a){r===1&&a.readMessage(n2,t)}function n2(r,t,a){if(r===3){const{id:l,bitmap:f,width:y,height:v,left:x,top:T,advance:A}=a.readMessage(r2,{});t.push({id:l,bitmap:new wu({width:y+2*Bp,height:v+2*Bp},f),metrics:{width:y,height:v,left:x,top:T,advance:A}})}}function r2(r,t,a){r===1?t.id=a.readVarint():r===2?t.bitmap=a.readBytes():r===3?t.width=a.readVarint():r===4?t.height=a.readVarint():r===5?t.left=a.readSVarint():r===6?t.top=a.readSVarint():r===7&&(t.advance=a.readVarint())}const cy=Bp;function uy(r){let t=0,a=0;for(const v of r)t+=v.w*v.h,a=Math.max(a,v.w);r.sort((v,x)=>x.h-v.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let f=0,y=0;for(const v of r)for(let x=l.length-1;x>=0;x--){const T=l[x];if(!(v.w>T.w||v.h>T.h)){if(v.x=T.x,v.y=T.y,y=Math.max(y,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===T.w&&v.h===T.h){const A=l.pop();x<l.length&&(l[x]=A)}else v.h===T.h?(T.x+=v.w,T.w-=v.w):v.w===T.w?(T.y+=v.h,T.h-=v.h):(l.push({x:T.x+v.w,y:T.y,w:T.w-v.w,h:v.h}),T.y+=v.h,T.h-=v.h);break}}return{w:f,h:y,fill:t/(f*y)||0}}const zr=1;class Op{constructor(t,{pixelRatio:a,version:l,stretchX:f,stretchY:y,content:v,textFitWidth:x,textFitHeight:T}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=f,this.stretchY=y,this.content=v,this.version=l,this.textFitWidth=x,this.textFitHeight=T}get tl(){return[this.paddedRect.x+zr,this.paddedRect.y+zr]}get br(){return[this.paddedRect.x+this.paddedRect.w-zr,this.paddedRect.y+this.paddedRect.h-zr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*zr)/this.pixelRatio,(this.paddedRect.h-2*zr)/this.pixelRatio]}}class hy{constructor(t,a){const l={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(t,l,y),this.addImages(a,f,y);const{w:v,h:x}=uy(y),T=new Qr({width:v||1,height:x||1});for(const A in t){const I=t[A],P=l[A].paddedRect;Qr.copy(I.data,T,{x:0,y:0},{x:P.x+zr,y:P.y+zr},I.data)}for(const A in a){const I=a[A],P=f[A].paddedRect,L=P.x+zr,j=P.y+zr,$=I.data.width,U=I.data.height;Qr.copy(I.data,T,{x:0,y:0},{x:L,y:j},I.data),Qr.copy(I.data,T,{x:0,y:U-1},{x:L,y:j-1},{width:$,height:1}),Qr.copy(I.data,T,{x:0,y:0},{x:L,y:j+U},{width:$,height:1}),Qr.copy(I.data,T,{x:$-1,y:0},{x:L-1,y:j},{width:1,height:U}),Qr.copy(I.data,T,{x:0,y:0},{x:L+$,y:j},{width:1,height:U})}this.image=T,this.iconPositions=l,this.patternPositions=f}addImages(t,a,l){for(const f in t){const y=t[f],v={x:0,y:0,w:y.data.width+2*zr,h:y.data.height+2*zr};l.push(v),a[f]=new Op(v,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),a),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),a)}patchUpdatedImage(t,a,l){if(!t||!a||t.version===a.version)return;t.version=a.version;const[f,y]=t.tl;l.update(a.data,void 0,{x:f,y})}}var $s;ht("ImagePosition",Op),ht("ImageAtlas",hy),_.ah=void 0,($s=_.ah||(_.ah={}))[$s.none=0]="none",$s[$s.horizontal=1]="horizontal",$s[$s.vertical=2]="vertical",$s[$s.horizontalOnly=3]="horizontalOnly";const Eu=-17;class Cu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,a){const l=new Cu;return l.scale=t||1,l.fontStack=a,l}static forImage(t){const a=new Cu;return a.imageName=t,a}}class Kl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const l=new Kl;for(let f=0;f<t.sections.length;f++){const y=t.sections[f];y.image?l.addImageSection(y):l.addTextSection(y,a)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let l=0;l<t.length;l++){const f=t.charCodeAt(l+1)||null,y=t.charCodeAt(l-1)||null;a+=f&&sd(f)&&!Iu[t[l+1]]||y&&sd(y)&&!Iu[t[l-1]]||!Iu[t[l]]?t[l]:Iu[t[l]]}return a}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&Td[this.text.charCodeAt(l)];l++)t++;let a=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&Td[this.text.charCodeAt(l)];l--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const l=new Kl;return l.text=this.text.substring(t,a),l.sectionIndex=this.sectionIndex.slice(t,a),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}addTextSection(t,a){this.text+=t.text,this.sections.push(Cu.forText(t.scale,t.fontStack||a));const l=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(l)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void fe("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Cu.forImage(a)),this.sectionIndex.push(this.sections.length-1)):fe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function wd(r,t,a,l,f,y,v,x,T,A,I,P,L,j,$){const U=Kl.fromFeature(r,f);let J;P===_.ah.vertical&&U.verticalizePunctuation();const{processBidirectionalText:re,processStyledBidirectionalText:xe}=rs;if(re&&U.sections.length===1){J=[];const Ce=re(U.toString(),Fp(U,A,y,t,l,j));for(const We of Ce){const ct=new Kl;ct.text=We,ct.sections=U.sections;for(let zt=0;zt<We.length;zt++)ct.sectionIndex.push(0);J.push(ct)}}else if(xe){J=[];const Ce=xe(U.text,U.sectionIndex,Fp(U,A,y,t,l,j));for(const We of Ce){const ct=new Kl;ct.text=We[0],ct.sectionIndex=We[1],ct.sections=U.sections,J.push(ct)}}else J=function(Ce,We){const ct=[],zt=Ce.text;let st=0;for(const nt of We)ct.push(Ce.substring(st,nt)),st=nt;return st<zt.length&&ct.push(Ce.substring(st,zt.length)),ct}(U,Fp(U,A,y,t,l,j));const ue=[],ye={positionedLines:ue,text:U.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:P,iconsInText:!1,verticalizable:!1};return function(Ce,We,ct,zt,st,nt,wt,yt,ft,Oe,At,bt){let Ft=0,Wi=Eu,ji=0,Pn=0;const ha=yt==="right"?1:yt==="left"?0:.5;let Zn=0;for(const mn of st){mn.trim();const Dn=mn.getMaxScale(),sr=(Dn-1)*Mn,Xn={positionedGlyphs:[],lineOffset:0};Ce.positionedLines[Zn]=Xn;const wr=Xn.positionedGlyphs;let Yn=0;if(!mn.length()){Wi+=nt,++Zn;continue}for(let Dr=0;Dr<mn.length();Dr++){const _i=mn.getSection(Dr),Gi=mn.getSectionIndex(Dr),Ki=mn.getCharCode(Dr);let jr=0,an=null,tc=null,Ba=null,Oa=Mn;const da=!(ft===_.ah.horizontal||!At&&!pu(Ki)||At&&(Td[Ki]||(zn=Ki,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(zn)))));if(_i.imageName){const ia=zt[_i.imageName];if(!ia)continue;Ba=_i.imageName,Ce.iconsInText=Ce.iconsInText||!0,tc=ia.paddedRect;const jn=ia.displaySize;_i.scale=_i.scale*Mn/bt,an={width:jn[0],height:jn[1],left:zr,top:-cy,advance:da?jn[1]:jn[0]},jr=sr+(Mn-jn[1]*_i.scale),Oa=an.advance;const cs=da?jn[0]*_i.scale-Mn*Dn:jn[1]*_i.scale-Mn*Dn;cs>0&&cs>Yn&&(Yn=cs)}else{const ia=ct[_i.fontStack],jn=ia&&ia[Ki];if(jn&&jn.rect)tc=jn.rect,an=jn.metrics;else{const cs=We[_i.fontStack],Bu=cs&&cs[Ki];if(!Bu)continue;an=Bu.metrics}jr=(Dn-_i.scale)*Mn}da?(Ce.verticalizable=!0,wr.push({glyph:Ki,imageName:Ba,x:Ft,y:Wi+jr,vertical:da,scale:_i.scale,fontStack:_i.fontStack,sectionIndex:Gi,metrics:an,rect:tc}),Ft+=Oa*_i.scale+Oe):(wr.push({glyph:Ki,imageName:Ba,x:Ft,y:Wi+jr,vertical:da,scale:_i.scale,fontStack:_i.fontStack,sectionIndex:Gi,metrics:an,rect:tc}),Ft+=an.advance*_i.scale+Oe)}wr.length!==0&&(ji=Math.max(Ft-Oe,ji),l2(wr,0,wr.length-1,ha,Yn)),Ft=0;const ta=nt*Dn+Yn;Xn.lineOffset=Math.max(Yn,sr),Wi+=ta,Pn=Math.max(ta,Pn),++Zn}var zn;const vr=Wi-Eu,{horizontalAlign:br,verticalAlign:xr}=Np(wt);(function(mn,Dn,sr,Xn,wr,Yn,ta,Dr,_i){const Gi=(Dn-sr)*wr;let Ki=0;Ki=Yn!==ta?-Dr*Xn-Eu:(-Xn*_i+.5)*ta;for(const jr of mn)for(const an of jr.positionedGlyphs)an.x+=Gi,an.y+=Ki})(Ce.positionedLines,ha,br,xr,ji,Pn,nt,vr,st.length),Ce.top+=-xr*vr,Ce.bottom=Ce.top+vr,Ce.left+=-br*ji,Ce.right=Ce.left+ji}(ye,t,a,l,J,v,x,T,P,A,L,$),!function(Ce){for(const We of Ce)if(We.positionedGlyphs.length!==0)return!1;return!0}(ue)&&ye}const Td={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},a2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},s2={40:!0};function dy(r,t,a,l,f,y){if(t.imageName){const v=l[t.imageName];return v?v.displaySize[0]*t.scale*Mn/y+f:0}{const v=a[t.fontStack],x=v&&v[r];return x?x.metrics.advance*t.scale+f:0}}function fy(r,t,a,l){const f=Math.pow(r-t,2);return l?r<t?f/2:2*f:f+Math.abs(a)*a}function o2(r,t,a){let l=0;return r===10&&(l-=1e4),a&&(l+=150),r!==40&&r!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function py(r,t,a,l,f,y){let v=null,x=fy(t,a,f,y);for(const T of l){const A=fy(t-T.x,a,f,y)+T.badness;A<=x&&(v=T,x=A)}return{index:r,x:t,priorBreak:v,badness:x}}function my(r){return r?my(r.priorBreak).concat(r.index):[]}function Fp(r,t,a,l,f,y){if(!r)return[];const v=[],x=function(P,L,j,$,U,J){let re=0;for(let xe=0;xe<P.length();xe++){const ue=P.getSection(xe);re+=dy(P.getCharCode(xe),ue,$,U,L,J)}return re/Math.max(1,Math.ceil(re/j))}(r,t,a,l,f,y),T=r.text.indexOf("​")>=0;let A=0;for(let P=0;P<r.length();P++){const L=r.getSection(P),j=r.getCharCode(P);if(Td[j]||(A+=dy(j,L,l,f,t,y)),P<r.length()-1){const $=!((I=j)<11904)&&(!!li["CJK Compatibility Forms"](I)||!!li["CJK Compatibility"](I)||!!li["CJK Strokes"](I)||!!li["CJK Symbols and Punctuation"](I)||!!li["Enclosed CJK Letters and Months"](I)||!!li["Halfwidth and Fullwidth Forms"](I)||!!li["Ideographic Description Characters"](I)||!!li["Vertical Forms"](I)||ns.test(String.fromCodePoint(I)));(a2[j]||$||L.imageName||P!==r.length()-2&&s2[r.getCharCode(P+1)])&&v.push(py(P+1,A,x,v,o2(j,r.getCharCode(P+1),$&&T),!1))}}var I;return my(py(r.length(),A,x,v,0,!0))}function Np(r){let t=.5,a=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function l2(r,t,a,l,f){if(!l&&!f)return;const y=r[a],v=(r[a].x+y.metrics.advance*y.scale)*l;for(let x=t;x<=a;x++)r[x].x-=v,r[x].y+=f}function c2(r,t,a){const{horizontalAlign:l,verticalAlign:f}=Np(a),y=t[0]-r.displaySize[0]*l,v=t[1]-r.displaySize[1]*f;return{image:r,top:v,bottom:v+r.displaySize[1],left:y,right:y+r.displaySize[0]}}function gy(r){var t,a;let l=r.left,f=r.top,y=r.right-l,v=r.bottom-f;const x=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",T=(a=r.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",A=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(T==="proportional"){if(x==="stretchOnly"&&y/v<A||x==="proportional"){const I=Math.ceil(v*A);l*=I/y,y=I}}else if(x==="proportional"&&T==="stretchOnly"&&A!==0&&y/v>A){const I=Math.ceil(y/A);f*=I/v,v=I}return{x1:l,y1:f,x2:l+y,y2:f+v}}function yy(r,t,a,l,f,y){const v=r.image;let x;if(v.content){const J=v.content,re=v.pixelRatio||1;x=[J[0]/re,J[1]/re,v.displaySize[0]-J[2]/re,v.displaySize[1]-J[3]/re]}const T=t.left*y,A=t.right*y;let I,P,L,j;a==="width"||a==="both"?(j=f[0]+T-l[3],P=f[0]+A+l[1]):(j=f[0]+(T+A-v.displaySize[0])/2,P=j+v.displaySize[0]);const $=t.top*y,U=t.bottom*y;return a==="height"||a==="both"?(I=f[1]+$-l[0],L=f[1]+U+l[2]):(I=f[1]+($+U-v.displaySize[1])/2,L=I+v.displaySize[1]),{image:v,top:I,right:P,bottom:L,left:j,collisionPadding:x}}const Pu=255,Ra=128,Us=Pu*Ra;function _y(r,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Pi(r+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:f}=a;let y=0;for(;y<l.length&&l[y]<=r;)y++;y=Math.max(0,y-1);let v=y;for(;v<l.length&&l[v]<r+1;)v++;v=Math.min(l.length-1,v);const x=l[y],T=l[v];return a.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:T,interpolationType:f}:{kind:"camera",minZoom:x,maxZoom:T,minSize:a.evaluate(new Pi(x)),maxSize:a.evaluate(new Pi(T)),interpolationType:f}}}function jp(r,t,a){let l="never";const f=r.get(t);return f?l=f:r.get(a)&&(l="always"),l}const u2=Vs.VectorTileFeature.types,h2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sd(r,t,a,l,f,y,v,x,T,A,I,P,L){const j=x?Math.min(Us,Math.round(x[0])):0,$=x?Math.min(Us,Math.round(x[1])):0;r.emplaceBack(t,a,Math.round(32*l),Math.round(32*f),y,v,(j<<1)+(T?1:0),$,16*A,16*I,256*P,256*L)}function Vp(r,t,a){r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a),r.emplaceBack(t.x,t.y,a)}function d2(r){for(const t of r.sections)if(mp(t.text))return!0;return!1}class $p{constructor(t){this.layoutVertexArray=new as,this.indexArray=new Pr,this.programConfigurations=t,this.segments=new Fi,this.dynamicLayoutVertexArray=new Vl,this.opacityVertexArray=new yu,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ot}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,l,f){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$w.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Uw.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,h2,!0),this.opacityVertexBuffer.itemSize=1),(l||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ht("SymbolBuffers",$p);class Up{constructor(t,a,l){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new l,this.segments=new Fi,this.collisionVertexArray=new Jr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Ww.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ht("CollisionBuffers",Up);class Jl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(v=>v.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=wp([]),this.placementViewportMatrix=wp([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_y(this.zoom,a["text-size"]),this.iconSizeData=_y(this.zoom,a["icon-size"]);const l=this.layers[0].layout,f=l.get("symbol-sort-key"),y=l.get("symbol-z-order");this.canOverlap=jp(l,"text-overlap","text-allow-overlap")!=="never"||jp(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(v=>_.ah[v])),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=t.sourceID}createArrays(){this.text=new $p(new Uo(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new $p(new Uo(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ci,this.lineVertexArray=new Xi,this.symbolInstances=new Jt,this.textAnchorOffsets=new Yr}calculateGlyphDependencies(t,a,l,f,y){for(let v=0;v<t.length;v++)if(a[t.charCodeAt(v)]=!0,(l||f)&&y){const x=Iu[t.charAt(v)];x&&(a[x.charCodeAt(0)]=!0)}}populate(t,a,l){const f=this.layers[0],y=f.layout,v=y.get("text-font"),x=y.get("text-field"),T=y.get("icon-image"),A=(x.value.kind!=="constant"||x.value.value instanceof Mr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),I=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,P=y.get("symbol-sort-key");if(this.features=[],!A&&!I)return;const L=a.iconDependencies,j=a.glyphDependencies,$=a.availableImages,U=new Pi(this.zoom);for(const{feature:J,id:re,index:xe,sourceLayerIndex:ue}of t){const ye=f._featureFilter.needGeometry,Ce=Ho(J,ye);if(!f._featureFilter.filter(U,Ce,l))continue;let We,ct;if(ye||(Ce.geometry=Wo(J)),A){const st=f.getValueAndResolveTokens("text-field",Ce,l,$),nt=Mr.factory(st),wt=this.hasRTLText=this.hasRTLText||d2(nt);(!wt||rs.getRTLTextPluginStatus()==="unavailable"||wt&&rs.isParsed())&&(We=qw(nt,f,Ce))}if(I){const st=f.getValueAndResolveTokens("icon-image",Ce,l,$);ct=st instanceof Er?st:Er.fromString(st)}if(!We&&!ct)continue;const zt=this.sortFeaturesByKey?P.evaluate(Ce,{},l):void 0;if(this.features.push({id:re,text:We,icon:ct,index:xe,sourceLayerIndex:ue,geometry:Ce.geometry,properties:J.properties,type:u2[J.type],sortKey:zt}),ct&&(L[ct.name]=!0),We){const st=v.evaluate(Ce,{},l).join(","),nt=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_.ah.vertical)>=0;for(const wt of We.sections)if(wt.image)L[wt.image.name]=!0;else{const yt=du(We.toString()),ft=wt.fontStack||st,Oe=j[ft]=j[ft]||{};this.calculateGlyphDependencies(wt.text,Oe,nt,this.allowVerticalPlacement,yt)}}}y.get("symbol-placement")==="line"&&(this.features=function(J){const re={},xe={},ue=[];let ye=0;function Ce(st){ue.push(J[st]),ye++}function We(st,nt,wt){const yt=xe[st];return delete xe[st],xe[nt]=yt,ue[yt].geometry[0].pop(),ue[yt].geometry[0]=ue[yt].geometry[0].concat(wt[0]),yt}function ct(st,nt,wt){const yt=re[nt];return delete re[nt],re[st]=yt,ue[yt].geometry[0].shift(),ue[yt].geometry[0]=wt[0].concat(ue[yt].geometry[0]),yt}function zt(st,nt,wt){const yt=wt?nt[0][nt[0].length-1]:nt[0][0];return`${st}:${yt.x}:${yt.y}`}for(let st=0;st<J.length;st++){const nt=J[st],wt=nt.geometry,yt=nt.text?nt.text.toString():null;if(!yt){Ce(st);continue}const ft=zt(yt,wt),Oe=zt(yt,wt,!0);if(ft in xe&&Oe in re&&xe[ft]!==re[Oe]){const At=ct(ft,Oe,wt),bt=We(ft,Oe,ue[At].geometry);delete re[ft],delete xe[Oe],xe[zt(yt,ue[bt].geometry,!0)]=bt,ue[At].geometry=null}else ft in xe?We(ft,Oe,wt):Oe in re?ct(ft,Oe,wt):(Ce(st),re[ft]=ye-1,xe[Oe]=ye-1)}return ue.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((J,re)=>J.sortKey-re.sortKey)}update(t,a,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const l=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(a[t.segment+1]),y=t.dist(a[t.segment]);const v={};for(let x=t.segment+1;x<a.length;x++)v[x]={x:a[x].x,y:a[x].y,tileUnitDistanceFromAnchor:f},x<a.length-1&&(f+=a[x+1].dist(a[x]));for(let x=t.segment||0;x>=0;x--)v[x]={x:a[x].x,y:a[x].y,tileUnitDistanceFromAnchor:y},x>0&&(y+=a[x-1].dist(a[x]));for(let x=0;x<a.length;x++){const T=v[x];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,a,l,f,y,v,x,T,A,I,P,L){const j=t.indexArray,$=t.layoutVertexArray,U=t.segments.prepareSegment(4*a.length,$,j,this.canOverlap?v.sortKey:void 0),J=this.glyphOffsetArray.length,re=U.vertexLength,xe=this.allowVerticalPlacement&&x===_.ah.vertical?Math.PI/2:0,ue=v.text&&v.text.sections;for(let ye=0;ye<a.length;ye++){const{tl:Ce,tr:We,bl:ct,br:zt,tex:st,pixelOffsetTL:nt,pixelOffsetBR:wt,minFontScaleX:yt,minFontScaleY:ft,glyphOffset:Oe,isSDF:At,sectionIndex:bt}=a[ye],Ft=U.vertexLength,Wi=Oe[1];Sd($,T.x,T.y,Ce.x,Wi+Ce.y,st.x,st.y,l,At,nt.x,nt.y,yt,ft),Sd($,T.x,T.y,We.x,Wi+We.y,st.x+st.w,st.y,l,At,wt.x,nt.y,yt,ft),Sd($,T.x,T.y,ct.x,Wi+ct.y,st.x,st.y+st.h,l,At,nt.x,wt.y,yt,ft),Sd($,T.x,T.y,zt.x,Wi+zt.y,st.x+st.w,st.y+st.h,l,At,wt.x,wt.y,yt,ft),Vp(t.dynamicLayoutVertexArray,T,xe),j.emplaceBack(Ft,Ft+1,Ft+2),j.emplaceBack(Ft+1,Ft+2,Ft+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Oe[0]),ye!==a.length-1&&bt===a[ye+1].sectionIndex||t.programConfigurations.populatePaintArrays($.length,v,v.index,{},L,ue&&ue[bt])}t.placedSymbolArray.emplaceBack(T.x,T.y,J,this.glyphOffsetArray.length-J,re,A,I,T.segment,l?l[0]:0,l?l[1]:0,f[0],f[1],x,0,!1,0,P)}_addCollisionDebugVertex(t,a,l,f,y,v){return a.emplaceBack(0,0),t.emplaceBack(l.x,l.y,f,y,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(t,a,l,f,y,v,x){const T=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),A=T.vertexLength,I=y.layoutVertexArray,P=y.collisionVertexArray,L=x.anchorX,j=x.anchorY;this._addCollisionDebugVertex(I,P,v,L,j,new R(t,a)),this._addCollisionDebugVertex(I,P,v,L,j,new R(l,a)),this._addCollisionDebugVertex(I,P,v,L,j,new R(l,f)),this._addCollisionDebugVertex(I,P,v,L,j,new R(t,f)),T.vertexLength+=4;const $=y.indexArray;$.emplaceBack(A,A+1),$.emplaceBack(A+1,A+2),$.emplaceBack(A+2,A+3),$.emplaceBack(A+3,A),T.primitiveLength+=4}addDebugCollisionBoxes(t,a,l,f){for(let y=t;y<a;y++){const v=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,f?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Up(Cr,ty.members,La),this.iconCollisionBox=new Up(Cr,ty.members,La);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,l,f,y,v,x,T,A){const I={};for(let P=a;P<l;P++){const L=t.get(P);I.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.textFeatureIndex=L.featureIndex;break}for(let P=f;P<y;P++){const L=t.get(P);I.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.verticalTextFeatureIndex=L.featureIndex;break}for(let P=v;P<x;P++){const L=t.get(P);I.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.iconFeatureIndex=L.featureIndex;break}for(let P=T;P<A;P++){const L=t.get(P);I.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.verticalIconFeatureIndex=L.featureIndex;break}return I}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const l=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const l=t.placedSymbolArray.get(a),f=l.vertexStartIndex+4*l.numGlyphs;for(let y=l.vertexStartIndex;y<f;y+=4)t.indexArray.emplaceBack(y,y+1,y+2),t.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),l=Math.cos(t),f=[],y=[],v=[];for(let x=0;x<this.symbolInstances.length;++x){v.push(x);const T=this.symbolInstances.get(x);f.push(0|Math.round(a*T.anchorX+l*T.anchorY)),y.push(T.featureIndex)}return v.sort((x,T)=>f[x]-f[T]||y[T]-y[x]),v}addToSortKeyRanges(t,a){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===a?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const l=this.symbolInstances.get(a);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((f,y,v)=>{f>=0&&v.indexOf(f)===y&&this.addIndicesForPlacedSymbol(this.text,f)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let vy,by;ht("SymbolBucket",Jl,{omit:["layers","collisionBoxArray","features","compareText"]}),Jl.MAX_GLYPHS=65535,Jl.addDynamicAttributes=Vp;var Wp={get paint(){return by=by||new gr({"icon-opacity":new Et(ke.paint_symbol["icon-opacity"]),"icon-color":new Et(ke.paint_symbol["icon-color"]),"icon-halo-color":new Et(ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new Et(ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Et(ke.paint_symbol["icon-halo-blur"]),"icon-translate":new St(ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new St(ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new Et(ke.paint_symbol["text-opacity"]),"text-color":new Et(ke.paint_symbol["text-color"],{runtimeType:Di,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Et(ke.paint_symbol["text-halo-color"]),"text-halo-width":new Et(ke.paint_symbol["text-halo-width"]),"text-halo-blur":new Et(ke.paint_symbol["text-halo-blur"]),"text-translate":new St(ke.paint_symbol["text-translate"]),"text-translate-anchor":new St(ke.paint_symbol["text-translate-anchor"])})},get layout(){return vy=vy||new gr({"symbol-placement":new St(ke.layout_symbol["symbol-placement"]),"symbol-spacing":new St(ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new St(ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Et(ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new St(ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new St(ke.layout_symbol["icon-allow-overlap"]),"icon-overlap":new St(ke.layout_symbol["icon-overlap"]),"icon-ignore-placement":new St(ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new St(ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new St(ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new Et(ke.layout_symbol["icon-size"]),"icon-text-fit":new St(ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St(ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new Et(ke.layout_symbol["icon-image"]),"icon-rotate":new Et(ke.layout_symbol["icon-rotate"]),"icon-padding":new Et(ke.layout_symbol["icon-padding"]),"icon-keep-upright":new St(ke.layout_symbol["icon-keep-upright"]),"icon-offset":new Et(ke.layout_symbol["icon-offset"]),"icon-anchor":new Et(ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new St(ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new St(ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new St(ke.layout_symbol["text-rotation-alignment"]),"text-field":new Et(ke.layout_symbol["text-field"]),"text-font":new Et(ke.layout_symbol["text-font"]),"text-size":new Et(ke.layout_symbol["text-size"]),"text-max-width":new Et(ke.layout_symbol["text-max-width"]),"text-line-height":new St(ke.layout_symbol["text-line-height"]),"text-letter-spacing":new Et(ke.layout_symbol["text-letter-spacing"]),"text-justify":new Et(ke.layout_symbol["text-justify"]),"text-radial-offset":new Et(ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new St(ke.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Et(ke.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Et(ke.layout_symbol["text-anchor"]),"text-max-angle":new St(ke.layout_symbol["text-max-angle"]),"text-writing-mode":new St(ke.layout_symbol["text-writing-mode"]),"text-rotate":new Et(ke.layout_symbol["text-rotate"]),"text-padding":new St(ke.layout_symbol["text-padding"]),"text-keep-upright":new St(ke.layout_symbol["text-keep-upright"]),"text-transform":new Et(ke.layout_symbol["text-transform"]),"text-offset":new Et(ke.layout_symbol["text-offset"]),"text-allow-overlap":new St(ke.layout_symbol["text-allow-overlap"]),"text-overlap":new St(ke.layout_symbol["text-overlap"]),"text-ignore-placement":new St(ke.layout_symbol["text-ignore-placement"]),"text-optional":new St(ke.layout_symbol["text-optional"])})}};class xy{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Oi,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ht("FormatSectionOverride",xy,{omit:["defaultValue"]});class kd extends e{constructor(t){super(t,Wp)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const f=[];for(const y of l)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,l,f){const y=this.layout.get(t).evaluate(a,{},l,f),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||Mo(v.value)||!y?y:function(x,T){return T.replace(/{([^{}]+)}/g,(A,I)=>x&&I in x?String(x[I]):"")}(a.properties,y)}createBucket(t){return new Jl(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Wp.paint.overridableProperties){if(!kd.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),l=new xy(a),f=new Ml(l,a.property.specification);let y=null;y=a.value.kind==="constant"||a.value.kind==="source"?new Io("source",f):new Ds("composite",f,a.value.zoomStops),this.paint._values[t]=new mr(a.property,y,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,l){return!(!this.layout||a.isDataDriven()||l.isDataDriven())&&kd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const l=t.get("text-field"),f=Wp.paint.properties[a];let y=!1;const v=x=>{for(const T of x)if(f.overrides&&f.overrides.hasOverride(T))return void(y=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Mr)v(l.value.value.sections);else if(l.value.kind==="source"){const x=A=>{y||(A instanceof Wr&&wn(A.value)===Ar?v(A.value.sections):A instanceof vl?v(A.sections):A.eachChild(x))},T=l.value;T._styleExpression&&x(T._styleExpression.expression)}return y}}let wy;var f2={get paint(){return wy=wy||new gr({"background-color":new St(ke.paint_background["background-color"]),"background-pattern":new gu(ke.paint_background["background-pattern"]),"background-opacity":new St(ke.paint_background["background-opacity"])})}};class p2 extends e{constructor(t){super(t,f2)}}let Ty;var m2={get paint(){return Ty=Ty||new gr({"raster-opacity":new St(ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new St(ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new St(ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new St(ke.paint_raster["raster-brightness-max"]),"raster-saturation":new St(ke.paint_raster["raster-saturation"]),"raster-contrast":new St(ke.paint_raster["raster-contrast"]),"raster-resampling":new St(ke.paint_raster["raster-resampling"]),"raster-fade-duration":new St(ke.paint_raster["raster-fade-duration"])})}};class g2 extends e{constructor(t){super(t,m2)}}class y2 extends e{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class _2{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Hp=63710088e-1;class Ws{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ws(Ae(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,l=this.lat*a,f=t.lat*a,y=Math.sin(l)*Math.sin(f)+Math.cos(l)*Math.cos(f)*Math.cos((t.lng-this.lng)*a);return Hp*Math.acos(Math.min(y,1))}static convert(t){if(t instanceof Ws)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ws(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ws(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Sy=2*Math.PI*Hp;function ky(r){return Sy*Math.cos(r*Math.PI/180)}function Ay(r){return(180+r)/360}function My(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Iy(r,t){return r/ky(t)}function qp(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class zu{constructor(t,a,l=0){this.x=+t,this.y=+a,this.z=+l}static fromLngLat(t,a=0){const l=Ws.convert(t);return new zu(Ay(l.lng),My(l.lat),Iy(a,l.lat))}toLngLat(){return new Ws(360*this.x-180,qp(this.y))}toAltitude(){return this.z*ky(qp(this.y))}meterInMercatorCoordinateUnits(){return 1/Sy*(t=qp(this.y),1/Math.cos(t*Math.PI/180));var t}}function Ey(r,t,a){var l=2*Math.PI*6378137/256/Math.pow(2,a);return[r*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class Gp{constructor(t,a,l){if(!function(f,y,v){return!(f<0||f>25||v<0||v>=Math.pow(2,f)||y<0||y>=Math.pow(2,f))}(t,a,l))throw new Error(`x=${a}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=l,this.key=Du(0,t,t,a,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,l){const f=(v=this.y,x=this.z,T=Ey(256*(y=this.x),256*(v=Math.pow(2,x)-v-1),x),A=Ey(256*(y+1),256*(v+1),x),T[0]+","+T[1]+","+A[0]+","+A[1]);var y,v,x,T,A;const I=function(P,L,j){let $,U="";for(let J=P;J>0;J--)$=1<<J-1,U+=(L&$?1:0)+(j&$?2:0);return U}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new R((t.x*a-this.x)*Tn,(t.y*a-this.y)*Tn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Cy{constructor(t,a){this.wrap=t,this.canonical=a,this.key=Du(t,a.z,a.z,a.x,a.y)}}class ea{constructor(t,a,l,f,y){if(t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=a,this.canonical=new Gp(l,+f,+y),this.key=Du(a,t,l,f,y)}clone(){return new ea(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new ea(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ea(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?Du(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):Du(this.wrap*+a,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new ea(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,l=2*this.canonical.x,f=2*this.canonical.y;return[new ea(a,this.wrap,a,l,f),new ea(a,this.wrap,a,l+1,f),new ea(a,this.wrap,a,l,f+1),new ea(a,this.wrap,a,l+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ea(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ea(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Cy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new zu(t.x-this.wrap,t.y))}}function Du(r,t,a,l,f){(r*=2)<0&&(r=-1*r-1);const y=1<<a;return(y*y*r+y*f+l).toString(36)+a.toString(36)+t.toString(36)}ht("CanonicalTileID",Gp),ht("OverscaledTileID",ea,{omit:["posMatrix"]});class Py{constructor(t,a,l,f=1,y=1,v=1,x=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void fe(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const T=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=y,this.blueFactor=v,this.baseShift=x;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let A=0;A<T;A++)this.data[this._idx(-1,A)]=this.data[this._idx(0,A)],this.data[this._idx(T,A)]=this.data[this._idx(T-1,A)],this.data[this._idx(A,-1)]=this.data[this._idx(A,0)],this.data[this._idx(A,T)]=this.data[this._idx(A,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let A=0;A<T;A++)for(let I=0;I<T;I++){const P=this.get(A,I);P>this.max&&(this.max=P),P<this.min&&(this.min=P)}}get(t,a){const l=new Uint8Array(this.data.buffer),f=4*this._idx(t,a);return this.unpack(l[f],l[f+1],l[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,l){return t*this.redFactor+a*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Qr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=a*this.dim,y=a*this.dim+this.dim,v=l*this.dim,x=l*this.dim+this.dim;switch(a){case-1:f=y-1;break;case 1:y=f+1}switch(l){case-1:v=x-1;break;case 1:x=v+1}const T=-a*this.dim,A=-l*this.dim;for(let I=v;I<x;I++)for(let P=f;P<y;P++)this.data[this._idx(P,I)]=t.data[this._idx(P+T,I+A)]}}ht("DEMData",Py);class zy{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const l=t[a];this._stringToNumber[l]=a,this._numberToString[a]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Dy{constructor(t,a,l,f,y){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=l,t._y=f,this.properties=t.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class Ly{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Bs(Tn,16,0),this.grid3D=new Bs(Tn,16,0),this.featureIndexArray=new yr,this.promoteId=a}insert(t,a,l,f,y,v){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,f,y);const T=v?this.grid3D:this.grid;for(let A=0;A<a.length;A++){const I=a[A],P=[1/0,1/0,-1/0,-1/0];for(let L=0;L<I.length;L++){const j=I[L];P[0]=Math.min(P[0],j.x),P[1]=Math.min(P[1],j.y),P[2]=Math.max(P[2],j.x),P[3]=Math.max(P[3],j.y)}P[0]<Tn&&P[1]<Tn&&P[2]>=0&&P[3]>=0&&T.insert(x,P[0],P[1],P[2],P[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Vs.VectorTile(new Rp(this.rawTileData)).layers,this.sourceLayerCoder=new zy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,l,f){this.loadVTLayers();const y=t.params||{},v=Tn/t.tileSize/t.scale,x=Rs(y.filter),T=t.queryGeometry,A=t.queryPadding*v,I=By(T),P=this.grid.query(I.minX-A,I.minY-A,I.maxX+A,I.maxY+A),L=By(t.cameraQueryGeometry),j=this.grid3D.query(L.minX-A,L.minY-A,L.maxX+A,L.maxY+A,(J,re,xe,ue)=>function(ye,Ce,We,ct,zt){for(const nt of ye)if(Ce<=nt.x&&We<=nt.y&&ct>=nt.x&&zt>=nt.y)return!0;const st=[new R(Ce,We),new R(Ce,zt),new R(ct,zt),new R(ct,We)];if(ye.length>2){for(const nt of st)if(Hl(ye,nt))return!0}for(let nt=0;nt<ye.length-1;nt++)if(Jx(ye[nt],ye[nt+1],st))return!0;return!1}(t.cameraQueryGeometry,J-A,re-A,xe+A,ue+A));for(const J of j)P.push(J);P.sort(v2);const $={};let U;for(let J=0;J<P.length;J++){const re=P[J];if(re===U)continue;U=re;const xe=this.featureIndexArray.get(re);let ue=null;this.loadMatchingFeature($,xe.bucketIndex,xe.sourceLayerIndex,xe.featureIndex,x,y.layers,y.availableImages,a,l,f,(ye,Ce,We)=>(ue||(ue=Wo(ye)),Ce.queryIntersectsFeature(T,ye,We,ue,this.z,t.transform,v,t.pixelPosMatrix)))}return $}loadMatchingFeature(t,a,l,f,y,v,x,T,A,I,P){const L=this.bucketLayerIDs[a];if(v&&!function(J,re){for(let xe=0;xe<J.length;xe++)if(re.indexOf(J[xe])>=0)return!0;return!1}(v,L))return;const j=this.sourceLayerCoder.decode(l),$=this.vtLayers[j].feature(f);if(y.needGeometry){const J=Ho($,!0);if(!y.filter(new Pi(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!y.filter(new Pi(this.tileID.overscaledZ),$))return;const U=this.getId($,j);for(let J=0;J<L.length;J++){const re=L[J];if(v&&v.indexOf(re)<0)continue;const xe=T[re];if(!xe)continue;let ue={};U&&I&&(ue=I.getState(xe.sourceLayer||"_geojsonTileLayer",U));const ye=de({},A[re]);ye.paint=Ry(ye.paint,xe.paint,$,ue,x),ye.layout=Ry(ye.layout,xe.layout,$,ue,x);const Ce=!P||P($,xe,ue);if(!Ce)continue;const We=new Dy($,this.z,this.x,this.y,U);We.layer=ye;let ct=t[re];ct===void 0&&(ct=t[re]=[]),ct.push({featureIndex:f,feature:We,intersectionZ:Ce})}}lookupSymbolFeatures(t,a,l,f,y,v,x,T){const A={};this.loadVTLayers();const I=Rs(y);for(const P of t)this.loadMatchingFeature(A,l,f,P,I,v,x,T,a);return A}hasLayer(t){for(const a of this.bucketLayerIDs)for(const l of a)if(t===l)return!0;return!1}getId(t,a){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof l=="boolean"&&(l=Number(l))),l}}function Ry(r,t,a,l,f){return Fe(r,(y,v)=>{const x=t instanceof Ol?t.get(v):null;return x&&x.evaluate?x.evaluate(a,l,f):x})}function By(r){let t=1/0,a=1/0,l=-1/0,f=-1/0;for(const y of r)t=Math.min(t,y.x),a=Math.min(a,y.y),l=Math.max(l,y.x),f=Math.max(f,y.y);return{minX:t,minY:a,maxX:l,maxY:f}}function v2(r,t){return t-r}function Oy(r,t,a,l,f){const y=[];for(let v=0;v<r.length;v++){const x=r[v];let T;for(let A=0;A<x.length-1;A++){let I=x[A],P=x[A+1];I.x<t&&P.x<t||(I.x<t?I=new R(t,I.y+(t-I.x)/(P.x-I.x)*(P.y-I.y))._round():P.x<t&&(P=new R(t,I.y+(t-I.x)/(P.x-I.x)*(P.y-I.y))._round()),I.y<a&&P.y<a||(I.y<a?I=new R(I.x+(a-I.y)/(P.y-I.y)*(P.x-I.x),a)._round():P.y<a&&(P=new R(I.x+(a-I.y)/(P.y-I.y)*(P.x-I.x),a)._round()),I.x>=l&&P.x>=l||(I.x>=l?I=new R(l,I.y+(l-I.x)/(P.x-I.x)*(P.y-I.y))._round():P.x>=l&&(P=new R(l,I.y+(l-I.x)/(P.x-I.x)*(P.y-I.y))._round()),I.y>=f&&P.y>=f||(I.y>=f?I=new R(I.x+(f-I.y)/(P.y-I.y)*(P.x-I.x),f)._round():P.y>=f&&(P=new R(I.x+(f-I.y)/(P.y-I.y)*(P.x-I.x),f)._round()),T&&I.equals(T[T.length-1])||(T=[I],y.push(T)),T.push(P)))))}}return y}ht("FeatureIndex",Ly,{omit:["rawTileData","sourceLayerCoder"]});class Hs extends R{constructor(t,a,l,f){super(t,a),this.angle=l,f!==void 0&&(this.segment=f)}clone(){return new Hs(this.x,this.y,this.angle,this.segment)}}function Fy(r,t,a,l,f){if(t.segment===void 0||a===0)return!0;let y=t,v=t.segment+1,x=0;for(;x>-a/2;){if(v--,v<0)return!1;x-=r[v].dist(y),y=r[v]}x+=r[v].dist(r[v+1]),v++;const T=[];let A=0;for(;x<a/2;){const I=r[v],P=r[v+1];if(!P)return!1;let L=r[v-1].angleTo(I)-I.angleTo(P);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:x,angleDelta:L}),A+=L;x-T[0].distance>l;)A-=T.shift().angleDelta;if(A>f)return!1;v++,x+=I.dist(P)}return!0}function Ny(r){let t=0;for(let a=0;a<r.length-1;a++)t+=r[a].dist(r[a+1]);return t}function jy(r,t,a){return r?.6*t*a:0}function Vy(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function b2(r,t,a,l,f,y){const v=jy(a,f,y),x=Vy(a,l)*y;let T=0;const A=Ny(r)/2;for(let I=0;I<r.length-1;I++){const P=r[I],L=r[I+1],j=P.dist(L);if(T+j>A){const $=(A-T)/j,U=fr.number(P.x,L.x,$),J=fr.number(P.y,L.y,$),re=new Hs(U,J,L.angleTo(P),I);return re._round(),!v||Fy(r,re,x,v,t)?re:void 0}T+=j}}function x2(r,t,a,l,f,y,v,x,T){const A=jy(l,y,v),I=Vy(l,f),P=I*v,L=r[0].x===0||r[0].x===T||r[0].y===0||r[0].y===T;return t-P<t/4&&(t=P+t/4),$y(r,L?t/2*x%t:(I/2+2*y)*v*x%t,t,A,a,P,L,!1,T)}function $y(r,t,a,l,f,y,v,x,T){const A=y/2,I=Ny(r);let P=0,L=t-a,j=[];for(let $=0;$<r.length-1;$++){const U=r[$],J=r[$+1],re=U.dist(J),xe=J.angleTo(U);for(;L+a<P+re;){L+=a;const ue=(L-P)/re,ye=fr.number(U.x,J.x,ue),Ce=fr.number(U.y,J.y,ue);if(ye>=0&&ye<T&&Ce>=0&&Ce<T&&L-A>=0&&L+A<=I){const We=new Hs(ye,Ce,xe,$);We._round(),l&&!Fy(r,We,y,l,f)||j.push(We)}}P+=re}return x||j.length||v||(j=$y(r,P/2,a,l,f,y,v,!0,T)),j}ht("Anchor",Hs);const Ql=zr;function Uy(r,t,a,l){const f=[],y=r.image,v=y.pixelRatio,x=y.paddedRect.w-2*Ql,T=y.paddedRect.h-2*Ql;let A={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const I=y.stretchX||[[0,x]],P=y.stretchY||[[0,T]],L=(Oe,At)=>Oe+At[1]-At[0],j=I.reduce(L,0),$=P.reduce(L,0),U=x-j,J=T-$;let re=0,xe=j,ue=0,ye=$,Ce=0,We=U,ct=0,zt=J;if(y.content&&l){const Oe=y.content,At=Oe[2]-Oe[0],bt=Oe[3]-Oe[1];(y.textFitWidth||y.textFitHeight)&&(A=gy(r)),re=Ad(I,0,Oe[0]),ue=Ad(P,0,Oe[1]),xe=Ad(I,Oe[0],Oe[2]),ye=Ad(P,Oe[1],Oe[3]),Ce=Oe[0]-re,ct=Oe[1]-ue,We=At-xe,zt=bt-ye}const st=A.x1,nt=A.y1,wt=A.x2-st,yt=A.y2-nt,ft=(Oe,At,bt,Ft)=>{const Wi=Md(Oe.stretch-re,xe,wt,st),ji=Id(Oe.fixed-Ce,We,Oe.stretch,j),Pn=Md(At.stretch-ue,ye,yt,nt),ha=Id(At.fixed-ct,zt,At.stretch,$),Zn=Md(bt.stretch-re,xe,wt,st),zn=Id(bt.fixed-Ce,We,bt.stretch,j),vr=Md(Ft.stretch-ue,ye,yt,nt),br=Id(Ft.fixed-ct,zt,Ft.stretch,$),xr=new R(Wi,Pn),mn=new R(Zn,Pn),Dn=new R(Zn,vr),sr=new R(Wi,vr),Xn=new R(ji/v,ha/v),wr=new R(zn/v,br/v),Yn=t*Math.PI/180;if(Yn){const _i=Math.sin(Yn),Gi=Math.cos(Yn),Ki=[Gi,-_i,_i,Gi];xr._matMult(Ki),mn._matMult(Ki),sr._matMult(Ki),Dn._matMult(Ki)}const ta=Oe.stretch+Oe.fixed,Dr=At.stretch+At.fixed;return{tl:xr,tr:mn,bl:sr,br:Dn,tex:{x:y.paddedRect.x+Ql+ta,y:y.paddedRect.y+Ql+Dr,w:bt.stretch+bt.fixed-ta,h:Ft.stretch+Ft.fixed-Dr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Xn,pixelOffsetBR:wr,minFontScaleX:We/v/wt,minFontScaleY:zt/v/yt,isSDF:a}};if(l&&(y.stretchX||y.stretchY)){const Oe=Wy(I,U,j),At=Wy(P,J,$);for(let bt=0;bt<Oe.length-1;bt++){const Ft=Oe[bt],Wi=Oe[bt+1];for(let ji=0;ji<At.length-1;ji++)f.push(ft(Ft,At[ji],Wi,At[ji+1]))}}else f.push(ft({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:T+1}));return f}function Ad(r,t,a){let l=0;for(const f of r)l+=Math.max(t,Math.min(a,f[1]))-Math.max(t,Math.min(a,f[0]));return l}function Wy(r,t,a){const l=[{fixed:-Ql,stretch:0}];for(const[f,y]of r){const v=l[l.length-1];l.push({fixed:f-v.stretch,stretch:v.stretch}),l.push({fixed:f-v.stretch,stretch:v.stretch+(y-f)})}return l.push({fixed:t+Ql,stretch:a}),l}function Md(r,t,a,l){return r/t*a+l}function Id(r,t,a,l){return r-t*a/l}class Ed{constructor(t,a,l,f,y,v,x,T,A,I){var P;if(this.boxStartIndex=t.length,A){let L=v.top,j=v.bottom;const $=v.collisionPadding;$&&(L-=$[1],j+=$[3]);let U=j-L;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{const L=!((P=v.image)===null||P===void 0)&&P.content&&(v.image.textFitWidth||v.image.textFitHeight)?gy(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};L.y1=L.y1*x-T[0],L.y2=L.y2*x+T[2],L.x1=L.x1*x-T[3],L.x2=L.x2*x+T[1];const j=v.collisionPadding;if(j&&(L.x1-=j[0]*x,L.y1-=j[1]*x,L.x2+=j[2]*x,L.y2+=j[3]*x),I){const $=new R(L.x1,L.y1),U=new R(L.x2,L.y1),J=new R(L.x1,L.y2),re=new R(L.x2,L.y2),xe=I*Math.PI/180;$._rotate(xe),U._rotate(xe),J._rotate(xe),re._rotate(xe),L.x1=Math.min($.x,U.x,J.x,re.x),L.x2=Math.max($.x,U.x,J.x,re.x),L.y1=Math.min($.y,U.y,J.y,re.y),L.y2=Math.max($.y,U.y,J.y,re.y)}t.emplaceBack(a.x,a.y,L.x1,L.y1,L.x2,L.y2,l,f,y)}this.boxEndIndex=t.length}}class w2{constructor(t=[],a=(l,f)=>l<f?-1:l>f?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:l}=this,f=a[t];for(;t>0;){const y=t-1>>1,v=a[y];if(l(f,v)>=0)break;a[t]=v,t=y}a[t]=f}_down(t){const{data:a,compare:l}=this,f=this.length>>1,y=a[t];for(;t<f;){let v=1+(t<<1);const x=v+1;if(x<this.length&&l(a[x],a[v])<0&&(v=x),l(a[v],y)>=0)break;a[t]=a[v],t=v}a[t]=y}}function T2(r,t=1,a=!1){let l=1/0,f=1/0,y=-1/0,v=-1/0;const x=r[0];for(let j=0;j<x.length;j++){const $=x[j];(!j||$.x<l)&&(l=$.x),(!j||$.y<f)&&(f=$.y),(!j||$.x>y)&&(y=$.x),(!j||$.y>v)&&(v=$.y)}const T=Math.min(y-l,v-f);let A=T/2;const I=new w2([],S2);if(T===0)return new R(l,f);for(let j=l;j<y;j+=T)for(let $=f;$<v;$+=T)I.push(new ec(j+A,$+A,A,r));let P=function(j){let $=0,U=0,J=0;const re=j[0];for(let xe=0,ue=re.length,ye=ue-1;xe<ue;ye=xe++){const Ce=re[xe],We=re[ye],ct=Ce.x*We.y-We.x*Ce.y;U+=(Ce.x+We.x)*ct,J+=(Ce.y+We.y)*ct,$+=3*ct}return new ec(U/$,J/$,0,j)}(r),L=I.length;for(;I.length;){const j=I.pop();(j.d>P.d||!P.d)&&(P=j,a&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,L)),j.max-P.d<=t||(A=j.h/2,I.push(new ec(j.p.x-A,j.p.y-A,A,r)),I.push(new ec(j.p.x+A,j.p.y-A,A,r)),I.push(new ec(j.p.x-A,j.p.y+A,A,r)),I.push(new ec(j.p.x+A,j.p.y+A,A,r)),L+=4)}return a&&(console.log(`num probes: ${L}`),console.log(`best distance: ${P.d}`)),P.p}function S2(r,t){return t.max-r.max}function ec(r,t,a,l){this.p=new R(r,t),this.h=a,this.d=function(f,y){let v=!1,x=1/0;for(let T=0;T<y.length;T++){const A=y[T];for(let I=0,P=A.length,L=P-1;I<P;L=I++){const j=A[I],$=A[L];j.y>f.y!=$.y>f.y&&f.x<($.x-j.x)*(f.y-j.y)/($.y-j.y)+j.x&&(v=!v),x=Math.min(x,M0(f,j,$))}}return(v?1:-1)*Math.sqrt(x)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var Gn;_.aq=void 0,(Gn=_.aq||(_.aq={}))[Gn.center=1]="center",Gn[Gn.left=2]="left",Gn[Gn.right=3]="right",Gn[Gn.top=4]="top",Gn[Gn.bottom=5]="bottom",Gn[Gn["top-left"]=6]="top-left",Gn[Gn["top-right"]=7]="top-right",Gn[Gn["bottom-left"]=8]="bottom-left",Gn[Gn["bottom-right"]=9]="bottom-right";const qs=7,Zp=Number.POSITIVE_INFINITY;function Hy(r,t){return t[1]!==Zp?function(a,l,f){let y=0,v=0;switch(l=Math.abs(l),f=Math.abs(f),a){case"top-right":case"top-left":case"top":v=f-qs;break;case"bottom-right":case"bottom-left":case"bottom":v=-f+qs}switch(a){case"top-right":case"bottom-right":case"right":y=-l;break;case"top-left":case"bottom-left":case"left":y=l}return[y,v]}(r,t[0],t[1]):function(a,l){let f=0,y=0;l<0&&(l=0);const v=l/Math.SQRT2;switch(a){case"top-right":case"top-left":y=v-qs;break;case"bottom-right":case"bottom-left":y=-v+qs;break;case"bottom":y=-l+qs;break;case"top":y=l-qs}switch(a){case"top-right":case"bottom-right":f=-v;break;case"top-left":case"bottom-left":f=v;break;case"left":f=l;break;case"right":f=-l}return[f,y]}(r,t[0])}function qy(r,t,a){var l;const f=r.layout,y=(l=f.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},a);if(y){const x=y.values,T=[];for(let A=0;A<x.length;A+=2){const I=T[A]=x[A],P=x[A+1].map(L=>L*Mn);I.startsWith("top")?P[1]-=qs:I.startsWith("bottom")&&(P[1]+=qs),T[A+1]=P}return new Fr(T)}const v=f.get("text-variable-anchor");if(v){let x;x=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(t,{},a)*Mn,Zp]:f.get("text-offset").evaluate(t,{},a).map(A=>A*Mn);const T=[];for(const A of v)T.push(A,Hy(A,x));return new Fr(T)}return null}function Xp(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function k2(r,t,a,l,f,y,v,x,T,A,I){let P=y.textMaxSize.evaluate(t,{});P===void 0&&(P=v);const L=r.layers[0].layout,j=L.get("icon-offset").evaluate(t,{},I),$=Zy(a.horizontal),U=v/24,J=r.tilePixelRatio*U,re=r.tilePixelRatio*P/24,xe=r.tilePixelRatio*x,ue=r.tilePixelRatio*L.get("symbol-spacing"),ye=L.get("text-padding")*r.tilePixelRatio,Ce=function(Oe,At,bt,Ft=1){const Wi=Oe.get("icon-padding").evaluate(At,{},bt),ji=Wi&&Wi.values;return[ji[0]*Ft,ji[1]*Ft,ji[2]*Ft,ji[3]*Ft]}(L,t,I,r.tilePixelRatio),We=L.get("text-max-angle")/180*Math.PI,ct=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",zt=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",st=L.get("symbol-placement"),nt=ue/2,wt=L.get("icon-text-fit");let yt;l&&wt!=="none"&&(r.allowVerticalPlacement&&a.vertical&&(yt=yy(l,a.vertical,wt,L.get("icon-text-fit-padding"),j,U)),$&&(l=yy(l,$,wt,L.get("icon-text-fit-padding"),j,U)));const ft=(Oe,At)=>{At.x<0||At.x>=Tn||At.y<0||At.y>=Tn||function(bt,Ft,Wi,ji,Pn,ha,Zn,zn,vr,br,xr,mn,Dn,sr,Xn,wr,Yn,ta,Dr,_i,Gi,Ki,jr,an,tc){const Ba=bt.addToLineVertexArray(Ft,Wi);let Oa,da,ia,jn,cs=0,Bu=0,Jy=0,Qy=0,nm=-1,rm=-1;const us={};let e_=Ul("");if(bt.allowVerticalPlacement&&ji.vertical){const or=zn.layout.get("text-rotate").evaluate(Gi,{},an)+90;ia=new Ed(vr,Ft,br,xr,mn,ji.vertical,Dn,sr,Xn,or),Zn&&(jn=new Ed(vr,Ft,br,xr,mn,Zn,Yn,ta,Xn,or))}if(Pn){const or=zn.layout.get("icon-rotate").evaluate(Gi,{}),na=zn.layout.get("icon-text-fit")!=="none",Go=Uy(Pn,or,jr,na),xa=Zn?Uy(Zn,or,jr,na):void 0;da=new Ed(vr,Ft,br,xr,mn,Pn,Yn,ta,!1,or),cs=4*Go.length;const Zo=bt.iconSizeData;let Fa=null;Zo.kind==="source"?(Fa=[Ra*zn.layout.get("icon-size").evaluate(Gi,{})],Fa[0]>Us&&fe(`${bt.layerIds[0]}: Value for "icon-size" is >= ${Pu}. Reduce your "icon-size".`)):Zo.kind==="composite"&&(Fa=[Ra*Ki.compositeIconSizes[0].evaluate(Gi,{},an),Ra*Ki.compositeIconSizes[1].evaluate(Gi,{},an)],(Fa[0]>Us||Fa[1]>Us)&&fe(`${bt.layerIds[0]}: Value for "icon-size" is >= ${Pu}. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,Go,Fa,_i,Dr,Gi,_.ah.none,Ft,Ba.lineStartIndex,Ba.lineLength,-1,an),nm=bt.icon.placedSymbolArray.length-1,xa&&(Bu=4*xa.length,bt.addSymbols(bt.icon,xa,Fa,_i,Dr,Gi,_.ah.vertical,Ft,Ba.lineStartIndex,Ba.lineLength,-1,an),rm=bt.icon.placedSymbolArray.length-1)}const t_=Object.keys(ji.horizontal);for(const or of t_){const na=ji.horizontal[or];if(!Oa){e_=Ul(na.text);const xa=zn.layout.get("text-rotate").evaluate(Gi,{},an);Oa=new Ed(vr,Ft,br,xr,mn,na,Dn,sr,Xn,xa)}const Go=na.positionedLines.length===1;if(Jy+=Gy(bt,Ft,na,ha,zn,Xn,Gi,wr,Ba,ji.vertical?_.ah.horizontal:_.ah.horizontalOnly,Go?t_:[or],us,nm,Ki,an),Go)break}ji.vertical&&(Qy+=Gy(bt,Ft,ji.vertical,ha,zn,Xn,Gi,wr,Ba,_.ah.vertical,["vertical"],us,rm,Ki,an));const I2=Oa?Oa.boxStartIndex:bt.collisionBoxArray.length,E2=Oa?Oa.boxEndIndex:bt.collisionBoxArray.length,C2=ia?ia.boxStartIndex:bt.collisionBoxArray.length,P2=ia?ia.boxEndIndex:bt.collisionBoxArray.length,z2=da?da.boxStartIndex:bt.collisionBoxArray.length,D2=da?da.boxEndIndex:bt.collisionBoxArray.length,L2=jn?jn.boxStartIndex:bt.collisionBoxArray.length,R2=jn?jn.boxEndIndex:bt.collisionBoxArray.length;let ba=-1;const Pd=(or,na)=>or&&or.circleDiameter?Math.max(or.circleDiameter,na):na;ba=Pd(Oa,ba),ba=Pd(ia,ba),ba=Pd(da,ba),ba=Pd(jn,ba);const i_=ba>-1?1:0;i_&&(ba*=tc/Mn),bt.glyphOffsetArray.length>=Jl.MAX_GLYPHS&&fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Gi.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,Gi.sortKey);const B2=qy(zn,Gi,an),[O2,F2]=function(or,na){const Go=or.length,xa=na==null?void 0:na.values;if((xa==null?void 0:xa.length)>0)for(let Zo=0;Zo<xa.length;Zo+=2){const Fa=xa[Zo+1];or.emplaceBack(_.aq[xa[Zo]],Fa[0],Fa[1])}return[Go,or.length]}(bt.textAnchorOffsets,B2);bt.symbolInstances.emplaceBack(Ft.x,Ft.y,us.right>=0?us.right:-1,us.center>=0?us.center:-1,us.left>=0?us.left:-1,us.vertical||-1,nm,rm,e_,I2,E2,C2,P2,z2,D2,L2,R2,br,Jy,Qy,cs,Bu,i_,0,Dn,ba,O2,F2)}(r,At,Oe,a,l,f,yt,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,J,[ye,ye,ye,ye],ct,T,xe,Ce,zt,j,t,y,A,I,v)};if(st==="line")for(const Oe of Oy(t.geometry,0,0,Tn,Tn)){const At=x2(Oe,ue,We,a.vertical||$,l,24,re,r.overscaling,Tn);for(const bt of At)$&&A2(r,$.text,nt,bt)||ft(Oe,bt)}else if(st==="line-center"){for(const Oe of t.geometry)if(Oe.length>1){const At=b2(Oe,We,a.vertical||$,l,24,re);At&&ft(Oe,At)}}else if(t.type==="Polygon")for(const Oe of xl(t.geometry,0)){const At=T2(Oe,16);ft(Oe[0],new Hs(At.x,At.y,0))}else if(t.type==="LineString")for(const Oe of t.geometry)ft(Oe,new Hs(Oe[0].x,Oe[0].y,0));else if(t.type==="Point")for(const Oe of t.geometry)for(const At of Oe)ft([At],new Hs(At.x,At.y,0))}function Gy(r,t,a,l,f,y,v,x,T,A,I,P,L,j,$){const U=function(xe,ue,ye,Ce,We,ct,zt,st){const nt=Ce.layout.get("text-rotate").evaluate(ct,{})*Math.PI/180,wt=[];for(const yt of ue.positionedLines)for(const ft of yt.positionedGlyphs){if(!ft.rect)continue;const Oe=ft.rect||{};let At=cy+1,bt=!0,Ft=1,Wi=0;const ji=(We||st)&&ft.vertical,Pn=ft.metrics.advance*ft.scale/2;if(st&&ue.verticalizable&&(Wi=yt.lineOffset/2-(ft.imageName?-(Mn-ft.metrics.width*ft.scale)/2:(ft.scale-1)*Mn)),ft.imageName){const _i=zt[ft.imageName];bt=_i.sdf,Ft=_i.pixelRatio,At=zr/Ft}const ha=We?[ft.x+Pn,ft.y]:[0,0];let Zn=We?[0,0]:[ft.x+Pn+ye[0],ft.y+ye[1]-Wi],zn=[0,0];ji&&(zn=Zn,Zn=[0,0]);const vr=ft.metrics.isDoubleResolution?2:1,br=(ft.metrics.left-At)*ft.scale-Pn+Zn[0],xr=(-ft.metrics.top-At)*ft.scale+Zn[1],mn=br+Oe.w/vr*ft.scale/Ft,Dn=xr+Oe.h/vr*ft.scale/Ft,sr=new R(br,xr),Xn=new R(mn,xr),wr=new R(br,Dn),Yn=new R(mn,Dn);if(ji){const _i=new R(-Pn,Pn-Eu),Gi=-Math.PI/2,Ki=Mn/2-Pn,jr=new R(5-Eu-Ki,-(ft.imageName?Ki:0)),an=new R(...zn);sr._rotateAround(Gi,_i)._add(jr)._add(an),Xn._rotateAround(Gi,_i)._add(jr)._add(an),wr._rotateAround(Gi,_i)._add(jr)._add(an),Yn._rotateAround(Gi,_i)._add(jr)._add(an)}if(nt){const _i=Math.sin(nt),Gi=Math.cos(nt),Ki=[Gi,-_i,_i,Gi];sr._matMult(Ki),Xn._matMult(Ki),wr._matMult(Ki),Yn._matMult(Ki)}const ta=new R(0,0),Dr=new R(0,0);wt.push({tl:sr,tr:Xn,bl:wr,br:Yn,tex:Oe,writingMode:ue.writingMode,glyphOffset:ha,sectionIndex:ft.sectionIndex,isSDF:bt,pixelOffsetTL:ta,pixelOffsetBR:Dr,minFontScaleX:0,minFontScaleY:0})}return wt}(0,a,x,f,y,v,l,r.allowVerticalPlacement),J=r.textSizeData;let re=null;J.kind==="source"?(re=[Ra*f.layout.get("text-size").evaluate(v,{})],re[0]>Us&&fe(`${r.layerIds[0]}: Value for "text-size" is >= ${Pu}. Reduce your "text-size".`)):J.kind==="composite"&&(re=[Ra*j.compositeTextSizes[0].evaluate(v,{},$),Ra*j.compositeTextSizes[1].evaluate(v,{},$)],(re[0]>Us||re[1]>Us)&&fe(`${r.layerIds[0]}: Value for "text-size" is >= ${Pu}. Reduce your "text-size".`)),r.addSymbols(r.text,U,re,x,y,v,A,t,T.lineStartIndex,T.lineLength,L,$);for(const xe of I)P[xe]=r.text.placedSymbolArray.length-1;return 4*U.length}function Zy(r){for(const t in r)return r[t];return null}function A2(r,t,a,l){const f=r.compareText;if(t in f){const y=f[t];for(let v=y.length-1;v>=0;v--)if(l.dist(y[v])<a)return!0}else f[t]=[];return f[t].push(l),!1}const Xy=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Yp{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,l]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=l>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=Xy[15&l];if(!y)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(t,2,1),[x]=new Uint32Array(t,4,1);return new Yp(x,v,y,t)}constructor(t,a=64,l=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const y=Xy.indexOf(this.ArrayType),v=2*t*this.ArrayType.BYTES_PER_ELEMENT,x=t*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-x%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${l}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+T,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+v+x+T),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+T,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=a,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Kp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,l,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:v,nodeSize:x}=this,T=[0,y.length-1,0],A=[];for(;T.length;){const I=T.pop()||0,P=T.pop()||0,L=T.pop()||0;if(P-L<=x){for(let J=L;J<=P;J++){const re=v[2*J],xe=v[2*J+1];re>=t&&re<=l&&xe>=a&&xe<=f&&A.push(y[J])}continue}const j=L+P>>1,$=v[2*j],U=v[2*j+1];$>=t&&$<=l&&U>=a&&U<=f&&A.push(y[j]),(I===0?t<=$:a<=U)&&(T.push(L),T.push(j-1),T.push(1-I)),(I===0?l>=$:f>=U)&&(T.push(j+1),T.push(P),T.push(1-I))}return A}within(t,a,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:v}=this,x=[0,f.length-1,0],T=[],A=l*l;for(;x.length;){const I=x.pop()||0,P=x.pop()||0,L=x.pop()||0;if(P-L<=v){for(let J=L;J<=P;J++)Ky(y[2*J],y[2*J+1],t,a)<=A&&T.push(f[J]);continue}const j=L+P>>1,$=y[2*j],U=y[2*j+1];Ky($,U,t,a)<=A&&T.push(f[j]),(I===0?t-l<=$:a-l<=U)&&(x.push(L),x.push(j-1),x.push(1-I)),(I===0?t+l>=$:a+l>=U)&&(x.push(j+1),x.push(P),x.push(1-I))}return T}}function Kp(r,t,a,l,f,y){if(f-l<=a)return;const v=l+f>>1;Yy(r,t,v,l,f,y),Kp(r,t,a,l,v-1,1-y),Kp(r,t,a,v+1,f,1-y)}function Yy(r,t,a,l,f,y){for(;f>l;){if(f-l>600){const A=f-l+1,I=a-l+1,P=Math.log(A),L=.5*Math.exp(2*P/3),j=.5*Math.sqrt(P*L*(A-L)/A)*(I-A/2<0?-1:1);Yy(r,t,a,Math.max(l,Math.floor(a-I*L/A+j)),Math.min(f,Math.floor(a+(A-I)*L/A+j)),y)}const v=t[2*a+y];let x=l,T=f;for(Lu(r,t,l,a),t[2*f+y]>v&&Lu(r,t,l,f);x<T;){for(Lu(r,t,x,T),x++,T--;t[2*x+y]<v;)x++;for(;t[2*T+y]>v;)T--}t[2*l+y]===v?Lu(r,t,l,T):(T++,Lu(r,t,T,f)),T<=a&&(l=T+1),a<=T&&(f=T-1)}}function Lu(r,t,a,l){Jp(r,a,l),Jp(t,2*a,2*l),Jp(t,2*a+1,2*l+1)}function Jp(r,t,a){const l=r[t];r[t]=r[a],r[a]=l}function Ky(r,t,a,l){const f=r-a,y=t-l;return f*f+y*y}var Qp;_.bg=void 0,(Qp=_.bg||(_.bg={})).create="create",Qp.load="load",Qp.fullLoad="fullLoad";let Cd=null,Ru=[];const em=1e3/60,tm="loadTime",im="fullLoadTime",M2={mark(r){performance.mark(r)},frame(r){const t=r;Cd!=null&&Ru.push(t-Cd),Cd=t},clearMetrics(){Cd=null,Ru=[],performance.clearMeasures(tm),performance.clearMeasures(im);for(const r in _.bg)performance.clearMarks(_.bg[r])},getPerformanceMetrics(){performance.measure(tm,_.bg.create,_.bg.load),performance.measure(im,_.bg.create,_.bg.fullLoad);const r=performance.getEntriesByName(tm)[0].duration,t=performance.getEntriesByName(im)[0].duration,a=Ru.length,l=1/(Ru.reduce((y,v)=>y+v,0)/a/1e3),f=Ru.filter(y=>y>em).reduce((y,v)=>y+(v-em)/em,0);return{loadTime:r,fullLoadTime:t,fps:l,percentDroppedFrames:f/(a+f)*100,totalFrames:a}}};_.$=class extends E{},_.A=ql,_.B=cp,_.C=function(r){if($e==null){const t=r.navigator?r.navigator.userAgent:null;$e=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return $e},_.D=St,_.E=xi,_.F=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new _2(()=>this.process()),this.subscription=function(a,l,f,y){return a.addEventListener(l,f,!1),{unsubscribe:()=>{a.removeEventListener(l,f,!1)}}}(this.target,"message",a=>this.receive(a)),this.globalScope=Ee(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((a,l)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[f]={resolve:a,reject:l},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[f];const x={id:f,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(x)},{once:!0});const y=[],v=Object.assign(Object.assign({},r),{id:f,sourceMapId:this.mapId,origin:location.origin,data:Oo(r.data,y)});this.target.postMessage(v,{transfer:y})})}receive(r){const t=r.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const l=this.abortControllers[a];return delete this.abortControllers[a],void(l&&l.abort())}if(Ee(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const f=this.resolveRejects[r];return delete this.resolveRejects[r],f?void(t.error?f.reject(Os(t.error)):f.resolve(Os(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=Os(t.data),l=new AbortController;this.abortControllers[r]=l;try{const f=yield this.messageHandlers[t.type](t.sourceMapId,a,l);this.completeTask(r,null,f)}catch(f){this.completeTask(r,f)}})}completeTask(r,t,a){const l=[];delete this.abortControllers[r];const f={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Oo(t):null,data:Oo(a,l)};this.target.postMessage(f,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},_.G=jt,_.H=function(){var r=new ql(16);return ql!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},_.I=Op,_.J=function(r,t,a){var l,f,y,v,x,T,A,I,P,L,j,$,U=a[0],J=a[1],re=a[2];return t===r?(r[12]=t[0]*U+t[4]*J+t[8]*re+t[12],r[13]=t[1]*U+t[5]*J+t[9]*re+t[13],r[14]=t[2]*U+t[6]*J+t[10]*re+t[14],r[15]=t[3]*U+t[7]*J+t[11]*re+t[15]):(f=t[1],y=t[2],v=t[3],x=t[4],T=t[5],A=t[6],I=t[7],P=t[8],L=t[9],j=t[10],$=t[11],r[0]=l=t[0],r[1]=f,r[2]=y,r[3]=v,r[4]=x,r[5]=T,r[6]=A,r[7]=I,r[8]=P,r[9]=L,r[10]=j,r[11]=$,r[12]=l*U+x*J+P*re+t[12],r[13]=f*U+T*J+L*re+t[13],r[14]=y*U+A*J+j*re+t[14],r[15]=v*U+I*J+$*re+t[15]),r},_.K=function(r,t,a){var l=a[0],f=a[1],y=a[2];return r[0]=t[0]*l,r[1]=t[1]*l,r[2]=t[2]*l,r[3]=t[3]*l,r[4]=t[4]*f,r[5]=t[5]*f,r[6]=t[6]*f,r[7]=t[7]*f,r[8]=t[8]*y,r[9]=t[9]*y,r[10]=t[10]*y,r[11]=t[11]*y,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},_.L=P0,_.M=function(r,t){const a={};for(let l=0;l<t.length;l++){const f=t[l];f in r&&(a[f]=r[f])}return a},_.N=Ws,_.O=Ay,_.P=R,_.Q=My,_.R=Qr,_.S=ea,_.T=mu,_.U=q,_.V=te,_.W=Re,_.X=Tn,_.Y=m,_.Z=zu,_._=c,_.a=_t,_.a$=function(r,t){var a=r[0],l=r[1],f=r[2],y=r[3],v=r[4],x=r[5],T=r[6],A=r[7],I=r[8],P=r[9],L=r[10],j=r[11],$=r[12],U=r[13],J=r[14],re=r[15],xe=t[0],ue=t[1],ye=t[2],Ce=t[3],We=t[4],ct=t[5],zt=t[6],st=t[7],nt=t[8],wt=t[9],yt=t[10],ft=t[11],Oe=t[12],At=t[13],bt=t[14],Ft=t[15];return Math.abs(a-xe)<=_r*Math.max(1,Math.abs(a),Math.abs(xe))&&Math.abs(l-ue)<=_r*Math.max(1,Math.abs(l),Math.abs(ue))&&Math.abs(f-ye)<=_r*Math.max(1,Math.abs(f),Math.abs(ye))&&Math.abs(y-Ce)<=_r*Math.max(1,Math.abs(y),Math.abs(Ce))&&Math.abs(v-We)<=_r*Math.max(1,Math.abs(v),Math.abs(We))&&Math.abs(x-ct)<=_r*Math.max(1,Math.abs(x),Math.abs(ct))&&Math.abs(T-zt)<=_r*Math.max(1,Math.abs(T),Math.abs(zt))&&Math.abs(A-st)<=_r*Math.max(1,Math.abs(A),Math.abs(st))&&Math.abs(I-nt)<=_r*Math.max(1,Math.abs(I),Math.abs(nt))&&Math.abs(P-wt)<=_r*Math.max(1,Math.abs(P),Math.abs(wt))&&Math.abs(L-yt)<=_r*Math.max(1,Math.abs(L),Math.abs(yt))&&Math.abs(j-ft)<=_r*Math.max(1,Math.abs(j),Math.abs(ft))&&Math.abs($-Oe)<=_r*Math.max(1,Math.abs($),Math.abs(Oe))&&Math.abs(U-At)<=_r*Math.max(1,Math.abs(U),Math.abs(At))&&Math.abs(J-bt)<=_r*Math.max(1,Math.abs(J),Math.abs(bt))&&Math.abs(re-Ft)<=_r*Math.max(1,Math.abs(re),Math.abs(Ft))},_.a0=Fi,_.a1=Gp,_.a2=ze,_.a3=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(a=>{t.onloadstart=()=>{a(t)};for(const l of r){const f=window.document.createElement("source");bi(l)||(t.crossOrigin="Anonymous"),f.src=l,t.appendChild(f)}})},_.a4=function(){return Be++},_.a5=it,_.a6=Jl,_.a7=Rs,_.a8=Ho,_.a9=Dy,_.aA=function(r){if(r.type==="custom")return new y2(r);switch(r.type){case"background":return new p2(r);case"circle":return new tw(r);case"fill":return new _w(r);case"fill-extrusion":return new Dw(r);case"heatmap":return new nw(r);case"hillshade":return new aw(r);case"line":return new Vw(r);case"raster":return new g2(r);case"symbol":return new kd(r)}},_.aB=we,_.aC=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let a=[];try{if(!Kt(r.version,t.version))return[{command:"setStyle",args:[t]}];Kt(r.center,t.center)||a.push({command:"setCenter",args:[t.center]}),Kt(r.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),Kt(r.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),Kt(r.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),Kt(r.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),Kt(r.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),Kt(r.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),Kt(r.light,t.light)||a.push({command:"setLight",args:[t.light]}),Kt(r.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),Kt(r.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),Kt(r.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const l={},f=[];(function(v,x,T,A){let I;for(I in x=x||{},v=v||{})Object.prototype.hasOwnProperty.call(v,I)&&(Object.prototype.hasOwnProperty.call(x,I)||bn(I,T,A));for(I in x)Object.prototype.hasOwnProperty.call(x,I)&&(Object.prototype.hasOwnProperty.call(v,I)?Kt(v[I],x[I])||(v[I].type==="geojson"&&x[I].type==="geojson"&&Ia(v,x,I)?Ei(T,{command:"setGeoJSONSourceData",args:[I,x[I].data]}):Jn(I,x,T,A)):dr(I,x,T))})(r.sources,t.sources,f,l);const y=[];r.layers&&r.layers.forEach(v=>{"source"in v&&l[v.source]?a.push({command:"removeLayer",args:[v.id]}):y.push(v)}),a=a.concat(f),function(v,x,T){x=x||[];const A=(v=v||[]).map(xt),I=x.map(xt),P=v.reduce(Tt,{}),L=x.reduce(Tt,{}),j=A.slice(),$=Object.create(null);let U,J,re,xe,ue;for(let ye=0,Ce=0;ye<A.length;ye++)U=A[ye],Object.prototype.hasOwnProperty.call(L,U)?Ce++:(Ei(T,{command:"removeLayer",args:[U]}),j.splice(j.indexOf(U,Ce),1));for(let ye=0,Ce=0;ye<I.length;ye++)U=I[I.length-1-ye],j[j.length-1-ye]!==U&&(Object.prototype.hasOwnProperty.call(P,U)?(Ei(T,{command:"removeLayer",args:[U]}),j.splice(j.lastIndexOf(U,j.length-Ce),1)):Ce++,xe=j[j.length-ye],Ei(T,{command:"addLayer",args:[L[U],xe]}),j.splice(j.length-ye,0,U),$[U]=!0);for(let ye=0;ye<I.length;ye++)if(U=I[ye],J=P[U],re=L[U],!$[U]&&!Kt(J,re))if(Kt(J.source,re.source)&&Kt(J["source-layer"],re["source-layer"])&&Kt(J.type,re.type)){for(ue in Qn(J.layout,re.layout,T,U,null,"setLayoutProperty"),Qn(J.paint,re.paint,T,U,null,"setPaintProperty"),Kt(J.filter,re.filter)||Ei(T,{command:"setFilter",args:[U,re.filter]}),Kt(J.minzoom,re.minzoom)&&Kt(J.maxzoom,re.maxzoom)||Ei(T,{command:"setLayerZoomRange",args:[U,re.minzoom,re.maxzoom]}),J)Object.prototype.hasOwnProperty.call(J,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?Qn(J[ue],re[ue],T,U,ue.slice(6),"setPaintProperty"):Kt(J[ue],re[ue])||Ei(T,{command:"setLayerProperty",args:[U,ue,re[ue]]}));for(ue in re)Object.prototype.hasOwnProperty.call(re,ue)&&!Object.prototype.hasOwnProperty.call(J,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?Qn(J[ue],re[ue],T,U,ue.slice(6),"setPaintProperty"):Kt(J[ue],re[ue])||Ei(T,{command:"setLayerProperty",args:[U,ue,re[ue]]}))}else Ei(T,{command:"removeLayer",args:[U]}),xe=j[j.lastIndexOf(U)+1],Ei(T,{command:"addLayer",args:[re,xe]})}(y,t.layers,a)}catch(l){console.warn("Unable to compute style diff:",l),a=[{command:"setStyle",args:[t]}]}return a},_.aD=function(r){const t=[],a=r.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},_.aE=function r(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let l=0;l<t.length;l++)if(!r(t[l],a[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const l in t)if(!r(t[l],a[l]))return!1;return!0}return t===a},_.aF=Fe,_.aG=Le,_.aH=class extends _a{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},_.aI=dd,_.aJ=class extends _a{constructor(r,t){super(r,t),this.current=Gx}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},_.aK=b0,_.aL=x0,_.aM=Ri,_.aN=class extends _a{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},_.aO=class extends _a{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},_.aP=function(r,t,a,l,f,y,v){var x=1/(t-a),T=1/(l-f),A=1/(y-v);return r[0]=-2*x,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*T,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*A,r[11]=0,r[12]=(t+a)*x,r[13]=(f+l)*T,r[14]=(v+y)*A,r[15]=1,r},_.aQ=ew,_.aR=class extends K{},_.aS=Hw,_.aT=class extends ge{},_.aU=kp,_.aV=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},_.aW=B0,_.aX=ir,_.aY=Pr,_.aZ=class extends Je{},_.a_=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},_.aa=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,l,f,y)=>{const v=f||y;return t[l]=!v||v.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},_.ab=function(r,t){const a=[];for(const l in r)l in t||a.push(l);return a},_.ac=be,_.ad=function(r,t,a){var l=Math.sin(a),f=Math.cos(a),y=t[0],v=t[1],x=t[2],T=t[3],A=t[4],I=t[5],P=t[6],L=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=y*f+A*l,r[1]=v*f+I*l,r[2]=x*f+P*l,r[3]=T*f+L*l,r[4]=A*f-y*l,r[5]=I*f-v*l,r[6]=P*f-x*l,r[7]=L*f-T*l,r},_.ae=function(r){var t=new ql(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},_.af=gd,_.ag=function(r,t){let a=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:v}=r,x=f?be(pr.interpolationFactor(f,t,y,v),0,1):0;r.kind==="camera"?l=fr.number(r.minSize,r.maxSize,x):a=x}return{uSizeT:a,uSize:l}},_.ai=function(r,{uSize:t,uSizeT:a},{lowerSize:l,upperSize:f}){return r.kind==="source"?l/Ra:r.kind==="composite"?fr.number(l/Ra,f/Ra,a):t},_.aj=Vp,_.ak=function(r,t,a,l){const f=t.y-r.y,y=t.x-r.x,v=l.y-a.y,x=l.x-a.x,T=v*y-x*f;if(T===0)return null;const A=(x*(r.y-a.y)-v*(r.x-a.x))/T;return new R(r.x+A*y,r.y+A*f)},_.al=Oy,_.am=k0,_.an=wp,_.ao=function(r){let t=1/0,a=1/0,l=-1/0,f=-1/0;for(const y of r)t=Math.min(t,y.x),a=Math.min(a,y.y),l=Math.max(l,y.x),f=Math.max(f,y.y);return[t,a,l,f]},_.ap=Mn,_.ar=jp,_.as=function(r,t){var a=t[0],l=t[1],f=t[2],y=t[3],v=t[4],x=t[5],T=t[6],A=t[7],I=t[8],P=t[9],L=t[10],j=t[11],$=t[12],U=t[13],J=t[14],re=t[15],xe=a*x-l*v,ue=a*T-f*v,ye=a*A-y*v,Ce=l*T-f*x,We=l*A-y*x,ct=f*A-y*T,zt=I*U-P*$,st=I*J-L*$,nt=I*re-j*$,wt=P*J-L*U,yt=P*re-j*U,ft=L*re-j*J,Oe=xe*ft-ue*yt+ye*wt+Ce*nt-We*st+ct*zt;return Oe?(r[0]=(x*ft-T*yt+A*wt)*(Oe=1/Oe),r[1]=(f*yt-l*ft-y*wt)*Oe,r[2]=(U*ct-J*We+re*Ce)*Oe,r[3]=(L*We-P*ct-j*Ce)*Oe,r[4]=(T*nt-v*ft-A*st)*Oe,r[5]=(a*ft-f*nt+y*st)*Oe,r[6]=(J*ye-$*ct-re*ue)*Oe,r[7]=(I*ct-L*ye+j*ue)*Oe,r[8]=(v*yt-x*nt+A*zt)*Oe,r[9]=(l*nt-a*yt-y*zt)*Oe,r[10]=($*We-U*ye+re*xe)*Oe,r[11]=(P*ye-I*We-j*xe)*Oe,r[12]=(x*st-v*wt-T*zt)*Oe,r[13]=(a*wt-l*st+f*zt)*Oe,r[14]=(U*ue-$*Ce-J*xe)*Oe,r[15]=(I*Ce-P*ue+L*xe)*Oe,r):null},_.at=Xp,_.au=Np,_.av=Yp,_.aw=function(){const r={},t=ke.$version;for(const a in ke.$root){const l=ke.$root[a];if(l.required){let f=null;f=a==="version"?t:l.type==="array"?[]:{},f!=null&&(r[a]=f)}}return r},_.ax=hu,_.ay=fi,_.az=function(r){r=r.slice();const t=Object.create(null);for(let a=0;a<r.length;a++)t[r[a].id]=r[a];for(let a=0;a<r.length;a++)"ref"in r[a]&&(r[a]=Ii(r[a],t[r[a].ref]));return r},_.b=He,_.b0=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},_.b1=function(r,t,a){return r[0]=t[0]*a[0],r[1]=t[1]*a[1],r[2]=t[2]*a[2],r[3]=t[3]*a[3],r},_.b2=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},_.b3=Ae,_.b4=Cy,_.b5=Iy,_.b6=function(r,t,a,l,f){var y,v=1/Math.tan(t/2);return r[0]=v/a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,f!=null&&f!==1/0?(r[10]=(f+l)*(y=1/(l-f)),r[14]=2*f*l*y):(r[10]=-1,r[14]=-2*l),r},_.b7=function(r,t,a){var l=Math.sin(a),f=Math.cos(a),y=t[4],v=t[5],x=t[6],T=t[7],A=t[8],I=t[9],P=t[10],L=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=y*f+A*l,r[5]=v*f+I*l,r[6]=x*f+P*l,r[7]=T*f+L*l,r[8]=A*f-y*l,r[9]=I*f-v*l,r[10]=P*f-x*l,r[11]=L*f-T*l,r},_.b8=ne,_.b9=_e,_.bA=iy,_.bB=function(r){return r.message===Mt},_.bC=Il,_.bD=rs,_.ba=function(r){return r*Math.PI/180},_.bb=function(r,t){const{x:a,y:l}=zu.fromLngLat(t);return!(r<0||r>25||l<0||l>=1||a<0||a>=1)},_.bc=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},_.bd=class extends k{},_.be=Hp,_.bf=M2,_.bh=si,_.bi=function(r,t){_t.REGISTERED_PROTOCOLS[r]=t},_.bj=function(r){delete _t.REGISTERED_PROTOCOLS[r]},_.bk=function(r,t){const a={};for(let f=0;f<r.length;f++){const y=t&&t[r[f].id]||zo(r[f]);t&&(t[r[f].id]=y);let v=a[y];v||(v=a[y]=[]),v.push(r[f])}const l=[];for(const f in a)l.push(a[f]);return l},_.bl=ht,_.bm=zy,_.bn=Ly,_.bo=hy,_.bp=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Tn/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],a=t.layout,l=t._unevaluatedLayout._values,f={layoutIconSize:l["icon-size"].possiblyEvaluate(new Pi(r.bucket.zoom+1),r.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Pi(r.bucket.zoom+1),r.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Pi(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:A,maxZoom:I}=r.bucket.textSizeData;f.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Pi(A),r.canonical),l["text-size"].possiblyEvaluate(new Pi(I),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:A,maxZoom:I}=r.bucket.iconSizeData;f.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Pi(A),r.canonical),l["icon-size"].possiblyEvaluate(new Pi(I),r.canonical)]}const y=a.get("text-line-height")*Mn,v=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",x=a.get("text-keep-upright"),T=a.get("text-size");for(const A of r.bucket.features){const I=a.get("text-font").evaluate(A,{},r.canonical).join(","),P=T.evaluate(A,{},r.canonical),L=f.layoutTextSize.evaluate(A,{},r.canonical),j=f.layoutIconSize.evaluate(A,{},r.canonical),$={horizontal:{},vertical:void 0},U=A.text;let J,re=[0,0];if(U){const ye=U.toString(),Ce=a.get("text-letter-spacing").evaluate(A,{},r.canonical)*Mn,We=hp(ye)?Ce:0,ct=a.get("text-anchor").evaluate(A,{},r.canonical),zt=qy(t,A,r.canonical);if(!zt){const yt=a.get("text-radial-offset").evaluate(A,{},r.canonical);re=yt?Hy(ct,[yt*Mn,Zp]):a.get("text-offset").evaluate(A,{},r.canonical).map(ft=>ft*Mn)}let st=v?"center":a.get("text-justify").evaluate(A,{},r.canonical);const nt=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(A,{},r.canonical)*Mn:1/0,wt=()=>{r.bucket.allowVerticalPlacement&&du(ye)&&($.vertical=wd(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,nt,y,ct,"left",We,re,_.ah.vertical,!0,L,P))};if(!v&&zt){const yt=new Set;if(st==="auto")for(let Oe=0;Oe<zt.values.length;Oe+=2)yt.add(Xp(zt.values[Oe]));else yt.add(st);let ft=!1;for(const Oe of yt)if(!$.horizontal[Oe])if(ft)$.horizontal[Oe]=$.horizontal[0];else{const At=wd(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,nt,y,"center",Oe,We,re,_.ah.horizontal,!1,L,P);At&&($.horizontal[Oe]=At,ft=At.positionedLines.length===1)}wt()}else{st==="auto"&&(st=Xp(ct));const yt=wd(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,nt,y,ct,st,We,re,_.ah.horizontal,!1,L,P);yt&&($.horizontal[st]=yt),wt(),du(ye)&&v&&x&&($.vertical=wd(U,r.glyphMap,r.glyphPositions,r.imagePositions,I,nt,y,ct,st,We,re,_.ah.vertical,!1,L,P))}}let xe=!1;if(A.icon&&A.icon.name){const ye=r.imageMap[A.icon.name];ye&&(J=c2(r.imagePositions[A.icon.name],a.get("icon-offset").evaluate(A,{},r.canonical),a.get("icon-anchor").evaluate(A,{},r.canonical)),xe=!!ye.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=xe:r.bucket.sdfIcons!==xe&&fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ye.pixelRatio!==r.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const ue=Zy($.horizontal)||$.vertical;r.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||J)&&k2(r.bucket,A,$,J,r.imageMap,f,L,j,re,xe,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},_.bq=Dp,_.br=Cp,_.bs=zp,_.bt=Vs,_.bu=Rp,_.bv=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},_.bw=function(r,t,a,l,f){return c(this,void 0,void 0,function*(){if(te())try{return yield Re(r,t,a,l,f)}catch{}return function(y,v,x,T,A){const I=y.width,P=y.height;Xe&&Ue||(Xe=new OffscreenCanvas(I,P),Ue=Xe.getContext("2d",{willReadFrequently:!0})),Xe.width=I,Xe.height=P,Ue.drawImage(y,0,0,I,P);const L=Ue.getImageData(v,x,T,A);return Ue.clearRect(0,0,I,P),L.data}(r,t,a,l,f)})},_.bx=Py,_.by=M,_.bz=B,_.c=Rt,_.d=r=>c(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),_.e=de,_.f=r=>new Promise((t,a)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Ge})},l.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(r)],{type:"image/png"});l.src=r.byteLength?URL.createObjectURL(f):Ge}),_.g=Xt,_.h=(r,t)=>qt(de(r,{type:"json"}),t),_.i=Ee,_.j=hi,_.k=Qi,_.l=(r,t)=>qt(de(r,{type:"arrayBuffer"}),t),_.m=qt,_.n=function(r){return new Rp(r).readFields(i2,[])},_.o=wu,_.p=uy,_.q=gr,_.r=id,_.s=bi,_.t=uu,_.u=is,_.v=ke,_.w=fe,_.x=function([r,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(a),y:r*Math.sin(t)*Math.sin(a),z:r*Math.cos(a)}},_.y=fr,_.z=Pi}),p("worker",["./shared"],function(_){class c{constructor(F){this.keyCache={},F&&this.replace(F)}replace(F){this._layerConfigs={},this._layers={},this.update(F,[])}update(F,N){for(const Q of F){this._layerConfigs[Q.id]=Q;const he=this._layers[Q.id]=_.aA(Q);he._featureFilter=_.a7(he.filter),this.keyCache[Q.id]&&delete this.keyCache[Q.id]}for(const Q of N)delete this.keyCache[Q],delete this._layerConfigs[Q],delete this._layers[Q];this.familiesBySource={};const W=_.bk(Object.values(this._layerConfigs),this.keyCache);for(const Q of W){const he=Q.map(Ie=>this._layers[Ie.id]),me=he[0];if(me.visibility==="none")continue;const ve=me.source||"";let le=this.familiesBySource[ve];le||(le=this.familiesBySource[ve]={});const Pe=me.sourceLayer||"_geojsonTileLayer";let Ve=le[Pe];Ve||(Ve=le[Pe]=[]),Ve.push(he)}}}class M{constructor(F){const N={},W=[];for(const ve in F){const le=F[ve],Pe=N[ve]={};for(const Ve in le){const Ie=le[+Ve];if(!Ie||Ie.bitmap.width===0||Ie.bitmap.height===0)continue;const Ke={x:0,y:0,w:Ie.bitmap.width+2,h:Ie.bitmap.height+2};W.push(Ke),Pe[Ve]={rect:Ke,metrics:Ie.metrics}}}const{w:Q,h:he}=_.p(W),me=new _.o({width:Q||1,height:he||1});for(const ve in F){const le=F[ve];for(const Pe in le){const Ve=le[+Pe];if(!Ve||Ve.bitmap.width===0||Ve.bitmap.height===0)continue;const Ie=N[ve][Pe].rect;_.o.copy(Ve.bitmap,me,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},Ve.bitmap)}}this.image=me,this.positions=N}}_.bl("GlyphAtlas",M);class B{constructor(F){this.tileID=new _.S(F.tileID.overscaledZ,F.tileID.wrap,F.tileID.canonical.z,F.tileID.canonical.x,F.tileID.canonical.y),this.uid=F.uid,this.zoom=F.zoom,this.pixelRatio=F.pixelRatio,this.tileSize=F.tileSize,this.source=F.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=F.showCollisionBoxes,this.collectResourceTiming=!!F.collectResourceTiming,this.returnDependencies=!!F.returnDependencies,this.promoteId=F.promoteId,this.inFlightDependencies=[]}parse(F,N,W,Q){return _._(this,void 0,void 0,function*(){this.status="parsing",this.data=F,this.collisionBoxArray=new _.a5;const he=new _.bm(Object.keys(F.layers).sort()),me=new _.bn(this.tileID,this.promoteId);me.bucketLayerIDs=[];const ve={},le={featureIndex:me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},Pe=N.familiesBySource[this.source];for(const ti in Pe){const Li=F.layers[ti];if(!Li)continue;Li.version===1&&_.w(`Vector tile source "${this.source}" layer "${ti}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const en=he.encode(ti),Cn=[];for(let Nn=0;Nn<Li.length;Nn++){const er=Li.feature(Nn),Ss=me.getId(er,ti);Cn.push({feature:er,id:Ss,index:Nn,sourceLayerIndex:en})}for(const Nn of Pe[ti]){const er=Nn[0];er.source!==this.source&&_.w(`layer.source = ${er.source} does not equal this.source = ${this.source}`),er.minzoom&&this.zoom<Math.floor(er.minzoom)||er.maxzoom&&this.zoom>=er.maxzoom||er.visibility!=="none"&&(O(Nn,this.zoom,W),(ve[er.id]=er.createBucket({index:me.bucketLayerIDs.length,layers:Nn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:en,sourceID:this.source})).populate(Cn,le,this.tileID.canonical),me.bucketLayerIDs.push(Nn.map(Ss=>Ss.id)))}}const Ve=_.aF(le.glyphDependencies,ti=>Object.keys(ti).map(Number));this.inFlightDependencies.forEach(ti=>ti==null?void 0:ti.abort()),this.inFlightDependencies=[];let Ie=Promise.resolve({});if(Object.keys(Ve).length){const ti=new AbortController;this.inFlightDependencies.push(ti),Ie=Q.sendAsync({type:"GG",data:{stacks:Ve,source:this.source,tileID:this.tileID,type:"glyphs"}},ti)}const Ke=Object.keys(le.iconDependencies);let It=Promise.resolve({});if(Ke.length){const ti=new AbortController;this.inFlightDependencies.push(ti),It=Q.sendAsync({type:"GI",data:{icons:Ke,source:this.source,tileID:this.tileID,type:"icons"}},ti)}const Pt=Object.keys(le.patternDependencies);let mi=Promise.resolve({});if(Pt.length){const ti=new AbortController;this.inFlightDependencies.push(ti),mi=Q.sendAsync({type:"GI",data:{icons:Pt,source:this.source,tileID:this.tileID,type:"patterns"}},ti)}const[Gt,gi,oi]=yield Promise.all([Ie,It,mi]),xn=new M(Gt),nn=new _.bo(gi,oi);for(const ti in ve){const Li=ve[ti];Li instanceof _.a6?(O(Li.layers,this.zoom,W),_.bp({bucket:Li,glyphMap:Gt,glyphPositions:xn.positions,imageMap:gi,imagePositions:nn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Li.hasPattern&&(Li instanceof _.bq||Li instanceof _.br||Li instanceof _.bs)&&(O(Li.layers,this.zoom,W),Li.addFeatures(le,this.tileID.canonical,nn.patternPositions))}return this.status="done",{buckets:Object.values(ve).filter(ti=>!ti.isEmpty()),featureIndex:me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:xn.image,imageAtlas:nn,glyphMap:this.returnDependencies?Gt:null,iconMap:this.returnDependencies?gi:null,glyphPositions:this.returnDependencies?xn.positions:null}})}}function O(ie,F,N){const W=new _.z(F);for(const Q of ie)Q.recalculate(W,N)}class R{constructor(F,N,W){this.actor=F,this.layerIndex=N,this.availableImages=W,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(F,N){return _._(this,void 0,void 0,function*(){const W=yield _.l(F.request,N);try{return{vectorTile:new _.bt.VectorTile(new _.bu(W.data)),rawData:W.data,cacheControl:W.cacheControl,expires:W.expires}}catch(Q){const he=new Uint8Array(W.data);let me=`Unable to parse the tile at ${F.request.url}, `;throw me+=he[0]===31&&he[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Q.message}`,new Error(me)}})}loadTile(F){return _._(this,void 0,void 0,function*(){const N=F.uid,W=!!(F&&F.request&&F.request.collectResourceTiming)&&new _.bv(F.request),Q=new B(F);this.loading[N]=Q;const he=new AbortController;Q.abort=he;try{const me=yield this.loadVectorTile(F,he);if(delete this.loading[N],!me)return null;const ve=me.rawData,le={};me.expires&&(le.expires=me.expires),me.cacheControl&&(le.cacheControl=me.cacheControl);const Pe={};if(W){const Ie=W.finish();Ie&&(Pe.resourceTiming=JSON.parse(JSON.stringify(Ie)))}Q.vectorTile=me.vectorTile;const Ve=Q.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[N]=Q,this.fetching[N]={rawTileData:ve,cacheControl:le,resourceTiming:Pe};try{const Ie=yield Ve;return _.e({rawTileData:ve.slice(0)},Ie,le,Pe)}finally{delete this.fetching[N]}}catch(me){throw delete this.loading[N],Q.status="done",this.loaded[N]=Q,me}})}reloadTile(F){return _._(this,void 0,void 0,function*(){const N=F.uid;if(!this.loaded||!this.loaded[N])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const W=this.loaded[N];if(W.showCollisionBoxes=F.showCollisionBoxes,W.status==="parsing"){const Q=yield W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor);let he;if(this.fetching[N]){const{rawTileData:me,cacheControl:ve,resourceTiming:le}=this.fetching[N];delete this.fetching[N],he=_.e({rawTileData:me.slice(0)},Q,ve,le)}else he=Q;return he}if(W.status==="done"&&W.vectorTile)return W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(F){return _._(this,void 0,void 0,function*(){const N=this.loading,W=F.uid;N&&N[W]&&N[W].abort&&(N[W].abort.abort(),delete N[W])})}removeTile(F){return _._(this,void 0,void 0,function*(){this.loaded&&this.loaded[F.uid]&&delete this.loaded[F.uid]})}}class C{constructor(){this.loaded={}}loadTile(F){return _._(this,void 0,void 0,function*(){const{uid:N,encoding:W,rawImageData:Q,redFactor:he,greenFactor:me,blueFactor:ve,baseShift:le}=F,Pe=Q.width+2,Ve=Q.height+2,Ie=_.b(Q)?new _.R({width:Pe,height:Ve},yield _.bw(Q,-1,-1,Pe,Ve)):Q,Ke=new _.bx(N,Ie,W,he,me,ve,le);return this.loaded=this.loaded||{},this.loaded[N]=Ke,Ke})}removeTile(F){const N=this.loaded,W=F.uid;N&&N[W]&&delete N[W]}}function Y(ie,F){if(ie.length!==0){X(ie[0],F);for(var N=1;N<ie.length;N++)X(ie[N],!F)}}function X(ie,F){for(var N=0,W=0,Q=0,he=ie.length,me=he-1;Q<he;me=Q++){var ve=(ie[Q][0]-ie[me][0])*(ie[me][1]+ie[Q][1]),le=N+ve;W+=Math.abs(N)>=Math.abs(ve)?N-le+ve:ve-le+N,N=le}N+W>=0!=!!F&&ie.reverse()}var Z=_.by(function ie(F,N){var W,Q=F&&F.type;if(Q==="FeatureCollection")for(W=0;W<F.features.length;W++)ie(F.features[W],N);else if(Q==="GeometryCollection")for(W=0;W<F.geometries.length;W++)ie(F.geometries[W],N);else if(Q==="Feature")ie(F.geometry,N);else if(Q==="Polygon")Y(F.coordinates,N);else if(Q==="MultiPolygon")for(W=0;W<F.coordinates.length;W++)Y(F.coordinates[W],N);return F});const se=_.bt.VectorTileFeature.prototype.toGeoJSON;var q={exports:{}},te=_.bz,ne=_.bt.VectorTileFeature,_e=be;function be(ie,F){this.options=F||{},this.features=ie,this.length=ie.length}function Ae(ie,F){this.id=typeof ie.id=="number"?ie.id:void 0,this.type=ie.type,this.rawGeometry=ie.type===1?[ie.geometry]:ie.geometry,this.properties=ie.tags,this.extent=F||4096}be.prototype.feature=function(ie){return new Ae(this.features[ie],this.options.extent)},Ae.prototype.loadGeometry=function(){var ie=this.rawGeometry;this.geometry=[];for(var F=0;F<ie.length;F++){for(var N=ie[F],W=[],Q=0;Q<N.length;Q++)W.push(new te(N[Q][0],N[Q][1]));this.geometry.push(W)}return this.geometry},Ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ie=this.geometry,F=1/0,N=-1/0,W=1/0,Q=-1/0,he=0;he<ie.length;he++)for(var me=ie[he],ve=0;ve<me.length;ve++){var le=me[ve];F=Math.min(F,le.x),N=Math.max(N,le.x),W=Math.min(W,le.y),Q=Math.max(Q,le.y)}return[F,W,N,Q]},Ae.prototype.toGeoJSON=ne.prototype.toGeoJSON;var de=_.bA,Be=_e;function Fe(ie){var F=new de;return function(N,W){for(var Q in N.layers)W.writeMessage(3,Le,N.layers[Q])}(ie,F),F.finish()}function Le(ie,F){var N;F.writeVarintField(15,ie.version||1),F.writeStringField(1,ie.name||""),F.writeVarintField(5,ie.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(N=0;N<ie.length;N++)W.feature=ie.feature(N),F.writeMessage(2,we,W);var Q=W.keys;for(N=0;N<Q.length;N++)F.writeStringField(3,Q[N]);var he=W.values;for(N=0;N<he.length;N++)F.writeMessage(4,$e,he[N])}function we(ie,F){var N=ie.feature;N.id!==void 0&&F.writeVarintField(1,N.id),F.writeMessage(2,Te,ie),F.writeVarintField(3,N.type),F.writeMessage(4,Ee,N)}function Te(ie,F){var N=ie.feature,W=ie.keys,Q=ie.values,he=ie.keycache,me=ie.valuecache;for(var ve in N.properties){var le=N.properties[ve],Pe=he[ve];if(le!==null){Pe===void 0&&(W.push(ve),he[ve]=Pe=W.length-1),F.writeVarint(Pe);var Ve=typeof le;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(le=JSON.stringify(le));var Ie=Ve+":"+le,Ke=me[Ie];Ke===void 0&&(Q.push(le),me[Ie]=Ke=Q.length-1),F.writeVarint(Ke)}}}function fe(ie,F){return(F<<3)+(7&ie)}function Me(ie){return ie<<1^ie>>31}function Ee(ie,F){for(var N=ie.loadGeometry(),W=ie.type,Q=0,he=0,me=N.length,ve=0;ve<me;ve++){var le=N[ve],Pe=1;W===1&&(Pe=le.length),F.writeVarint(fe(1,Pe));for(var Ve=W===3?le.length-1:le.length,Ie=0;Ie<Ve;Ie++){Ie===1&&W!==1&&F.writeVarint(fe(2,Ve-1));var Ke=le[Ie].x-Q,It=le[Ie].y-he;F.writeVarint(Me(Ke)),F.writeVarint(Me(It)),Q+=Ke,he+=It}W===3&&F.writeVarint(fe(7,1))}}function $e(ie,F){var N=typeof ie;N==="string"?F.writeStringField(1,ie):N==="boolean"?F.writeBooleanField(7,ie):N==="number"&&(ie%1!=0?F.writeDoubleField(3,ie):ie<0?F.writeSVarintField(6,ie):F.writeVarintField(5,ie))}q.exports=Fe,q.exports.fromVectorTileJs=Fe,q.exports.fromGeojsonVt=function(ie,F){F=F||{};var N={};for(var W in ie)N[W]=new Be(ie[W].features,F),N[W].name=W,N[W].version=F.version,N[W].extent=F.extent;return Fe({layers:N})},q.exports.GeoJSONWrapper=Be;var He=_.by(q.exports);const Ge={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ie=>ie},Re=Math.fround||(Xe=new Float32Array(1),ie=>(Xe[0]=+ie,Xe[0]));var Xe;const Ue=3,Mt=5,Rt=6;class _t{constructor(F){this.options=Object.assign(Object.create(Ge),F),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(F){const{log:N,minZoom:W,maxZoom:Q}=this.options;N&&console.time("total time");const he=`prepare ${F.length} points`;N&&console.time(he),this.points=F;const me=[];for(let le=0;le<F.length;le++){const Pe=F[le];if(!Pe.geometry)continue;const[Ve,Ie]=Pe.geometry.coordinates,Ke=Re(si(Ve)),It=Re(fi(Ie));me.push(Ke,It,1/0,le,-1,1),this.options.reduce&&me.push(0)}let ve=this.trees[Q+1]=this._createTree(me);N&&console.timeEnd(he);for(let le=Q;le>=W;le--){const Pe=+Date.now();ve=this.trees[le]=this._createTree(this._cluster(ve,le)),N&&console.log("z%d: %d clusters in %dms",le,ve.numItems,+Date.now()-Pe)}return N&&console.timeEnd("total time"),this}getClusters(F,N){let W=((F[0]+180)%360+360)%360-180;const Q=Math.max(-90,Math.min(90,F[1]));let he=F[2]===180?180:((F[2]+180)%360+360)%360-180;const me=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)W=-180,he=180;else if(W>he){const Ie=this.getClusters([W,Q,180,me],N),Ke=this.getClusters([-180,Q,he,me],N);return Ie.concat(Ke)}const ve=this.trees[this._limitZoom(N)],le=ve.range(si(W),fi(me),si(he),fi(Q)),Pe=ve.data,Ve=[];for(const Ie of le){const Ke=this.stride*Ie;Ve.push(Pe[Ke+Mt]>1?Xt(Pe,Ke,this.clusterProps):this.points[Pe[Ke+Ue]])}return Ve}getChildren(F){const N=this._getOriginId(F),W=this._getOriginZoom(F),Q="No cluster with the specified id.",he=this.trees[W];if(!he)throw new Error(Q);const me=he.data;if(N*this.stride>=me.length)throw new Error(Q);const ve=this.options.radius/(this.options.extent*Math.pow(2,W-1)),le=he.within(me[N*this.stride],me[N*this.stride+1],ve),Pe=[];for(const Ve of le){const Ie=Ve*this.stride;me[Ie+4]===F&&Pe.push(me[Ie+Mt]>1?Xt(me,Ie,this.clusterProps):this.points[me[Ie+Ue]])}if(Pe.length===0)throw new Error(Q);return Pe}getLeaves(F,N,W){const Q=[];return this._appendLeaves(Q,F,N=N||10,W=W||0,0),Q}getTile(F,N,W){const Q=this.trees[this._limitZoom(F)],he=Math.pow(2,F),{extent:me,radius:ve}=this.options,le=ve/me,Pe=(W-le)/he,Ve=(W+1+le)/he,Ie={features:[]};return this._addTileFeatures(Q.range((N-le)/he,Pe,(N+1+le)/he,Ve),Q.data,N,W,he,Ie),N===0&&this._addTileFeatures(Q.range(1-le/he,Pe,1,Ve),Q.data,he,W,he,Ie),N===he-1&&this._addTileFeatures(Q.range(0,Pe,le/he,Ve),Q.data,-1,W,he,Ie),Ie.features.length?Ie:null}getClusterExpansionZoom(F){let N=this._getOriginZoom(F)-1;for(;N<=this.options.maxZoom;){const W=this.getChildren(F);if(N++,W.length!==1)break;F=W[0].properties.cluster_id}return N}_appendLeaves(F,N,W,Q,he){const me=this.getChildren(N);for(const ve of me){const le=ve.properties;if(le&&le.cluster?he+le.point_count<=Q?he+=le.point_count:he=this._appendLeaves(F,le.cluster_id,W,Q,he):he<Q?he++:F.push(ve),F.length===W)break}return he}_createTree(F){const N=new _.av(F.length/this.stride|0,this.options.nodeSize,Float32Array);for(let W=0;W<F.length;W+=this.stride)N.add(F[W],F[W+1]);return N.finish(),N.data=F,N}_addTileFeatures(F,N,W,Q,he,me){for(const ve of F){const le=ve*this.stride,Pe=N[le+Mt]>1;let Ve,Ie,Ke;if(Pe)Ve=jt(N,le,this.clusterProps),Ie=N[le],Ke=N[le+1];else{const mi=this.points[N[le+Ue]];Ve=mi.properties;const[Gt,gi]=mi.geometry.coordinates;Ie=si(Gt),Ke=fi(gi)}const It={type:1,geometry:[[Math.round(this.options.extent*(Ie*he-W)),Math.round(this.options.extent*(Ke*he-Q))]],tags:Ve};let Pt;Pt=Pe||this.options.generateId?N[le+Ue]:this.points[N[le+Ue]].id,Pt!==void 0&&(It.id=Pt),me.features.push(It)}}_limitZoom(F){return Math.max(this.options.minZoom,Math.min(Math.floor(+F),this.options.maxZoom+1))}_cluster(F,N){const{radius:W,extent:Q,reduce:he,minPoints:me}=this.options,ve=W/(Q*Math.pow(2,N)),le=F.data,Pe=[],Ve=this.stride;for(let Ie=0;Ie<le.length;Ie+=Ve){if(le[Ie+2]<=N)continue;le[Ie+2]=N;const Ke=le[Ie],It=le[Ie+1],Pt=F.within(le[Ie],le[Ie+1],ve),mi=le[Ie+Mt];let Gt=mi;for(const gi of Pt){const oi=gi*Ve;le[oi+2]>N&&(Gt+=le[oi+Mt])}if(Gt>mi&&Gt>=me){let gi,oi=Ke*mi,xn=It*mi,nn=-1;const ti=((Ie/Ve|0)<<5)+(N+1)+this.points.length;for(const Li of Pt){const en=Li*Ve;if(le[en+2]<=N)continue;le[en+2]=N;const Cn=le[en+Mt];oi+=le[en]*Cn,xn+=le[en+1]*Cn,le[en+4]=ti,he&&(gi||(gi=this._map(le,Ie,!0),nn=this.clusterProps.length,this.clusterProps.push(gi)),he(gi,this._map(le,en)))}le[Ie+4]=ti,Pe.push(oi/Gt,xn/Gt,1/0,ti,-1,Gt),he&&Pe.push(nn)}else{for(let gi=0;gi<Ve;gi++)Pe.push(le[Ie+gi]);if(Gt>1)for(const gi of Pt){const oi=gi*Ve;if(!(le[oi+2]<=N)){le[oi+2]=N;for(let xn=0;xn<Ve;xn++)Pe.push(le[oi+xn])}}}}return Pe}_getOriginId(F){return F-this.points.length>>5}_getOriginZoom(F){return(F-this.points.length)%32}_map(F,N,W){if(F[N+Mt]>1){const me=this.clusterProps[F[N+Rt]];return W?Object.assign({},me):me}const Q=this.points[F[N+Ue]].properties,he=this.options.map(Q);return W&&he===Q?Object.assign({},he):he}}function Xt(ie,F,N){return{type:"Feature",id:ie[F+Ue],properties:jt(ie,F,N),geometry:{type:"Point",coordinates:[(W=ie[F],360*(W-.5)),qt(ie[F+1])]}};var W}function jt(ie,F,N){const W=ie[F+Mt],Q=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W,he=ie[F+Rt],me=he===-1?{}:Object.assign({},N[he]);return Object.assign(me,{cluster:!0,cluster_id:ie[F+Ue],point_count:W,point_count_abbreviated:Q})}function si(ie){return ie/360+.5}function fi(ie){const F=Math.sin(ie*Math.PI/180),N=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return N<0?0:N>1?1:N}function qt(ie){const F=(180-360*ie)*Math.PI/180;return 360*Math.atan(Math.exp(F))/Math.PI-90}function bi(ie,F,N,W){let Q=W;const he=F+(N-F>>1);let me,ve=N-F;const le=ie[F],Pe=ie[F+1],Ve=ie[N],Ie=ie[N+1];for(let Ke=F+3;Ke<N;Ke+=3){const It=Yt(ie[Ke],ie[Ke+1],le,Pe,Ve,Ie);if(It>Q)me=Ke,Q=It;else if(It===Q){const Pt=Math.abs(Ke-he);Pt<ve&&(me=Ke,ve=Pt)}}Q>W&&(me-F>3&&bi(ie,F,me,W),ie[me+2]=Q,N-me>3&&bi(ie,me,N,W))}function Yt(ie,F,N,W,Q,he){let me=Q-N,ve=he-W;if(me!==0||ve!==0){const le=((ie-N)*me+(F-W)*ve)/(me*me+ve*ve);le>1?(N=Q,W=he):le>0&&(N+=me*le,W+=ve*le)}return me=ie-N,ve=F-W,me*me+ve*ve}function Bi(ie,F,N,W){const Q={id:ie??null,type:F,geometry:N,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(F==="Point"||F==="MultiPoint"||F==="LineString")Qi(Q,N);else if(F==="Polygon")Qi(Q,N[0]);else if(F==="MultiLineString")for(const he of N)Qi(Q,he);else if(F==="MultiPolygon")for(const he of N)Qi(Q,he[0]);return Q}function Qi(ie,F){for(let N=0;N<F.length;N+=3)ie.minX=Math.min(ie.minX,F[N]),ie.minY=Math.min(ie.minY,F[N+1]),ie.maxX=Math.max(ie.maxX,F[N]),ie.maxY=Math.max(ie.maxY,F[N+1])}function hi(ie,F,N,W){if(!F.geometry)return;const Q=F.geometry.coordinates;if(Q&&Q.length===0)return;const he=F.geometry.type,me=Math.pow(N.tolerance/((1<<N.maxZoom)*N.extent),2);let ve=[],le=F.id;if(N.promoteId?le=F.properties[N.promoteId]:N.generateId&&(le=W||0),he==="Point")xi(Q,ve);else if(he==="MultiPoint")for(const Pe of Q)xi(Pe,ve);else if(he==="LineString")ke(Q,ve,me,!1);else if(he==="MultiLineString"){if(N.lineMetrics){for(const Pe of Q)ve=[],ke(Pe,ve,me,!1),ie.push(Bi(le,"LineString",ve,F.properties));return}dn(Q,ve,me,!1)}else if(he==="Polygon")dn(Q,ve,me,!0);else{if(he!=="MultiPolygon"){if(he==="GeometryCollection"){for(const Pe of F.geometry.geometries)hi(ie,{id:le,geometry:Pe,properties:F.properties},N,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Pe of Q){const Ve=[];dn(Pe,Ve,me,!0),ve.push(Ve)}}ie.push(Bi(le,he,ve,F.properties))}function xi(ie,F){F.push(Ii(ie[0]),Kt(ie[1]),0)}function ke(ie,F,N,W){let Q,he,me=0;for(let le=0;le<ie.length;le++){const Pe=Ii(ie[le][0]),Ve=Kt(ie[le][1]);F.push(Pe,Ve,0),le>0&&(me+=W?(Q*Ve-Pe*he)/2:Math.sqrt(Math.pow(Pe-Q,2)+Math.pow(Ve-he,2))),Q=Pe,he=Ve}const ve=F.length-3;F[2]=1,bi(F,0,ve,N),F[ve+2]=1,F.size=Math.abs(me),F.start=0,F.end=F.size}function dn(ie,F,N,W){for(let Q=0;Q<ie.length;Q++){const he=[];ke(ie[Q],he,N,W),F.push(he)}}function Ii(ie){return ie/360+.5}function Kt(ie){const F=Math.sin(ie*Math.PI/180),N=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return N<0?0:N>1?1:N}function Ei(ie,F,N,W,Q,he,me,ve){if(W/=F,he>=(N/=F)&&me<W)return ie;if(me<N||he>=W)return null;const le=[];for(const Pe of ie){const Ve=Pe.geometry;let Ie=Pe.type;const Ke=Q===0?Pe.minX:Pe.minY,It=Q===0?Pe.maxX:Pe.maxY;if(Ke>=N&&It<W){le.push(Pe);continue}if(It<N||Ke>=W)continue;let Pt=[];if(Ie==="Point"||Ie==="MultiPoint")dr(Ve,Pt,N,W,Q);else if(Ie==="LineString")bn(Ve,Pt,N,W,Q,!1,ve.lineMetrics);else if(Ie==="MultiLineString")Ia(Ve,Pt,N,W,Q,!1);else if(Ie==="Polygon")Ia(Ve,Pt,N,W,Q,!0);else if(Ie==="MultiPolygon")for(const mi of Ve){const Gt=[];Ia(mi,Gt,N,W,Q,!0),Gt.length&&Pt.push(Gt)}if(Pt.length){if(ve.lineMetrics&&Ie==="LineString"){for(const mi of Pt)le.push(Bi(Pe.id,Ie,mi,Pe.tags));continue}Ie!=="LineString"&&Ie!=="MultiLineString"||(Pt.length===1?(Ie="LineString",Pt=Pt[0]):Ie="MultiLineString"),Ie!=="Point"&&Ie!=="MultiPoint"||(Ie=Pt.length===3?"Point":"MultiPoint"),le.push(Bi(Pe.id,Ie,Pt,Pe.tags))}}return le.length?le:null}function dr(ie,F,N,W,Q){for(let he=0;he<ie.length;he+=3){const me=ie[he+Q];me>=N&&me<=W&&Qn(F,ie[he],ie[he+1],ie[he+2])}}function bn(ie,F,N,W,Q,he,me){let ve=Jn(ie);const le=Q===0?xt:Tt;let Pe,Ve,Ie=ie.start;for(let Gt=0;Gt<ie.length-3;Gt+=3){const gi=ie[Gt],oi=ie[Gt+1],xn=ie[Gt+2],nn=ie[Gt+3],ti=ie[Gt+4],Li=Q===0?gi:oi,en=Q===0?nn:ti;let Cn=!1;me&&(Pe=Math.sqrt(Math.pow(gi-nn,2)+Math.pow(oi-ti,2))),Li<N?en>N&&(Ve=le(ve,gi,oi,nn,ti,N),me&&(ve.start=Ie+Pe*Ve)):Li>W?en<W&&(Ve=le(ve,gi,oi,nn,ti,W),me&&(ve.start=Ie+Pe*Ve)):Qn(ve,gi,oi,xn),en<N&&Li>=N&&(Ve=le(ve,gi,oi,nn,ti,N),Cn=!0),en>W&&Li<=W&&(Ve=le(ve,gi,oi,nn,ti,W),Cn=!0),!he&&Cn&&(me&&(ve.end=Ie+Pe*Ve),F.push(ve),ve=Jn(ie)),me&&(Ie+=Pe)}let Ke=ie.length-3;const It=ie[Ke],Pt=ie[Ke+1],mi=Q===0?It:Pt;mi>=N&&mi<=W&&Qn(ve,It,Pt,ie[Ke+2]),Ke=ve.length-3,he&&Ke>=3&&(ve[Ke]!==ve[0]||ve[Ke+1]!==ve[1])&&Qn(ve,ve[0],ve[1],ve[2]),ve.length&&F.push(ve)}function Jn(ie){const F=[];return F.size=ie.size,F.start=ie.start,F.end=ie.end,F}function Ia(ie,F,N,W,Q,he){for(const me of ie)bn(me,F,N,W,Q,he,!1)}function Qn(ie,F,N,W){ie.push(F,N,W)}function xt(ie,F,N,W,Q,he){const me=(he-F)/(W-F);return Qn(ie,he,N+(Q-N)*me,1),me}function Tt(ie,F,N,W,Q,he){const me=(he-N)/(Q-N);return Qn(ie,F+(W-F)*me,he,1),me}function ze(ie,F){const N=[];for(let W=0;W<ie.length;W++){const Q=ie[W],he=Q.type;let me;if(he==="Point"||he==="MultiPoint"||he==="LineString")me=Vt(Q.geometry,F);else if(he==="MultiLineString"||he==="Polygon"){me=[];for(const ve of Q.geometry)me.push(Vt(ve,F))}else if(he==="MultiPolygon"){me=[];for(const ve of Q.geometry){const le=[];for(const Pe of ve)le.push(Vt(Pe,F));me.push(le)}}N.push(Bi(Q.id,he,me,Q.tags))}return N}function Vt(ie,F){const N=[];N.size=ie.size,ie.start!==void 0&&(N.start=ie.start,N.end=ie.end);for(let W=0;W<ie.length;W+=3)N.push(ie[W]+F,ie[W+1],ie[W+2]);return N}function Ut(ie,F){if(ie.transformed)return ie;const N=1<<ie.z,W=ie.x,Q=ie.y;for(const he of ie.features){const me=he.geometry,ve=he.type;if(he.geometry=[],ve===1)for(let le=0;le<me.length;le+=2)he.geometry.push(Qt(me[le],me[le+1],F,N,W,Q));else for(let le=0;le<me.length;le++){const Pe=[];for(let Ve=0;Ve<me[le].length;Ve+=2)Pe.push(Qt(me[le][Ve],me[le][Ve+1],F,N,W,Q));he.geometry.push(Pe)}}return ie.transformed=!0,ie}function Qt(ie,F,N,W,Q,he){return[Math.round(N*(ie*W-Q)),Math.round(N*(F*W-he))]}function Oi(ie,F,N,W,Q){const he=F===Q.maxZoom?0:Q.tolerance/((1<<F)*Q.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:ie.length,source:null,x:N,y:W,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ve of ie)qe(me,ve,he,Q);return me}function qe(ie,F,N,W){const Q=F.geometry,he=F.type,me=[];if(ie.minX=Math.min(ie.minX,F.minX),ie.minY=Math.min(ie.minY,F.minY),ie.maxX=Math.max(ie.maxX,F.maxX),ie.maxY=Math.max(ie.maxY,F.maxY),he==="Point"||he==="MultiPoint")for(let ve=0;ve<Q.length;ve+=3)me.push(Q[ve],Q[ve+1]),ie.numPoints++,ie.numSimplified++;else if(he==="LineString")Dt(me,Q,ie,N,!1,!1);else if(he==="MultiLineString"||he==="Polygon")for(let ve=0;ve<Q.length;ve++)Dt(me,Q[ve],ie,N,he==="Polygon",ve===0);else if(he==="MultiPolygon")for(let ve=0;ve<Q.length;ve++){const le=Q[ve];for(let Pe=0;Pe<le.length;Pe++)Dt(me,le[Pe],ie,N,!0,Pe===0)}if(me.length){let ve=F.tags||null;if(he==="LineString"&&W.lineMetrics){ve={};for(const Pe in F.tags)ve[Pe]=F.tags[Pe];ve.mapbox_clip_start=Q.start/Q.size,ve.mapbox_clip_end=Q.end/Q.size}const le={geometry:me,type:he==="Polygon"||he==="MultiPolygon"?3:he==="LineString"||he==="MultiLineString"?2:1,tags:ve};F.id!==null&&(le.id=F.id),ie.features.push(le)}}function Dt(ie,F,N,W,Q,he){const me=W*W;if(W>0&&F.size<(Q?me:W))return void(N.numPoints+=F.length/3);const ve=[];for(let le=0;le<F.length;le+=3)(W===0||F[le+2]>me)&&(N.numSimplified++,ve.push(F[le],F[le+1])),N.numPoints++;Q&&function(le,Pe){let Ve=0;for(let Ie=0,Ke=le.length,It=Ke-2;Ie<Ke;It=Ie,Ie+=2)Ve+=(le[Ie]-le[It])*(le[Ie+1]+le[It+1]);if(Ve>0===Pe)for(let Ie=0,Ke=le.length;Ie<Ke/2;Ie+=2){const It=le[Ie],Pt=le[Ie+1];le[Ie]=le[Ke-2-Ie],le[Ie+1]=le[Ke-1-Ie],le[Ke-2-Ie]=It,le[Ke-1-Ie]=Pt}}(ve,he),ie.push(ve)}const kt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Di{constructor(F,N){const W=(N=this.options=function(he,me){for(const ve in me)he[ve]=me[ve];return he}(Object.create(kt),N)).debug;if(W&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");let Q=function(he,me){const ve=[];if(he.type==="FeatureCollection")for(let le=0;le<he.features.length;le++)hi(ve,he.features[le],me,le);else hi(ve,he.type==="Feature"?he:{geometry:he},me);return ve}(F,N);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Q=function(he,me){const ve=me.buffer/me.extent;let le=he;const Pe=Ei(he,1,-1-ve,ve,0,-1,2,me),Ve=Ei(he,1,1-ve,2+ve,0,-1,2,me);return(Pe||Ve)&&(le=Ei(he,1,-ve,1+ve,0,-1,2,me)||[],Pe&&(le=ze(Pe,1).concat(le)),Ve&&(le=le.concat(ze(Ve,-1)))),le}(Q,N),Q.length&&this.splitTile(Q,0,0,0),W&&(Q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(F,N,W,Q,he,me,ve){const le=[F,N,W,Q],Pe=this.options,Ve=Pe.debug;for(;le.length;){Q=le.pop(),W=le.pop(),N=le.pop(),F=le.pop();const Ie=1<<N,Ke=Fn(N,W,Q);let It=this.tiles[Ke];if(!It&&(Ve>1&&console.time("creation"),It=this.tiles[Ke]=Oi(F,N,W,Q,Pe),this.tileCoords.push({z:N,x:W,y:Q}),Ve)){Ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,W,Q,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));const Cn=`z${N}`;this.stats[Cn]=(this.stats[Cn]||0)+1,this.total++}if(It.source=F,he==null){if(N===Pe.indexMaxZoom||It.numPoints<=Pe.indexMaxPoints)continue}else{if(N===Pe.maxZoom||N===he)continue;if(he!=null){const Cn=he-N;if(W!==me>>Cn||Q!==ve>>Cn)continue}}if(It.source=null,F.length===0)continue;Ve>1&&console.time("clipping");const Pt=.5*Pe.buffer/Pe.extent,mi=.5-Pt,Gt=.5+Pt,gi=1+Pt;let oi=null,xn=null,nn=null,ti=null,Li=Ei(F,Ie,W-Pt,W+Gt,0,It.minX,It.maxX,Pe),en=Ei(F,Ie,W+mi,W+gi,0,It.minX,It.maxX,Pe);F=null,Li&&(oi=Ei(Li,Ie,Q-Pt,Q+Gt,1,It.minY,It.maxY,Pe),xn=Ei(Li,Ie,Q+mi,Q+gi,1,It.minY,It.maxY,Pe),Li=null),en&&(nn=Ei(en,Ie,Q-Pt,Q+Gt,1,It.minY,It.maxY,Pe),ti=Ei(en,Ie,Q+mi,Q+gi,1,It.minY,It.maxY,Pe),en=null),Ve>1&&console.timeEnd("clipping"),le.push(oi||[],N+1,2*W,2*Q),le.push(xn||[],N+1,2*W,2*Q+1),le.push(nn||[],N+1,2*W+1,2*Q),le.push(ti||[],N+1,2*W+1,2*Q+1)}}getTile(F,N,W){F=+F,N=+N,W=+W;const Q=this.options,{extent:he,debug:me}=Q;if(F<0||F>24)return null;const ve=1<<F,le=Fn(F,N=N+ve&ve-1,W);if(this.tiles[le])return Ut(this.tiles[le],he);me>1&&console.log("drilling down to z%d-%d-%d",F,N,W);let Pe,Ve=F,Ie=N,Ke=W;for(;!Pe&&Ve>0;)Ve--,Ie>>=1,Ke>>=1,Pe=this.tiles[Fn(Ve,Ie,Ke)];return Pe&&Pe.source?(me>1&&(console.log("found parent tile z%d-%d-%d",Ve,Ie,Ke),console.time("drilling down")),this.splitTile(Pe.source,Ve,Ie,Ke,F,N,W),me>1&&console.timeEnd("drilling down"),this.tiles[le]?Ut(this.tiles[le],he):null):null}}function Fn(ie,F,N){return 32*((1<<ie)*N+F)+ie}function Bt(ie,F){return F?ie.properties[F]:ie.id}function An(ie,F){if(ie==null)return!0;if(ie.type==="Feature")return Bt(ie,F)!=null;if(ie.type==="FeatureCollection"){const N=new Set;for(const W of ie.features){const Q=Bt(W,F);if(Q==null||N.has(Q))return!1;N.add(Q)}return!0}return!1}function Ar(ie,F){const N=new Map;if(ie!=null)if(ie.type==="Feature")N.set(Bt(ie,F),ie);else for(const W of ie.features)N.set(Bt(W,F),W);return N}class Ur extends R{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(F,N){return _._(this,void 0,void 0,function*(){const W=F.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Q=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!Q)return null;const he=new class{constructor(ve){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=_.X,this.length=ve.length,this._features=ve}feature(ve){return new class{constructor(le){this._feature=le,this.extent=_.X,this.type=le.type,this.properties=le.tags,"id"in le&&!isNaN(le.id)&&(this.id=parseInt(le.id,10))}loadGeometry(){if(this._feature.type===1){const le=[];for(const Pe of this._feature.geometry)le.push([new _.P(Pe[0],Pe[1])]);return le}{const le=[];for(const Pe of this._feature.geometry){const Ve=[];for(const Ie of Pe)Ve.push(new _.P(Ie[0],Ie[1]));le.push(Ve)}return le}}toGeoJSON(le,Pe,Ve){return se.call(this,le,Pe,Ve)}}(this._features[ve])}}(Q.features);let me=He(he);return me.byteOffset===0&&me.byteLength===me.buffer.byteLength||(me=new Uint8Array(me)),{vectorTile:he,rawData:me.buffer}})}loadData(F){return _._(this,void 0,void 0,function*(){var N;(N=this._pendingRequest)===null||N===void 0||N.abort();const W=!!(F&&F.request&&F.request.collectResourceTiming)&&new _.bv(F.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(F,this._pendingRequest),this._geoJSONIndex=F.cluster?new _t(function({superclusterOptions:me,clusterProperties:ve}){if(!ve||!me)return me;const le={},Pe={},Ve={accumulated:null,zoom:0},Ie={properties:null},Ke=Object.keys(ve);for(const It of Ke){const[Pt,mi]=ve[It],Gt=_.bC(mi),gi=_.bC(typeof Pt=="string"?[Pt,["accumulated"],["get",It]]:Pt);le[It]=Gt.value,Pe[It]=gi.value}return me.map=It=>{Ie.properties=It;const Pt={};for(const mi of Ke)Pt[mi]=le[mi].evaluate(Ve,Ie);return Pt},me.reduce=(It,Pt)=>{Ie.properties=Pt;for(const mi of Ke)Ve.accumulated=It[mi],It[mi]=Pe[mi].evaluate(Ve,Ie)},me}(F)).load((yield this._pendingData).features):(Q=yield this._pendingData,new Di(Q,F.geojsonVtOptions)),this.loaded={};const he={};if(W){const me=W.finish();me&&(he.resourceTiming={},he.resourceTiming[F.source]=JSON.parse(JSON.stringify(me)))}return he}catch(he){if(delete this._pendingRequest,_.bB(he))return{abandoned:!0};throw he}var Q})}getData(){return _._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(F){const N=this.loaded;return N&&N[F.uid]?super.reloadTile(F):this.loadTile(F)}loadAndProcessGeoJSON(F,N){return _._(this,void 0,void 0,function*(){let W=yield this.loadGeoJSON(F,N);if(delete this._pendingRequest,typeof W!="object")throw new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`);if(Z(W,!0),F.filter){const Q=_.bC(F.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Q.result==="error")throw new Error(Q.value.map(me=>`${me.key}: ${me.message}`).join(", "));W={type:"FeatureCollection",features:W.features.filter(me=>Q.value.evaluate({zoom:0},me))}}return W})}loadGeoJSON(F,N){return _._(this,void 0,void 0,function*(){const{promoteId:W}=F;if(F.request){const Q=yield _.h(F.request,N);return this._dataUpdateable=An(Q.data,W)?Ar(Q.data,W):void 0,Q.data}if(typeof F.data=="string")try{const Q=JSON.parse(F.data);return this._dataUpdateable=An(Q,W)?Ar(Q,W):void 0,Q}catch{throw new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`)}if(!F.dataDiff)throw new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${F.source}`);return function(Q,he,me){var ve,le,Pe,Ve;if(he.removeAll&&Q.clear(),he.remove)for(const Ie of he.remove)Q.delete(Ie);if(he.add)for(const Ie of he.add){const Ke=Bt(Ie,me);Ke!=null&&Q.set(Ke,Ie)}if(he.update)for(const Ie of he.update){let Ke=Q.get(Ie.id);if(Ke==null)continue;const It=!Ie.removeAllProperties&&(((ve=Ie.removeProperties)===null||ve===void 0?void 0:ve.length)>0||((le=Ie.addOrUpdateProperties)===null||le===void 0?void 0:le.length)>0);if((Ie.newGeometry||Ie.removeAllProperties||It)&&(Ke=Object.assign({},Ke),Q.set(Ie.id,Ke),It&&(Ke.properties=Object.assign({},Ke.properties))),Ie.newGeometry&&(Ke.geometry=Ie.newGeometry),Ie.removeAllProperties)Ke.properties={};else if(((Pe=Ie.removeProperties)===null||Pe===void 0?void 0:Pe.length)>0)for(const Pt of Ie.removeProperties)Object.prototype.hasOwnProperty.call(Ke.properties,Pt)&&delete Ke.properties[Pt];if(((Ve=Ie.addOrUpdateProperties)===null||Ve===void 0?void 0:Ve.length)>0)for(const{key:Pt,value:mi}of Ie.addOrUpdateProperties)Ke.properties[Pt]=mi}}(this._dataUpdateable,F.dataDiff,W),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(F){return _._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(F){return this._geoJSONIndex.getClusterExpansionZoom(F.clusterId)}getClusterChildren(F){return this._geoJSONIndex.getChildren(F.clusterId)}getClusterLeaves(F){return this._geoJSONIndex.getLeaves(F.clusterId,F.limit,F.offset)}}class En{constructor(F){this.self=F,this.actor=new _.F(F),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(N,W)=>{if(this.externalWorkerSourceTypes[N])throw new Error(`Worker source with name "${N}" already registered.`);this.externalWorkerSourceTypes[N]=W},this.self.addProtocol=_.bi,this.self.removeProtocol=_.bj,this.self.registerRTLTextPlugin=N=>{if(_.bD.isParsed())throw new Error("RTL text plugin already registered.");_.bD.setMethods(N)},this.actor.registerMessageHandler("LDT",(N,W)=>this._getDEMWorkerSource(N,W.source).loadTile(W)),this.actor.registerMessageHandler("RDT",(N,W)=>_._(this,void 0,void 0,function*(){this._getDEMWorkerSource(N,W.source).removeTile(W)})),this.actor.registerMessageHandler("GCEZ",(N,W)=>_._(this,void 0,void 0,function*(){return this._getWorkerSource(N,W.type,W.source).getClusterExpansionZoom(W)})),this.actor.registerMessageHandler("GCC",(N,W)=>_._(this,void 0,void 0,function*(){return this._getWorkerSource(N,W.type,W.source).getClusterChildren(W)})),this.actor.registerMessageHandler("GCL",(N,W)=>_._(this,void 0,void 0,function*(){return this._getWorkerSource(N,W.type,W.source).getClusterLeaves(W)})),this.actor.registerMessageHandler("LD",(N,W)=>this._getWorkerSource(N,W.type,W.source).loadData(W)),this.actor.registerMessageHandler("GD",(N,W)=>this._getWorkerSource(N,W.type,W.source).getData()),this.actor.registerMessageHandler("LT",(N,W)=>this._getWorkerSource(N,W.type,W.source).loadTile(W)),this.actor.registerMessageHandler("RT",(N,W)=>this._getWorkerSource(N,W.type,W.source).reloadTile(W)),this.actor.registerMessageHandler("AT",(N,W)=>this._getWorkerSource(N,W.type,W.source).abortTile(W)),this.actor.registerMessageHandler("RMT",(N,W)=>this._getWorkerSource(N,W.type,W.source).removeTile(W)),this.actor.registerMessageHandler("RS",(N,W)=>_._(this,void 0,void 0,function*(){if(!this.workerSources[N]||!this.workerSources[N][W.type]||!this.workerSources[N][W.type][W.source])return;const Q=this.workerSources[N][W.type][W.source];delete this.workerSources[N][W.type][W.source],Q.removeSource!==void 0&&Q.removeSource(W)})),this.actor.registerMessageHandler("RM",N=>_._(this,void 0,void 0,function*(){delete this.layerIndexes[N],delete this.availableImages[N],delete this.workerSources[N],delete this.demWorkerSources[N]})),this.actor.registerMessageHandler("SR",(N,W)=>_._(this,void 0,void 0,function*(){this.referrer=W})),this.actor.registerMessageHandler("SRPS",(N,W)=>this._syncRTLPluginState(N,W)),this.actor.registerMessageHandler("IS",(N,W)=>_._(this,void 0,void 0,function*(){this.self.importScripts(W)})),this.actor.registerMessageHandler("SI",(N,W)=>this._setImages(N,W)),this.actor.registerMessageHandler("UL",(N,W)=>_._(this,void 0,void 0,function*(){this._getLayerIndex(N).update(W.layers,W.removedIds)})),this.actor.registerMessageHandler("SL",(N,W)=>_._(this,void 0,void 0,function*(){this._getLayerIndex(N).replace(W)}))}_setImages(F,N){return _._(this,void 0,void 0,function*(){this.availableImages[F]=N;for(const W in this.workerSources[F]){const Q=this.workerSources[F][W];for(const he in Q)Q[he].availableImages=N}})}_syncRTLPluginState(F,N){return _._(this,void 0,void 0,function*(){if(_.bD.isParsed())return _.bD.getState();if(N.pluginStatus!=="loading")return _.bD.setState(N),N;const W=N.pluginURL;if(this.self.importScripts(W),_.bD.isParsed()){const Q={pluginStatus:"loaded",pluginURL:W};return _.bD.setState(Q),Q}throw _.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${W}`)})}_getAvailableImages(F){let N=this.availableImages[F];return N||(N=[]),N}_getLayerIndex(F){let N=this.layerIndexes[F];return N||(N=this.layerIndexes[F]=new c),N}_getWorkerSource(F,N,W){if(this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][N]||(this.workerSources[F][N]={}),!this.workerSources[F][N][W]){const Q={sendAsync:(he,me)=>(he.targetMapId=F,this.actor.sendAsync(he,me))};switch(N){case"vector":this.workerSources[F][N][W]=new R(Q,this._getLayerIndex(F),this._getAvailableImages(F));break;case"geojson":this.workerSources[F][N][W]=new Ur(Q,this._getLayerIndex(F),this._getAvailableImages(F));break;default:this.workerSources[F][N][W]=new this.externalWorkerSourceTypes[N](Q,this._getLayerIndex(F),this._getAvailableImages(F))}}return this.workerSources[F][N][W]}_getDEMWorkerSource(F,N){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][N]||(this.demWorkerSources[F][N]=new C),this.demWorkerSources[F][N]}}return _.i(self)&&(self.worker=new En(self)),En}),p("index",["exports","./shared"],function(_,c){var M="4.7.1";let B,O;const R={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((e,s)=>{const u=requestAnimationFrame(e);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),s(c.c())})}),getImageData(g,e=0){return this.getImageCanvasContext(g).getImageData(-e,-e,g.width+2*e,g.height+2*e)},getImageCanvasContext(g){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=g.width,e.height=g.height,s.drawImage(g,0,0,g.width,g.height),s},resolveURL:g=>(B||(B=document.createElement("a")),B.href=g,B.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(O==null&&(O=matchMedia("(prefers-reduced-motion: reduce)")),O.matches)}};class C{static testProp(e){if(!C.docStyle)return e[0];for(let s=0;s<e.length;s++)if(e[s]in C.docStyle)return e[s];return e[0]}static create(e,s,u){const d=window.document.createElement(e);return s!==void 0&&(d.className=s),u&&u.appendChild(d),d}static createNS(e,s){return window.document.createElementNS(e,s)}static disableDrag(){C.docStyle&&C.selectProp&&(C.userSelect=C.docStyle[C.selectProp],C.docStyle[C.selectProp]="none")}static enableDrag(){C.docStyle&&C.selectProp&&(C.docStyle[C.selectProp]=C.userSelect)}static setTransform(e,s){e.style[C.transformProp]=s}static addEventListener(e,s,u,d={}){e.addEventListener(s,u,"passive"in d?d:d.capture)}static removeEventListener(e,s,u,d={}){e.removeEventListener(s,u,"passive"in d?d:d.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",C.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",C.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",C.suppressClickInternal,!0)},0)}static getScale(e){const s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}static getPoint(e,s,u){const d=s.boundingClientRect;return new c.P((u.clientX-d.left)/s.x-e.clientLeft,(u.clientY-d.top)/s.y-e.clientTop)}static mousePos(e,s){const u=C.getScale(e);return C.getPoint(e,u,s)}static touchPos(e,s){const u=[],d=C.getScale(e);for(let m=0;m<s.length;m++)u.push(C.getPoint(e,d,s[m]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}C.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,C.selectProp=C.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),C.transformProp=C.testProp(["transform","WebkitTransform"]);const Y={supported:!1,testSupport:function(g){!se&&Z&&(q?te(g):X=g)}};let X,Z,se=!1,q=!1;function te(g){const e=g.createTexture();g.bindTexture(g.TEXTURE_2D,e);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Z),g.isContextLost())return;Y.supported=!0}catch{}g.deleteTexture(e),se=!0}var ne;typeof document<"u"&&(Z=document.createElement("img"),Z.onload=()=>{X&&te(X),X=null,q=!0},Z.onerror=()=>{se=!0,X=null},Z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let e,s,u,d;g.resetRequestQueue=()=>{e=[],s=0,u=0,d={}},g.addThrottleControl=k=>{const E=u++;return d[E]=k,E},g.removeThrottleControl=k=>{delete d[k],w()},g.getImage=(k,E,z=!0)=>new Promise((D,V)=>{Y.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),c.e(k,{type:"image"}),e.push({abortController:E,requestParameters:k,supportImageRefresh:z,state:"queued",onError:H=>{V(H)},onSuccess:H=>{D(H)}}),w()});const m=k=>c._(this,void 0,void 0,function*(){k.state="running";const{requestParameters:E,supportImageRefresh:z,onError:D,onSuccess:V,abortController:H}=k,G=z===!1&&!c.i(self)&&!c.g(E.url)&&(!E.headers||Object.keys(E.headers).reduce((oe,ce)=>oe&&ce==="accept",!0));s++;const ee=G?S(E,H):c.m(E,H);try{const oe=yield ee;delete k.abortController,k.state="completed",oe.data instanceof HTMLImageElement||c.b(oe.data)?V(oe):oe.data&&V({data:yield(ae=oe.data,typeof createImageBitmap=="function"?c.d(ae):c.f(ae)),cacheControl:oe.cacheControl,expires:oe.expires})}catch(oe){delete k.abortController,D(oe)}finally{s--,w()}var ae}),w=()=>{const k=(()=>{for(const E of Object.keys(d))if(d[E]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let E=s;E<k&&e.length>0;E++){const z=e.shift();z.abortController.signal.aborted?E--:m(z)}},S=(k,E)=>new Promise((z,D)=>{const V=new Image,H=k.url,G=k.credentials;G&&G==="include"?V.crossOrigin="use-credentials":(G&&G==="same-origin"||!c.s(H))&&(V.crossOrigin="anonymous"),E.signal.addEventListener("abort",()=>{V.src="",D(c.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,z({data:V})},V.onerror=()=>{V.onerror=V.onload=null,E.signal.aborted||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=H})}(ne||(ne={})),ne.resetRequestQueue();class _e{constructor(e){this._transformRequestFn=e}transformRequest(e,s){return this._transformRequestFn&&this._transformRequestFn(e,s)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function be(g){var e=new c.A(3);return e[0]=g[0],e[1]=g[1],e[2]=g[2],e}var Ae,de=function(g,e,s){return g[0]=e[0]-s[0],g[1]=e[1]-s[1],g[2]=e[2]-s[2],g};Ae=new c.A(3),c.A!=Float32Array&&(Ae[0]=0,Ae[1]=0,Ae[2]=0);var Be=function(g){var e=g[0],s=g[1];return e*e+s*s};function Fe(g){const e=[];if(typeof g=="string")e.push({id:"default",url:g});else if(g&&g.length>0){const s=[];for(const{id:u,url:d}of g){const m=`${u}${d}`;s.indexOf(m)===-1&&(s.push(m),e.push({id:u,url:d}))}}return e}function Le(g,e,s){const u=g.split("?");return u[0]+=`${e}${s}`,u.join("?")}(function(){var g=new c.A(2);c.A!=Float32Array&&(g[0]=0,g[1]=0)})();class we{constructor(e,s,u,d){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(s,d)}update(e,s,u){const{width:d,height:m}=e,w=!(this.size&&this.size[0]===d&&this.size[1]===m||u),{context:S}=this,{gl:k}=S;if(this.useMipmap=!!(s&&s.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!s||s.premultiply!==!1)),w)this.size=[d,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,d,m,0,this.format,k.UNSIGNED_BYTE,e.data);else{const{x:E,y:z}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?k.texSubImage2D(k.TEXTURE_2D,0,E,z,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,E,z,d,m,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(e,s,u){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),u!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,u||e),this.filter=e),s!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Te(g){const{userImage:e}=g;return!!(e&&e.render&&e.render())&&(g.data.replace(new Uint8Array(e.data.buffer)),!0)}class fe extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:s,promiseResolve:u}of this.requestors)u(this._getImagesForIds(s));this.requestors=[]}}getImage(e){const s=this.images[e];if(s&&!s.data&&s.spriteData){const u=s.spriteData;s.data=new c.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),s.spriteData=null}return s}addImage(e,s){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,s)&&(this.images[e]=s)}_validate(e,s){let u=!0;const d=s.data||s.spriteData;return this._validateStretch(s.stretchX,d&&d.width)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(s.stretchY,d&&d.height)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(s.content,s)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,s){if(!e)return!0;let u=0;for(const d of e){if(d[0]<u||d[1]<d[0]||s<d[1])return!1;u=d[1]}return!0}_validateContent(e,s){if(!e)return!0;if(e.length!==4)return!1;const u=s.spriteData,d=u&&u.width||s.data.width,m=u&&u.height||s.data.height;return!(e[0]<0||d<e[0]||e[1]<0||m<e[1]||e[2]<0||d<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,s,u=!0){const d=this.getImage(e);if(u&&(d.data.width!==s.data.width||d.data.height!==s.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=d.version+1,this.images[e]=s,this.updatedImages[e]=!0}removeImage(e){const s=this.images[e];delete this.images[e],delete this.patterns[e],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((s,u)=>{let d=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(d=!1);this.isLoaded()||d?s(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:s})})}_getImagesForIds(e){const s={};for(const u of e){let d=this.getImage(u);d||(this.fire(new c.k("styleimagemissing",{id:u})),d=this.getImage(u)),d?s[u]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:c.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:e,height:s}=this.atlasImage;return{width:e,height:s}}getPattern(e){const s=this.patterns[e],u=this.getImage(e);if(!u)return null;if(s&&s.position.version===u.version)return s.position;if(s)s.position.version=u.version;else{const d={w:u.data.width+2,h:u.data.height+2,x:0,y:0},m=new c.I(d,u);this.patterns[e]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const s=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new we(e,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:s,h:u}=c.p(e),d=this.atlasImage;d.resize({width:s||1,height:u||1});for(const m in this.patterns){const{bin:w}=this.patterns[m],S=w.x+1,k=w.y+1,E=this.getImage(m).data,z=E.width,D=E.height;c.R.copy(E,d,{x:0,y:0},{x:S,y:k},{width:z,height:D}),c.R.copy(E,d,{x:0,y:D-1},{x:S,y:k-1},{width:z,height:1}),c.R.copy(E,d,{x:0,y:0},{x:S,y:k+D},{width:z,height:1}),c.R.copy(E,d,{x:z-1,y:0},{x:S-1,y:k},{width:1,height:D}),c.R.copy(E,d,{x:0,y:0},{x:S+z,y:k},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const s of e){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const u=this.getImage(s);u||c.w(`Image with ID: "${s}" was not found`),Te(u)&&this.updateImage(s,u)}}}const Me=1e20;function Ee(g,e,s,u,d,m,w,S,k){for(let E=e;E<e+u;E++)$e(g,s*m+E,m,d,w,S,k);for(let E=s;E<s+d;E++)$e(g,E*m+e,1,u,w,S,k)}function $e(g,e,s,u,d,m,w){m[0]=0,w[0]=-Me,w[1]=Me,d[0]=g[e];for(let S=1,k=0,E=0;S<u;S++){d[S]=g[e+S*s];const z=S*S;do{const D=m[k];E=(d[S]-d[D]+z-D*D)/(S-D)/2}while(E<=w[k]&&--k>-1);k++,m[k]=S,w[k]=E,w[k+1]=Me}for(let S=0,k=0;S<u;S++){for(;w[k+1]<S;)k++;const E=m[k],z=S-E;g[e+S*s]=d[E]+z*z}}class He{constructor(e,s){this.requestManager=e,this.localIdeographFontFamily=s,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const s=[];for(const m in e)for(const w of e[m])s.push(this._getAndCacheGlyphsPromise(m,w));const u=yield Promise.all(s),d={};for(const{stack:m,id:w,glyph:S}of u)d[m]||(d[m]={}),d[m][w]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return d})}_getAndCacheGlyphsPromise(e,s){return c._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let d=u.glyphs[s];if(d!==void 0)return{stack:e,id:s,glyph:d};if(d=this._tinySDF(u,e,s),d)return u.glyphs[s]=d,{stack:e,id:s,glyph:d};const m=Math.floor(s/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[m])return{stack:e,id:s,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[m]){const S=He.loadGlyphRange(e,m,this.url,this.requestManager);u.requests[m]=S}const w=yield u.requests[m];for(const S in w)this._doesCharSupportLocalGlyph(+S)||(u.glyphs[+S]=w[+S]);return u.ranges[m]=!0,{stack:e,id:s,glyph:w[s]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,s,u){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(u))return;let m=e.tinySDF;if(!m){let S="400";/bold/i.test(s)?S="900":/medium/i.test(s)?S="500":/light/i.test(s)&&(S="200"),m=e.tinySDF=new He.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:S})}const w=m.draw(String.fromCharCode(u));return{id:u,bitmap:new c.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}He.loadGlyphRange=function(g,e,s,u){return c._(this,void 0,void 0,function*(){const d=256*e,m=d+255,w=u.transformRequest(s.replace("{fontstack}",g).replace("{range}",`${d}-${m}`),"Glyphs"),S=yield c.l(w,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${e}, ${d}-${m}`);const k={};for(const E of c.n(S.data))k[E.id]=E;return k})},He.TinySDF=class{constructor({fontSize:g=24,buffer:e=3,radius:s=8,cutoff:u=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:w="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=s;const S=this.size=g+4*e,k=this._createCanvas(S),E=this.ctx=k.getContext("2d",{willReadFrequently:!0});E.font=`${w} ${m} ${g}px ${d}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(g){const e=document.createElement("canvas");return e.width=e.height=g,e}draw(g){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(g),w=Math.ceil(s),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),k=Math.min(this.size-this.buffer,w+Math.ceil(u)),E=S+2*this.buffer,z=k+2*this.buffer,D=Math.max(E*z,0),V=new Uint8ClampedArray(D),H={data:V,width:E,height:z,glyphWidth:S,glyphHeight:k,glyphTop:w,glyphLeft:0,glyphAdvance:e};if(S===0||k===0)return H;const{ctx:G,buffer:ee,gridInner:ae,gridOuter:oe}=this;G.clearRect(ee,ee,S,k),G.fillText(g,ee,ee+w);const ce=G.getImageData(ee,ee,S,k);oe.fill(Me,0,D),ae.fill(0,0,D);for(let K=0;K<k;K++)for(let pe=0;pe<S;pe++){const ge=ce.data[4*(K*S+pe)+3]/255;if(ge===0)continue;const Se=(K+ee)*E+pe+ee;if(ge===1)oe[Se]=0,ae[Se]=Me;else{const je=.5-ge;oe[Se]=je>0?je*je:0,ae[Se]=je<0?je*je:0}}Ee(oe,0,0,E,z,E,this.f,this.v,this.z),Ee(ae,ee,ee,S,k,E,this.f,this.v,this.z);for(let K=0;K<D;K++){const pe=Math.sqrt(oe[K])-Math.sqrt(ae[K]);V[K]=Math.round(255-255*(pe/this.radius+this.cutoff))}return H}};class Ge{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,s){return c.x(e.expression.evaluate(s))}interpolate(e,s,u){return{x:c.y.number(e.x,s.x,u),y:c.y.number(e.y,s.y,u),z:c.y.number(e.z,s.z,u)}}}let Re;class Xe extends c.E{constructor(e){super(),Re=Re||new c.q({anchor:new c.D(c.v.light.anchor),position:new Ge,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(Re),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,s={}){if(!this._validate(c.r,e,s))for(const u in e){const d=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,u){return(!u||u.validate!==!1)&&c.t(this,e.call(c.u,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Ue=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Mt extends c.E{constructor(e){super(),this._transitionable=new c.T(Ue),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(e,s={}){if(!this._validate(c.B,e,s)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const u in e){const d=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,u={}){return(u==null?void 0:u.validate)!==!1&&c.t(this,e.call(c.u,c.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Rt{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,s){const u=e.join(",")+String(s);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,s)),this.dashEntry[u]}getDashRanges(e,s,u){const d=[];let m=e.length%2==1?-e[e.length-1]*u:0,w=e[0]*u,S=!0;d.push({left:m,right:w,isDash:S,zeroLength:e[0]===0});let k=e[0];for(let E=1;E<e.length;E++){S=!S;const z=e[E];m=k*u,k+=z,w=k*u,d.push({left:m,right:w,isDash:S,zeroLength:z===0})}return d}addRoundDash(e,s,u){const d=s/2;for(let m=-u;m<=u;m++){const w=this.width*(this.nextRow+u+m);let S=0,k=e[S];for(let E=0;E<this.width;E++){E/k.right>1&&(k=e[++S]);const z=Math.abs(E-k.left),D=Math.abs(E-k.right),V=Math.min(z,D);let H;const G=m/u*(d+1);if(k.isDash){const ee=d-Math.abs(G);H=Math.sqrt(V*V+ee*ee)}else H=d-Math.sqrt(V*V+G*G);this.data[w+E]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(e){for(let S=e.length-1;S>=0;--S){const k=e[S],E=e[S+1];k.zeroLength?e.splice(S,1):E&&E.isDash===k.isDash&&(E.left=k.left,e.splice(S,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const d=this.width*this.nextRow;let m=0,w=e[m];for(let S=0;S<this.width;S++){S/w.right>1&&(w=e[++m]);const k=Math.abs(S-w.left),E=Math.abs(S-w.right),z=Math.min(k,E);this.data[d+S]=Math.max(0,Math.min(255,(w.isDash?z:-z)+128))}}addDash(e,s){const u=s?7:0,d=2*u+1;if(this.nextRow+d>this.height)return c.w("LineAtlas out of space"),null;let m=0;for(let S=0;S<e.length;S++)m+=e[S];if(m!==0){const S=this.width/m,k=this.getDashRanges(e,this.width,S);s?this.addRoundDash(k,S,u):this.addRegularDash(k)}const w={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:m};return this.nextRow+=d,this.dirty=!0,w}bind(e){const s=e.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const _t="maplibre_preloaded_worker_pool";class Xt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Xt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_t]}numActive(){return Object.keys(this.active).length}}const jt=Math.floor(R.hardwareConcurrency/2);let si,fi;function qt(){return si||(si=new Xt),si}Xt.workerCount=c.C(globalThis)?Math.max(Math.min(jt,3),1):1;class bi{constructor(e,s){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=s;const u=this.workerPool.acquire(s);for(let d=0;d<u.length;d++){const m=new c.F(u[d],s);m.name=`Worker ${d}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,s){const u=[];for(const d of this.actors)u.push(d.sendAsync({type:e,data:s}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,s){for(const u of this.actors)u.registerMessageHandler(e,s)}}function Yt(){return fi||(fi=new bi(qt(),c.G),fi.registerMessageHandler("GR",(g,e,s)=>c.m(e,s))),fi}function Bi(g,e){const s=c.H();return c.J(s,s,[1,1,0]),c.K(s,s,[.5*g.width,.5*g.height,1]),c.L(s,s,g.calculatePosMatrix(e.toUnwrapped()))}function Qi(g,e,s,u,d,m){const w=function(D,V,H){if(D)for(const G of D){const ee=V[G];if(ee&&ee.source===H&&ee.type==="fill-extrusion")return!0}else for(const G in V){const ee=V[G];if(ee.source===H&&ee.type==="fill-extrusion")return!0}return!1}(d&&d.layers,e,g.id),S=m.maxPitchScaleFactor(),k=g.tilesIn(u,S,w);k.sort(hi);const E=[];for(const D of k)E.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,s,g._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,d,m,S,Bi(g.transform,D.tileID))});const z=function(D){const V={},H={};for(const G of D){const ee=G.queryResults,ae=G.wrappedTileID,oe=H[ae]=H[ae]||{};for(const ce in ee){const K=ee[ce],pe=oe[ce]=oe[ce]||{},ge=V[ce]=V[ce]||[];for(const Se of K)pe[Se.featureIndex]||(pe[Se.featureIndex]=!0,ge.push(Se))}}return V}(E);for(const D in z)z[D].forEach(V=>{const H=V.feature,G=g.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=G});return z}function hi(g,e){const s=g.tileID,u=e.tileID;return s.overscaledZ-u.overscaledZ||s.canonical.y-u.canonical.y||s.wrap-u.wrap||s.canonical.x-u.canonical.x}function xi(g,e,s){return c._(this,void 0,void 0,function*(){let u=g;if(g.url?u=(yield c.h(e.transformRequest(g.url,"Source"),s)).data:yield R.frameAsync(s),!u)return null;const d=c.M(c.e(u,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(d.vectorLayerIds=u.vector_layers.map(m=>m.id)),d})}class ke{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.N?new c.N(e.lng,e.lat):c.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.N?new c.N(e.lng,e.lat):c.N.convert(e),this}extend(e){const s=this._sw,u=this._ne;let d,m;if(e instanceof c.N)d=e,m=e;else{if(!(e instanceof ke))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ke.convert(e)):this.extend(c.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.N.convert(e)):this;if(d=e._sw,m=e._ne,!d||!m)return this}return s||u?(s.lng=Math.min(d.lng,s.lng),s.lat=Math.min(d.lat,s.lat),u.lng=Math.max(m.lng,u.lng),u.lat=Math.max(m.lat,u.lat)):(this._sw=new c.N(d.lng,d.lat),this._ne=new c.N(m.lng,m.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:u}=c.N.convert(e);let d=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&d}static convert(e){return e instanceof ke?e:e&&new ke(e)}static fromLngLat(e,s=0){const u=360*s/40075017,d=u/Math.cos(Math.PI/180*e.lat);return new ke(new c.N(e.lng-d,e.lat-u),new c.N(e.lng+d,e.lat+u))}adjustAntiMeridian(){const e=new c.N(this._sw.lng,this._sw.lat),s=new c.N(this._ne.lng,this._ne.lat);return new ke(e,e.lng>s.lng?new c.N(s.lng+360,s.lat):s)}}class dn{constructor(e,s,u){this.bounds=ke.convert(this.validateBounds(e)),this.minzoom=s||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const s=Math.pow(2,e.z),u=Math.floor(c.O(this.bounds.getWest())*s),d=Math.floor(c.Q(this.bounds.getNorth())*s),m=Math.ceil(c.O(this.bounds.getEast())*s),w=Math.ceil(c.Q(this.bounds.getSouth())*s);return e.x>=u&&e.x<m&&e.y>=d&&e.y<w}}class Ii extends c.E{constructor(e,s,u,d){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(s,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield xi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new dn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(s,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,w)=>{e.reloadPromise={resolve:m,reject:w}})}else e.actor=this.dispatcher.getActor(),d="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:d,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,s){if(s&&s.resourceTiming&&(e.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&e.setExpiryData(s),e.loadVectorData(s,this.map.painter),e.reloadPromise){const u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Kt extends c.E{constructor(e,s,u,d){super(),this.id=e,this.dispatcher=u,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},s),c.e(this,c.M(s,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield xi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(c.e(this,e),e.bounds&&(this.tileBounds=new dn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const u=yield ne.getImage(this.map._requestManager.transformRequest(s,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const d=this.map.painter.context,m=d.gl,w=u.data;e.texture=this.map.painter.getTileTexture(w.width),e.texture?e.texture.update(w,{useMipmap:!0}):(e.texture=new we(d,w,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Ei extends Kt{constructor(e,s,u,d){super(e,s,u,d),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(s,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const d=yield ne.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(d&&d.data){const m=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&e.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const w=c.b(m)&&c.U()?m:yield this.readImageNow(m),S={type:this.type,uid:e.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const k=yield e.actor.sendAsync({type:"LDT",data:S});e.dem=k,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(d){if(delete e.abortController,e.aborted)e.state="unloaded";else if(d)throw e.state="errored",d}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const s=e.width+2,u=e.height+2;try{return new c.R({width:s,height:u},yield c.W(e,-1,-1,s,u))}catch{}}return R.getImageData(e,1)})}_getNeighboringTiles(e){const s=e.canonical,u=Math.pow(2,s.z),d=(s.x-1+u)%u,m=s.x===0?e.wrap-1:e.wrap,w=(s.x+1+u)%u,S=s.x+1===u?e.wrap+1:e.wrap,k={};return k[new c.S(e.overscaledZ,m,s.z,d,s.y).key]={backfilled:!1},k[new c.S(e.overscaledZ,S,s.z,w,s.y).key]={backfilled:!1},s.y>0&&(k[new c.S(e.overscaledZ,m,s.z,d,s.y-1).key]={backfilled:!1},k[new c.S(e.overscaledZ,e.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},k[new c.S(e.overscaledZ,S,s.z,w,s.y-1).key]={backfilled:!1}),s.y+1<u&&(k[new c.S(e.overscaledZ,m,s.z,d,s.y+1).key]={backfilled:!1},k[new c.S(e.overscaledZ,e.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},k[new c.S(e.overscaledZ,S,s.z,w,s.y+1).key]={backfilled:!1}),k}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class dr extends c.E{constructor(e,s,u,d){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(d),this._data=s.data,this._options=c.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const m=c.X/this.tileSize;s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*m,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*m,extent:c.X,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:c.X,radius:(s.clusterRadius||50)*m,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,s,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:s,offset:u}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const s=c.e({type:this.type},this.workerOptions);e?s.dataDiff=e:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(R.resolveURL(this._data),"Source"),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:s});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let d=null;u.resourceTiming&&u.resourceTiming[this.id]&&(d=u.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&c.e(m,{resourceTiming:d}),this.fire(new c.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const s=e.actor?"RT":"LT";e.actor=this.actor;const u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const d=yield this.actor.sendAsync({type:s,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(d,this.map.painter,s==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var bn=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Jn extends c.E{constructor(e,s,u,d){super(),this.id=e,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=s}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield ne.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,e&&(this.coordinates=e),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new c.j(s))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const s=e.map(c.Z.fromLngLat);this.tileID=function(d){let m=1/0,w=1/0,S=-1/0,k=-1/0;for(const V of d)m=Math.min(m,V.x),w=Math.min(w,V.y),S=Math.max(S,V.x),k=Math.max(k,V.y);const E=Math.max(S-m,k-w),z=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),D=Math.pow(2,z);return new c.a1(z,Math.floor((m+S)/2*D),Math.floor((w+k)/2*D))}(s),this.minzoom=this.maxzoom=this.tileID.z;const u=s.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,c.X,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,c.X),this._boundsArray.emplaceBack(u[2].x,u[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,bn.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new we(e,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,u=!0)}u&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ia extends Jn{constructor(e,s,u,d){super(e,s,u,d),this.roundZoom=!0,this.type="video",this.options=s}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const s of e.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield c.a3(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new c.j(s))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const s=this.video.seekable;e<s.start(0)||e>s.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,bn.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new we(e,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let u=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,u=!0)}u&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Qn extends Jn{constructor(e,s,u,d){super(e,s,u,d),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(w=>typeof w!="number"))||this.fire(new c.j(new c.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${e}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,u=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,bn.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new we(s,this.canvas,u.RGBA,{premultiply:!0});let d=!1;for(const m in this.tiles){const w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const xt={},Tt=g=>{switch(g){case"geojson":return dr;case"image":return Jn;case"raster":return Kt;case"raster-dem":return Ei;case"vector":return Ii;case"video":return Ia;case"canvas":return Qn}return xt[g]},ze="RTLPluginLoaded";class Vt extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Yt()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(s=>{throw this.status="error",s})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(s,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=R.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(ze))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ut=null;function Qt(){return Ut||(Ut=new Vt),Ut}class Oi{constructor(e,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a4(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,s,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(d,m){const w={};if(!m)return w;for(const S of d){const k=S.layerIds.map(E=>m.getLayer(E)).filter(Boolean);if(k.length!==0){S.layers=k,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(E=>k.filter(z=>z.id===E)[0]));for(const E of k)w[E.id]=S}}return w}(e.buckets,s.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof c.a6){if(this.hasSymbolBuckets=!0,!u)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof c.a6&&m.hasRTLText){this.hasRTLText=!0,Qt().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(d).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const d=this.buckets[u];d.uploadPending()&&d.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new we(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new we(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,u,d,m,w,S,k,E,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:w,tileSize:this.tileSize,pixelPosMatrix:z,transform:k,params:S,queryPadding:this.queryPadding*E},e,s,u):{}}querySourceFeatures(e,s){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const d=u.loadVTLayers(),m=s&&s.sourceLayer?s.sourceLayer:"",w=d._geojsonTileLayer||d[m];if(!w)return;const S=c.a7(s&&s.filter),{z:k,x:E,y:z}=this.tileID.canonical,D={z:k,x:E,y:z};for(let V=0;V<w.length;V++){const H=w.feature(V);if(S.needGeometry){const ae=c.a8(H,!0);if(!S.filter(new c.z(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!S.filter(new c.z(this.tileID.overscaledZ),H))continue;const G=u.getId(H,m),ee=new c.a9(H,k,E,z,G);ee.tile=D,e.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const u=c.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let d=!1;if(this.expirationTime>u)d=!1;else if(s)if(this.expirationTime<s)d=!0;else{const m=this.expirationTime-s;m?this.expirationTime=u+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!s.style.hasLayer(d))continue;const m=this.buckets[d],w=m.layers[0].sourceLayer||"_geojsonTileLayer",S=u[w],k=e[w];if(!S||!k||Object.keys(k).length===0)continue;m.update(k,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=s&&s.style&&s.style.getLayer(d);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<R.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=R.now()+e}setDependencies(e,s){const u={};for(const d of s)u[d]=!0;this.dependencies[e]=u}hasDependency(e,s){for(const u of e){const d=this.dependencies[u];if(d){for(const m of s)if(d[m])return!0}}return!1}}class qe{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,u){const d=e.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:s,timeout:void 0};if(u!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},u)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const u=e.wrapped().key,d=s===void 0?0:this.data[u].indexOf(s),m=this.data[u][d];return this.data[u].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(m.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const u in this.data)for(const d of this.data[u])e(d.value)||s.push(d);for(const u of s)this.remove(u.value.tileID,u)}}class Dt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,u){const d=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][d]=this.stateChanges[e][d]||{},c.e(this.stateChanges[e][d],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==d&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][d]===null){this.deletedStates[e][d]={};for(const m in this.state[e][d])u[m]||(this.deletedStates[e][d][m]=null)}else for(const m in u)this.deletedStates[e]&&this.deletedStates[e][d]&&this.deletedStates[e][d][m]===null&&delete this.deletedStates[e][d][m]}removeFeatureState(e,s,u){if(this.deletedStates[e]===null)return;const d=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&s!==void 0)this.deletedStates[e][d]!==null&&(this.deletedStates[e][d]=this.deletedStates[e][d]||{},this.deletedStates[e][d][u]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][d])for(u in this.deletedStates[e][d]={},this.stateChanges[e][d])this.deletedStates[e][d][u]=null;else this.deletedStates[e][d]=null;else this.deletedStates[e]=null}getState(e,s){const u=String(s),d=c.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][s];if(m===null)return{};for(const w in m)delete d[w]}return d}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const u={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const w in this.stateChanges[d])this.state[d][w]||(this.state[d][w]={}),c.e(this.state[d][w],this.stateChanges[d][w]),m[w]=this.state[d][w];u[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const w in this.state[d])m[w]={},this.state[d][w]={};else for(const w in this.deletedStates[d]){if(this.deletedStates[d][w]===null)this.state[d][w]={};else for(const S of Object.keys(this.deletedStates[d][w]))delete this.state[d][w][S];m[w]=this.state[d][w]}u[d]=u[d]||{},c.e(u[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const d in e)e[d].setFeatureState(u,s)}}class kt extends c.E{constructor(e,s,u){super(),this.id=e,this.dispatcher=u,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,m,w,S)=>{const k=new(Tt(m.type))(d,m,w,S);if(k.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${k.id}`);return k})(e,s,u,this),this._tiles={},this._cache=new qe(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Dt,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,s,u){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,s,u)}catch(d){e.state="errored",d.status!==404?this._source.fire(new c.j(d,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const u=this._tiles[s];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Di).map(e=>e.key)}getRenderableIds(e){const s=[];for(const u in this._tiles)this._isIdRenderable(u,e)&&s.push(this._tiles[u]);return e?s.sort((u,d)=>{const m=u.tileID,w=d.tileID,S=new c.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),k=new c.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-w.overscaledZ||k.y-S.y||k.x-S.x}).map(u=>u.tileID.key):s.map(u=>u.tileID).sort(Di).map(u=>u.key)}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,s){return c._(this,void 0,void 0,function*(){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=s),yield this._loadTile(u,e,s))})}_tileLoaded(e,s,u){e.timeAdded=R.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const s=this.getRenderableIds();for(let d=0;d<s.length;d++){const m=s[d];if(e.neighboringTiles&&e.neighboringTiles[m]){const w=this.getTileByID(m);u(e,w),u(w,e)}}function u(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let w=m.tileID.canonical.x-d.tileID.canonical.x;const S=m.tileID.canonical.y-d.tileID.canonical.y,k=Math.pow(2,d.tileID.canonical.z),E=m.tileID.key;w===0&&S===0||Math.abs(S)>1||(Math.abs(w)>1&&(Math.abs(w+k)===1?w+=k:Math.abs(w-k)===1&&(w-=k)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,w,S),d.neighboringTiles&&d.neighboringTiles[E]&&(d.neighboringTiles[E].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,u,d){for(const m in this._tiles){let w=this._tiles[m];if(d[m]||!w.hasData()||w.tileID.overscaledZ<=s||w.tileID.overscaledZ>u)continue;let S=w.tileID;for(;w&&w.tileID.overscaledZ>s+1;){const E=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[E.key],w&&w.hasData()&&(S=E)}let k=S;for(;k.overscaledZ>s;)if(k=k.scaledTo(k.overscaledZ-1),e[k.key]){d[S.key]=S;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=s?u:null}for(let u=e.overscaledZ-1;u>=s;u--){const d=e.scaledTo(u),m=this._getLoadedTile(d);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const s=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,d=Math.floor(s*u*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const u={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+s),u[m.tileID.key]=m}this._tiles=u;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(e,s,u,d,m,w){const S={},k={},E=Object.keys(e),z=R.now();for(const D of E){const V=e[D],H=this._tiles[D];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=z)continue;const G=this.findLoadedParent(V,s),ee=this.findLoadedSibling(V),ae=G||ee||null;ae&&(this._addTile(ae.tileID),S[ae.tileID.key]=ae.tileID),k[D]=V}this._retainLoadedChildren(k,d,u,e);for(const D in S)e[D]||(this._coveredTiles[D]=!0,e[D]=S[D]);if(w){const D={},V={};for(const H of m)this._tiles[H.key].hasData()?D[H.key]=H:V[H.key]=H;for(const H in V){const G=V[H].children(this._source.maxzoom);this._tiles[G[0].key]&&this._tiles[G[1].key]&&this._tiles[G[2].key]&&this._tiles[G[3].key]&&(D[G[0].key]=e[G[0].key]=G[0],D[G[1].key]=e[G[1].key]=G[1],D[G[2].key]=e[G[2].key]=G[2],D[G[3].key]=e[G[3].key]=G[3],delete V[H])}for(const H in V){const G=V[H],ee=this.findLoadedParent(G,this._source.minzoom),ae=this.findLoadedSibling(G),oe=ee||ae||null;if(oe){D[oe.tileID.key]=e[oe.tileID.key]=oe.tileID;for(const ce in D)D[ce].isChildOf(oe.tileID)&&delete D[ce]}}for(const H in this._tiles)D[H]||(this._coveredTiles[H]=!0)}}update(e,s){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=s,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new c.S(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(u=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(u=u.filter(z=>this._source.hasTile(z)))):u=[];const d=e.coveringZoomLevel(this._source),m=Math.max(d-kt.maxOverzooming,this._source.minzoom),w=Math.max(d+kt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const D of u)if(D.canonical.z>this._source.minzoom){const V=D.scaledTo(D.canonical.z-1);z[V.key]=V;const H=D.scaledTo(Math.max(this._source.minzoom,Math.min(D.canonical.z,5)));z[H.key]=H}u=u.concat(Object.values(z))}const S=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(u,d);Fn(this._source.type)&&this._updateCoveredAndRetainedTiles(k,m,w,d,u,s);for(const z in k)this._tiles[z].clearFadeHold();const E=c.ab(this._tiles,k);for(const z of E){const D=this._tiles[z];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,s){var u;const d={},m={},w=Math.max(s-kt.maxOverzooming,this._source.minzoom),S=Math.max(s+kt.maxUnderzooming,this._source.minzoom),k={};for(const E of e){const z=this._addTile(E);d[E.key]=E,z.hasData()||s<this._source.maxzoom&&(k[E.key]=E)}this._retainLoadedChildren(k,s,S,d);for(const E of e){let z=this._tiles[E.key];if(z.hasData())continue;if(s+1>this._source.maxzoom){const V=E.children(this._source.maxzoom)[0],H=this.getTile(V);if(H&&H.hasData()){d[V.key]=V;continue}}else{const V=E.children(this._source.maxzoom);if(d[V[0].key]&&d[V[1].key]&&d[V[2].key]&&d[V[3].key])continue}let D=z.wasRequested();for(let V=E.overscaledZ-1;V>=w;--V){const H=E.scaledTo(V);if(m[H.key])break;if(m[H.key]=!0,z=this.getTile(H),!z&&D&&(z=this._addTile(H)),z){const G=z.hasData();if((G||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||D)&&(d[H.key]=H),D=z.wasRequested(),G)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let u,d=this._tiles[e].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){u=this._loadedParentTiles[d.key];break}s.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(u=this._getLoadedTile(m),u)break;d=m}for(const m of s)this._loadedParentTiles[m]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const s=this._tiles[e].tileID,u=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=u}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const u=s;return s||(s=new Oi(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(s,e.key,s.state)),s.uses++,this._tiles[e.key]=s,u||this._source.fire(new c.k("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=s.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(e){const s=e.sourceDataType;e.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&s==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,s,u){const d=[],m=this.transform;if(!m)return d;const w=u?m.getCameraQueryGeometry(e):e,S=e.map(G=>m.pointCoordinate(G,this.terrain)),k=w.map(G=>m.pointCoordinate(G,this.terrain)),E=this.getIds();let z=1/0,D=1/0,V=-1/0,H=-1/0;for(const G of k)z=Math.min(z,G.x),D=Math.min(D,G.y),V=Math.max(V,G.x),H=Math.max(H,G.y);for(let G=0;G<E.length;G++){const ee=this._tiles[E[G]];if(ee.holdingForFade())continue;const ae=ee.tileID,oe=Math.pow(2,m.zoom-ee.tileID.overscaledZ),ce=s*ee.queryPadding*c.X/ee.tileSize/oe,K=[ae.getTilePoint(new c.Z(z,D)),ae.getTilePoint(new c.Z(V,H))];if(K[0].x-ce<c.X&&K[0].y-ce<c.X&&K[1].x+ce>=0&&K[1].y+ce>=0){const pe=S.map(Se=>ae.getTilePoint(Se)),ge=k.map(Se=>ae.getTilePoint(Se));d.push({tile:ee,tileID:ae,queryGeometry:pe,cameraQueryGeometry:ge,scale:oe})}}return d}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);for(const u of s)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(Fn(this._source.type)){const e=R.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=e)return!0}return!1}setFeatureState(e,s,u){this._state.updateState(e=e||"_geojsonTileLayer",s,u)}removeFeatureState(e,s,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,u)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,u){const d=this._tiles[e];d&&d.setDependencies(s,u)}reloadTilesForDependencies(e,s){for(const u in this._tiles)this._tiles[u].hasDependency(e,s)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,s))}}function Di(g,e){const s=Math.abs(2*g.wrap)-+(g.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return g.overscaledZ-e.overscaledZ||u-s||e.canonical.y-g.canonical.y||e.canonical.x-g.canonical.x}function Fn(g){return g==="raster"||g==="image"||g==="video"}kt.maxOverzooming=10,kt.maxUnderzooming=3;class Bt{constructor(e,s){this.reset(e,s)}reset(e,s){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ac(e,0,1);let s=1,u=this._distances[s];const d=e*this.paddedLength+this.padding;for(;u<d&&s<this._distances.length;)u=this._distances[++s];const m=s-1,w=this._distances[m],S=u-w,k=S>0?(d-w)/S:0;return this.points[m].mult(1-k).add(this.points[s].mult(k))}}function An(g,e){let s=!0;return g==="always"||g!=="never"&&e!=="never"||(s=!1),s}class Ar{constructor(e,s,u){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(s/u);for(let w=0;w<this.xCellCount*this.yCellCount;w++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=s,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,s,u,d,m){this._forEachCell(s,u,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(e,s,u,d){this._forEachCell(s-d,u-d,s+d,u+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(s),this.circles.push(u),this.circles.push(d)}_insertBoxCell(e,s,u,d,m,w){this.boxCells[m].push(w)}_insertCircleCell(e,s,u,d,m,w){this.circleCells[m].push(w)}_query(e,s,u,d,m,w,S){if(u<0||e>this.width||d<0||s>this.height)return[];const k=[];if(e<=0&&s<=0&&this.width<=u&&this.height<=d){if(m)return[{key:null,x1:e,y1:s,x2:u,y2:d}];for(let E=0;E<this.boxKeys.length;E++)k.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const z=this.circles[3*E],D=this.circles[3*E+1],V=this.circles[3*E+2];k.push({key:this.circleKeys[E],x1:z-V,y1:D-V,x2:z+V,y2:D+V})}}else this._forEachCell(e,s,u,d,this._queryCell,k,{hitTest:m,overlapMode:w,seenUids:{box:{},circle:{}}},S);return k}query(e,s,u,d){return this._query(e,s,u,d,!1,null)}hitTest(e,s,u,d,m,w){return this._query(e,s,u,d,!0,m,w).length>0}hitTestCircle(e,s,u,d,m){const w=e-u,S=e+u,k=s-u,E=s+u;if(S<0||w>this.width||E<0||k>this.height)return!1;const z=[];return this._forEachCell(w,k,S,E,this._queryCellCircle,z,{hitTest:!0,overlapMode:d,circle:{x:e,y:s,radius:u},seenUids:{box:{},circle:{}}},m),z.length>0}_queryCell(e,s,u,d,m,w,S,k){const{seenUids:E,hitTest:z,overlapMode:D}=S,V=this.boxCells[m];if(V!==null){const G=this.bboxes;for(const ee of V)if(!E.box[ee]){E.box[ee]=!0;const ae=4*ee,oe=this.boxKeys[ee];if(e<=G[ae+2]&&s<=G[ae+3]&&u>=G[ae+0]&&d>=G[ae+1]&&(!k||k(oe))&&(!z||!An(D,oe.overlapMode))&&(w.push({key:oe,x1:G[ae],y1:G[ae+1],x2:G[ae+2],y2:G[ae+3]}),z))return!0}}const H=this.circleCells[m];if(H!==null){const G=this.circles;for(const ee of H)if(!E.circle[ee]){E.circle[ee]=!0;const ae=3*ee,oe=this.circleKeys[ee];if(this._circleAndRectCollide(G[ae],G[ae+1],G[ae+2],e,s,u,d)&&(!k||k(oe))&&(!z||!An(D,oe.overlapMode))){const ce=G[ae],K=G[ae+1],pe=G[ae+2];if(w.push({key:oe,x1:ce-pe,y1:K-pe,x2:ce+pe,y2:K+pe}),z)return!0}}}return!1}_queryCellCircle(e,s,u,d,m,w,S,k){const{circle:E,seenUids:z,overlapMode:D}=S,V=this.boxCells[m];if(V!==null){const G=this.bboxes;for(const ee of V)if(!z.box[ee]){z.box[ee]=!0;const ae=4*ee,oe=this.boxKeys[ee];if(this._circleAndRectCollide(E.x,E.y,E.radius,G[ae+0],G[ae+1],G[ae+2],G[ae+3])&&(!k||k(oe))&&!An(D,oe.overlapMode))return w.push(!0),!0}}const H=this.circleCells[m];if(H!==null){const G=this.circles;for(const ee of H)if(!z.circle[ee]){z.circle[ee]=!0;const ae=3*ee,oe=this.circleKeys[ee];if(this._circlesCollide(G[ae],G[ae+1],G[ae+2],E.x,E.y,E.radius)&&(!k||k(oe))&&!An(D,oe.overlapMode))return w.push(!0),!0}}}_forEachCell(e,s,u,d,m,w,S,k){const E=this._convertToXCellCoord(e),z=this._convertToYCellCoord(s),D=this._convertToXCellCoord(u),V=this._convertToYCellCoord(d);for(let H=E;H<=D;H++)for(let G=z;G<=V;G++)if(m.call(this,e,s,u,d,this.xCellCount*G+H,w,S,k))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,s,u,d,m,w){const S=d-e,k=m-s,E=u+w;return E*E>S*S+k*k}_circleAndRectCollide(e,s,u,d,m,w,S){const k=(w-d)/2,E=Math.abs(e-(d+k));if(E>k+u)return!1;const z=(S-m)/2,D=Math.abs(s-(m+z));if(D>z+u)return!1;if(E<=k||D<=z)return!0;const V=E-k,H=D-z;return V*V+H*H<=u*u}}function Ur(g,e,s,u,d){const m=c.H();return e?(c.K(m,m,[1/d,1/d,1]),s||c.ad(m,m,u.angle)):c.L(m,u.labelPlaneMatrix,g),m}function En(g,e,s,u,d){if(e){const m=c.ae(g);return c.K(m,m,[d,d,1]),s||c.ad(m,m,-u.angle),m}return u.glCoordMatrix}function ie(g,e,s,u){let d;u?(d=[g,e,u(g,e),1],c.af(d,d,s)):(d=[g,e,0,1],mi(d,d,s));const m=d[3];return{point:new c.P(d[0]/m,d[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function F(g,e){return .5+g/e*.5}function N(g,e){return g.x>=-e[0]&&g.x<=e[0]&&g.y>=-e[1]&&g.y<=e[1]}function W(g,e,s,u,d,m,w,S,k,E,z,D,V,H,G){const ee=u?g.textSizeData:g.iconSizeData,ae=c.ag(ee,s.transform.zoom),oe=[256/s.width*2+1,256/s.height*2+1],ce=u?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ce.clear();const K=g.lineVertexArray,pe=u?g.text.placedSymbolArray:g.icon.placedSymbolArray,ge=s.transform.width/s.transform.height;let Se=!1;for(let je=0;je<pe.length;je++){const Ze=pe.get(je);if(Ze.hidden||Ze.writingMode===c.ah.vertical&&!Se){Pt(Ze.numGlyphs,ce);continue}Se=!1;const at=ie(Ze.anchorX,Ze.anchorY,e,G);if(!N(at.point,oe)){Pt(Ze.numGlyphs,ce);continue}const dt=F(s.transform.cameraToCenterDistance,at.signedDistanceFromCamera),Qe=c.ai(ee,ae,Ze),Je=w?Qe/dt:Qe*dt,vt={getElevation:G,labelPlaneMatrix:d,lineVertexArray:K,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:E,tileAnchorPoint:new c.P(Ze.anchorX,Ze.anchorY),unwrappedTileID:z,width:D,height:V,translation:H},$t=me(vt,Ze,Je,!1,S,e,m,g.glyphOffsetArray,ce,ge,k);Se=$t.useVertical,($t.notEnoughRoom||Se||$t.needsFlipping&&me(vt,Ze,Je,!0,S,e,m,g.glyphOffsetArray,ce,ge,k).notEnoughRoom)&&Pt(Ze.numGlyphs,ce)}u?g.text.dynamicLayoutVertexBuffer.updateData(ce):g.icon.dynamicLayoutVertexBuffer.updateData(ce)}function Q(g,e,s,u,d,m,w,S){const k=m.glyphStartIndex+m.numGlyphs,E=m.lineStartIndex,z=m.lineStartIndex+m.lineLength,D=e.getoffsetX(m.glyphStartIndex),V=e.getoffsetX(k-1),H=Ke(g*D,s,u,d,m.segment,E,z,S,w);if(!H)return null;const G=Ke(g*V,s,u,d,m.segment,E,z,S,w);return G?S.projectionCache.anyProjectionOccluded?null:{first:H,last:G}:null}function he(g,e,s,u){return g===c.ah.horizontal&&Math.abs(s.y-e.y)>Math.abs(s.x-e.x)*u?{useVertical:!0}:(g===c.ah.vertical?e.y<s.y:e.x>s.x)?{needsFlipping:!0}:null}function me(g,e,s,u,d,m,w,S,k,E,z){const D=s/24,V=e.lineOffsetX*D,H=e.lineOffsetY*D;let G;if(e.numGlyphs>1){const ee=e.glyphStartIndex+e.numGlyphs,ae=e.lineStartIndex,oe=e.lineStartIndex+e.lineLength,ce=Q(D,S,V,H,u,e,z,g);if(!ce)return{notEnoughRoom:!0};const K=ie(ce.first.point.x,ce.first.point.y,w,g.getElevation).point,pe=ie(ce.last.point.x,ce.last.point.y,w,g.getElevation).point;if(d&&!u){const ge=he(e.writingMode,K,pe,E);if(ge)return ge}G=[ce.first];for(let ge=e.glyphStartIndex+1;ge<ee-1;ge++)G.push(Ke(D*S.getoffsetX(ge),V,H,u,e.segment,ae,oe,g,z));G.push(ce.last)}else{if(d&&!u){const ae=ie(g.tileAnchorPoint.x,g.tileAnchorPoint.y,m,g.getElevation).point,oe=e.lineStartIndex+e.segment+1,ce=new c.P(g.lineVertexArray.getx(oe),g.lineVertexArray.gety(oe)),K=ie(ce.x,ce.y,m,g.getElevation),pe=K.signedDistanceFromCamera>0?K.point:function(Se,je,Ze,at,dt,Qe){return ve(Se,je,Ze,1,dt,Qe)}(g.tileAnchorPoint,ce,ae,0,m,g),ge=he(e.writingMode,ae,pe,E);if(ge)return ge}const ee=Ke(D*S.getoffsetX(e.glyphStartIndex),V,H,u,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,g,z);if(!ee||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};G=[ee]}for(const ee of G)c.aj(k,ee.point,ee.angle);return{}}function ve(g,e,s,u,d,m){const w=g.add(g.sub(e)._unit()),S=d!==void 0?ie(w.x,w.y,d,m.getElevation).point:Pe(w.x,w.y,m).point,k=s.sub(S);return s.add(k._mult(u/k.mag()))}function le(g,e,s){const u=e.projectionCache;if(u.projections[g])return u.projections[g];const d=new c.P(e.lineVertexArray.getx(g),e.lineVertexArray.gety(g)),m=Pe(d.x,d.y,e);if(m.signedDistanceFromCamera>0)return u.projections[g]=m.point,u.anyProjectionOccluded=u.anyProjectionOccluded||m.isOccluded,m.point;const w=g-s.direction;return function(S,k,E,z,D){return ve(S,k,E,z,void 0,D)}(s.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(w),e.lineVertexArray.gety(w)),d,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,e)}function Pe(g,e,s){const u=g+s.translation[0],d=e+s.translation[1];let m;return!s.pitchWithMap&&s.projection.useSpecialProjectionForSymbols?(m=s.projection.projectTileCoordinates(u,d,s.unwrappedTileID,s.getElevation),m.point.x=(.5*m.point.x+.5)*s.width,m.point.y=(.5*-m.point.y+.5)*s.height):(m=ie(u,d,s.labelPlaneMatrix,s.getElevation),m.isOccluded=!1),m}function Ve(g,e,s){return g._unit()._perp()._mult(e*s)}function Ie(g,e,s,u,d,m,w,S,k){if(S.projectionCache.offsets[g])return S.projectionCache.offsets[g];const E=s.add(e);if(g+k.direction<u||g+k.direction>=d)return S.projectionCache.offsets[g]=E,E;const z=le(g+k.direction,S,k),D=Ve(z.sub(s),w,k.direction),V=s.add(D),H=z.add(D);return S.projectionCache.offsets[g]=c.ak(m,E,V,H)||E,S.projectionCache.offsets[g]}function Ke(g,e,s,u,d,m,w,S,k){const E=u?g-e:g+e;let z=E>0?1:-1,D=0;u&&(z*=-1,D=Math.PI),z<0&&(D+=Math.PI);let V,H=z>0?m+d:m+d+1;S.projectionCache.cachedAnchorPoint?V=S.projectionCache.cachedAnchorPoint:(V=Pe(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=V);let G,ee,ae=V,oe=V,ce=0,K=0;const pe=Math.abs(E),ge=[];let Se;for(;ce+K<=pe;){if(H+=z,H<m||H>=w)return null;ce+=K,oe=ae,ee=G;const at={absOffsetX:pe,direction:z,distanceFromAnchor:ce,previousVertex:oe};if(ae=le(H,S,at),s===0)ge.push(oe),Se=ae.sub(oe);else{let dt;const Qe=ae.sub(oe);dt=Qe.mag()===0?Ve(le(H+z,S,at).sub(ae),s,z):Ve(Qe,s,z),ee||(ee=oe.add(dt)),G=Ie(H,dt,ae,m,w,ee,s,S,at),ge.push(ee),Se=G.sub(ee)}K=Se.mag()}const je=Se._mult((pe-ce)/K)._add(ee||oe),Ze=D+Math.atan2(ae.y-oe.y,ae.x-oe.x);return ge.push(je),{point:je,angle:k?Ze:0,path:ge}}const It=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Pt(g,e){for(let s=0;s<g;s++){const u=e.length;e.resize(u+4),e.float32.set(It,3*u)}}function mi(g,e,s){const u=e[0],d=e[1];return g[0]=s[0]*u+s[4]*d+s[12],g[1]=s[1]*u+s[5]*d+s[13],g[3]=s[3]*u+s[7]*d+s[15],g}const Gt=100;class gi{constructor(e,s,u=new Ar(e.width+200,e.height+200,25),d=new Ar(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=s,this.grid=u,this.ignoredGrid=d,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Gt,this.screenBottomBoundary=e.height+Gt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,s,u,d,m,w,S,k,E,z,D){const V=e.anchorPointX+k[0],H=e.anchorPointY+k[1],G=this.projectAndGetPerspectiveRatio(d,V,H,m,z),ee=u*G.perspectiveRatio;let ae;if(w||S)ae=this._projectCollisionBox(e,ee,d,m,w,S,k,G,z,D);else{const ge=G.point.x+(D?D.x*ee:0),Se=G.point.y+(D?D.y*ee:0);ae={allPointsOccluded:!1,box:[ge+e.x1*ee,Se+e.y1*ee,ge+e.x2*ee,Se+e.y2*ee]}}const[oe,ce,K,pe]=ae.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?ae.allPointsOccluded:this.mapProjection.isOccluded(V,H,m))||G.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(oe,ce,K,pe)||s!=="always"&&this.grid.hitTest(oe,ce,K,pe,s,E)?{box:[oe,ce,K,pe],placeable:!1,offscreen:!1}:{box:[oe,ce,K,pe],placeable:!0,offscreen:this.isOffscreen(oe,ce,K,pe)}}placeCollisionCircles(e,s,u,d,m,w,S,k,E,z,D,V,H,G,ee,ae){const oe=[],ce=new c.P(s.anchorX,s.anchorY),K=this.getPerspectiveRatio(w,ce.x,ce.y,S,ae),pe=(D?m/K:m*K)/c.ap,ge={getElevation:ae,labelPlaneMatrix:k,lineVertexArray:u,pitchWithMap:D,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ce,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:ee},Se=Q(pe,d,s.lineOffsetX*pe,s.lineOffsetY*pe,!1,s,!1,ge);let je=!1,Ze=!1,at=!0;if(Se){const dt=.5*H*K+G,Qe=new c.P(-100,-100),Je=new c.P(this.screenRightBoundary,this.screenBottomBoundary),vt=new Bt,$t=Se.first,it=Se.last;let lt=[];for(let Jt=$t.path.length-1;Jt>=1;Jt--)lt.push($t.path[Jt]);for(let Jt=1;Jt<it.path.length;Jt++)lt.push(it.path[Jt]);const Ot=2.5*dt;if(E){const Jt=this.projectPathToScreenSpace(lt,ge,E);lt=Jt.some(ci=>ci.signedDistanceFromCamera<=0)?[]:Jt.map(ci=>ci.point)}let Zi=[];if(lt.length>0){const Jt=lt[0].clone(),ci=lt[0].clone();for(let Xi=1;Xi<lt.length;Xi++)Jt.x=Math.min(Jt.x,lt[Xi].x),Jt.y=Math.min(Jt.y,lt[Xi].y),ci.x=Math.max(ci.x,lt[Xi].x),ci.y=Math.max(ci.y,lt[Xi].y);Zi=Jt.x>=Qe.x&&ci.x<=Je.x&&Jt.y>=Qe.y&&ci.y<=Je.y?[lt]:ci.x<Qe.x||Jt.x>Je.x||ci.y<Qe.y||Jt.y>Je.y?[]:c.al([lt],Qe.x,Qe.y,Je.x,Je.y)}for(const Jt of Zi){vt.reset(Jt,.25*dt);let ci=0;ci=vt.length<=.5*dt?1:Math.ceil(vt.paddedLength/Ot)+1;for(let Xi=0;Xi<ci;Xi++){const Hn=Xi/Math.max(ci-1,1),Yr=vt.lerp(Hn),Yi=Yr.x+Gt,yr=Yr.y+Gt;oe.push(Yi,yr,dt,0);const ir=Yi-dt,nr=yr-dt,rr=Yi+dt,ua=yr+dt;if(at=at&&this.isOffscreen(ir,nr,rr,ua),Ze=Ze||this.isInsideGrid(ir,nr,rr,ua),e!=="always"&&this.grid.hitTestCircle(Yi,yr,dt,e,V)&&(je=!0,!z))return{circles:[],offscreen:!1,collisionDetected:je}}}}return{circles:!z&&je||!Ze||K<this.perspectiveRatioCutoff?[]:oe,offscreen:at,collisionDetected:je}}projectPathToScreenSpace(e,s,u){return e.map(d=>ie(d.x,d.y,u,s.getElevation))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let u=1/0,d=1/0,m=-1/0,w=-1/0;for(const z of e){const D=new c.P(z.x+Gt,z.y+Gt);u=Math.min(u,D.x),d=Math.min(d,D.y),m=Math.max(m,D.x),w=Math.max(w,D.y),s.push(D)}const S=this.grid.query(u,d,m,w).concat(this.ignoredGrid.query(u,d,m,w)),k={},E={};for(const z of S){const D=z.key;if(k[D.bucketInstanceId]===void 0&&(k[D.bucketInstanceId]={}),k[D.bucketInstanceId][D.featureIndex])continue;const V=[new c.P(z.x1,z.y1),new c.P(z.x2,z.y1),new c.P(z.x2,z.y2),new c.P(z.x1,z.y2)];c.am(s,V)&&(k[D.bucketInstanceId][D.featureIndex]=!0,E[D.bucketInstanceId]===void 0&&(E[D.bucketInstanceId]=[]),E[D.bucketInstanceId].push(D.featureIndex))}return E}insertCollisionBox(e,s,u,d,m,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:w,overlapMode:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,s,u,d,m,w){const S=u?this.ignoredGrid:this.grid,k={bucketInstanceId:d,featureIndex:m,collisionGroupID:w,overlapMode:s};for(let E=0;E<e.length;E+=4)S.insertCircle(k,e[E],e[E+1],e[E+2])}projectAndGetPerspectiveRatio(e,s,u,d,m){let w;m?(w=[s,u,m(s,u),1],c.af(w,w,e)):(w=[s,u,0,1],mi(w,w,e));const S=w[3];return{point:new c.P((w[0]/S+1)/2*this.transform.width+Gt,(-w[1]/S+1)/2*this.transform.height+Gt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/S*.5,isOccluded:!1,signedDistanceFromCamera:S}}getPerspectiveRatio(e,s,u,d,m){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(s,u,d,m):ie(s,u,e,m);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(e,s,u,d){return u<Gt||e>=this.screenRightBoundary||d<Gt||s>this.screenBottomBoundary}isInsideGrid(e,s,u,d){return u>=0&&e<this.gridRightBoundary&&d>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const e=c.an([]);return c.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,s,u,d,m,w,S,k,E,z){let D=new c.P(1,0),V=new c.P(0,1);const H=new c.P(e.anchorPointX+S[0],e.anchorPointY+S[1]);if(w&&!m){const at=this.projectAndGetPerspectiveRatio(u,H.x+1,H.y,d,E).point.sub(k.point).unit(),dt=Math.atan(at.y/at.x)+(at.x<0?Math.PI:0),Qe=Math.sin(dt),Je=Math.cos(dt);D=new c.P(Je,Qe),V=new c.P(-Qe,Je)}else if(!w&&m){const at=-this.transform.angle,dt=Math.sin(at),Qe=Math.cos(at);D=new c.P(Qe,dt),V=new c.P(-dt,Qe)}let G=k.point,ee=s;if(m){G=H;const at=this.transform.zoom-Math.floor(this.transform.zoom);ee=Math.pow(2,-at),ee*=this.mapProjection.getPitchedTextCorrection(this.transform,H,d),z||(ee*=c.ac(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}z&&(G=G.add(D.mult(z.x*ee)).add(V.mult(z.y*ee)));const ae=e.x1*ee,oe=e.x2*ee,ce=(ae+oe)/2,K=e.y1*ee,pe=e.y2*ee,ge=(K+pe)/2,Se=[{offsetX:ae,offsetY:K},{offsetX:ce,offsetY:K},{offsetX:oe,offsetY:K},{offsetX:oe,offsetY:ge},{offsetX:oe,offsetY:pe},{offsetX:ce,offsetY:pe},{offsetX:ae,offsetY:pe},{offsetX:ae,offsetY:ge}];let je=[];for(const{offsetX:at,offsetY:dt}of Se)je.push(new c.P(G.x+D.x*at+V.x*dt,G.y+D.y*at+V.y*dt));let Ze=!1;if(m){const at=je.map(dt=>this.projectAndGetPerspectiveRatio(u,dt.x,dt.y,d,E));Ze=at.some(dt=>!dt.isOccluded),je=at.map(dt=>dt.point)}else Ze=!0;return{box:c.ao(je),allPointsOccluded:!Ze}}}function oi(g,e,s){return e*(c.X/(g.tileSize*Math.pow(2,s-g.tileID.overscaledZ)))}class xn{constructor(e,s,u,d){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?s:-s))):d&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class nn{constructor(e,s,u,d,m){this.text=new xn(e?e.text:null,s,u,m),this.icon=new xn(e?e.icon:null,s,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ti{constructor(e,s,u){this.text=e,this.icon=s,this.skipFade=u}}class Li{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class en{constructor(e,s,u,d,m){this.bucketInstanceId=e,this.featureIndex=s,this.sourceLayerIndex=u,this.bucketIndex=d,this.tileID=m}}class Cn{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const s=++this.maxGroupID;this.collisionGroups[e]={ID:s,predicate:u=>u.collisionGroupID===s}}return this.collisionGroups[e]}}function Nn(g,e,s,u,d){const{horizontalAlign:m,verticalAlign:w}=c.au(g);return new c.P(-(m-.5)*e+u[0]*d,-(w-.5)*s+u[1]*d)}class er{constructor(e,s,u,d,m,w){this.transform=e.clone(),this.terrain=u,this.collisionIndex=new gi(this.transform,s),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Cn(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const s=this.terrain;return s?(u,d)=>s.getElevation(e,u,d):null}getBucketParts(e,s,u,d){const m=u.getBucket(s),w=u.latestFeatureIndex;if(!m||!w||s.id!==m.layerIds[0])return;const S=u.collisionBoxArray,k=m.layers[0].layout,E=m.layers[0].paint,z=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),D=u.tileSize/c.X,V=u.tileID.toUnwrapped(),H=this.transform.calculatePosMatrix(V),G=k.get("text-pitch-alignment")==="map",ee=k.get("text-rotation-alignment")==="map",ae=oi(u,1,this.transform.zoom),oe=this.collisionIndex.mapProjection.translatePosition(this.transform,u,E.get("text-translate"),E.get("text-translate-anchor")),ce=this.collisionIndex.mapProjection.translatePosition(this.transform,u,E.get("icon-translate"),E.get("icon-translate-anchor")),K=Ur(H,G,ee,this.transform,ae);let pe=null;if(G){const Se=En(H,G,ee,this.transform,ae);pe=c.L([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[m.bucketInstanceId]=new en(m.bucketInstanceId,w,m.sourceLayerIndex,m.index,u.tileID);const ge={bucket:m,layout:k,translationText:oe,translationIcon:ce,posMatrix:H,unwrappedTileID:V,textLabelPlaneMatrix:K,labelToScreenMatrix:pe,scale:z,textPixelRatio:D,holdingForFade:u.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:c.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const Se of m.sortKeyRanges){const{sortKey:je,symbolInstanceStart:Ze,symbolInstanceEnd:at}=Se;e.push({sortKey:je,symbolInstanceStart:Ze,symbolInstanceEnd:at,parameters:ge})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:ge})}attemptAnchorPlacement(e,s,u,d,m,w,S,k,E,z,D,V,H,G,ee,ae,oe,ce,K){const pe=c.aq[e.textAnchor],ge=[e.textOffset0,e.textOffset1],Se=Nn(pe,u,d,ge,m),je=this.collisionIndex.placeCollisionBox(s,V,k,E,z,S,w,ae,D.predicate,K,Se);if((!ce||this.collisionIndex.placeCollisionBox(ce,V,k,E,z,S,w,oe,D.predicate,K,Se).placeable)&&je.placeable){let Ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Ze=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:ge,width:u,height:d,anchor:pe,textBoxScale:m,prevAnchor:Ze},this.markUsedJustification(G,pe,H,ee),G.allowVerticalPlacement&&(this.markUsedOrientation(G,ee,H),this.placedOrientations[H.crossTileID]=ee),{shift:Se,placedGlyphBoxes:je}}}placeLayerBucketPart(e,s,u){const{bucket:d,layout:m,translationText:w,translationIcon:S,posMatrix:k,unwrappedTileID:E,textLabelPlaneMatrix:z,labelToScreenMatrix:D,textPixelRatio:V,holdingForFade:H,collisionBoxArray:G,partiallyEvaluatedTextSize:ee,collisionGroup:ae}=e.parameters,oe=m.get("text-optional"),ce=m.get("icon-optional"),K=c.ar(m,"text-overlap","text-allow-overlap"),pe=K==="always",ge=c.ar(m,"icon-overlap","icon-allow-overlap"),Se=ge==="always",je=m.get("text-rotation-alignment")==="map",Ze=m.get("text-pitch-alignment")==="map",at=m.get("icon-text-fit")!=="none",dt=m.get("symbol-z-order")==="viewport-y",Qe=pe&&(Se||!d.hasIconData()||ce),Je=Se&&(pe||!d.hasTextData()||oe);!d.collisionArrays&&G&&d.deserializeCollisionBoxes(G);const vt=this._getTerrainElevationFunc(this.retainedQueryData[d.bucketInstanceId].tileID),$t=(it,lt,Ot)=>{var Zi,Jt;if(s[it.crossTileID])return;if(H)return void(this.placements[it.crossTileID]=new ti(!1,!1,!1));let ci=!1,Xi=!1,Hn=!0,Yr=null,Yi={box:null,placeable:!1,offscreen:null},yr={box:null,placeable:!1,offscreen:null},ir=null,nr=null,rr=null,ua=0,Fs=0,jl=0;lt.textFeatureIndex?ua=lt.textFeatureIndex:it.useRuntimeCollisionCircles&&(ua=it.featureIndex),lt.verticalTextFeatureIndex&&(Fs=lt.verticalTextFeatureIndex);const Kr=lt.textBox;if(Kr){const Cr=ar=>{let qn=c.ah.horizontal;if(d.allowVerticalPlacement&&!ar&&this.prevPlacement){const Fi=this.prevPlacement.placedOrientations[it.crossTileID];Fi&&(this.placedOrientations[it.crossTileID]=Fi,qn=Fi,this.markUsedOrientation(d,qn,it))}return qn},Jr=(ar,qn)=>{if(d.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&lt.verticalTextBox){for(const Fi of d.writingModes)if(Fi===c.ah.vertical?(Yi=qn(),yr=Yi):Yi=ar(),Yi&&Yi.placeable)break}else Yi=ar()},Pr=it.textAnchorOffsetStartIndex,La=it.textAnchorOffsetEndIndex;if(La===Pr){const ar=(qn,Fi)=>{const rn=this.collisionIndex.placeCollisionBox(qn,K,V,k,E,Ze,je,w,ae.predicate,vt);return rn&&rn.placeable&&(this.markUsedOrientation(d,Fi,it),this.placedOrientations[it.crossTileID]=Fi),rn};Jr(()=>ar(Kr,c.ah.horizontal),()=>{const qn=lt.verticalTextBox;return d.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&qn?ar(qn,c.ah.vertical):{box:null,offscreen:null}}),Cr(Yi&&Yi.placeable)}else{let ar=c.aq[(Jt=(Zi=this.prevPlacement)===null||Zi===void 0?void 0:Zi.variableOffsets[it.crossTileID])===null||Jt===void 0?void 0:Jt.anchor];const qn=(rn,ya,Ns)=>{const $l=rn.x2-rn.x1,gp=rn.y2-rn.y1,ud=it.textBoxScale,hd=at&&ge==="never"?ya:null;let ss=null,Ul=K==="never"?1:2,jo="never";ar&&Ul++;for(let _u=0;_u<Ul;_u++){for(let Vo=Pr;Vo<La;Vo++){const $o=d.textAnchorOffsets.get(Vo);if(ar&&$o.textAnchor!==ar)continue;const _a=this.attemptAnchorPlacement($o,rn,$l,gp,ud,je,Ze,V,k,E,ae,jo,it,d,Ns,w,S,hd,vt);if(_a&&(ss=_a.placedGlyphBoxes,ss&&ss.placeable))return ci=!0,Yr=_a.shift,ss}ar?ar=null:jo=K}return u&&!ss&&(ss={box:this.collisionIndex.placeCollisionBox(Kr,"always",V,k,E,Ze,je,w,ae.predicate,vt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),ss};Jr(()=>qn(Kr,lt.iconBox,c.ah.horizontal),()=>{const rn=lt.verticalTextBox;return d.allowVerticalPlacement&&(!Yi||!Yi.placeable)&&it.numVerticalGlyphVertices>0&&rn?qn(rn,lt.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Yi&&(ci=Yi.placeable,Hn=Yi.offscreen);const Fi=Cr(Yi&&Yi.placeable);if(!ci&&this.prevPlacement){const rn=this.prevPlacement.variableOffsets[it.crossTileID];rn&&(this.variableOffsets[it.crossTileID]=rn,this.markUsedJustification(d,rn.anchor,it,Fi))}}}if(ir=Yi,ci=ir&&ir.placeable,Hn=ir&&ir.offscreen,it.useRuntimeCollisionCircles){const Cr=d.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),Jr=c.ai(d.textSizeData,ee,Cr),Pr=m.get("text-padding");nr=this.collisionIndex.placeCollisionCircles(K,Cr,d.lineVertexArray,d.glyphOffsetArray,Jr,k,E,z,D,u,Ze,ae.predicate,it.collisionCircleDiameter,Pr,w,vt),nr.circles.length&&nr.collisionDetected&&!u&&c.w("Collisions detected, but collision boxes are not shown"),ci=pe||nr.circles.length>0&&!nr.collisionDetected,Hn=Hn&&nr.offscreen}if(lt.iconFeatureIndex&&(jl=lt.iconFeatureIndex),lt.iconBox){const Cr=Jr=>this.collisionIndex.placeCollisionBox(Jr,ge,V,k,E,Ze,je,S,ae.predicate,vt,at&&Yr?Yr:void 0);yr&&yr.placeable&&lt.verticalIconBox?(rr=Cr(lt.verticalIconBox),Xi=rr.placeable):(rr=Cr(lt.iconBox),Xi=rr.placeable),Hn=Hn&&rr.offscreen}const as=oe||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,Vl=ce||it.numIconVertices===0;as||Vl?Vl?as||(Xi=Xi&&ci):ci=Xi&&ci:Xi=ci=Xi&&ci;const yu=Xi&&rr.placeable;if(ci&&ir.placeable&&this.collisionIndex.insertCollisionBox(ir.box,K,m.get("text-ignore-placement"),d.bucketInstanceId,yr&&yr.placeable&&Fs?Fs:ua,ae.ID),yu&&this.collisionIndex.insertCollisionBox(rr.box,ge,m.get("icon-ignore-placement"),d.bucketInstanceId,jl,ae.ID),nr&&ci&&this.collisionIndex.insertCollisionCircles(nr.circles,K,m.get("text-ignore-placement"),d.bucketInstanceId,ua,ae.ID),u&&this.storeCollisionData(d.bucketInstanceId,Ot,lt,ir,rr,nr),it.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[it.crossTileID]=new ti(ci||Qe,Xi||Je,Hn||d.justReloaded),s[it.crossTileID]=!0};if(dt){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const it=d.getSortedSymbolIndexes(this.transform.angle);for(let lt=it.length-1;lt>=0;--lt){const Ot=it[lt];$t(d.symbolInstances.get(Ot),d.collisionArrays[Ot],Ot)}}else for(let it=e.symbolInstanceStart;it<e.symbolInstanceEnd;it++)$t(d.symbolInstances.get(it),d.collisionArrays[it],it);if(u&&d.bucketInstanceId in this.collisionCircleArrays){const it=this.collisionCircleArrays[d.bucketInstanceId];c.as(it.invProjMatrix,k),it.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}storeCollisionData(e,s,u,d,m,w){if(u.textBox||u.iconBox){let S,k;this.collisionBoxArrays.has(e)?S=this.collisionBoxArrays.get(e):(S=new Map,this.collisionBoxArrays.set(e,S)),S.has(s)?k=S.get(s):(k={text:null,icon:null},S.set(s,k)),u.textBox&&(k.text=d.box),u.iconBox&&(k.icon=m.box)}if(w){let S=this.collisionCircleArrays[e];S===void 0&&(S=this.collisionCircleArrays[e]=new Li);for(let k=0;k<w.circles.length;k+=4)S.circles.push(w.circles[k+0]),S.circles.push(w.circles[k+1]),S.circles.push(w.circles[k+2]),S.circles.push(w.collisionDetected?1:0)}}markUsedJustification(e,s,u,d){let m;m=d===c.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[c.at(s)];const w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const S of w)S>=0&&(e.text.placedSymbolArray.get(S).crossTileID=m>=0&&S!==m?0:u.crossTileID)}markUsedOrientation(e,s,u){const d=s===c.ah.horizontal||s===c.ah.horizontalOnly?s:0,m=s===c.ah.vertical?s:0,w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const S of w)e.text.placedSymbolArray.get(S).placedOrientation=d;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let u=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const d=s?s.symbolFadeChange(e):1,m=s?s.opacities:{},w=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(const k in this.placements){const E=this.placements[k],z=m[k];z?(this.opacities[k]=new nn(z,d,E.text,E.icon),u=u||E.text!==z.text.placed||E.icon!==z.icon.placed):(this.opacities[k]=new nn(null,d,E.text,E.icon,E.skipFade),u=u||E.text||E.icon)}for(const k in m){const E=m[k];if(!this.opacities[k]){const z=new nn(E,d,!1,!1);z.isHidden()||(this.opacities[k]=z,u=u||E.text.placed||E.icon.placed)}}for(const k in w)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=w[k]);for(const k in S)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=S[k]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:e)}updateLayerOpacities(e,s){const u={};for(const d of s){const m=d.getBucket(e);m&&d.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,d.tileID,u,d.collisionBoxArray)}}updateBucketOpacities(e,s,u,d){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],w=m.layout,S=new nn(null,0,!1,!1,!0),k=w.get("text-allow-overlap"),E=w.get("icon-allow-overlap"),z=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=w.get("text-rotation-alignment")==="map",V=w.get("text-pitch-alignment")==="map",H=w.get("icon-text-fit")!=="none",G=new nn(null,0,k&&(E||!e.hasIconData()||w.get("icon-optional")),E&&(k||!e.hasTextData()||w.get("text-optional")),!0);!e.collisionArrays&&d&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(d);const ee=(oe,ce,K)=>{for(let pe=0;pe<ce/4;pe++)oe.opacityVertexArray.emplaceBack(K);oe.hasVisibleVertices=oe.hasVisibleVertices||K!==ks},ae=this.collisionBoxArrays.get(e.bucketInstanceId);for(let oe=0;oe<e.symbolInstances.length;oe++){const ce=e.symbolInstances.get(oe),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:pe,crossTileID:ge}=ce;let Se=this.opacities[ge];u[ge]?Se=S:Se||(Se=G,this.opacities[ge]=Se),u[ge]=!0;const je=ce.numIconVertices>0,Ze=this.placedOrientations[ce.crossTileID],at=Ze===c.ah.vertical,dt=Ze===c.ah.horizontal||Ze===c.ah.horizontalOnly;if(K>0||pe>0){const Je=Er(Se.text);ee(e.text,K,at?ks:Je),ee(e.text,pe,dt?ks:Je);const vt=Se.text.isHidden();[ce.rightJustifiedTextSymbolIndex,ce.centerJustifiedTextSymbolIndex,ce.leftJustifiedTextSymbolIndex].forEach(lt=>{lt>=0&&(e.text.placedSymbolArray.get(lt).hidden=vt||at?1:0)}),ce.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ce.verticalPlacedTextSymbolIndex).hidden=vt||dt?1:0);const $t=this.variableOffsets[ce.crossTileID];$t&&this.markUsedJustification(e,$t.anchor,ce,Ze);const it=this.placedOrientations[ce.crossTileID];it&&(this.markUsedJustification(e,"left",ce,it),this.markUsedOrientation(e,it,ce))}if(je){const Je=Er(Se.icon),vt=!(H&&ce.verticalPlacedIconSymbolIndex&&at);ce.placedIconSymbolIndex>=0&&(ee(e.icon,ce.numIconVertices,vt?Je:ks),e.icon.placedSymbolArray.get(ce.placedIconSymbolIndex).hidden=Se.icon.isHidden()),ce.verticalPlacedIconSymbolIndex>=0&&(ee(e.icon,ce.numVerticalIconVertices,vt?ks:Je),e.icon.placedSymbolArray.get(ce.verticalPlacedIconSymbolIndex).hidden=Se.icon.isHidden())}const Qe=ae&&ae.has(oe)?ae.get(oe):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Je=e.collisionArrays[oe];if(Je){let vt=new c.P(0,0);if(Je.textBox||Je.verticalTextBox){let $t=!0;if(z){const it=this.variableOffsets[ge];it?(vt=Nn(it.anchor,it.width,it.height,it.textOffset,it.textBoxScale),D&&vt._rotate(V?this.transform.angle:-this.transform.angle)):$t=!1}if(Je.textBox||Je.verticalTextBox){let it;Je.textBox&&(it=at),Je.verticalTextBox&&(it=dt),Ss(e.textCollisionBox.collisionVertexArray,Se.text.placed,!$t||it,Qe.text,vt.x,vt.y)}}if(Je.iconBox||Je.verticalIconBox){const $t=!!(!dt&&Je.verticalIconBox);let it;Je.iconBox&&(it=$t),Je.verticalIconBox&&(it=!$t),Ss(e.iconCollisionBox.collisionVertexArray,Se.icon.placed,it,Qe.icon,H?vt.x:0,H?vt.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const oe=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=oe.invProjMatrix,e.placementViewportMatrix=oe.viewportMatrix,e.collisionCircleArray=oe.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,s){const u=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function Ss(g,e,s,u,d,m){u&&u.length!==0||(u=[0,0,0,0]);const w=u[0]-Gt,S=u[1]-Gt,k=u[2]-Gt,E=u[3]-Gt;g.emplaceBack(e?1:0,s?1:0,d||0,m||0,w,S),g.emplaceBack(e?1:0,s?1:0,d||0,m||0,k,S),g.emplaceBack(e?1:0,s?1:0,d||0,m||0,k,E),g.emplaceBack(e?1:0,s?1:0,d||0,m||0,w,E)}const Ri=Math.pow(2,25),Rc=Math.pow(2,24),Bc=Math.pow(2,17),Mr=Math.pow(2,16),Ir=Math.pow(2,9),Uf=Math.pow(2,8),Fr=Math.pow(2,1);function Er(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const e=g.placed?1:0,s=Math.floor(127*g.opacity);return s*Ri+e*Rc+s*Bc+e*Mr+s*Ir+e*Uf+s*Fr+e}const ks=0;function Ua(){return{isOccluded:(g,e,s)=>!1,getPitchedTextCorrection:(g,e,s)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,e,s,u){throw new Error("Not implemented.")},translatePosition:(g,e,s,u)=>function(d,m,w,S,k=!1){if(!w[0]&&!w[1])return[0,0];const E=k?S==="map"?d.angle:0:S==="viewport"?-d.angle:0;if(E){const z=Math.sin(E),D=Math.cos(E);w=[w[0]*D-w[1]*z,w[0]*z+w[1]*D]}return[k?w[0]:oi(m,w[0],d.zoom),k?w[1]:oi(m,w[1],d.zoom)]}(g,e,s,u),getCircleRadiusCorrection:g=>1}}class wn{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,s,u,d,m){const w=this._bucketParts;for(;this._currentTileIndex<e.length;)if(s.getBucketParts(w,d,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((S,k)=>S.sortKey-k.sortKey));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,m())return!0;return!1}}class go{constructor(e,s,u,d,m,w,S,k){this.placement=new er(e,Ua(),s,w,S,k),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,s,u){const d=R.now(),m=()=>!this._forceFullPlacement&&R.now()-d>2;for(;this._currentPlacementIndex>=0;){const w=s[e[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=S)&&(!w.maxzoom||w.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new wn(w)),this._inProgressLayer.continuePlacement(u[w.source],this.placement,this._showCollisionBoxes,w,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Wr=512/c.X/2;class yn{constructor(e,s,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};const d=new Map;for(let m=0;m<s.length;m++){const w=s.get(m),S=w.key,k=d.get(S);k?k.push(w):d.set(S,[w])}for(const[m,w]of d){const S={positions:w.map(k=>({x:Math.floor(k.anchorX*Wr),y:Math.floor(k.anchorY*Wr)})),crossTileIDs:w.map(k=>k.crossTileID)};if(S.positions.length>128){const k=new c.av(S.positions.length,16,Uint16Array);for(const{x:E,y:z}of S.positions)k.add(E,z);k.finish(),delete S.positions,S.index=k}this._symbolsByKey[m]=S}}getScaledCoordinates(e,s){const{x:u,y:d,z:m}=this.tileID.canonical,{x:w,y:S,z:k}=s.canonical,E=Wr/Math.pow(2,k-m),z=(S*c.X+e.anchorY)*E,D=d*c.X*Wr;return{x:Math.floor((w*c.X+e.anchorX)*E-u*c.X*Wr),y:Math.floor(z-D)}}findMatches(e,s,u){const d=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let m=0;m<e.length;m++){const w=e.get(m);if(w.crossTileID)continue;const S=this._symbolsByKey[w.key];if(!S)continue;const k=this.getScaledCoordinates(w,s);if(S.index){const E=S.index.range(k.x-d,k.y-d,k.x+d,k.y+d).sort();for(const z of E){const D=S.crossTileIDs[z];if(!u[D]){u[D]=!0,w.crossTileID=D;break}}}else if(S.positions)for(let E=0;E<S.positions.length;E++){const z=S.positions[E],D=S.crossTileIDs[E];if(Math.abs(z.x-k.x)<=d&&Math.abs(z.y-k.y)<=d&&!u[D]){u[D]=!0,w.crossTileID=D;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class dl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Hr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const s=Math.round((e-this.lng)/360);if(s!==0)for(const u in this.indexes){const d=this.indexes[u],m={};for(const w in d){const S=d[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),m[S.tileID.key]=S}this.indexes[u]=m}this.lng=e}addBucket(e,s,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<s.symbolInstances.length;m++)s.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const d=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const w=this.indexes[m];if(Number(m)>e.overscaledZ)for(const S in w){const k=w[S];k.tileID.isChildOf(e)&&k.findMatches(s.symbolInstances,e,d)}else{const S=w[e.scaledTo(Number(m)).key];S&&S.findMatches(s.symbolInstances,e,d)}}for(let m=0;m<s.symbolInstances.length;m++){const w=s.symbolInstances.get(m);w.crossTileID||(w.crossTileID=u.generate(),d[w.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new yn(e,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(e,s){for(const u of s.getCrossTileIDsLists())for(const d of u)delete this.usedCrossTileIDs[e][d]}removeStaleBuckets(e){let s=!1;for(const u in this.indexes){const d=this.indexes[u];for(const m in d)e[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,d[m]),delete d[m],s=!0)}return s}}class Oc{constructor(){this.layerIndexes={},this.crossTileIDs=new dl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,s,u){let d=this.layerIndexes[e.id];d===void 0&&(d=this.layerIndexes[e.id]=new Hr);let m=!1;const w={};d.handleWrapJump(u);for(const S of s){const k=S.getBucket(e);k&&e.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(S.tileID,k,this.crossTileIDs)&&(m=!0),w[k.bucketInstanceId]=!0)}return d.removeStaleBuckets(w)&&(m=!0),m}pruneUnusedLayers(e){const s={};e.forEach(u=>{s[u]=!0});for(const u in this.layerIndexes)s[u]||delete this.layerIndexes[u]}}const qr=(g,e)=>c.t(g,e&&e.filter(s=>s.identifier!=="source.canvas")),Wf=c.aw();class fl extends c.E{constructor(e,s={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const d=this.sourceCaches[u].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new bi(qt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,d)=>this.getGlyphs(u,d)),this.dispatcher.registerMessageHandler("GI",(u,d)=>this.getImages(u,d)),this.imageManager=new fe,this.imageManager.setEventedParent(this),this.glyphManager=new He(e._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Rt(256,512),this.crossTileSymbolIndex=new Oc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),Qt().on(ze,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const d=this.sourceCaches[u.sourceId];if(!d)return;const m=d.getSource();if(m&&m.vectorLayerIds)for(const w in this._layers){const S=this._layers[w];S.source===m.id&&this._validateLayer(S)}})}loadURL(e,s={},u){this.fire(new c.k("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const d=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;c.h(d,this._loadStyleRequest).then(w=>{this._loadStyleRequest=null,this._load(w.data,s,u)}).catch(w=>{this._loadStyleRequest=null,w&&!m.signal.aborted&&this.fire(new c.j(w))})}loadJSON(e,s={},u){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,R.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(e,s,u)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Wf,{validate:!1})}_load(e,s,u){var d;const m=s.transformStyle?s.transformStyle(u,e):e;if(!s.validate||!qr(this,c.u(m))){this._loaded=!0,this.stylesheet=m;for(const w in m.sources)this.addSource(w,m.sources[w],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new Xe(this.stylesheet.light),this.sky=new Mt(this.stylesheet.sky),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const e=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of e){const u=c.aA(s);u.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=u}}_loadSprite(e,s=!1,u=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,w,S,k){return c._(this,void 0,void 0,function*(){const E=Fe(m),z=S>1?"@2x":"",D={},V={};for(const{id:H,url:G}of E){const ee=w.transformRequest(Le(G,z,".json"),"SpriteJSON");D[H]=c.h(ee,k);const ae=w.transformRequest(Le(G,z,".png"),"SpriteImage");V[H]=ne.getImage(ae,k)}return yield Promise.all([...Object.values(D),...Object.values(V)]),function(H,G){return c._(this,void 0,void 0,function*(){const ee={};for(const ae in H){ee[ae]={};const oe=R.getImageCanvasContext((yield G[ae]).data),ce=(yield H[ae]).data;for(const K in ce){const{width:pe,height:ge,x:Se,y:je,sdf:Ze,pixelRatio:at,stretchX:dt,stretchY:Qe,content:Je,textFitWidth:vt,textFitHeight:$t}=ce[K];ee[ae][K]={data:null,pixelRatio:at,sdf:Ze,stretchX:dt,stretchY:Qe,content:Je,textFitWidth:vt,textFitHeight:$t,spriteData:{width:pe,height:ge,x:Se,y:je,context:oe}}}}return ee})}(D,V)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const w in m){this._spritesImagesIds[w]=[];const S=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(k=>!(k in m)):[];for(const k of S)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in m[w]){const E=w==="default"?k:`${w}:${k}`;this._spritesImagesIds[w].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,m[w][k],!1):this.imageManager.addImage(E,m[w][k]),s&&(this._changedImages[E]=!0)}}}).catch(m=>{this._spriteRequest=null,d=m,this.fire(new c.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),u&&u(d)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(e){const s=this.sourceCaches[e.source];if(!s)return;const u=e.sourceLayer;if(!u)return;const d=s.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(u)===-1)&&this.fire(new c.j(new Error(`Source layer "${u}" does not exist on source "${d.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,s=!1){const u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(s?c.aB(u):u);const d=[];for(const m of e)if(u[m]){const w=s?c.aB(u[m]):u[m];d.push(w)}return d}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const s=Object.keys(this._layers);for(const u of s){const d=this._layers[u];d.type!=="custom"&&(e[u]=d.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const s=this._changed;if(s){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const w in this._updatedSources){const S=this._updatedSources[w];if(S==="reload")this._reloadSource(w);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const u={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];u[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in u){const m=this.sourceCaches[d];!!u[d]!=!!m.used&&m.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,s&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,s={}){var u;this._checkLoaded();const d=this.serialize();if(e=s.transformStyle?s.transformStyle(d,e):e,((u=s.validate)===null||u===void 0||u)&&qr(this,c.u(e)))return!1;(e=c.aB(e)).layers=c.az(e.layers);const m=c.aC(d,e),w=this._getOperationsToPerform(m);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const S of w.operations)S();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const s=[],u=[];for(const d of e)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":s.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":s.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":s.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":s.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":s.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":s.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":s.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":s.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":s.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":s.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":s.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":s.push(()=>this.setSprite.apply(this,d.args));break;case"setSky":s.push(()=>this.setSky.apply(this,d.args));break;case"setTerrain":s.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setTransition":s.push(()=>{});break;default:u.push(d.command)}return{operations:s,unimplemented:u}}addImage(e,s){if(this.getImage(e))return this.fire(new c.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,s),this._afterImageUpdated(e)}updateImage(e,s){this.imageManager.updateImage(e,s)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,s,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(c.u.source,`sources.${e}`,s,null,u))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const d=this.sourceCaches[e]=new kt(e,s,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:e})),d.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===e)return this.fire(new c.j(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));const s=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],s.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,s){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(s),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,s,u={}){this._checkLoaded();const d=e.id;if(this.getLayer(d))return void this.fire(new c.j(new Error(`Layer "${d}" already exists on this map.`)));let m;if(e.type==="custom"){if(qr(this,c.aD(e)))return;m=c.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(d,e.source),e=c.aB(e),e=c.e(e,{source:d})),this._validate(c.u.layer,`layers.${d}`,e,{arrayIndex:-1},u))return;m=c.aA(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const w=s?this._order.indexOf(s):this._order.length;if(s&&w===-1)this.fire(new c.j(new Error(`Cannot add layer "${d}" before non-existing layer "${s}".`)));else{if(this._order.splice(w,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const S=this._removedLayers[d];delete this._removedLayers[d],S.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,s){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===s)return;const u=this._order.indexOf(e);this._order.splice(u,1);const d=s?this._order.indexOf(s):this._order.length;s&&d===-1?this.fire(new c.j(new Error(`Cannot move layer "${e}" before non-existing layer "${s}".`))):(this._order.splice(d,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const s=this._layers[e];if(!s)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${e}".`)));s.setEventedParent(null);const u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=s,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],s.onRemove&&s.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,s,u){this._checkLoaded();const d=this.getLayer(e);d?d.minzoom===s&&d.maxzoom===u||(s!=null&&(d.minzoom=s),u!=null&&(d.maxzoom=u),this._updateLayer(d)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,s,u={}){this._checkLoaded();const d=this.getLayer(e);if(d){if(!c.aE(d.filter,s))return s==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(c.u.filter,`layers.${d.id}.filter`,s,null,u)||(d.filter=c.aB(s),this._updateLayer(d)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.aB(this.getLayer(e).filter)}setLayoutProperty(e,s,u,d={}){this._checkLoaded();const m=this.getLayer(e);m?c.aE(m.getLayoutProperty(s),u)||(m.setLayoutProperty(s,u,d),this._updateLayer(m)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,s){const u=this.getLayer(e);if(u)return u.getLayoutProperty(s);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,s,u,d={}){this._checkLoaded();const m=this.getLayer(e);m?c.aE(m.getPaintProperty(s),u)||(m.setPaintProperty(s,u,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,s){return this.getLayer(e).getPaintProperty(s)}setFeatureState(e,s){this._checkLoaded();const u=e.source,d=e.sourceLayer,m=this.sourceCaches[u];if(m===void 0)return void this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)));const w=m.getSource().type;w==="geojson"&&d?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||d?(e.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,e.id,s)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,s){this._checkLoaded();const u=e.source,d=this.sourceCaches[u];if(d===void 0)return void this.fire(new c.j(new Error(`The source '${u}' does not exist in the map's style.`)));const m=d.getSource().type,w=m==="vector"?e.sourceLayer:void 0;m!=="vector"||w?s&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(w,e.id,s):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const s=e.source,u=e.sourceLayer,d=this.sourceCaches[s];if(d!==void 0)return d.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(u,e.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.aF(this.sourceCaches,m=>m.serialize()),s=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,d=this.stylesheet;return c.aG({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:e,layers:s,terrain:u},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const s=w=>this._layers[w].type==="fill-extrusion",u={},d=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(s(S)){u[S]=w;for(const k of e){const E=k[S];if(E)for(const z of E)d.push(z)}}}d.sort((w,S)=>S.intersectionZ-w.intersectionZ);const m=[];for(let w=this._order.length-1;w>=0;w--){const S=this._order[w];if(s(S))for(let k=d.length-1;k>=0;k--){const E=d[k].feature;if(u[E.layer.id]<w)break;m.push(E),d.pop()}else for(const k of e){const E=k[S];if(E)for(const z of E)m.push(z.feature)}}return m}queryRenderedFeatures(e,s,u){s&&s.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",s.filter,null,s);const d={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const S of s.layers){const k=this._layers[S];if(!k)return this.fire(new c.j(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];d[k.source]=!0}}const m=[];s.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const S in this.sourceCaches)s.layers&&!d[S]||m.push(Qi(this.sourceCaches[S],this._layers,w,e,s,u));return this.placement&&m.push(function(S,k,E,z,D,V,H){const G={},ee=V.queryRenderedSymbols(z),ae=[];for(const oe of Object.keys(ee).map(Number))ae.push(H[oe]);ae.sort(hi);for(const oe of ae){const ce=oe.featureIndex.lookupSymbolFeatures(ee[oe.bucketInstanceId],k,oe.bucketIndex,oe.sourceLayerIndex,D.filter,D.layers,D.availableImages,S);for(const K in ce){const pe=G[K]=G[K]||[],ge=ce[K];ge.sort((Se,je)=>{const Ze=oe.featureSortOrder;if(Ze){const at=Ze.indexOf(Se.featureIndex);return Ze.indexOf(je.featureIndex)-at}return je.featureIndex-Se.featureIndex});for(const Se of ge)pe.push(Se)}}for(const oe in G)G[oe].forEach(ce=>{const K=ce.feature,pe=E[S[oe].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=pe});return G}(this._layers,w,this.sourceCaches,e,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,s){s&&s.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",s.filter,null,s);const u=this.sourceCaches[e];return u?function(d,m){const w=d.getRenderableIds().map(E=>d.getTileByID(E)),S=[],k={};for(let E=0;E<w.length;E++){const z=w[E],D=z.tileID.canonical.key;k[D]||(k[D]=!0,z.querySourceFeatures(S,m))}return S}(u,s):[]}getLight(){return this.light.getLight()}setLight(e,s={}){this._checkLoaded();const u=this.light.getLight();let d=!1;for(const w in e)if(!c.aE(e[w],u[w])){d=!0;break}if(!d)return;const m={now:R.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,s),this.light.updateTransitions(m)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,s={}){const u=this.getSky();let d=!1;if(!e&&!u)return;if(e&&!u)d=!0;else if(!e&&u)d=!0;else for(const w in e)if(!c.aE(e[w],u[w])){d=!0;break}if(!d)return;const m={now:R.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,s),this.sky.updateTransitions(m)}_validate(e,s,u,d,m={}){return(!m||m.validate!==!1)&&qr(this,e.call(c.u,c.e({key:s,style:this.serialize(),value:u,styleSpec:c.v},d)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Qt().off(ze,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const u=this.sourceCaches[s];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const s in this.sourceCaches)this.sourceCaches[s].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,s,u,d,m=!1){let w=!1,S=!1;const k={};for(const E of this._order){const z=this._layers[E];if(z.type!=="symbol")continue;if(!k[z.source]){const V=this.sourceCaches[z.source];k[z.source]=V.getRenderableIds(!0).map(H=>V.getTileByID(H)).sort((H,G)=>G.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(G.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(z,k[z.source],e.center.lng);w=w||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(R.now(),e.zoom))&&(this.pauseablePlacement=new go(e,this.map.terrain,this._order,m,s,u,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(R.now()),S=!0),w&&this.pauseablePlacement.placement.setStale()),S||w)for(const E of this._order){const z=this._layers[E];z.type==="symbol"&&this.placement.updateLayerOpacities(z,k[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(R.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,s){return c._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[s.source];return d&&d.setDependencies(s.tileID.key,s.type,s.icons),u})}getGlyphs(e,s){return c._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(s.stacks),d=this.sourceCaches[s.source];return d&&d.setDependencies(s.tileID.key,s.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,s={}){this._checkLoaded(),e&&this._validate(c.u.glyphs,"glyphs",e,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,s,u={},d){this._checkLoaded();const m=[{id:e,url:s}],w=[...Fe(this.stylesheet.sprite),...m];this._validate(c.u.sprite,"sprite",w,null,u)||(this.stylesheet.sprite=w,this._loadSprite(m,!0,d))}removeSprite(e){this._checkLoaded();const s=Fe(this.stylesheet.sprite);if(s.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(const u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;s.splice(s.findIndex(u=>u.id===e),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Fe(this.stylesheet.sprite)}setSprite(e,s={},u){this._checkLoaded(),e&&this._validate(c.u.sprite,"sprite",e,null,s)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var Wa=c.Y([{name:"a_pos",type:"Int16",components:2}]);const Ea={prelude:wi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:wi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:wi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:wi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:wi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:wi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:wi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:wi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:wi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:wi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:wi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:wi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:wi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:wi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:wi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:wi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:wi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:wi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:wi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:wi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:wi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:wi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:wi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:wi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:wi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:wi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:wi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function wi(g,e){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/attribute ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=m?m.concat(d):d,S={};return{fragmentSource:g=g.replace(s,(k,E,z,D,V)=>(S[V]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${V}
varying ${z} ${D} ${V};
#else
uniform ${z} ${D} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${z} ${D} ${V} = u_${V};
#endif
`)),vertexSource:e=e.replace(s,(k,E,z,D,V)=>{const H=D==="float"?"vec2":"vec4",G=V.match(/color/)?"color":H;return S[V]?E==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${z} ${H} a_${V};
varying ${z} ${D} ${V};
#else
uniform ${z} ${D} u_${V};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${z} ${D} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${G}(a_${V}, u_${V}_t);
#else
    ${z} ${D} ${V} = u_${V};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${z} ${H} a_${V};
#else
uniform ${z} ${D} u_${V};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${z} ${D} ${V} = a_${V};
#else
    ${z} ${D} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${z} ${D} ${V} = unpack_mix_${G}(a_${V}, u_${V}_t);
#else
    ${z} ${D} ${V} = u_${V};
#endif
`}),staticAttributes:u,staticUniforms:w}}class Fc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,s,u,d,m,w,S,k,E){this.context=e;let z=this.boundPaintVertexBuffers.length!==d.length;for(let D=0;!z&&D<d.length;D++)this.boundPaintVertexBuffers[D]!==d[D]&&(z=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==u||z||this.boundIndexBuffer!==m||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==E?this.freshBind(s,u,d,m,w,S,k,E):(e.bindVertexArray.set(this.vao),S&&S.bind(),m&&m.dynamicDraw&&m.bind(),k&&k.bind(),E&&E.bind())}freshBind(e,s,u,d,m,w,S,k){const E=e.numAttributes,z=this.context,D=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=k,s.enableAttributes(D,e);for(const V of u)V.enableAttributes(D,e);w&&w.enableAttributes(D,e),S&&S.enableAttributes(D,e),k&&k.enableAttributes(D,e),s.bind(),s.setVertexAttribPointers(D,e,m);for(const V of u)V.bind(),V.setVertexAttribPointers(D,e,m);w&&(w.bind(),w.setVertexAttribPointers(D,e,m)),d&&d.bind(),S&&(S.bind(),S.setVertexAttribPointers(D,e,m)),k&&(k.bind(),k.setVertexAttribPointers(D,e,m)),z.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Nc=(g,e,s,u,d)=>({u_matrix:g,u_texture:0,u_ele_delta:e,u_fog_matrix:s,u_fog_color:u?u.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?u.calculateFogBlendOpacity(d):0,u_horizon_color:u?u.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1});function As(g){const e=[];for(let s=0;s<g.length;s++){if(g[s]===null)continue;const u=g[s].split(" ");e.push(u.pop())}return e}class jc{constructor(e,s,u,d,m,w){const S=e.gl;this.program=S.createProgram();const k=As(s.staticAttributes),E=u?u.getBinderAttributes():[],z=k.concat(E),D=Ea.prelude.staticUniforms?As(Ea.prelude.staticUniforms):[],V=s.staticUniforms?As(s.staticUniforms):[],H=u?u.getBinderUniforms():[],G=D.concat(V).concat(H),ee=[];for(const Se of G)ee.indexOf(Se)<0&&ee.push(Se);const ae=u?u.defines():[];m&&ae.push("#define OVERDRAW_INSPECTOR;"),w&&ae.push("#define TERRAIN3D;");const oe=ae.concat(Ea.prelude.fragmentSource,s.fragmentSource).join(`
`),ce=ae.concat(Ea.prelude.vertexSource,s.vertexSource).join(`
`),K=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(K,oe),S.compileShader(K),!S.getShaderParameter(K,S.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${S.getShaderInfoLog(K)}`);S.attachShader(this.program,K);const pe=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);if(S.shaderSource(pe,ce),S.compileShader(pe),!S.getShaderParameter(pe,S.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${S.getShaderInfoLog(pe)}`);S.attachShader(this.program,pe),this.attributes={};const ge={};this.numAttributes=z.length;for(let Se=0;Se<this.numAttributes;Se++)z[Se]&&(S.bindAttribLocation(this.program,Se,z[Se]),this.attributes[z[Se]]=Se);if(S.linkProgram(this.program),!S.getProgramParameter(this.program,S.LINK_STATUS))throw new Error(`Program failed to link: ${S.getProgramInfoLog(this.program)}`);S.deleteShader(pe),S.deleteShader(K);for(let Se=0;Se<ee.length;Se++){const je=ee[Se];if(je&&!ge[je]){const Ze=S.getUniformLocation(this.program,je);Ze&&(ge[je]=Ze)}}this.fixedUniforms=d(e,ge),this.terrainUniforms=((Se,je)=>({u_depth:new c.aH(Se,je.u_depth),u_terrain:new c.aH(Se,je.u_terrain),u_terrain_dim:new c.aI(Se,je.u_terrain_dim),u_terrain_matrix:new c.aJ(Se,je.u_terrain_matrix),u_terrain_unpack:new c.aK(Se,je.u_terrain_unpack),u_terrain_exaggeration:new c.aI(Se,je.u_terrain_exaggeration)}))(e,ge),this.binderUniforms=u?u.getUniforms(e,ge):[]}draw(e,s,u,d,m,w,S,k,E,z,D,V,H,G,ee,ae,oe,ce){const K=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(d),e.setColorMode(m),e.setCullFace(w),k){e.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,k.depthTexture),e.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,k.texture);for(const ge in this.terrainUniforms)this.terrainUniforms[ge].set(k[ge])}for(const ge in this.fixedUniforms)this.fixedUniforms[ge].set(S[ge]);ee&&ee.setUniforms(e,this.binderUniforms,H,{zoom:G});let pe=0;switch(s){case K.LINES:pe=2;break;case K.TRIANGLES:pe=3;break;case K.LINE_STRIP:pe=1}for(const ge of V.get()){const Se=ge.vaos||(ge.vaos={});(Se[E]||(Se[E]=new Fc)).bind(e,this,z,ee?ee.getPaintVertexBuffers():[],D,ge.vertexOffset,ae,oe,ce),K.drawElements(s,ge.primitiveLength*pe,K.UNSIGNED_SHORT,ge.primitiveOffset*pe*2)}}}function pl(g,e,s){const u=1/oi(s,1,e.transform.tileZoom),d=Math.pow(2,s.tileID.overscaledZ),m=s.tileSize*Math.pow(2,e.transform.tileZoom)/d,w=m*(s.tileID.canonical.x+s.tileID.wrap*d),S=m*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[u,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S]}}const yo=(g,e,s,u)=>{const d=e.style.light,m=d.properties.get("position"),w=[m.x,m.y,m.z],S=function(){var E=new c.A(9);return c.A!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}();d.properties.get("anchor")==="viewport"&&function(E,z){var D=Math.sin(z),V=Math.cos(z);E[0]=V,E[1]=D,E[2]=0,E[3]=-D,E[4]=V,E[5]=0,E[6]=0,E[7]=0,E[8]=1}(S,-e.transform.angle),function(E,z,D){var V=z[0],H=z[1],G=z[2];E[0]=V*D[0]+H*D[3]+G*D[6],E[1]=V*D[1]+H*D[4]+G*D[7],E[2]=V*D[2]+H*D[5]+G*D[8]}(w,w,S);const k=d.properties.get("color");return{u_matrix:g,u_lightpos:w,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+s,u_opacity:u}},ml=(g,e,s,u,d,m,w)=>c.e(yo(g,e,s,u),pl(m,e,w),{u_height_factor:-Math.pow(2,d.overscaledZ)/w.tileSize/8}),Ms=g=>({u_matrix:g}),kh=(g,e,s,u)=>c.e(Ms(g),pl(s,e,u)),Hf=(g,e)=>({u_matrix:g,u_world:e}),Ah=(g,e,s,u,d)=>c.e(kh(g,e,s,u),{u_world:d}),qf=(g,e,s,u)=>{const d=g.transform;let m,w;if(u.paint.get("circle-pitch-alignment")==="map"){const S=oi(s,1,d.zoom);m=!0,w=[S,S]}else m=!1,w=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(e.posMatrix,s,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:w}},Ha=(g,e,s)=>({u_matrix:g,u_inv_matrix:e,u_camera_to_center_distance:s.cameraToCenterDistance,u_viewport_size:[s.width,s.height]}),_o=(g,e,s=1)=>({u_matrix:g,u_color:e,u_overlay:0,u_overlay_scale:s}),fr=g=>({u_matrix:g}),pr=(g,e,s,u)=>({u_matrix:g,u_extrude_scale:oi(e,1,s),u_intensity:u}),gl=(g,e,s,u)=>{const d=c.H();c.aP(d,0,g.width,g.height,0,0,1);const m=g.context.gl;return{u_matrix:d,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:s,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}};function yl(g,e){const s=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new c.Z(0,u/s).toLngLat().lat,new c.Z(0,(u+1)/s).toLngLat().lat]}const _l=(g,e,s,u)=>{const d=g.transform;return{u_matrix:Eh(g,e,s,u),u_ratio:1/oi(e,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Mh=(g,e,s,u,d)=>c.e(_l(g,e,s,d),{u_image:0,u_image_height:u}),Is=(g,e,s,u,d)=>{const m=g.transform,w=Ih(e,m);return{u_matrix:Eh(g,e,s,d),u_texsize:e.imageAtlasTexture.size,u_ratio:1/oi(e,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Gf=(g,e,s,u,d,m)=>{const w=g.lineAtlas,S=Ih(e,g.transform),k=s.layout.get("line-cap")==="round",E=w.getDash(u.from,k),z=w.getDash(u.to,k),D=E.width*d.fromScale,V=z.width*d.toScale;return c.e(_l(g,e,s,m),{u_patternscale_a:[S/D,-E.height/2],u_patternscale_b:[S/V,-z.height/2],u_sdfgamma:w.width/(256*Math.min(D,V)*g.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:z.y,u_mix:d.t})};function Ih(g,e){return 1/oi(g,1,e.tileZoom)}function Eh(g,e,s,u){return g.translatePosMatrix(u?u.posMatrix:e.tileID.posMatrix,e,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Zf=(g,e,s,u,d)=>{return{u_matrix:g,u_tl_parent:e,u_scale_parent:s,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(w=d.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Xf(d.paint.get("raster-hue-rotate"))};var m,w};function Xf(g){g*=Math.PI/180;const e=Math.sin(g),s=Math.cos(g);return[(2*s+1)/3,(-Math.sqrt(3)*e-s+1)/3,(Math.sqrt(3)*e-s+1)/3]}const Ch=(g,e,s,u,d,m,w,S,k,E,z,D,V,H)=>{const G=w.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:G.width/G.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:k,u_coord_matrix:E,u_is_text:+D,u_pitch_with_map:+u,u_is_along_line:d,u_is_variable_anchor:m,u_texsize:V,u_texture:0,u_translation:z,u_pitched_scale:H}},vo=(g,e,s,u,d,m,w,S,k,E,z,D,V,H,G)=>{const ee=w.transform;return c.e(Ch(g,e,s,u,d,m,w,S,k,E,z,D,V,G),{u_gamma_scale:u?Math.cos(ee._pitch)*ee.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+H})},Vc=(g,e,s,u,d,m,w,S,k,E,z,D,V,H)=>c.e(vo(g,e,s,u,d,m,w,S,k,E,z,!0,D,!0,H),{u_texsize_icon:V,u_texture_icon:1}),vl=(g,e,s)=>({u_matrix:g,u_opacity:e,u_color:s}),$c=(g,e,s,u,d,m)=>c.e(function(w,S,k,E){const z=k.imageManager.getPattern(w.from.toString()),D=k.imageManager.getPattern(w.to.toString()),{width:V,height:H}=k.imageManager.getPixelSize(),G=Math.pow(2,E.tileID.overscaledZ),ee=E.tileSize*Math.pow(2,k.transform.tileZoom)/G,ae=ee*(E.tileID.canonical.x+E.tileID.wrap*G),oe=ee*E.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:D.tl,u_pattern_br_b:D.br,u_texsize:[V,H],u_mix:S.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:D.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/oi(E,1,k.transform.tileZoom),u_pixel_coord_upper:[ae>>16,oe>>16],u_pixel_coord_lower:[65535&ae,65535&oe]}}(u,m,s,d),{u_matrix:g,u_opacity:e}),Uc={fillExtrusion:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_lightpos:new c.aN(g,e.u_lightpos),u_lightintensity:new c.aI(g,e.u_lightintensity),u_lightcolor:new c.aN(g,e.u_lightcolor),u_vertical_gradient:new c.aI(g,e.u_vertical_gradient),u_opacity:new c.aI(g,e.u_opacity)}),fillExtrusionPattern:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_lightpos:new c.aN(g,e.u_lightpos),u_lightintensity:new c.aI(g,e.u_lightintensity),u_lightcolor:new c.aN(g,e.u_lightcolor),u_vertical_gradient:new c.aI(g,e.u_vertical_gradient),u_height_factor:new c.aI(g,e.u_height_factor),u_image:new c.aH(g,e.u_image),u_texsize:new c.aO(g,e.u_texsize),u_pixel_coord_upper:new c.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,e.u_pixel_coord_lower),u_scale:new c.aN(g,e.u_scale),u_fade:new c.aI(g,e.u_fade),u_opacity:new c.aI(g,e.u_opacity)}),fill:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix)}),fillPattern:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_image:new c.aH(g,e.u_image),u_texsize:new c.aO(g,e.u_texsize),u_pixel_coord_upper:new c.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,e.u_pixel_coord_lower),u_scale:new c.aN(g,e.u_scale),u_fade:new c.aI(g,e.u_fade)}),fillOutline:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_world:new c.aO(g,e.u_world)}),fillOutlinePattern:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_world:new c.aO(g,e.u_world),u_image:new c.aH(g,e.u_image),u_texsize:new c.aO(g,e.u_texsize),u_pixel_coord_upper:new c.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,e.u_pixel_coord_lower),u_scale:new c.aN(g,e.u_scale),u_fade:new c.aI(g,e.u_fade)}),circle:(g,e)=>({u_camera_to_center_distance:new c.aI(g,e.u_camera_to_center_distance),u_scale_with_map:new c.aH(g,e.u_scale_with_map),u_pitch_with_map:new c.aH(g,e.u_pitch_with_map),u_extrude_scale:new c.aO(g,e.u_extrude_scale),u_device_pixel_ratio:new c.aI(g,e.u_device_pixel_ratio),u_matrix:new c.aJ(g,e.u_matrix)}),collisionBox:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_pixel_extrude_scale:new c.aO(g,e.u_pixel_extrude_scale)}),collisionCircle:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_inv_matrix:new c.aJ(g,e.u_inv_matrix),u_camera_to_center_distance:new c.aI(g,e.u_camera_to_center_distance),u_viewport_size:new c.aO(g,e.u_viewport_size)}),debug:(g,e)=>({u_color:new c.aL(g,e.u_color),u_matrix:new c.aJ(g,e.u_matrix),u_overlay:new c.aH(g,e.u_overlay),u_overlay_scale:new c.aI(g,e.u_overlay_scale)}),clippingMask:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix)}),heatmap:(g,e)=>({u_extrude_scale:new c.aI(g,e.u_extrude_scale),u_intensity:new c.aI(g,e.u_intensity),u_matrix:new c.aJ(g,e.u_matrix)}),heatmapTexture:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_world:new c.aO(g,e.u_world),u_image:new c.aH(g,e.u_image),u_color_ramp:new c.aH(g,e.u_color_ramp),u_opacity:new c.aI(g,e.u_opacity)}),hillshade:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_image:new c.aH(g,e.u_image),u_latrange:new c.aO(g,e.u_latrange),u_light:new c.aO(g,e.u_light),u_shadow:new c.aL(g,e.u_shadow),u_highlight:new c.aL(g,e.u_highlight),u_accent:new c.aL(g,e.u_accent)}),hillshadePrepare:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_image:new c.aH(g,e.u_image),u_dimension:new c.aO(g,e.u_dimension),u_zoom:new c.aI(g,e.u_zoom),u_unpack:new c.aK(g,e.u_unpack)}),line:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_ratio:new c.aI(g,e.u_ratio),u_device_pixel_ratio:new c.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,e.u_units_to_pixels)}),lineGradient:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_ratio:new c.aI(g,e.u_ratio),u_device_pixel_ratio:new c.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,e.u_units_to_pixels),u_image:new c.aH(g,e.u_image),u_image_height:new c.aI(g,e.u_image_height)}),linePattern:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_texsize:new c.aO(g,e.u_texsize),u_ratio:new c.aI(g,e.u_ratio),u_device_pixel_ratio:new c.aI(g,e.u_device_pixel_ratio),u_image:new c.aH(g,e.u_image),u_units_to_pixels:new c.aO(g,e.u_units_to_pixels),u_scale:new c.aN(g,e.u_scale),u_fade:new c.aI(g,e.u_fade)}),lineSDF:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_ratio:new c.aI(g,e.u_ratio),u_device_pixel_ratio:new c.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new c.aO(g,e.u_units_to_pixels),u_patternscale_a:new c.aO(g,e.u_patternscale_a),u_patternscale_b:new c.aO(g,e.u_patternscale_b),u_sdfgamma:new c.aI(g,e.u_sdfgamma),u_image:new c.aH(g,e.u_image),u_tex_y_a:new c.aI(g,e.u_tex_y_a),u_tex_y_b:new c.aI(g,e.u_tex_y_b),u_mix:new c.aI(g,e.u_mix)}),raster:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_tl_parent:new c.aO(g,e.u_tl_parent),u_scale_parent:new c.aI(g,e.u_scale_parent),u_buffer_scale:new c.aI(g,e.u_buffer_scale),u_fade_t:new c.aI(g,e.u_fade_t),u_opacity:new c.aI(g,e.u_opacity),u_image0:new c.aH(g,e.u_image0),u_image1:new c.aH(g,e.u_image1),u_brightness_low:new c.aI(g,e.u_brightness_low),u_brightness_high:new c.aI(g,e.u_brightness_high),u_saturation_factor:new c.aI(g,e.u_saturation_factor),u_contrast_factor:new c.aI(g,e.u_contrast_factor),u_spin_weights:new c.aN(g,e.u_spin_weights)}),symbolIcon:(g,e)=>({u_is_size_zoom_constant:new c.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,e.u_is_size_feature_constant),u_size_t:new c.aI(g,e.u_size_t),u_size:new c.aI(g,e.u_size),u_camera_to_center_distance:new c.aI(g,e.u_camera_to_center_distance),u_pitch:new c.aI(g,e.u_pitch),u_rotate_symbol:new c.aH(g,e.u_rotate_symbol),u_aspect_ratio:new c.aI(g,e.u_aspect_ratio),u_fade_change:new c.aI(g,e.u_fade_change),u_matrix:new c.aJ(g,e.u_matrix),u_label_plane_matrix:new c.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,e.u_coord_matrix),u_is_text:new c.aH(g,e.u_is_text),u_pitch_with_map:new c.aH(g,e.u_pitch_with_map),u_is_along_line:new c.aH(g,e.u_is_along_line),u_is_variable_anchor:new c.aH(g,e.u_is_variable_anchor),u_texsize:new c.aO(g,e.u_texsize),u_texture:new c.aH(g,e.u_texture),u_translation:new c.aO(g,e.u_translation),u_pitched_scale:new c.aI(g,e.u_pitched_scale)}),symbolSDF:(g,e)=>({u_is_size_zoom_constant:new c.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,e.u_is_size_feature_constant),u_size_t:new c.aI(g,e.u_size_t),u_size:new c.aI(g,e.u_size),u_camera_to_center_distance:new c.aI(g,e.u_camera_to_center_distance),u_pitch:new c.aI(g,e.u_pitch),u_rotate_symbol:new c.aH(g,e.u_rotate_symbol),u_aspect_ratio:new c.aI(g,e.u_aspect_ratio),u_fade_change:new c.aI(g,e.u_fade_change),u_matrix:new c.aJ(g,e.u_matrix),u_label_plane_matrix:new c.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,e.u_coord_matrix),u_is_text:new c.aH(g,e.u_is_text),u_pitch_with_map:new c.aH(g,e.u_pitch_with_map),u_is_along_line:new c.aH(g,e.u_is_along_line),u_is_variable_anchor:new c.aH(g,e.u_is_variable_anchor),u_texsize:new c.aO(g,e.u_texsize),u_texture:new c.aH(g,e.u_texture),u_gamma_scale:new c.aI(g,e.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,e.u_device_pixel_ratio),u_is_halo:new c.aH(g,e.u_is_halo),u_translation:new c.aO(g,e.u_translation),u_pitched_scale:new c.aI(g,e.u_pitched_scale)}),symbolTextAndIcon:(g,e)=>({u_is_size_zoom_constant:new c.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,e.u_is_size_feature_constant),u_size_t:new c.aI(g,e.u_size_t),u_size:new c.aI(g,e.u_size),u_camera_to_center_distance:new c.aI(g,e.u_camera_to_center_distance),u_pitch:new c.aI(g,e.u_pitch),u_rotate_symbol:new c.aH(g,e.u_rotate_symbol),u_aspect_ratio:new c.aI(g,e.u_aspect_ratio),u_fade_change:new c.aI(g,e.u_fade_change),u_matrix:new c.aJ(g,e.u_matrix),u_label_plane_matrix:new c.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,e.u_coord_matrix),u_is_text:new c.aH(g,e.u_is_text),u_pitch_with_map:new c.aH(g,e.u_pitch_with_map),u_is_along_line:new c.aH(g,e.u_is_along_line),u_is_variable_anchor:new c.aH(g,e.u_is_variable_anchor),u_texsize:new c.aO(g,e.u_texsize),u_texsize_icon:new c.aO(g,e.u_texsize_icon),u_texture:new c.aH(g,e.u_texture),u_texture_icon:new c.aH(g,e.u_texture_icon),u_gamma_scale:new c.aI(g,e.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,e.u_device_pixel_ratio),u_is_halo:new c.aH(g,e.u_is_halo),u_translation:new c.aO(g,e.u_translation),u_pitched_scale:new c.aI(g,e.u_pitched_scale)}),background:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_opacity:new c.aI(g,e.u_opacity),u_color:new c.aL(g,e.u_color)}),backgroundPattern:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_opacity:new c.aI(g,e.u_opacity),u_image:new c.aH(g,e.u_image),u_pattern_tl_a:new c.aO(g,e.u_pattern_tl_a),u_pattern_br_a:new c.aO(g,e.u_pattern_br_a),u_pattern_tl_b:new c.aO(g,e.u_pattern_tl_b),u_pattern_br_b:new c.aO(g,e.u_pattern_br_b),u_texsize:new c.aO(g,e.u_texsize),u_mix:new c.aI(g,e.u_mix),u_pattern_size_a:new c.aO(g,e.u_pattern_size_a),u_pattern_size_b:new c.aO(g,e.u_pattern_size_b),u_scale_a:new c.aI(g,e.u_scale_a),u_scale_b:new c.aI(g,e.u_scale_b),u_pixel_coord_upper:new c.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(g,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(g,e.u_tile_units_to_pixels)}),terrain:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_texture:new c.aH(g,e.u_texture),u_ele_delta:new c.aI(g,e.u_ele_delta),u_fog_matrix:new c.aJ(g,e.u_fog_matrix),u_fog_color:new c.aL(g,e.u_fog_color),u_fog_ground_blend:new c.aI(g,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(g,e.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(g,e.u_horizon_color),u_horizon_fog_blend:new c.aI(g,e.u_horizon_fog_blend)}),terrainDepth:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_ele_delta:new c.aI(g,e.u_ele_delta)}),terrainCoords:(g,e)=>({u_matrix:new c.aJ(g,e.u_matrix),u_texture:new c.aH(g,e.u_texture),u_terrain_coords_id:new c.aI(g,e.u_terrain_coords_id),u_ele_delta:new c.aI(g,e.u_ele_delta)}),sky:(g,e)=>({u_sky_color:new c.aL(g,e.u_sky_color),u_horizon_color:new c.aL(g,e.u_horizon_color),u_horizon:new c.aI(g,e.u_horizon),u_sky_horizon_blend:new c.aI(g,e.u_sky_horizon_blend)})};class la{constructor(e,s,u){this.context=e;const d=e.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wc{constructor(e,s,u,d){this.length=s.length,this.attributes=u,this.itemSize=s.bytesPerElement,this.dynamicDraw=d,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,s){for(let u=0;u<this.attributes.length;u++){const d=s.attributes[this.attributes[u].name];d!==void 0&&e.enableVertexAttribArray(d)}}setVertexAttribPointers(e,s,u){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],w=s.attributes[m.name];w!==void 0&&e.vertexAttribPointer(w,m.components,e[Yf[m.type]],!1,this.itemSize,m.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qa=new WeakMap;function Ca(g){var e;if(qa.has(g))return qa.get(g);{const s=(e=g.getParameter(g.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return qa.set(g,s),s}}class ki{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bl extends ki{getDefault(){return c.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Kf extends ki{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Es extends ki{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Jf extends ki{getDefault(){return[!0,!0,!0,!0]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Ph extends ki{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Qf extends ki{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class zh extends ki{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const s=this.current;(e.func!==s.func||e.ref!==s.ref||e.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Hc extends ki{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Dh extends ki{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=e,this.dirty=!1}}class Lh extends ki{getDefault(){return[0,1]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Rh extends ki{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=e,this.dirty=!1}}class Bh extends ki{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Ga extends ki{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.BLEND):s.disable(s.BLEND),this.current=e,this.dirty=!1}}class Oh extends ki{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class ep extends ki{getDefault(){return c.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Fh extends ki{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class bo extends ki{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=e,this.dirty=!1}}class xl extends ki{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class tp extends ki{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ip extends ki{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Nh extends ki{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class jh extends ki{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Vh extends ki{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class qc extends ki{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class $h extends ki{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class wl extends ki{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ga extends ki{getDefault(){return null}set(e){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Gc extends ki{getDefault(){return null}set(e){var s;if(e===this.current&&!this.dirty)return;const u=this.gl;Ca(u)?u.bindVertexArray(e):(s=u.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Zc extends ki{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Xc extends ki{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Uh extends ki{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class xo extends ki{constructor(e,s){super(e),this.context=e,this.parent=s}getDefault(){return null}}class Za extends xo{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Yc extends xo{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class np extends xo{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class rp{constructor(e,s,u,d,m){this.context=e,this.width=s,this.height=u;const w=e.gl,S=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new Za(e,S),d)this.depthAttachment=m?new np(e,S):new Yc(e,S);else if(m)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,s=this.colorAttachment.get();if(s&&e.deleteTexture(s),this.depthAttachment){const u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class fn{constructor(e,s,u){this.blendFunction=e,this.blendColor=s,this.mask=u}}fn.Replace=[1,0],fn.disabled=new fn(fn.Replace,c.aM.transparent,[!1,!1,!1,!1]),fn.unblended=new fn(fn.Replace,c.aM.transparent,[!0,!0,!0,!0]),fn.alphaBlended=new fn([1,771],c.aM.transparent,[!0,!0,!0,!0]);class ap{constructor(e){var s,u;if(this.gl=e,this.clearColor=new bl(this),this.clearDepth=new Kf(this),this.clearStencil=new Es(this),this.colorMask=new Jf(this),this.depthMask=new Ph(this),this.stencilMask=new Qf(this),this.stencilFunc=new zh(this),this.stencilOp=new Hc(this),this.stencilTest=new Dh(this),this.depthRange=new Lh(this),this.depthTest=new Rh(this),this.depthFunc=new Bh(this),this.blend=new Ga(this),this.blendFunc=new Oh(this),this.blendColor=new ep(this),this.blendEquation=new Fh(this),this.cullFace=new bo(this),this.cullFaceSide=new xl(this),this.frontFace=new tp(this),this.program=new ip(this),this.activeTexture=new Nh(this),this.viewport=new jh(this),this.bindFramebuffer=new Vh(this),this.bindRenderbuffer=new qc(this),this.bindTexture=new $h(this),this.bindVertexBuffer=new wl(this),this.bindElementBuffer=new ga(this),this.bindVertexArray=new Gc(this),this.pixelStoreUnpack=new Zc(this),this.pixelStoreUnpackPremultiplyAlpha=new Xc(this),this.pixelStoreUnpackFlipY=new Uh(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Ca(e)){this.HALF_FLOAT=e.HALF_FLOAT;const d=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=e.RGBA16F)!==null&&s!==void 0?s:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:d==null?void 0:d.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const d=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,s){return new la(this,e,s)}createVertexBuffer(e,s,u){return new Wc(this,e,s,u)}createRenderbuffer(e,s,u){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,e,s,u),this.bindRenderbuffer.set(null),m}createFramebuffer(e,s,u,d){return new rp(this,e,s,u,d)}clear({color:e,depth:s,stencil:u}){const d=this.gl;let m=0;e&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),u!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),d.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.aE(e.blendFunction,fn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Ca(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var s;return Ca(this.gl)?this.gl.deleteVertexArray(e):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class ii{constructor(e,s,u){this.func=e,this.mask=s,this.range=u}}ii.ReadOnly=!1,ii.ReadWrite=!0,ii.disabled=new ii(519,ii.ReadOnly,[0,1]);const Kc=7680;class Ui{constructor(e,s,u,d,m,w){this.test=e,this.ref=s,this.mask=u,this.fail=d,this.depthFail=m,this.pass=w}}Ui.disabled=new Ui({func:519,mask:0},0,0,Kc,Kc,Kc);class Ci{constructor(e,s,u){this.enable=e,this.mode=s,this.frontFace=u}}let Xa;function wo(g,e,s,u,d){const m=g.context,w=m.gl,S=g.useProgram("collisionBox"),k=[];let E=0,z=0;for(let oe=0;oe<u.length;oe++){const ce=u[oe],K=e.getTile(ce).getBucket(s);if(!K)continue;const pe=d?K.textCollisionBox:K.iconCollisionBox,ge=K.collisionCircleArray;if(ge.length>0){const Se=c.H();c.aQ(Se,K.placementInvProjMatrix,g.transform.glCoordMatrix),c.aQ(Se,Se,K.placementViewportMatrix),k.push({circleArray:ge,circleOffset:z,transform:ce.posMatrix,invTransform:Se,coord:ce}),E+=ge.length/4,z=E}pe&&S.draw(m,w.LINES,ii.disabled,Ui.disabled,g.colorModeForRenderPass(),Ci.disabled,{u_matrix:ce.posMatrix,u_pixel_extrude_scale:[1/(D=g.transform).width,1/D.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce),s.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,null,g.transform.zoom,null,null,pe.collisionVertexBuffer)}var D;if(!d||!k.length)return;const V=g.useProgram("collisionCircle"),H=new c.aR;H.resize(4*E),H._trim();let G=0;for(const oe of k)for(let ce=0;ce<oe.circleArray.length/4;ce++){const K=4*ce,pe=oe.circleArray[K+0],ge=oe.circleArray[K+1],Se=oe.circleArray[K+2],je=oe.circleArray[K+3];H.emplace(G++,pe,ge,Se,je,0),H.emplace(G++,pe,ge,Se,je,1),H.emplace(G++,pe,ge,Se,je,2),H.emplace(G++,pe,ge,Se,je,3)}(!Xa||Xa.length<2*E)&&(Xa=function(oe){const ce=2*oe,K=new c.aT;K.resize(ce),K._trim();for(let pe=0;pe<ce;pe++){const ge=6*pe;K.uint16[ge+0]=4*pe+0,K.uint16[ge+1]=4*pe+1,K.uint16[ge+2]=4*pe+2,K.uint16[ge+3]=4*pe+2,K.uint16[ge+4]=4*pe+3,K.uint16[ge+5]=4*pe+0}return K}(E));const ee=m.createIndexBuffer(Xa,!0),ae=m.createVertexBuffer(H,c.aS.members,!0);for(const oe of k){const ce=Ha(oe.transform,oe.invTransform,g.transform);V.draw(m,w.TRIANGLES,ii.disabled,Ui.disabled,g.colorModeForRenderPass(),Ci.disabled,ce,g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe.coord),s.id,ae,ee,c.a0.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,g.transform.zoom,null,null,null)}ae.destroy(),ee.destroy()}Ci.disabled=new Ci(!1,1029,2305),Ci.backCCW=new Ci(!0,1029,2305);const Tl=c.an(new Float32Array(16));function Ya(g,e,s,u,d,m){const{horizontalAlign:w,verticalAlign:S}=c.au(g);return new c.P((-(w-.5)*e/d+u[0])*m,(-(S-.5)*s/d+u[1])*m)}function Cs(g,e,s,u,d,m){const w=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let S=u.mult(m);s||(S=S.rotate(-d));const k=w.add(S);return ie(k.x,k.y,e.labelPlaneMatrix,e.getElevation).point}if(s){const S=Pe(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(g),k=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return g.add(u.rotate(k))}return g.add(u)}function Nr(g,e,s,u,d,m,w,S,k,E,z,D,V,H){const G=g.text.placedSymbolArray,ee=g.text.dynamicLayoutVertexArray,ae=g.icon.dynamicLayoutVertexArray,oe={};ee.clear();for(let ce=0;ce<G.length;ce++){const K=G.get(ce),pe=K.hidden||!K.crossTileID||g.allowVerticalPlacement&&!K.placedOrientation?null:u[K.crossTileID];if(pe){const ge=new c.P(K.anchorX,K.anchorY),Se={getElevation:H,width:d.width,height:d.height,labelPlaneMatrix:m,lineVertexArray:null,pitchWithMap:s,projection:z,projectionCache:null,tileAnchorPoint:ge,translation:D,unwrappedTileID:V},je=s?ie(ge.x,ge.y,w,H):Pe(ge.x,ge.y,Se),Ze=F(d.cameraToCenterDistance,je.signedDistanceFromCamera);let at=c.ai(g.textSizeData,k,K)*Ze/c.ap;s&&(at*=g.tilePixelRatio/S);const{width:dt,height:Qe,anchor:Je,textOffset:vt,textBoxScale:$t}=pe,it=Ya(Je,dt,Qe,vt,$t,at),lt=z.getPitchedTextCorrection(d,ge.add(new c.P(D[0],D[1])),V),Ot=Cs(je.point,Se,e,it,d.angle,lt),Zi=g.allowVerticalPlacement&&K.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let Jt=0;Jt<K.numGlyphs;Jt++)c.aj(ee,Ot,Zi);E&&K.associatedIconIndex>=0&&(oe[K.associatedIconIndex]={shiftedAnchor:Ot,angle:Zi})}else Pt(K.numGlyphs,ee)}if(E){ae.clear();const ce=g.icon.placedSymbolArray;for(let K=0;K<ce.length;K++){const pe=ce.get(K);if(pe.hidden)Pt(pe.numGlyphs,ae);else{const ge=oe[K];if(ge)for(let Se=0;Se<pe.numGlyphs;Se++)c.aj(ae,ge.shiftedAnchor,ge.angle);else Pt(pe.numGlyphs,ae)}}g.icon.dynamicLayoutVertexBuffer.updateData(ae)}g.text.dynamicLayoutVertexBuffer.updateData(ee)}function Wh(g,e,s){return s.iconsInText&&e?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Jc(g,e,s,u,d,m,w,S,k,E,z,D){const V=g.context,H=V.gl,G=g.transform,ee=Ua(),ae=S==="map",oe=k==="map",ce=S!=="viewport"&&s.layout.get("symbol-placement")!=="point",K=ae&&!oe&&!ce,pe=!oe&&ce,ge=!s.layout.get("symbol-sort-key").isConstant();let Se=!1;const je=g.depthModeForSublayer(0,ii.ReadOnly),Ze=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),at=[],dt=ee.getCircleRadiusCorrection(G);for(const Qe of u){const Je=e.getTile(Qe),vt=Je.getBucket(s);if(!vt)continue;const $t=d?vt.text:vt.icon;if(!$t||!$t.segments.get().length||!$t.hasVisibleVertices)continue;const it=$t.programConfigurations.get(s.id),lt=d||vt.sdfIcons,Ot=d?vt.textSizeData:vt.iconSizeData,Zi=oe||G.pitch!==0,Jt=g.useProgram(Wh(lt,d,vt),it),ci=c.ag(Ot,G.zoom),Xi=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Qe);let Hn,Yr,Yi,yr,ir=[0,0],nr=null;if(d)Yr=Je.glyphAtlasTexture,Yi=H.LINEAR,Hn=Je.glyphAtlasTexture.size,vt.iconsInText&&(ir=Je.imageAtlasTexture.size,nr=Je.imageAtlasTexture,yr=Zi||g.options.rotating||g.options.zooming||Ot.kind==="composite"||Ot.kind==="camera"?H.LINEAR:H.NEAREST);else{const rn=s.layout.get("icon-size").constantOr(0)!==1||vt.iconsNeedLinear;Yr=Je.imageAtlasTexture,Yi=lt||g.options.rotating||g.options.zooming||rn||Zi?H.LINEAR:H.NEAREST,Hn=Je.imageAtlasTexture.size}const rr=oi(Je,1,g.transform.zoom),ua=pe?Qe.posMatrix:Tl,Fs=Ur(ua,oe,ae,g.transform,rr),jl=En(ua,oe,ae,g.transform,rr),Kr=En(Qe.posMatrix,oe,ae,g.transform,rr),as=ee.translatePosition(g.transform,Je,m,w),Vl=Ze&&vt.hasTextData(),yu=s.layout.get("icon-text-fit")!=="none"&&Vl&&vt.hasIconData();if(ce){const rn=g.style.map.terrain?(Ns,$l)=>g.style.map.terrain.getElevation(Qe,Ns,$l):null,ya=s.layout.get("text-rotation-alignment")==="map";W(vt,Qe.posMatrix,g,d,Fs,Kr,oe,E,ya,ee,Qe.toUnwrapped(),G.width,G.height,as,rn)}const Cr=Qe.posMatrix,Jr=d&&Ze||yu,Pr=ce||Jr?Tl:Fs,La=jl,ar=lt&&s.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let qn;qn=lt?vt.iconsInText?Vc(Ot.kind,ci,K,oe,ce,Jr,g,Cr,Pr,La,as,Hn,ir,dt):vo(Ot.kind,ci,K,oe,ce,Jr,g,Cr,Pr,La,as,d,Hn,!0,dt):Ch(Ot.kind,ci,K,oe,ce,Jr,g,Cr,Pr,La,as,d,Hn,dt);const Fi={program:Jt,buffers:$t,uniformValues:qn,atlasTexture:Yr,atlasTextureIcon:nr,atlasInterpolation:Yi,atlasInterpolationIcon:yr,isSDF:lt,hasHalo:ar};if(ge&&vt.canOverlap){Se=!0;const rn=$t.segments.get();for(const ya of rn)at.push({segments:new c.a0([ya]),sortKey:ya.sortKey,state:Fi,terrainData:Xi})}else at.push({segments:$t.segments,sortKey:0,state:Fi,terrainData:Xi})}Se&&at.sort((Qe,Je)=>Qe.sortKey-Je.sortKey);for(const Qe of at){const Je=Qe.state;if(V.activeTexture.set(H.TEXTURE0),Je.atlasTexture.bind(Je.atlasInterpolation,H.CLAMP_TO_EDGE),Je.atlasTextureIcon&&(V.activeTexture.set(H.TEXTURE1),Je.atlasTextureIcon&&Je.atlasTextureIcon.bind(Je.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),Je.isSDF){const vt=Je.uniformValues;Je.hasHalo&&(vt.u_is_halo=1,Sl(Je.buffers,Qe.segments,s,g,Je.program,je,z,D,vt,Qe.terrainData)),vt.u_is_halo=0}Sl(Je.buffers,Qe.segments,s,g,Je.program,je,z,D,Je.uniformValues,Qe.terrainData)}}function Sl(g,e,s,u,d,m,w,S,k,E){const z=u.context;d.draw(z,z.gl.TRIANGLES,m,w,S,Ci.disabled,k,E,s.id,g.layoutVertexBuffer,g.indexBuffer,e,s.paint,u.transform.zoom,g.programConfigurations.get(s.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Ka(g,e,s,u){const d=g.context,m=d.gl,w=Ui.disabled,S=new fn([m.ONE,m.ONE],c.aM.transparent,[!0,!0,!0,!0]),k=e.getBucket(s);if(!k)return;const E=u.key;let z=s.heatmapFbos.get(E);z||(z=To(d,e.tileSize,e.tileSize),s.heatmapFbos.set(E,z)),d.bindFramebuffer.set(z.framebuffer),d.viewport.set([0,0,e.tileSize,e.tileSize]),d.clear({color:c.aM.transparent});const D=k.programConfigurations.get(s.id),V=g.useProgram("heatmap",D),H=g.style.map.terrain.getTerrainData(u);V.draw(d,m.TRIANGLES,ii.disabled,w,S,Ci.disabled,pr(u.posMatrix,e,g.transform.zoom,s.paint.get("heatmap-intensity")),H,s.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,s.paint,g.transform.zoom,D)}function kl(g,e,s){const u=g.context,d=u.gl;u.setColorMode(g.colorModeForRenderPass());const m=Ps(u,e),w=s.key,S=e.heatmapFbos.get(w);S&&(u.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,S.colorAttachment.get()),u.activeTexture.set(d.TEXTURE1),m.bind(d.LINEAR,d.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(u,d.TRIANGLES,ii.disabled,Ui.disabled,g.colorModeForRenderPass(),Ci.disabled,gl(g,e,0,1),null,e.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,e.paint,g.transform.zoom),S.destroy(),e.heatmapFbos.delete(w))}function To(g,e,s){var u,d;const m=g.gl,w=m.createTexture();m.bindTexture(m.TEXTURE_2D,w),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const S=(u=g.HALF_FLOAT)!==null&&u!==void 0?u:m.UNSIGNED_BYTE,k=(d=g.RGBA16F)!==null&&d!==void 0?d:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,k,e,s,0,m.RGBA,S,null);const E=g.createFramebuffer(e,s,!1,!1);return E.colorAttachment.set(w),E}function Ps(g,e){return e.colorRampTexture||(e.colorRampTexture=new we(g,e.colorRamp,g.gl.RGBA)),e.colorRampTexture}function So(g,e,s,u,d){if(!s||!u||!u.imageAtlas)return;const m=u.imageAtlas.patternPositions;let w=m[s.to.toString()],S=m[s.from.toString()];if(!w&&S&&(w=S),!S&&w&&(S=w),!w||!S){const k=d.getPaintProperty(e);w=m[k],S=m[k]}w&&S&&g.setConstantPatternPositions(w,S)}function Qc(g,e,s,u,d,m,w){const S=g.context.gl,k="fill-pattern",E=s.paint.get(k),z=E&&E.constantOr(1),D=s.getCrossfadeParameters();let V,H,G,ee,ae;w?(H=z&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=S.LINES):(H=z?"fillPattern":"fill",V=S.TRIANGLES);const oe=E.constantOr(null);for(const ce of u){const K=e.getTile(ce);if(z&&!K.patternsLoaded())continue;const pe=K.getBucket(s);if(!pe)continue;const ge=pe.programConfigurations.get(s.id),Se=g.useProgram(H,ge),je=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce);z&&(g.context.activeTexture.set(S.TEXTURE0),K.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),ge.updatePaintBuffers(D)),So(ge,k,oe,K,s);const Ze=je?ce:null,at=g.translatePosMatrix(Ze?Ze.posMatrix:ce.posMatrix,K,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(w){ee=pe.indexBuffer2,ae=pe.segments2;const dt=[S.drawingBufferWidth,S.drawingBufferHeight];G=H==="fillOutlinePattern"&&z?Ah(at,g,D,K,dt):Hf(at,dt)}else ee=pe.indexBuffer,ae=pe.segments,G=z?kh(at,g,D,K):Ms(at);Se.draw(g.context,V,d,g.stencilModeForClipping(ce),m,Ci.disabled,G,je,s.id,pe.layoutVertexBuffer,ee,ae,s.paint,g.transform.zoom,ge)}}function Pa(g,e,s,u,d,m,w){const S=g.context,k=S.gl,E="fill-extrusion-pattern",z=s.paint.get(E),D=z.constantOr(1),V=s.getCrossfadeParameters(),H=s.paint.get("fill-extrusion-opacity"),G=z.constantOr(null);for(const ee of u){const ae=e.getTile(ee),oe=ae.getBucket(s);if(!oe)continue;const ce=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ee),K=oe.programConfigurations.get(s.id),pe=g.useProgram(D?"fillExtrusionPattern":"fillExtrusion",K);D&&(g.context.activeTexture.set(k.TEXTURE0),ae.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),K.updatePaintBuffers(V)),So(K,E,G,ae,s);const ge=g.translatePosMatrix(ee.posMatrix,ae,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Se=s.paint.get("fill-extrusion-vertical-gradient"),je=D?ml(ge,g,Se,H,ee,V,ae):yo(ge,g,Se,H);pe.draw(S,S.gl.TRIANGLES,d,m,w,Ci.backCCW,je,ce,s.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,s.paint,g.transform.zoom,K,g.style.map.terrain&&oe.centroidVertexBuffer)}}function zs(g,e,s,u,d,m,w){const S=g.context,k=S.gl,E=s.fbo;if(!E)return;const z=g.useProgram("hillshade"),D=g.style.map.terrain&&g.style.map.terrain.getTerrainData(e);S.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,E.colorAttachment.get()),z.draw(S,k.TRIANGLES,d,m,w,Ci.disabled,((V,H,G,ee)=>{const ae=G.paint.get("hillshade-shadow-color"),oe=G.paint.get("hillshade-highlight-color"),ce=G.paint.get("hillshade-accent-color");let K=G.paint.get("hillshade-illumination-direction")*(Math.PI/180);G.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=V.transform.angle);const pe=!V.options.moving;return{u_matrix:ee?ee.posMatrix:V.transform.calculatePosMatrix(H.tileID.toUnwrapped(),pe),u_image:0,u_latrange:yl(0,H.tileID),u_light:[G.paint.get("hillshade-exaggeration"),K],u_shadow:ae,u_highlight:oe,u_accent:ce}})(g,s,u,D?e:null),D,u.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function Hh(g,e,s,u,d,m){const w=g.context,S=w.gl,k=e.dem;if(k&&k.data){const E=k.dim,z=k.stride,D=k.getPixels();if(w.activeTexture.set(S.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||g.getTileTexture(z),e.demTexture){const H=e.demTexture;H.update(D,{premultiply:!1}),H.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else e.demTexture=new we(w,D,S.RGBA,{premultiply:!1}),e.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);w.activeTexture.set(S.TEXTURE0);let V=e.fbo;if(!V){const H=new we(w,{width:E,height:E,data:null},S.RGBA);H.bind(S.LINEAR,S.CLAMP_TO_EDGE),V=e.fbo=w.createFramebuffer(E,E,!0,!1),V.colorAttachment.set(H.texture)}w.bindFramebuffer.set(V.framebuffer),w.viewport.set([0,0,E,E]),g.useProgram("hillshadePrepare").draw(w,S.TRIANGLES,u,d,m,Ci.disabled,((H,G)=>{const ee=G.stride,ae=c.H();return c.aP(ae,0,c.X,-c.X,0,0,1),c.J(ae,ae,[0,-c.X,0]),{u_matrix:ae,u_image:1,u_dimension:[ee,ee],u_zoom:H.overscaledZ,u_unpack:G.getUnpackVector()}})(e.tileID,k),null,s.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function eu(g,e,s,u,d,m){const w=u.paint.get("raster-fade-duration");if(!m&&w>0){const S=R.now(),k=(S-g.timeAdded)/w,E=e?(S-e.timeAdded)/w:-1,z=s.getSource(),D=d.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),V=!e||Math.abs(e.tileID.overscaledZ-D)>Math.abs(g.tileID.overscaledZ-D),H=V&&g.refreshedUponExpiration?1:c.ac(V?k:1-E,0,1);return g.refreshedUponExpiration&&k>=1&&(g.refreshedUponExpiration=!1),e?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const yi=new c.aM(1,0,0,1),Al=new c.aM(0,1,0,1),sp=new c.aM(0,0,1,1),qh=new c.aM(1,0,1,1),ko=new c.aM(0,1,1,1);function Gh(g,e,s,u){Ao(g,0,e+s/2,g.transform.width,s,u)}function Zh(g,e,s,u){Ao(g,e-s/2,0,s,g.transform.height,u)}function Ao(g,e,s,u,d,m){const w=g.context,S=w.gl;S.enable(S.SCISSOR_TEST),S.scissor(e*g.pixelRatio,s*g.pixelRatio,u*g.pixelRatio,d*g.pixelRatio),w.clear({color:m}),S.disable(S.SCISSOR_TEST)}function op(g,e,s){const u=g.context,d=u.gl,m=s.posMatrix,w=g.useProgram("debug"),S=ii.disabled,k=Ui.disabled,E=g.colorModeForRenderPass(),z="$debug",D=g.style.map.terrain&&g.style.map.terrain.getTerrainData(s);u.activeTexture.set(d.TEXTURE0);const V=e.getTileByID(s.key).latestRawTileData,H=Math.floor((V&&V.byteLength||0)/1024),G=e.getTile(s).tileSize,ee=512/Math.min(G,512)*(s.overscaledZ/g.transform.zoom)*.5;let ae=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ae+=` => ${s.overscaledZ}`),function(oe,ce){oe.initDebugOverlayCanvas();const K=oe.debugOverlayCanvas,pe=oe.context.gl,ge=oe.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,K.width,K.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(ce,5,5),ge.strokeText(ce,5,5),oe.debugOverlayTexture.update(K),oe.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(g,`${ae} ${H}kB`),w.draw(u,d.TRIANGLES,S,k,fn.alphaBlended,Ci.disabled,_o(m,c.aM.transparent,ee),null,z,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),w.draw(u,d.LINE_STRIP,S,k,E,Ci.disabled,_o(m,c.aM.red),D,z,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function Ml(g,e,s){const u=g.context,d=u.gl,m=g.colorModeForRenderPass(),w=new ii(d.LEQUAL,ii.ReadWrite,g.depthRangeFor3D),S=g.useProgram("terrain"),k=e.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,g.width,g.height]);for(const E of s){const z=g.renderToTexture.getTexture(E),D=e.getTerrainData(E.tileID);u.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,z.texture);const V=g.transform.calculatePosMatrix(E.tileID.toUnwrapped()),H=e.getMeshFrameDelta(g.transform.zoom),G=g.transform.calculateFogMatrix(E.tileID.toUnwrapped()),ee=Nc(V,H,G,g.style.sky,g.transform.pitch);S.draw(u,d.TRIANGLES,w,Ui.disabled,m,Ci.backCCW,ee,D,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class Mo{constructor(e,s,u){this.vertexBuffer=e,this.indexBuffer=s,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Il{constructor(e,s){this.context=new ap(e),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=kt.maxUnderzooming+kt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Oc}resize(e,s,u){if(this.width=Math.floor(e*u),this.height=Math.floor(s*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const e=this.context,s=new c.aX;s.emplaceBack(0,0),s.emplaceBack(c.X,0),s.emplaceBack(0,c.X),s.emplaceBack(c.X,c.X),this.tileExtentBuffer=e.createVertexBuffer(s,Wa.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const u=new c.aX;u.emplaceBack(0,0),u.emplaceBack(c.X,0),u.emplaceBack(0,c.X),u.emplaceBack(c.X,c.X),this.debugBuffer=e.createVertexBuffer(u,Wa.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const d=new c.$;d.emplaceBack(0,0,0,0),d.emplaceBack(c.X,0,c.X,0),d.emplaceBack(0,c.X,0,c.X),d.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=e.createVertexBuffer(d,bn.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const m=new c.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(m,Wa.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const w=new c.aZ;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(w);const S=new c.aY;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(S);const k=this.context.gl;this.stencilClearMode=new Ui({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const e=this.context,s=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=c.H();c.aP(u,0,this.width,this.height,0,0,1),c.K(u,u,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,s.TRIANGLES,ii.disabled,this.stencilClearMode,fn.disabled,Ci.disabled,fr(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,s){if(this.currentStencilSource===e.source||!e.isTileClipped()||!s||!s.length)return;this.currentStencilSource=e.source;const u=this.context,d=u.gl;this.nextStencilID+s.length>256&&this.clearStencil(),u.setColorMode(fn.disabled),u.setDepthMode(ii.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of s){const S=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);m.draw(u,d.TRIANGLES,ii.disabled,new Ui({func:d.ALWAYS,mask:0},S,255,d.KEEP,d.KEEP,d.REPLACE),fn.disabled,Ci.disabled,fr(w.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,s=this.context.gl;return new Ui({func:s.NOTEQUAL,mask:255},e,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(e){const s=this.context.gl;return new Ui({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(e){const s=this.context.gl,u=e.sort((w,S)=>S.overscaledZ-w.overscaledZ),d=u[u.length-1].overscaledZ,m=u[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const w={};for(let S=0;S<m;S++)w[S+d]=new Ui({func:s.GEQUAL,mask:255},S+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=m,[w,u]}return[{[d]:Ui.disabled},u]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new fn([e.CONSTANT_COLOR,e.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fn.unblended:fn.alphaBlended}depthModeForSublayer(e,s,u){if(!this.opaquePassEnabledForLayer())return ii.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ii(u||this.context.gl.LEQUAL,s,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,s){this.style=e,this.options=s,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(R.now()),this.imageManager.beginFrame();const u=this.style._order,d=this.style.sourceCaches,m={},w={},S={};for(const k in d){const E=d[k];E.used&&E.prepare(this.context),m[k]=E.getVisibleCoordinates(),w[k]=m[k].slice().reverse(),S[k]=E.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<u.length;k++)if(this.style._layers[u[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of u){const E=this.style._layers[k];if(!E.hasOffscreenPass()||E.isHidden(this.transform.zoom))continue;const z=w[E.source];(E.type==="custom"||z.length)&&this.renderLayer(this,d[E.source],E,z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,E){const z=k.context,D=z.gl,V=((oe,ce,K)=>({u_sky_color:oe.properties.get("sky-color"),u_horizon_color:oe.properties.get("horizon-color"),u_horizon:(ce.height/2+ce.getHorizon())*K,u_sky_horizon_blend:oe.properties.get("sky-horizon-blend")*ce.height/2*K}))(E,k.style.map.transform,k.pixelRatio),H=new ii(D.LEQUAL,ii.ReadWrite,[0,1]),G=Ui.disabled,ee=k.colorModeForRenderPass(),ae=k.useProgram("sky");if(!E.mesh){const oe=new c.aX;oe.emplaceBack(-1,-1),oe.emplaceBack(1,-1),oe.emplaceBack(1,1),oe.emplaceBack(-1,1);const ce=new c.aY;ce.emplaceBack(0,1,2),ce.emplaceBack(0,2,3),E.mesh=new Mo(z.createVertexBuffer(oe,Wa.members),z.createIndexBuffer(ce),c.a0.simpleSegment(0,0,oe.length,ce.length))}ae.draw(z,D.TRIANGLES,H,G,ee,Ci.disabled,V,void 0,"sky",E.mesh.vertexBuffer,E.mesh.indexBuffer,E.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[u[this.currentLayer]],E=d[k.source],z=m[k.source];this._renderTileClippingMasks(k,z),this.renderLayer(this,E,k,z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const k=this.style._layers[u[this.currentLayer]],E=d[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const z=(k.type==="symbol"?S:w)[k.source];this._renderTileClippingMasks(k,m[k.source]),this.renderLayer(this,E,k,z)}if(this.options.showTileBoundaries){const k=function(E,z){let D=null;const V=Object.values(E._layers).flatMap(ae=>ae.source&&!ae.isHidden(z)?[E.sourceCaches[ae.source]]:[]),H=V.filter(ae=>ae.getSource().type==="vector"),G=V.filter(ae=>ae.getSource().type!=="vector"),ee=ae=>{(!D||D.getSource().maxzoom<ae.getSource().maxzoom)&&(D=ae)};return H.forEach(ae=>ee(ae)),D||G.forEach(ae=>ee(ae)),D}(this.style,this.transform.zoom);k&&function(E,z,D){for(let V=0;V<D.length;V++)op(E,z,D[V])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const E=k.transform.padding;Gh(k,k.transform.height-(E.top||0),3,yi),Gh(k,E.bottom||0,3,Al),Zh(k,E.left||0,3,sp),Zh(k,k.transform.width-(E.right||0),3,qh);const z=k.transform.centerPoint;(function(D,V,H,G){Ao(D,V-1,H-10,2,20,G),Ao(D,V-10,H-1,20,2,G)})(k,z.x,k.transform.height-z.y,ko)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=e?!c.a_(s,u):!c.a$(s,u)),d||(d=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),d&&(c.b0(s,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,w){const S=m.context,k=S.gl,E=fn.unblended,z=new ii(k.LEQUAL,ii.ReadWrite,[0,1]),D=w.getTerrainMesh(),V=w.sourceCache.getRenderableTiles(),H=m.useProgram("terrainDepth");S.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),S.clear({color:c.aM.transparent,depth:1});for(const G of V){const ee=w.getTerrainData(G.tileID),ae={u_matrix:m.transform.calculatePosMatrix(G.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(m.transform.zoom)};H.draw(S,k.TRIANGLES,z,Ui.disabled,E,Ci.backCCW,ae,ee,"terrain",D.vertexBuffer,D.indexBuffer,D.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,w){const S=m.context,k=S.gl,E=fn.unblended,z=new ii(k.LEQUAL,ii.ReadWrite,[0,1]),D=w.getTerrainMesh(),V=w.getCoordsTexture(),H=w.sourceCache.getRenderableTiles(),G=m.useProgram("terrainCoords");S.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),S.clear({color:c.aM.transparent,depth:1}),w.coordsIndex=[];for(const ee of H){const ae=w.getTerrainData(ee.tileID);S.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,V.texture);const oe={u_matrix:m.transform.calculatePosMatrix(ee.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(m.transform.zoom)};G.draw(S,k.TRIANGLES,z,Ui.disabled,E,Ci.backCCW,oe,ae,"terrain",D.vertexBuffer,D.indexBuffer,D.segments),w.coordsIndex.push(ee.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,s,u,d){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(d||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(m,w,S,k,E){if(m.renderPass!=="translucent")return;const z=Ui.disabled,D=m.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(V,H,G,ee,ae,oe,ce,K,pe){const ge=H.transform,Se=Ua(),je=ae==="map",Ze=oe==="map";for(const at of V){const dt=ee.getTile(at),Qe=dt.getBucket(G);if(!Qe||!Qe.text||!Qe.text.segments.get().length)continue;const Je=c.ag(Qe.textSizeData,ge.zoom),vt=oi(dt,1,H.transform.zoom),$t=Ur(at.posMatrix,Ze,je,H.transform,vt),it=G.layout.get("icon-text-fit")!=="none"&&Qe.hasIconData();if(Je){const lt=Math.pow(2,ge.zoom-dt.tileID.overscaledZ),Ot=H.style.map.terrain?(Jt,ci)=>H.style.map.terrain.getElevation(at,Jt,ci):null,Zi=Se.translatePosition(ge,dt,ce,K);Nr(Qe,je,Ze,pe,ge,$t,at.posMatrix,lt,Je,it,Se,Zi,at.toUnwrapped(),Ot)}}}(k,m,S,w,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),E),S.paint.get("icon-opacity").constantOr(1)!==0&&Jc(m,w,S,k,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),z,D),S.paint.get("text-opacity").constantOr(1)!==0&&Jc(m,w,S,k,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),z,D),w.map.showCollisionBoxes&&(wo(m,w,S,k,!0),wo(m,w,S,k,!1))})(e,s,u,d,this.style.placement.variableOffsets);break;case"circle":(function(m,w,S,k){if(m.renderPass!=="translucent")return;const E=S.paint.get("circle-opacity"),z=S.paint.get("circle-stroke-width"),D=S.paint.get("circle-stroke-opacity"),V=!S.layout.get("circle-sort-key").isConstant();if(E.constantOr(1)===0&&(z.constantOr(1)===0||D.constantOr(1)===0))return;const H=m.context,G=H.gl,ee=m.depthModeForSublayer(0,ii.ReadOnly),ae=Ui.disabled,oe=m.colorModeForRenderPass(),ce=[];for(let K=0;K<k.length;K++){const pe=k[K],ge=w.getTile(pe),Se=ge.getBucket(S);if(!Se)continue;const je=Se.programConfigurations.get(S.id),Ze=m.useProgram("circle",je),at=Se.layoutVertexBuffer,dt=Se.indexBuffer,Qe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(pe),Je={programConfiguration:je,program:Ze,layoutVertexBuffer:at,indexBuffer:dt,uniformValues:qf(m,pe,ge,S),terrainData:Qe};if(V){const vt=Se.segments.get();for(const $t of vt)ce.push({segments:new c.a0([$t]),sortKey:$t.sortKey,state:Je})}else ce.push({segments:Se.segments,sortKey:0,state:Je})}V&&ce.sort((K,pe)=>K.sortKey-pe.sortKey);for(const K of ce){const{programConfiguration:pe,program:ge,layoutVertexBuffer:Se,indexBuffer:je,uniformValues:Ze,terrainData:at}=K.state;ge.draw(H,G.TRIANGLES,ee,ae,oe,Ci.disabled,Ze,at,S.id,Se,je,K.segments,S.paint,m.transform.zoom,pe)}})(e,s,u,d);break;case"heatmap":(function(m,w,S,k){if(S.paint.get("heatmap-opacity")===0)return;const E=m.context;if(m.style.map.terrain){for(const z of k){const D=w.getTile(z);w.hasRenderableParent(z)||(m.renderPass==="offscreen"?Ka(m,D,S,z):m.renderPass==="translucent"&&kl(m,S,z))}E.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?function(z,D,V,H){const G=z.context,ee=G.gl,ae=Ui.disabled,oe=new fn([ee.ONE,ee.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(ce,K,pe){const ge=ce.gl;ce.activeTexture.set(ge.TEXTURE1),ce.viewport.set([0,0,K.width/4,K.height/4]);let Se=pe.heatmapFbos.get(c.aU);Se?(ge.bindTexture(ge.TEXTURE_2D,Se.colorAttachment.get()),ce.bindFramebuffer.set(Se.framebuffer)):(Se=To(ce,K.width/4,K.height/4),pe.heatmapFbos.set(c.aU,Se))})(G,z,V),G.clear({color:c.aM.transparent});for(let ce=0;ce<H.length;ce++){const K=H[ce];if(D.hasRenderableParent(K))continue;const pe=D.getTile(K),ge=pe.getBucket(V);if(!ge)continue;const Se=ge.programConfigurations.get(V.id),je=z.useProgram("heatmap",Se),{zoom:Ze}=z.transform;je.draw(G,ee.TRIANGLES,ii.disabled,ae,oe,Ci.disabled,pr(K.posMatrix,pe,Ze,V.paint.get("heatmap-intensity")),null,V.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,V.paint,z.transform.zoom,Se)}G.viewport.set([0,0,z.width,z.height])}(m,w,S,k):m.renderPass==="translucent"&&function(z,D){const V=z.context,H=V.gl;V.setColorMode(z.colorModeForRenderPass());const G=D.heatmapFbos.get(c.aU);G&&(V.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,G.colorAttachment.get()),V.activeTexture.set(H.TEXTURE1),Ps(V,D).bind(H.LINEAR,H.CLAMP_TO_EDGE),z.useProgram("heatmapTexture").draw(V,H.TRIANGLES,ii.disabled,Ui.disabled,z.colorModeForRenderPass(),Ci.disabled,gl(z,D,0,1),null,D.id,z.viewportBuffer,z.quadTriangleIndexBuffer,z.viewportSegments,D.paint,z.transform.zoom))}(m,S)})(e,s,u,d);break;case"line":(function(m,w,S,k){if(m.renderPass!=="translucent")return;const E=S.paint.get("line-opacity"),z=S.paint.get("line-width");if(E.constantOr(1)===0||z.constantOr(1)===0)return;const D=m.depthModeForSublayer(0,ii.ReadOnly),V=m.colorModeForRenderPass(),H=S.paint.get("line-dasharray"),G=S.paint.get("line-pattern"),ee=G.constantOr(1),ae=S.paint.get("line-gradient"),oe=S.getCrossfadeParameters(),ce=ee?"linePattern":H?"lineSDF":ae?"lineGradient":"line",K=m.context,pe=K.gl;let ge=!0;for(const Se of k){const je=w.getTile(Se);if(ee&&!je.patternsLoaded())continue;const Ze=je.getBucket(S);if(!Ze)continue;const at=Ze.programConfigurations.get(S.id),dt=m.context.program.get(),Qe=m.useProgram(ce,at),Je=ge||Qe.program!==dt,vt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Se),$t=G.constantOr(null);if($t&&je.imageAtlas){const Ot=je.imageAtlas,Zi=Ot.patternPositions[$t.to.toString()],Jt=Ot.patternPositions[$t.from.toString()];Zi&&Jt&&at.setConstantPatternPositions(Zi,Jt)}const it=vt?Se:null,lt=ee?Is(m,je,S,oe,it):H?Gf(m,je,S,H,oe,it):ae?Mh(m,je,S,Ze.lineClipsArray.length,it):_l(m,je,S,it);if(ee)K.activeTexture.set(pe.TEXTURE0),je.imageAtlasTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),at.updatePaintBuffers(oe);else if(H&&(Je||m.lineAtlas.dirty))K.activeTexture.set(pe.TEXTURE0),m.lineAtlas.bind(K);else if(ae){const Ot=Ze.gradients[S.id];let Zi=Ot.texture;if(S.gradientVersion!==Ot.version){let Jt=256;if(S.stepInterpolant){const ci=w.getSource().maxzoom,Xi=Se.canonical.z===ci?Math.ceil(1<<m.transform.maxZoom-Se.canonical.z):1;Jt=c.ac(c.aV(Ze.maxLineLength/c.X*1024*Xi),256,K.maxTextureSize)}Ot.gradient=c.aW({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:Jt,image:Ot.gradient||void 0,clips:Ze.lineClipsArray}),Ot.texture?Ot.texture.update(Ot.gradient):Ot.texture=new we(K,Ot.gradient,pe.RGBA),Ot.version=S.gradientVersion,Zi=Ot.texture}K.activeTexture.set(pe.TEXTURE0),Zi.bind(S.stepInterpolant?pe.NEAREST:pe.LINEAR,pe.CLAMP_TO_EDGE)}Qe.draw(K,pe.TRIANGLES,D,m.stencilModeForClipping(Se),V,Ci.disabled,lt,vt,S.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,S.paint,m.transform.zoom,at,Ze.layoutVertexBuffer2),ge=!1}})(e,s,u,d);break;case"fill":(function(m,w,S,k){const E=S.paint.get("fill-color"),z=S.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const D=m.colorModeForRenderPass(),V=S.paint.get("fill-pattern"),H=m.opaquePassEnabledForLayer()&&!V.constantOr(1)&&E.constantOr(c.aM.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===H){const G=m.depthModeForSublayer(1,m.renderPass==="opaque"?ii.ReadWrite:ii.ReadOnly);Qc(m,w,S,k,G,D,!1)}if(m.renderPass==="translucent"&&S.paint.get("fill-antialias")){const G=m.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,ii.ReadOnly);Qc(m,w,S,k,G,D,!0)}})(e,s,u,d);break;case"fill-extrusion":(function(m,w,S,k){const E=S.paint.get("fill-extrusion-opacity");if(E!==0&&m.renderPass==="translucent"){const z=new ii(m.context.gl.LEQUAL,ii.ReadWrite,m.depthRangeFor3D);if(E!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))Pa(m,w,S,k,z,Ui.disabled,fn.disabled),Pa(m,w,S,k,z,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const D=m.colorModeForRenderPass();Pa(m,w,S,k,z,Ui.disabled,D)}}})(e,s,u,d);break;case"hillshade":(function(m,w,S,k){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const E=m.context,z=m.depthModeForSublayer(0,ii.ReadOnly),D=m.colorModeForRenderPass(),[V,H]=m.renderPass==="translucent"?m.stencilConfigForOverlap(k):[{},k];for(const G of H){const ee=w.getTile(G);ee.needsHillshadePrepare!==void 0&&ee.needsHillshadePrepare&&m.renderPass==="offscreen"?Hh(m,ee,S,z,Ui.disabled,D):m.renderPass==="translucent"&&zs(m,G,ee,S,z,V[G.overscaledZ],D)}E.viewport.set([0,0,m.width,m.height])})(e,s,u,d);break;case"raster":(function(m,w,S,k){if(m.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!k.length)return;const E=m.context,z=E.gl,D=w.getSource(),V=m.useProgram("raster"),H=m.colorModeForRenderPass(),[G,ee]=D instanceof Jn?[{},k]:m.stencilConfigForOverlap(k),ae=ee[ee.length-1].overscaledZ,oe=!m.options.moving;for(const ce of ee){const K=m.depthModeForSublayer(ce.overscaledZ-ae,S.paint.get("raster-opacity")===1?ii.ReadWrite:ii.ReadOnly,z.LESS),pe=w.getTile(ce);pe.registerFadeDuration(S.paint.get("raster-fade-duration"));const ge=w.findLoadedParent(ce,0),Se=w.findLoadedSibling(ce),je=eu(pe,ge||Se||null,w,S,m.transform,m.style.map.terrain);let Ze,at;const dt=S.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;E.activeTexture.set(z.TEXTURE0),pe.texture.bind(dt,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(z.TEXTURE1),ge?(ge.texture.bind(dt,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),Ze=Math.pow(2,ge.tileID.overscaledZ-pe.tileID.overscaledZ),at=[pe.tileID.canonical.x*Ze%1,pe.tileID.canonical.y*Ze%1]):pe.texture.bind(dt,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),pe.texture.useMipmap&&E.extTextureFilterAnisotropic&&m.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax);const Qe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ce),Je=Qe?ce:null,vt=Je?Je.posMatrix:m.transform.calculatePosMatrix(ce.toUnwrapped(),oe),$t=Zf(vt,at||[0,0],Ze||1,je,S);D instanceof Jn?V.draw(E,z.TRIANGLES,K,Ui.disabled,H,Ci.disabled,$t,Qe,S.id,D.boundsBuffer,m.quadTriangleIndexBuffer,D.boundsSegments):V.draw(E,z.TRIANGLES,K,G[ce.overscaledZ],H,Ci.disabled,$t,Qe,S.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(e,s,u,d);break;case"background":(function(m,w,S,k){const E=S.paint.get("background-color"),z=S.paint.get("background-opacity");if(z===0)return;const D=m.context,V=D.gl,H=m.transform,G=H.tileSize,ee=S.paint.get("background-pattern");if(m.isPatternMissing(ee))return;const ae=!ee&&E.a===1&&z===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ae)return;const oe=Ui.disabled,ce=m.depthModeForSublayer(0,ae==="opaque"?ii.ReadWrite:ii.ReadOnly),K=m.colorModeForRenderPass(),pe=m.useProgram(ee?"backgroundPattern":"background"),ge=k||H.coveringTiles({tileSize:G,terrain:m.style.map.terrain});ee&&(D.activeTexture.set(V.TEXTURE0),m.imageManager.bind(m.context));const Se=S.getCrossfadeParameters();for(const je of ge){const Ze=k?je.posMatrix:m.transform.calculatePosMatrix(je.toUnwrapped()),at=ee?$c(Ze,z,m,ee,{tileID:je,tileSize:G},Se):vl(Ze,z,E),dt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(je);pe.draw(D,V.TRIANGLES,ce,oe,K,Ci.disabled,at,dt,S.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(e,0,u,d);break;case"custom":(function(m,w,S){const k=m.context,E=S.implementation;if(m.renderPass==="offscreen"){const z=E.prerender;z&&(m.setCustomLayerDefaults(),k.setColorMode(m.colorModeForRenderPass()),z.call(E,k.gl,m.transform.customLayerMatrix()),k.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),k.setColorMode(m.colorModeForRenderPass()),k.setStencilMode(Ui.disabled);const z=E.renderingMode==="3d"?new ii(m.context.gl.LEQUAL,ii.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,ii.ReadOnly);k.setDepthMode(z),E.render(k.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),k.setDirty(),m.setBaseState(),k.bindFramebuffer.set(null)}})(e,0,u)}}translatePosMatrix(e,s,u,d,m){if(!u[0]&&!u[1])return e;const w=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(w){const E=Math.sin(w),z=Math.cos(w);u=[u[0]*z-u[1]*E,u[0]*E+u[1]*z]}const S=[m?u[0]:oi(s,u[0],this.transform.zoom),m?u[1]:oi(s,u[1],this.transform.zoom),0],k=new Float32Array(16);return c.J(k,e,S),k}saveTileTexture(e){const s=this._tileTextures[e.size[0]];s?s.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const s=this._tileTextures[e];return s&&s.length>0?s.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const s=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!s||!u}useProgram(e,s){this.cache=this.cache||{};const u=e+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new jc(this.context,Ea[e],s,Uc[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new we(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:s}=this.context.gl;return this.width!==e||this.height!==s}}class Io{constructor(e,s){this.points=e,this.planes=s}static fromInvProjectionMatrix(e,s,u){const d=Math.pow(2,u),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const k=1/(S=c.af([],S,e))[3]/s*d;return c.b1(S,S,[k,k,1/S[3],k])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const k=function(V,H){var G=H[0],ee=H[1],ae=H[2],oe=G*G+ee*ee+ae*ae;return oe>0&&(oe=1/Math.sqrt(oe)),V[0]=H[0]*oe,V[1]=H[1]*oe,V[2]=H[2]*oe,V}([],function(V,H,G){var ee=H[0],ae=H[1],oe=H[2],ce=G[0],K=G[1],pe=G[2];return V[0]=ae*pe-oe*K,V[1]=oe*ce-ee*pe,V[2]=ee*K-ae*ce,V}([],de([],m[S[0]],m[S[1]]),de([],m[S[2]],m[S[1]]))),E=-((z=k)[0]*(D=m[S[1]])[0]+z[1]*D[1]+z[2]*D[2]);var z,D;return k.concat(E)});return new Io(m,w)}}class Ds{constructor(e,s){this.min=e,this.max=s,this.center=function(u,d,m){return u[0]=.5*d[0],u[1]=.5*d[1],u[2]=.5*d[2],u}([],function(u,d,m){return u[0]=d[0]+m[0],u[1]=d[1]+m[1],u[2]=d[2]+m[2],u}([],this.min,this.max))}quadrant(e){const s=[e%2==0,e<2],u=be(this.min),d=be(this.max);for(let m=0;m<s.length;m++)u[m]=s[m]?this.min[m]:this.center[m],d[m]=s[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new Ds(u,d)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let d=0;d<e.planes.length;d++){const m=e.planes[d];let w=0;for(let S=0;S<s.length;S++)c.b2(m,s[S])>=0&&w++;if(w===0)return 0;w!==s.length&&(u=!1)}if(u)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let S=0;S<e.points.length;S++){const k=e.points[S][d]-this.min[d];m=Math.min(m,k),w=Math.max(w,k)}if(w<0||m>this.max[d]-this.min[d])return 0}return 1}}class Eo{constructor(e=0,s=0,u=0,d=0){if(isNaN(e)||e<0||isNaN(s)||s<0||isNaN(u)||u<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=s,this.left=u,this.right=d}interpolate(e,s,u){return s.top!=null&&e.top!=null&&(this.top=c.y.number(e.top,s.top,u)),s.bottom!=null&&e.bottom!=null&&(this.bottom=c.y.number(e.bottom,s.bottom,u)),s.left!=null&&e.left!=null&&(this.left=c.y.number(e.left,s.left,u)),s.right!=null&&e.right!=null&&(this.right=c.y.number(e.right,s.right,u)),this}getCenter(e,s){const u=c.ac((this.left+e-this.right)/2,0,e),d=c.ac((this.top+s-this.bottom)/2,0,s);return new c.P(u,d)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Eo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Co=85.051129;class Ls{constructor(e,s,u,d,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=e||0,this._maxZoom=s||22,this._minPitch=u??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Eo,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new Ls(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const s=-c.b3(e,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=function(){var u=new c.A(4);return c.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,d,m){var w=d[0],S=d[1],k=d[2],E=d[3],z=Math.sin(m),D=Math.cos(m);u[0]=w*D+k*z,u[1]=S*D+E*z,u[2]=w*-z+k*D,u[3]=S*-z+E*D}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const s=c.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const s=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,s,u){this._unmodified=!1,this._edgeInsets.interpolate(e,s,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const s=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(e){const s=[new c.b4(0,e)];if(this._renderWorldCopies){const u=this.pointCoordinate(new c.P(0,0)),d=this.pointCoordinate(new c.P(this.width,0)),m=this.pointCoordinate(new c.P(this.width,this.height)),w=this.pointCoordinate(new c.P(0,this.height)),S=Math.floor(Math.min(u.x,d.x,m.x,w.x)),k=Math.floor(Math.max(u.x,d.x,m.x,w.x)),E=1;for(let z=S-E;z<=k+E;z++)z!==0&&s.push(new c.b4(z,e))}return s}coveringTiles(e){var s,u;let d=this.coveringZoomLevel(e);const m=d;if(e.minzoom!==void 0&&d<e.minzoom)return[];e.maxzoom!==void 0&&d>e.maxzoom&&(d=e.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),S=c.Z.fromLngLat(this.center),k=Math.pow(2,d),E=[k*w.x,k*w.y,0],z=[k*S.x,k*S.y,0],D=Io.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,d);let V=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(V=d);const H=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,G=K=>({aabb:new Ds([K*k,0,0],[(K+1)*k,k,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),ee=[],ae=[],oe=d,ce=e.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let K=1;K<=3;K++)ee.push(G(-K)),ee.push(G(K));for(ee.push(G(0));ee.length>0;){const K=ee.pop(),pe=K.x,ge=K.y;let Se=K.fullyVisible;if(!Se){const Qe=K.aabb.intersects(D);if(Qe===0)continue;Se=Qe===2}const je=e.terrain?E:z,Ze=K.aabb.distanceX(je),at=K.aabb.distanceY(je),dt=Math.max(Math.abs(Ze),Math.abs(at));if(K.zoom===oe||dt>H+(1<<oe-K.zoom)-2&&K.zoom>=V){const Qe=oe-K.zoom,Je=E[0]-.5-(pe<<Qe),vt=E[1]-.5-(ge<<Qe);ae.push({tileID:new c.S(K.zoom===oe?ce:K.zoom,K.wrap,K.zoom,pe,ge),distanceSq:Be([z[0]-.5-pe,z[1]-.5-ge]),tileDistanceToCamera:Math.sqrt(Je*Je+vt*vt)})}else for(let Qe=0;Qe<4;Qe++){const Je=(pe<<1)+Qe%2,vt=(ge<<1)+(Qe>>1),$t=K.zoom+1;let it=K.aabb.quadrant(Qe);if(e.terrain){const lt=new c.S($t,K.wrap,$t,Je,vt),Ot=e.terrain.getMinMaxElevation(lt),Zi=(s=Ot.minElevation)!==null&&s!==void 0?s:this.elevation,Jt=(u=Ot.maxElevation)!==null&&u!==void 0?u:this.elevation;it=new Ds([it.min[0],it.min[1],Zi],[it.max[0],it.max[1],Jt])}ee.push({aabb:it,zoom:$t,x:Je,y:vt,wrap:K.wrap,fullyVisible:Se})}}return ae.sort((K,pe)=>K.distanceSq-pe.distanceSq).map(K=>K.tileID)}resize(e,s){this.width=e,this.height=s,this.pixelsToGLUnits=[2/e,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const s=c.ac(e.lat,-85.051129,Co);return new c.P(c.O(e.lng)*this.worldSize,c.Q(s)*this.worldSize)}unproject(e){return new c.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const s=this.elevation,u=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,d=this.pointLocation(this.centerPoint,e),m=e.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-m))return;const w=u+s-m,S=Math.cos(this._pitch)*this.cameraToCenterDistance/w/c.b5(1,d.lat),k=this.scaleZoom(S/this.tileSize);this._elevation=m,this._center=d,this.zoom=k}setLocationAtPoint(e,s){const u=this.pointCoordinate(s),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(e),w=new c.Z(m.x-(u.x-d.x),m.y-(u.y-d.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,s){return s?this.coordinatePoint(this.locationCoordinate(e),s.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,s){return this.coordinateLocation(this.pointCoordinate(e,s))}locationCoordinate(e){return c.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,s){if(s){const V=s.pointCoordinate(e);if(V!=null)return V}const u=[e.x,e.y,0,1],d=[e.x,e.y,1,1];c.af(u,u,this.pixelMatrixInverse),c.af(d,d,this.pixelMatrixInverse);const m=u[3],w=d[3],S=u[1]/m,k=d[1]/w,E=u[2]/m,z=d[2]/w,D=E===z?0:(0-E)/(z-E);return new c.Z(c.y.number(u[0]/m,d[0]/w,D)/this.worldSize,c.y.number(S,k,D)/this.worldSize)}coordinatePoint(e,s=0,u=this.pixelMatrix){const d=[e.x*this.worldSize,e.y*this.worldSize,s,1];return c.af(d,d,u),new c.P(d[0]/d[3],d[1]/d[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return new ke().extend(this.pointLocation(new c.P(0,e))).extend(this.pointLocation(new c.P(this.width,e))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ke([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Co])}calculateTileMatrix(e){const s=e.canonical,u=this.worldSize/this.zoomScale(s.z),d=s.x+Math.pow(2,s.z)*e.wrap,m=c.an(new Float64Array(16));return c.J(m,m,[d*u,s.y*u,0]),c.K(m,m,[u/c.X,u/c.X,1]),m}calculatePosMatrix(e,s=!1){const u=e.key,d=s?this._alignedPosMatrixCache:this._posMatrixCache;if(d[u])return d[u];const m=this.calculateTileMatrix(e);return c.L(m,s?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),d[u]=new Float32Array(m),d[u]}calculateFogMatrix(e){const s=e.key,u=this._fogMatrixCache;if(u[s])return u[s];const d=this.calculateTileMatrix(e);return c.L(d,this.fogMatrix,d),u[s]=new Float32Array(d),u[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,s){s=c.ac(+s,this.minZoom,this.maxZoom);const u={center:new c.N(e.lng,e.lat),zoom:s};let d=this.lngRange;if(!this._renderWorldCopies&&d===null){const K=179.9999999999;d=[-K,K]}const m=this.tileSize*this.zoomScale(u.zoom);let w=0,S=m,k=0,E=m,z=0,D=0;const{x:V,y:H}=this.size;if(this.latRange){const K=this.latRange;w=c.Q(K[1])*m,S=c.Q(K[0])*m,S-w<H&&(z=H/(S-w))}d&&(k=c.b3(c.O(d[0])*m,0,m),E=c.b3(c.O(d[1])*m,0,m),E<k&&(E+=m),E-k<V&&(D=V/(E-k)));const{x:G,y:ee}=this.project.call({worldSize:m},e);let ae,oe;const ce=Math.max(D||0,z||0);if(ce){const K=new c.P(D?(E+k)/2:G,z?(S+w)/2:ee);return u.center=this.unproject.call({worldSize:m},K).wrap(),u.zoom+=this.scaleZoom(ce),u}if(this.latRange){const K=H/2;ee-K<w&&(oe=w+K),ee+K>S&&(oe=S-K)}if(d){const K=(k+E)/2;let pe=G;this._renderWorldCopies&&(pe=c.b3(G,K-m/2,K+m/2));const ge=V/2;pe-ge<k&&(ae=k+ge),pe+ge>E&&(ae=E-ge)}if(ae!==void 0||oe!==void 0){const K=new c.P(ae??G,oe??ee);u.center=this.unproject.call({worldSize:m},K).wrap()}return u}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:s,zoom:u}=this.getConstrained(this.center,this.zoom);this.center=s,this.zoom=u,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,s=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let d=c.an(new Float64Array(16));c.K(d,d,[this.width/2,-this.height/2,1]),c.J(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=c.an(new Float64Array(16)),c.K(d,d,[1,-1,1]),c.J(d,d,[-1,-1,0]),c.K(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),S=m-w*this._pixelPerMeter/Math.cos(this._pitch),k=w<0?S:m,E=Math.PI/2+this._pitch,z=this._fov*(.5+e.y/this.height),D=Math.sin(z)*k/Math.sin(c.ac(Math.PI-E-z,.01,Math.PI-.01)),V=this.getHorizon(),H=2*Math.atan(V/this.cameraToCenterDistance)*(.5+e.y/(2*V)),G=Math.sin(H)*k/Math.sin(c.ac(Math.PI-E-H,.01,Math.PI-.01)),ee=Math.min(D,G);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ee+k),this.nearZ=this.height/50,d=new Float64Array(16),c.b6(d,this._fov,this.width/this.height,this.nearZ,this.farZ),d[8]=2*-e.x/this.width,d[9]=2*e.y/this.height,this.projectionMatrix=c.ae(d),c.K(d,d,[1,-1,1]),c.J(d,d,[0,0,-this.cameraToCenterDistance]),c.b7(d,d,this._pitch),c.ad(d,d,this.angle),c.J(d,d,[-s,-u,0]),this.mercatorMatrix=c.K([],d,[this.worldSize,this.worldSize,this.worldSize]),c.K(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,d),c.J(d,d,[0,0,-this.elevation]),this.modelViewProjectionMatrix=d,this.invModelViewProjectionMatrix=c.as([],d),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-s,-u,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,d);const ae=this.width%2/2,oe=this.height%2/2,ce=Math.cos(this.angle),K=Math.sin(this.angle),pe=s-Math.round(s)+ce*ae+K*oe,ge=u-Math.round(u)+ce*oe+K*ae,Se=new Float64Array(d);if(c.J(Se,Se,[pe>.5?pe-1:pe,ge>.5?ge-1:ge,0]),this.alignedModelViewProjectionMatrix=Se,d=c.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new c.P(0,0)),s=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.af(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,e))}getCameraQueryGeometry(e){const s=this.getCameraPoint();if(e.length===1)return[e[0],s];{let u=s.x,d=s.y,m=s.x,w=s.y;for(const S of e)u=Math.min(u,S.x),d=Math.min(d,S.y),m=Math.max(m,S.x),w=Math.max(w,S.y);return[new c.P(u,d),new c.P(m,d),new c.P(m,w),new c.P(u,w),new c.P(u,d)]}}lngLatToCameraDepth(e,s){const u=this.locationCoordinate(e),d=[u.x*this.worldSize,u.y*this.worldSize,s,1];return c.af(d,d,this.modelViewProjectionMatrix),d[2]/d[3]}}function El(g,e){let s,u=!1,d=null,m=null;const w=()=>{d=null,u&&(g.apply(m,s),d=setTimeout(w,e),u=!1)};return(...S)=>(u=!0,m=this,s=S,d||w(),d)}class Xh{constructor(e){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(u=d)}),(u&&u[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(s.length>=3&&!s.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:u,pitch:+(s[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const u=s.join("/");let d=u;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${u}`);let m=window.location.hash.replace(d,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let w=window.location.href.replace(/(#.+)?$/,m);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=El(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const s=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,d=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),w=Math.round(s.lng*m)/m,S=Math.round(s.lat*m)/m,k=this._map.getBearing(),E=this._map.getPitch();let z="";if(z+=e?`/${w}/${S}/${u}`:`${u}/${S}/${w}`,(k||E)&&(z+="/"+Math.round(10*k)/10),E&&(z+=`/${Math.round(E)}`),this._hashName){const D=this._hashName;let V=!1;const H=window.location.hash.slice(1).split("&").map(G=>{const ee=G.split("=")[0];return ee===D?(V=!0,`${ee}=${z}`):G}).filter(G=>G);return V||H.push(`${D}=${z}`),`#${H.join("&")}`}return`#${z}`}}const Rs={linearity:.3,easing:c.b8(0,0,.3,1)},lp=c.e({deceleration:2500,maxSpeed:1400},Rs),Yh=c.e({deceleration:20,maxSpeed:1400},Rs),Cl=c.e({deceleration:1e3,maxSpeed:360},Rs),tu=c.e({deceleration:1e3,maxSpeed:90},Rs);class Kh{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:R.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,s=R.now();for(;e.length>0&&s-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(s.pan.mag()){const m=Ja(s.pan.mag(),u,c.e({},lp,e||{}));d.offset=s.pan.mult(m.amount/s.pan.mag()),d.center=this._map.transform.center,Po(d,m)}if(s.zoom){const m=Ja(s.zoom,u,Yh);d.zoom=this._map.transform.zoom+m.amount,Po(d,m)}if(s.bearing){const m=Ja(s.bearing,u,Cl);d.bearing=this._map.transform.bearing+c.ac(m.amount,-179,179),Po(d,m)}if(s.pitch){const m=Ja(s.pitch,u,tu);d.pitch=this._map.transform.pitch+m.amount,Po(d,m)}if(d.zoom||d.bearing){const m=s.pinchAround===void 0?s.around:s.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),c.e(d,{noMoveStart:!0})}}function Po(g,e){(!g.duration||g.duration<e.duration)&&(g.duration=e.duration,g.easing=e.easing)}function Ja(g,e,s){const{maxSpeed:u,linearity:d,deceleration:m}=s,w=c.ac(g*d/(e/1e3),-u,u),S=Math.abs(w)/(m*d);return{easing:s.easing,duration:1e3*S,amount:w*(S/2)}}class tr extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,u,d={}){const m=C.mousePos(s.getCanvas(),u),w=s.unproject(m);super(e,c.e({point:m,lngLat:w,originalEvent:u},d)),this._defaultPrevented=!1,this.target=s}}class zo extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,u){const d=e==="touchend"?u.changedTouches:u.touches,m=C.touchPos(s.getCanvasContainer(),d),w=m.map(k=>s.unproject(k)),S=m.reduce((k,E,z,D)=>k.add(E.div(D.length)),new c.P(0,0));super(e,{points:m,point:S,lngLats:w,lngLat:s.unproject(S),originalEvent:u}),this._defaultPrevented=!1}}class iu extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class pn{constructor(e,s){this._map=e,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new iu(e.type,this._map,e))}mousedown(e,s){return this._mousedownPos=s,this._firePreventable(new tr(e.type,this._map,e))}mouseup(e){this._map.fire(new tr(e.type,this._map,e))}click(e,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new tr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new tr(e.type,this._map,e))}mouseover(e){this._map.fire(new tr(e.type,this._map,e))}mouseout(e){this._map.fire(new tr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new zo(e.type,this._map,e))}touchmove(e){this._map.fire(new zo(e.type,this._map,e))}touchend(e){this._map.fire(new zo(e.type,this._map,e))}touchcancel(e){this._map.fire(new zo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Qa{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new tr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new tr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new tr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wn{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(c.P.convert(e),this._map.terrain)}}class Pl{constructor(e,s){this._map=e,this._tr=new Wn(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,s){this.isEnabled()&&e.shiftKey&&e.button===0&&(C.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(e,s){if(!this._active)return;const u=s;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=u,this._box||(this._box=C.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(d.x,u.x),w=Math.max(d.x,u.x),S=Math.min(d.y,u.y),k=Math.max(d.y,u.y);C.setTransform(this._box,`translate(${m}px,${S}px)`),this._box.style.width=w-m+"px",this._box.style.height=k-S+"px"}mouseupWindow(e,s){if(!this._active||e.button!==0)return;const u=this._startPos,d=s;if(this.reset(),C.suppressClick(),u.x!==d.x||u.y!==d.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(u,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(C.remove(this._box),this._box=null),C.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,s){return this._map.fire(new c.k(e,{originalEvent:s}))}}function Do(g,e){if(g.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${e.length}`);const s={};for(let u=0;u<g.length;u++)s[g[u].identifier]=e[u];return s}class Jh{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,s,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(d){const m=new c.P(0,0);for(const w of d)m._add(w);return m.div(d.length)}(s),this.touches=Do(u,s)))}touchmove(e,s,u){if(this.aborted||!this.centroid)return;const d=Do(u,s);for(const m in this.touches){const w=d[m];(!w||w.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,s,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class za{constructor(e){this.singleTap=new Jh(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,s,u){this.singleTap.touchstart(e,s,u)}touchmove(e,s,u){this.singleTap.touchmove(e,s,u)}touchend(e,s,u){const d=this.singleTap.touchend(e,s,u);if(d){const m=e.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(d)<30;if(m&&w||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Lo{constructor(e){this._tr=new Wn(e),this._zoomIn=new za({numTouches:1,numTaps:2}),this._zoomOut=new za({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,s,u){this._zoomIn.touchstart(e,s,u),this._zoomOut.touchstart(e,s,u)}touchmove(e,s,u){this._zoomIn.touchmove(e,s,u),this._zoomOut.touchmove(e,s,u)}touchend(e,s,u){const d=this._zoomIn.touchend(e,s,u),m=this._zoomOut.touchend(e,s,u),w=this._tr;return d?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(d)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class es{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const s=this._moveFunction(...e);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(e,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,s){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const d=s.length?s[0]:s;return!this._moved&&d.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(u,d))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&C.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Qh={0:1,2:2};class zl{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const s=C.mouseButton(e);this._eventButton=s}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(s,u){const d=Qh[u];return s.buttons===void 0||(s.buttons&d)!==d}(e,this._eventButton)}isValidEndEvent(e){return C.mouseButton(e)===this._eventButton}}class nu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const Dl=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=e=>{e.preventDefault()}},ru=({enable:g,clickTolerance:e,bearingDegreesPerPixelMoved:s=.8})=>{const u=new zl({checkCorrectEvent:d=>C.mouseButton(d)===0&&d.ctrlKey||C.mouseButton(d)===2});return new es({clickTolerance:e,move:(d,m)=>({bearingDelta:(m.x-d.x)*s}),moveStateManager:u,enable:g,assignEvents:Dl})},Da=({enable:g,clickTolerance:e,pitchDegreesPerPixelMoved:s=-.5})=>{const u=new zl({checkCorrectEvent:d=>C.mouseButton(d)===0&&d.ctrlKey||C.mouseButton(d)===2});return new es({clickTolerance:e,move:(d,m)=>({pitchDelta:(m.y-d.y)*s}),moveStateManager:u,enable:g,assignEvents:Dl})};class ed{constructor(e,s){this._clickTolerance=e.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,s,u){return this._calculateTransform(e,s,u)}touchmove(e,s,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,s,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,s,u){this._calculateTransform(e,s,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,s,u){u.length>0&&(this._active=!0);const d=Do(u,s),m=new c.P(0,0),w=new c.P(0,0);let S=0;for(const E in d){const z=d[E],D=this._touches[E];D&&(m._add(z),w._add(z.sub(D)),S++,d[E]=z)}if(this._touches=d,this._shouldBePrevented(S)||!w.mag())return;const k=w.div(S);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(S),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ll{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,s,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([s[0],s[1]]))}touchmove(e,s,u){if(!this._firstTwoTouches)return;e.preventDefault();const[d,m]=this._firstTwoTouches,w=Ro(u,s,d),S=Ro(u,s,m);if(!w||!S)return;const k=this._aroundCenter?null:w.add(S).div(2);return this._move([w,S],k,e)}touchend(e,s,u){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,w=Ro(u,s,d),S=Ro(u,s,m);w&&S||(this._active&&C.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ro(g,e,s){for(let u=0;u<g.length;u++)if(g[u].identifier===s)return e[u]}function au(g,e){return Math.log(g/e)/Math.LN2}class su extends Ll{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,s){const u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(au(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:au(this._distance,u),pinchAround:s}}}function ou(g,e){return 180*g.angleWith(e)/Math.PI}class lu extends Ll{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,s,u){const d=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ou(this._vector,d),pinchAround:s}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const s=25/(Math.PI*this._minDiameter)*360,u=ou(e,this._startVector);return Math.abs(u)<s}}function ts(g){return Math.abs(g.y)>Math.abs(g.x)}class cu extends Ll{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,s,u){super.touchstart(e,s,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,ts(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,s,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,s,u){if(this._valid!==void 0)return this._valid;const d=e.mag()>=2,m=s.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const w=e.y>0==s.y>0;return ts(e)&&ts(s)&&w}}const Gr={panStep:100,bearingStep:15,pitchStep:10};class Zr{constructor(e){this._tr=new Wn(e);const s=Gr;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let s=0,u=0,d=0,m=0,w=0;switch(e.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?d=1:(e.preventDefault(),w=-1);break;case 40:e.shiftKey?d=-1:(e.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(u=0,d=0),{cameraAnimation:S=>{const k=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:td,zoom:s?Math.round(k.zoom)+s*(e.shiftKey?2:1):k.zoom,bearing:k.bearing+u*this._bearingStep,pitch:k.pitch+d*this._pitchStep,offset:[-m*this._panStep,-w*this._panStep],center:k.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function td(g){return g*(2-g)}const Xr=4.000244140625;class is{constructor(e,s){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new Wn(e),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let s=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const u=R.now(),d=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,s!==0&&s%Xr==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(d*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),e.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=e,this._delta-=s,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=C.mousePos(this._map.getCanvas(),e),u=this._tr;this._around=s.y>u.transform.height/2-u.transform.getHorizon()?c.N.convert(this._aroundCenter?u.center:u.unproject(s)):c.N.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Xr?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&E!==0&&(E=1/E);const z=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(z*E))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,u=this._startZoom,d=this._easing;let m,w=!1;const S=R.now()-this._lastWheelEventTime;if(this._type==="wheel"&&u&&d&&S){const k=Math.min(S/200,1),E=d(k);m=c.y.number(u,s,E),k<1?this._frameId||(this._frameId=!0):w=!0}else m=s,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let s=c.b9;if(this._prevEase){const u=this._prevEase,d=(R.now()-u.start)/u.duration,m=u.easing(d+.01)-u.easing(d),w=.27/Math.sqrt(m*m+1e-4)*.01,S=Math.sqrt(.0729-w*w);s=c.b8(w,S,.25,1)}return this._prevEase={start:R.now(),duration:e,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class id{constructor(e,s){this._clickZoom=e,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class cp{constructor(e){this._tr=new Wn(e),this.reset()}reset(){this._active=!1}dblclick(e,s){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class up{constructor(){this._tap=new za({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,s,u){if(!this._swipePoint)if(this._tapTime){const d=s[0],m=e.timeStamp-this._tapTime<500,w=this._tapPoint.dist(d)<30;m&&w?u.length>0&&(this._swipePoint=d,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,s,u)}touchmove(e,s,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const d=s[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,s,u)}touchend(e,s,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const d=this._tap.touchend(e,s,u);d&&(this._tapTime=e.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nd{constructor(e,s,u){this._el=e,this._mousePan=s,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class uu{constructor(e,s,u){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=s,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Bs{constructor(e,s,u,d){this._el=e,this._touchZoom=s,this._touchRotate=u,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ca{constructor(e,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=C.create("div","maplibregl-cooperative-gesture-screen",e);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=s,this._container.appendChild(d);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=u,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(C.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,s){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:e,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ht=g=>g.zoom||g.drag||g.pitch||g.rotate;class rd extends c.k{}function Bo(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class ad{constructor(e,s){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=d.type==="renderFrame"?void 0:d,S={needsRenderFrame:!1},k={},E={},z=d.touches,D=z?this._getMapTouches(z):void 0,V=D?C.touchPos(this._map.getCanvas(),D):C.mousePos(this._map.getCanvas(),d);for(const{handlerName:ee,handler:ae,allowed:oe}of this._handlers){if(!ae.isEnabled())continue;let ce;this._blockedByActive(E,oe,ee)?ae.reset():ae[m||d.type]&&(ce=ae[m||d.type](d,V,D),this.mergeHandlerResult(S,k,ce,ee,w),ce&&ce.needsRenderFrame&&this._triggerRenderFrame()),(ce||ae.isActive())&&(E[ee]=ae)}const H={};for(const ee in this._previousActiveHandlers)E[ee]||(H[ee]=w);this._previousActiveHandlers=E,(Object.keys(H).length||Bo(S))&&(this._changes.push([S,k,H]),this._triggerRenderFrame()),(Object.keys(E).length||Bo(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=S;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Kh(e),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,w]of this._listeners)C.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[e,s,u]of this._listeners)C.removeEventListener(e,s,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){const s=this._map,u=s.getCanvasContainer();this._add("mapEvent",new pn(s,e));const d=s.boxZoom=new Pl(s,e);this._add("boxZoom",d),e.interactive&&e.boxZoom&&d.enable();const m=s.cooperativeGestures=new ca(s,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const w=new Lo(s),S=new cp(s);s.doubleClickZoom=new id(S,w),this._add("tapZoom",w),this._add("clickZoom",S),e.interactive&&e.doubleClickZoom&&s.doubleClickZoom.enable();const k=new up;this._add("tapDragZoom",k);const E=s.touchPitch=new cu(s);this._add("touchPitch",E),e.interactive&&e.touchPitch&&s.touchPitch.enable(e.touchPitch);const z=ru(e),D=Da(e);s.dragRotate=new uu(e,z,D),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]),e.interactive&&e.dragRotate&&s.dragRotate.enable();const V=(({enable:ce,clickTolerance:K})=>{const pe=new zl({checkCorrectEvent:ge=>C.mouseButton(ge)===0&&!ge.ctrlKey});return new es({clickTolerance:K,move:(ge,Se)=>({around:Se,panDelta:Se.sub(ge)}),activateOnStart:!0,moveStateManager:pe,enable:ce,assignEvents:Dl})})(e),H=new ed(e,s);s.dragPan=new nd(u,V,H),this._add("mousePan",V),this._add("touchPan",H,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&s.dragPan.enable(e.dragPan);const G=new lu,ee=new su;s.touchZoomRotate=new Bs(u,ee,G,k),this._add("touchRotate",G,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&s.touchZoomRotate.enable(e.touchZoomRotate);const ae=s.scrollZoom=new is(s,()=>this._triggerRenderFrame());this._add("scrollZoom",ae,["mousePan"]),e.interactive&&e.scrollZoom&&s.scrollZoom.enable(e.scrollZoom);const oe=s.keyboard=new Zr(s);this._add("keyboard",oe),e.interactive&&e.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new Qa(s))}_add(e,s,u){this._handlers.push({handlerName:e,handler:s,allowed:u}),this._handlersById[e]=s}stop(e){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ht(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,s,u){for(const d in e)if(d!==u&&(!s||s.indexOf(d)<0))return!0;return!1}_getMapTouches(e){const s=[];for(const u of e)this._el.contains(u.target)&&s.push(u);return s}mergeHandlerResult(e,s,u,d,m){if(!u)return;c.e(e,u);const w={handlerName:d,originalEvent:u.originalEvent||m};u.zoomDelta!==void 0&&(s.zoom=w),u.panDelta!==void 0&&(s.drag=w),u.pitchDelta!==void 0&&(s.pitch=w),u.bearingDelta!==void 0&&(s.rotate=w)}_applyChanges(){const e={},s={},u={};for(const[d,m,w]of this._changes)d.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(d.panDelta)),d.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(e.around=d.around),d.pinchAround!==void 0&&(e.pinchAround=d.pinchAround),d.noInertia&&(e.noInertia=d.noInertia),c.e(s,m),c.e(u,w);this._updateMapTransform(e,s,u),this._changes=[]}_updateMapTransform(e,s,u){const d=this._map,m=d._getTransformForUpdate(),w=d.terrain;if(!(Bo(e)||w&&this._terrainMovement))return this._fireEvents(s,u,!0);let{panDelta:S,zoomDelta:k,bearingDelta:E,pitchDelta:z,around:D,pinchAround:V}=e;V!==void 0&&(D=V),d._stop(!0),D=D||d.transform.centerPoint;const H=m.pointLocation(S?D.sub(S):D);E&&(m.bearing+=E),z&&(m.pitch+=z),k&&(m.zoom+=k),w?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(S)):m.setLocationAtPoint(H,D):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(H,D)):m.setLocationAtPoint(H,D),d._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(s,u,!0)}_fireEvents(e,s,u){const d=ht(this._eventsInProgress),m=ht(e),w={};for(const D in e){const{originalEvent:V}=e[D];this._eventsInProgress[D]||(w[`${D}start`]=V),this._eventsInProgress[D]=e[D]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const D in w)this._fireEvent(D,w[D]);m&&this._fireEvent("move",m.originalEvent);for(const D in e){const{originalEvent:V}=e[D];this._fireEvent(D,V)}const S={};let k;for(const D in this._eventsInProgress){const{handlerName:V,originalEvent:H}=this._eventsInProgress[D];this._handlersById[V].isActive()||(delete this._eventsInProgress[D],k=s[V]||H,S[`${D}end`]=k)}for(const D in S)this._fireEvent(D,S[D]);const E=ht(this._eventsInProgress),z=(d||m)&&!E;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const D=this._map._getTransformForUpdate();D.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(D)}if(u&&z){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!D||!D.essential&&R.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:k})),V(this._map.getBearing())&&this._map.resetNorth()):(V(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(e,s){this._map.fire(new c.k(e,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new rd("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Oo extends c.E{constructor(e,s){super(),this._renderFrameCallback=()=>{const u=Math.min((R.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=s.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,s){return this.jumpTo({center:e},s)}panBy(e,s,u){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},s),u)}panTo(e,s,u){return this.easeTo(c.e({center:e},s),u)}getZoom(){return this.transform.zoom}setZoom(e,s){return this.jumpTo({zoom:e},s),this}zoomTo(e,s,u){return this.easeTo(c.e({zoom:e},s),u)}zoomIn(e,s){return this.zoomTo(this.getZoom()+1,e,s),this}zoomOut(e,s){return this.zoomTo(this.getZoom()-1,e,s),this}getBearing(){return this.transform.bearing}setBearing(e,s){return this.jumpTo({bearing:e},s),this}getPadding(){return this.transform.padding}setPadding(e,s){return this.jumpTo({padding:e},s),this}rotateTo(e,s,u){return this.easeTo(c.e({bearing:e},s),u)}resetNorth(e,s){return this.rotateTo(0,c.e({duration:1e3},e),s),this}resetNorthPitch(e,s){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},e),s),this}snapToNorth(e,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,s):this}getPitch(){return this.transform.pitch}setPitch(e,s){return this.jumpTo({pitch:e},s),this}cameraForBounds(e,s){e=ke.convert(e).adjustAntiMeridian();const u=s&&s.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,s)}_cameraForBoxAndBearing(e,s,u,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=c.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const Qe=d.padding;d.padding={top:Qe,bottom:Qe,right:Qe,left:Qe}}d.padding=c.e(m,d.padding);const w=this.transform,S=w.padding,k=new ke(e,s),E=w.project(k.getNorthWest()),z=w.project(k.getNorthEast()),D=w.project(k.getSouthEast()),V=w.project(k.getSouthWest()),H=c.ba(-u),G=E.rotate(H),ee=z.rotate(H),ae=D.rotate(H),oe=V.rotate(H),ce=new c.P(Math.max(G.x,ee.x,oe.x,ae.x),Math.max(G.y,ee.y,oe.y,ae.y)),K=new c.P(Math.min(G.x,ee.x,oe.x,ae.x),Math.min(G.y,ee.y,oe.y,ae.y)),pe=ce.sub(K),ge=(w.width-(S.left+S.right+d.padding.left+d.padding.right))/pe.x,Se=(w.height-(S.top+S.bottom+d.padding.top+d.padding.bottom))/pe.y;if(Se<0||ge<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const je=Math.min(w.scaleZoom(w.scale*Math.min(ge,Se)),d.maxZoom),Ze=c.P.convert(d.offset),at=new c.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c.ba(u)),dt=Ze.add(at).mult(w.scale/w.zoomScale(je));return{center:w.unproject(E.add(D).div(2).sub(dt)),zoom:je,bearing:u}}fitBounds(e,s,u){return this._fitInternal(this.cameraForBounds(e,s),s,u)}fitScreenCoordinates(e,s,u,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(e)),this.transform.pointLocation(c.P.convert(s)),u,d),d,m)}_fitInternal(e,s,u){return e?(delete(s=c.e(e,s)).padding,s.linear?this.easeTo(s,u):this.flyTo(s,u)):this}jumpTo(e,s){this.stop();const u=this._getTransformForUpdate();let d=!1,m=!1,w=!1;return"zoom"in e&&u.zoom!==+e.zoom&&(d=!0,u.zoom=+e.zoom),e.center!==void 0&&(u.center=c.N.convert(e.center)),"bearing"in e&&u.bearing!==+e.bearing&&(m=!0,u.bearing=+e.bearing),"pitch"in e&&u.pitch!==+e.pitch&&(w=!0,u.pitch=+e.pitch),e.padding==null||u.isPaddingEqual(e.padding)||(u.padding=e.padding),this._applyUpdatedTransform(u),this.fire(new c.k("movestart",s)).fire(new c.k("move",s)),d&&this.fire(new c.k("zoomstart",s)).fire(new c.k("zoom",s)).fire(new c.k("zoomend",s)),m&&this.fire(new c.k("rotatestart",s)).fire(new c.k("rotate",s)).fire(new c.k("rotateend",s)),w&&this.fire(new c.k("pitchstart",s)).fire(new c.k("pitch",s)).fire(new c.k("pitchend",s)),this.fire(new c.k("moveend",s))}calculateCameraOptionsFromTo(e,s,u,d=0){const m=c.Z.fromLngLat(e,s),w=c.Z.fromLngLat(u,d),S=w.x-m.x,k=w.y-m.y,E=w.z-m.z,z=Math.hypot(S,k,E);if(z===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(S,k),V=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),H=180*Math.atan2(S,-k)/Math.PI;let G=180*Math.acos(D/z)/Math.PI;return G=E<0?90-G:90+G,{center:w.toLngLat(),zoom:V,pitch:G,bearing:H}}easeTo(e,s){var u;this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.b9},e)).animate===!1||!e.essential&&R.prefersReducedMotion)&&(e.duration=0);const d=this._getTransformForUpdate(),m=d.zoom,w=d.bearing,S=d.pitch,k=d.padding,E="bearing"in e?this._normalizeBearing(e.bearing,w):w,z="pitch"in e?+e.pitch:S,D="padding"in e?e.padding:d.padding,V=c.P.convert(e.offset);let H=d.centerPoint.add(V);const G=d.pointLocation(H),{center:ee,zoom:ae}=d.getConstrained(c.N.convert(e.center||G),(u=e.zoom)!==null&&u!==void 0?u:m);this._normalizeCenter(ee,d);const oe=d.project(G),ce=d.project(ee).sub(oe),K=d.zoomScale(ae-m);let pe,ge;e.around&&(pe=c.N.convert(e.around),ge=d.locationPoint(pe));const Se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ae!==m,this._rotating=this._rotating||w!==E,this._pitching=this._pitching||z!==S,this._padding=!d.isPaddingEqual(D),this._easeId=e.easeId,this._prepareEase(s,e.noMoveStart,Se),this.terrain&&this._prepareElevation(ee),this._ease(je=>{if(this._zooming&&(d.zoom=c.y.number(m,ae,je)),this._rotating&&(d.bearing=c.y.number(w,E,je)),this._pitching&&(d.pitch=c.y.number(S,z,je)),this._padding&&(d.interpolatePadding(k,D,je),H=d.centerPoint.add(V)),this.terrain&&!e.freezeElevation&&this._updateElevation(je),pe)d.setLocationAtPoint(pe,ge);else{const Ze=d.zoomScale(d.zoom-m),at=ae>m?Math.min(2,K):Math.max(.5,K),dt=Math.pow(at,1-je),Qe=d.unproject(oe.add(ce.mult(je*dt)).mult(Ze));d.setLocationAtPoint(d.renderWorldCopies?Qe.wrap():Qe,H)}this._applyUpdatedTransform(d),this._fireMoveEvents(s)},je=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s,je)},e),this}_prepareEase(e,s,u={}){this._moving=!0,s||u.moving||this.fire(new c.k("movestart",e)),this._zooming&&!u.zooming&&this.fire(new c.k("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new c.k("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new c.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&s!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(s-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=s}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const s=e.getCameraPosition(),u=this.terrain.getElevationForLngLatZoom(s.lngLat,e.zoom);if(s.altitude<u){const d=this.calculateCameraOptionsFromTo(s.lngLat,u,e.center,e.elevation);return{pitch:d.pitch,zoom:d.zoom}}return{}}_applyUpdatedTransform(e){const s=[];if(this.terrain&&s.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&s.push(d=>this.transformCameraUpdate(d)),!s.length)return;const u=e.clone();for(const d of s){const m=u.clone(),{center:w,zoom:S,pitch:k,bearing:E,elevation:z}=d(m);w&&(m.center=w),S!==void 0&&(m.zoom=S),k!==void 0&&(m.pitch=k),E!==void 0&&(m.bearing=E),z!==void 0&&(m.elevation=z),u.apply(m)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new c.k("move",e)),this._zooming&&this.fire(new c.k("zoom",e)),this._rotating&&this.fire(new c.k("rotate",e)),this._pitching&&this.fire(new c.k("pitch",e))}_afterEase(e,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const u=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new c.k("zoomend",e)),d&&this.fire(new c.k("rotateend",e)),m&&this.fire(new c.k("pitchend",e)),this.fire(new c.k("moveend",e))}flyTo(e,s){var u;if(!e.essential&&R.prefersReducedMotion){const lt=c.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(lt,s)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},e);const d=this._getTransformForUpdate(),m=d.zoom,w=d.bearing,S=d.pitch,k=d.padding,E="bearing"in e?this._normalizeBearing(e.bearing,w):w,z="pitch"in e?+e.pitch:S,D="padding"in e?e.padding:d.padding,V=c.P.convert(e.offset);let H=d.centerPoint.add(V);const G=d.pointLocation(H),{center:ee,zoom:ae}=d.getConstrained(c.N.convert(e.center||G),(u=e.zoom)!==null&&u!==void 0?u:m);this._normalizeCenter(ee,d);const oe=d.zoomScale(ae-m),ce=d.project(G),K=d.project(ee).sub(ce);let pe=e.curve;const ge=Math.max(d.width,d.height),Se=ge/oe,je=K.mag();if("minZoom"in e){const lt=c.ac(Math.min(e.minZoom,m,ae),d.minZoom,d.maxZoom),Ot=ge/d.zoomScale(lt-m);pe=Math.sqrt(Ot/je*2)}const Ze=pe*pe;function at(lt){const Ot=(Se*Se-ge*ge+(lt?-1:1)*Ze*Ze*je*je)/(2*(lt?Se:ge)*Ze*je);return Math.log(Math.sqrt(Ot*Ot+1)-Ot)}function dt(lt){return(Math.exp(lt)-Math.exp(-lt))/2}function Qe(lt){return(Math.exp(lt)+Math.exp(-lt))/2}const Je=at(!1);let vt=function(lt){return Qe(Je)/Qe(Je+pe*lt)},$t=function(lt){return ge*((Qe(Je)*(dt(Ot=Je+pe*lt)/Qe(Ot))-dt(Je))/Ze)/je;var Ot},it=(at(!0)-Je)/pe;if(Math.abs(je)<1e-6||!isFinite(it)){if(Math.abs(ge-Se)<1e-6)return this.easeTo(e,s);const lt=Se<ge?-1:1;it=Math.abs(Math.log(Se/ge))/pe,$t=()=>0,vt=Ot=>Math.exp(lt*pe*Ot)}return e.duration="duration"in e?+e.duration:1e3*it/("screenSpeed"in e?+e.screenSpeed/pe:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=w!==E,this._pitching=z!==S,this._padding=!d.isPaddingEqual(D),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(ee),this._ease(lt=>{const Ot=lt*it,Zi=1/vt(Ot);d.zoom=lt===1?ae:m+d.scaleZoom(Zi),this._rotating&&(d.bearing=c.y.number(w,E,lt)),this._pitching&&(d.pitch=c.y.number(S,z,lt)),this._padding&&(d.interpolatePadding(k,D,lt),H=d.centerPoint.add(V)),this.terrain&&!e.freezeElevation&&this._updateElevation(lt);const Jt=lt===1?ee:d.unproject(ce.add(K.mult($t(Ot))).mult(Zi));d.setLocationAtPoint(d.renderWorldCopies?Jt.wrap():Jt,H),this._applyUpdatedTransform(d),this._fireMoveEvents(s)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,s){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,s)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,s,u){u.animate===!1||u.duration===0?(e(1),s()):(this._easeStart=R.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,s){e=c.b3(e,-180,180);const u=Math.abs(e-s);return Math.abs(e-360-s)<u&&(e-=360),Math.abs(e+360-s)<u&&(e+=360),e}_normalizeCenter(e,s){if(!s.renderWorldCopies||s.lngRange)return;const u=e.lng-s.center.lng;e.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const Os={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class hu{constructor(e=Os){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=C.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=C.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=C.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){C.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,s){const u=this._map._getUIString(`AttributionControl.${s}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const s=this._map.style.sourceCaches;for(const d in s){const m=s[d];if(m.used||m.usedForTerrain){const w=m.getSource();w.attribution&&e.indexOf(w.attribution)<0&&e.push(w.attribution)}}e=e.filter(d=>String(d).trim()),e.sort((d,m)=>d.length-m.length),e=e.filter((d,m)=>{for(let w=m+1;w<e.length;w++)if(e[w].indexOf(d)>=0)return!1;return!0});const u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class li{constructor(e={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=C.create("div","maplibregl-ctrl");const s=C.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){C.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class du{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const s=++this._id;return this._queue.push({callback:e,id:s,cancelled:!1}),s}remove(e){const s=this._currentlyRunning,u=s?this._queue.concat(s):this._queue;for(const d of u)if(d.id===e)return void(d.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const u of s)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var hp=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class fu extends c.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,s){this.sourceCache.update(e,s),this._renderableTilesKeys=[];const u={};for(const d of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))u[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),c.aP(d.posMatrix,0,c.X,0,c.X,0,1),this._tiles[d.key]=new Oi(d,this.tileSize));for(const d in this._tiles)u[d]||delete this._tiles[d]}freeRtt(e){for(const s in this._tiles){const u=this._tiles[s];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const s={};for(const u of this._renderableTilesKeys){const d=this._tiles[u].tileID;if(d.canonical.equals(e.canonical)){const m=e.clone();m.posMatrix=new Float64Array(16),c.aP(m.posMatrix,0,c.X,0,c.X,0,1),s[u]=m}else if(d.canonical.isChildOf(e.canonical)){const m=e.clone();m.posMatrix=new Float64Array(16);const w=d.canonical.z-e.canonical.z,S=d.canonical.x-(d.canonical.x>>w<<w),k=d.canonical.y-(d.canonical.y>>w<<w),E=c.X>>w;c.aP(m.posMatrix,0,E,0,E,0,1),c.J(m.posMatrix,m.posMatrix,[-S*E,-k*E,0]),s[u]=m}else if(e.canonical.isChildOf(d.canonical)){const m=e.clone();m.posMatrix=new Float64Array(16);const w=e.canonical.z-d.canonical.z,S=e.canonical.x-(e.canonical.x>>w<<w),k=e.canonical.y-(e.canonical.y>>w<<w),E=c.X>>w;c.aP(m.posMatrix,0,c.X,0,c.X,0,1),c.J(m.posMatrix,m.posMatrix,[S*E,k*E,0]),c.K(m.posMatrix,m.posMatrix,[1/2**w,1/2**w,0]),s[u]=m}}return s}getSourceTile(e,s){const u=this.sourceCache._source;let d=e.overscaledZ-this.deltaZoom;if(d>u.maxzoom&&(d=u.maxzoom),d<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&s)for(;d>=u.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(d--).key);return m}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(s=>s.timeAdded>=e)}}class dp{constructor(e,s,u){this.painter=e,this.sourceCache=new fu(s),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,s,u,d=c.X){var m;if(!(s>=0&&s<d&&u>=0&&u<d))return 0;const w=this.getTerrainData(e),S=(m=w.tile)===null||m===void 0?void 0:m.dem;if(!S)return 0;const k=function(G,ee,ae){var oe=ee[0],ce=ee[1];return G[0]=ae[0]*oe+ae[4]*ce+ae[12],G[1]=ae[1]*oe+ae[5]*ce+ae[13],G}([],[s/d*c.X,u/d*c.X],w.u_terrain_matrix),E=[k[0]*S.dim,k[1]*S.dim],z=Math.floor(E[0]),D=Math.floor(E[1]),V=E[0]-z,H=E[1]-D;return S.get(z,D)*(1-V)*(1-H)+S.get(z+1,D)*V*(1-H)+S.get(z,D+1)*(1-V)*H+S.get(z+1,D+1)*V*H}getElevationForLngLatZoom(e,s){if(!c.bb(s,e.wrap()))return 0;const{tileID:u,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,s);return this.getElevation(u,d%c.X,m%c.X,c.X)}getElevation(e,s,u,d=c.X){return this.getDEMElevation(e,s,u,d)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const d=this.painter.context,m=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new we(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new we(d,new c.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const s=this.sourceCache.getSourceTile(e,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const d=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new we(d,s.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),s.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const u=s&&s+s.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-s.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=d?m=e.canonical.z-d:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=e.canonical.x-(e.canonical.x>>m<<m),S=e.canonical.y-(e.canonical.y>>m<<m),k=c.bc(new Float64Array(16),[1/(c.X<<m),1/(c.X<<m),0]);c.J(k,k,[w*c.X,S*c.X,0]),this._demMatrixCache[e.key]={matrix:k,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(e){const s=this.painter,u=s.width/devicePixelRatio,d=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new we(s.context,{width:u,height:d,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new we(s.context,{width:u,height:d,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(u,d,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,u,d))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,w=0;m<this._coordsTextureSize;m++)for(let S=0;S<this._coordsTextureSize;S++,w+=4)s[w+0]=255&S,s[w+1]=255&m,s[w+2]=S>>8<<4|m>>8,s[w+3]=0;const u=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),d=new we(e,u,e.gl.RGBA,{premultiply:!1});return d.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),u=this.painter.context,d=u.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(m,S-w-1,1,1,d.RGBA,d.UNSIGNED_BYTE,s),u.bindFramebuffer.set(null);const k=s[0]+(s[2]>>4<<8),E=s[1]+((15&s[2])<<8),z=this.coordsIndex[255-s[3]],D=z&&this.sourceCache.getTileByID(z);if(!D)return null;const V=this._coordsTextureSize,H=(1<<D.tileID.canonical.z)*V;return new c.Z((D.tileID.canonical.x*V+k)/H+D.tileID.wrap,(D.tileID.canonical.y*V+E)/H,this.getElevation(D.tileID,k,E,V))}depthAtPoint(e){const s=new Uint8Array(4),u=this.painter.context,d=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,s),u.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,s=new c.bd,u=new c.aY,d=this.meshSize,m=c.X/d,w=d*d;for(let D=0;D<=d;D++)for(let V=0;V<=d;V++)s.emplaceBack(V*m,D*m,0);for(let D=0;D<w;D+=d+1)for(let V=0;V<d;V++)u.emplaceBack(V+D,d+V+D+1,d+V+D+2),u.emplaceBack(V+D,d+V+D+2,V+D+1);const S=s.length,k=S+2*(d+1);for(const D of[0,1])for(let V=0;V<=d;V++)for(const H of[0,1])s.emplaceBack(V*m,D*c.X,H);for(let D=0;D<2*d;D+=2)u.emplaceBack(k+D,k+D+1,k+D+3),u.emplaceBack(k+D,k+D+3,k+D+2),u.emplaceBack(S+D,S+D+3,S+D+1),u.emplaceBack(S+D,S+D+2,S+D+3);const E=s.length,z=E+2*(d+1);for(const D of[0,1])for(let V=0;V<=d;V++)for(const H of[0,1])s.emplaceBack(D*c.X,V*m,H);for(let D=0;D<2*d;D+=2)u.emplaceBack(E+D,E+D+1,E+D+3),u.emplaceBack(E+D,E+D+3,E+D+2),u.emplaceBack(z+D,z+D+3,z+D+1),u.emplaceBack(z+D,z+D+2,z+D+3);return this._mesh=new Mo(e.createVertexBuffer(s,hp.members),e.createIndexBuffer(u),c.a0.simpleSegment(0,0,s.length,u.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*c.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,s){var u;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(e,s);return(u=this.getMinMaxElevation(d).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){const s=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return s&&s.dem&&(u.minElevation=s.dem.min*this.exaggeration,u.maxElevation=s.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,s){const u=c.Z.fromLngLat(e.wrap()),d=(1<<s)*c.X,m=u.x*d,w=u.y*d,S=Math.floor(m/c.X),k=Math.floor(w/c.X);return{tileID:new c.S(s,0,s,S,k),mercatorX:m,mercatorY:w}}}class fp{constructor(e,s,u){this._context=e,this._size=s,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new we(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(u.texture),{id:e,fbo:s,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>e.id!==s),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const ns={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class pu{constructor(e,s){this.painter=e,this.terrain=s,this.pool=new fp(e.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(s)),this._coordsDescendingInv={};for(const u in e.sourceCaches){this._coordsDescendingInv[u]={};const d=e.sourceCaches[u].getVisibleCoordinates();for(const m of d){const w=this.terrain.sourceCache.getTerrainCoords(m);for(const S in w)this._coordsDescendingInv[u][S]||(this._coordsDescendingInv[u][S]=[]),this._coordsDescendingInv[u][S].push(w[S])}}this._coordsDescendingInvStr={};for(const u of e._order){const d=e._layers[u],m=d.source;if(ns[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const w in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][w]=this._coordsDescendingInv[m][w].map(S=>S.key).sort().join()}}for(const u of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][u.tileID.key];m&&m!==u.rttCoords[d]&&(u.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const s=e.type,u=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(ns[s]&&(this._prevType&&ns[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(e.id),!d))return!0;if(ns[this._prevType]||ns[s]&&d){this._prevType=s;const m=this._stacks.length-1,w=this._stacks[m]||[];for(const S of this._renderableTiles){if(this.pool.isFull()&&(Ml(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(S),S.rtt[m]){const E=this.pool.getObjectForId(S.rtt[m].id);if(E.stamp===S.rtt[m].stamp){this.pool.useObject(E);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),S.rtt[m]={id:k.id,stamp:k.stamp},u.context.bindFramebuffer.set(k.fbo.framebuffer),u.context.clear({color:c.aM.transparent,stencil:0}),u.currentStencilSource=void 0;for(let E=0;E<w.length;E++){const z=u.style._layers[w[E]],D=z.source?this._coordsDescendingInv[z.source][S.tileID.key]:[S.tileID];u.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),u._renderTileClippingMasks(z,D),u.renderLayer(u,u.style.sourceCaches[z.source],z,D),z.source&&(S.rttCoords[z.source]=this._coordsDescendingInvStr[z.source][S.tileID.key])}}return Ml(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ns[s]}return!1}}const sd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},pp=M,od={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Os,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},ld=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},mp={showCompass:!0,showZoom:!0,visualizePitch:!1};class rs{constructor(e,s,u=!1){this.mousedown=w=>{this.startMouse(c.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),C.mousePos(this.element,w)),C.addEventListener(window,"mousemove",this.mousemove),C.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,C.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=C.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),C.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=C.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=e.dragRotate._mouseRotate.getClickTolerance(),m=e.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=ru({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:S,bearingDegreesPerPixelMoved:k=.8})=>{const E=new nu;return new es({clickTolerance:S,move:(z,D)=>({bearingDelta:(D.x-z.x)*k}),moveStateManager:E,enable:w,assignEvents:ld})})({clickTolerance:d,enable:!0}),this.map=e,u&&(this.mousePitch=Da({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:S,pitchDegreesPerPixelMoved:k=-.5})=>{const E=new nu;return new es({clickTolerance:S,move:(z,D)=>({pitchDelta:(D.y-z.y)*k}),moveStateManager:E,enable:w,assignEvents:ld})})({clickTolerance:m,enable:!0})),C.addEventListener(s,"mousedown",this.mousedown),C.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),C.addEventListener(s,"touchcancel",this.reset)}startMouse(e,s){this.mouseRotate.dragStart(e,s),this.mousePitch&&this.mousePitch.dragStart(e,s),C.disableDrag()}startTouch(e,s){this.touchRotate.dragStart(e,s),this.touchPitch&&this.touchPitch.dragStart(e,s),C.disableDrag()}moveMouse(e,s){const u=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(e,s)||{};if(d&&u.setBearing(u.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(e,s)||{};m&&u.setPitch(u.getPitch()+m)}}moveTouch(e,s){const u=this.map,{bearingDelta:d}=this.touchRotate.dragMove(e,s)||{};if(d&&u.setBearing(u.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(e,s)||{};m&&u.setPitch(u.getPitch()+m)}}off(){const e=this.element;C.removeEventListener(e,"mousedown",this.mousedown),C.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),C.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.removeEventListener(window,"touchend",this.touchend),C.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){C.enableDrag(),C.removeEventListener(window,"mousemove",this.mousemove),C.removeEventListener(window,"mouseup",this.mouseup),C.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),C.removeEventListener(window,"touchend",this.touchend)}}let Pi;function Fo(g,e,s){const u=new c.N(g.lng,g.lat);if(g=new c.N(g.lng,g.lat),e){const d=new c.N(g.lng-360,g.lat),m=new c.N(g.lng+360,g.lat),w=s.locationPoint(g).distSqr(e);s.locationPoint(d).distSqr(e)<w?g=d:s.locationPoint(m).distSqr(e)<w&&(g=m)}for(;Math.abs(g.lng-s.center.lng)>180;){const d=s.locationPoint(g);if(d.x>=0&&d.y>=0&&d.x<=s.width&&d.y<=s.height)break;g.lng>s.center.lng?g.lng-=360:g.lng+=360}return g.lng!==u.lng&&s.locationPoint(g).y>s.height/2-s.getHorizon()?g:u}const No={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function mu(g,e,s){const u=g.classList;for(const d in No)u.remove(`maplibregl-${s}-anchor-${d}`);u.add(`maplibregl-${s}-anchor-${e}`)}class Rl extends c.E{constructor(e){if(super(),this._onKeyPress=s=>{const u=s.code,d=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=s=>{const u=s.originalEvent.target,d=this._element;this._popup&&(u===d||d.contains(u))&&this.togglePopup()},this._update=s=>{var u;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Fo(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),C.setTransform(this._element,`${No[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${m}`),R.frameAsync(new AbortController).then(()=>{this._updateOpacity(s&&s.type==="moveend")}).catch(()=>{})},this._onMove=s=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=C.create("div");const s=C.createNS("http://www.w3.org/2000/svg","svg"),u=41,d=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${u}px`),s.setAttributeNS(null,"width",`${d}px`),s.setAttributeNS(null,"viewBox",`0 0 ${d} ${u}`);const m=C.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const w=C.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const S=C.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of k){const ce=C.createNS("http://www.w3.org/2000/svg","ellipse");ce.setAttributeNS(null,"opacity","0.04"),ce.setAttributeNS(null,"cx","10.5"),ce.setAttributeNS(null,"cy","5.80029008"),ce.setAttributeNS(null,"rx",oe.rx),ce.setAttributeNS(null,"ry",oe.ry),S.appendChild(ce)}const E=C.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const z=C.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(z);const D=C.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"opacity","0.25"),D.setAttributeNS(null,"fill","#000000");const V=C.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),D.appendChild(V);const H=C.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const G=C.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ee=C.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");const ae=C.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),G.appendChild(ee),G.appendChild(ae),w.appendChild(S),w.appendChild(E),w.appendChild(D),w.appendChild(H),w.appendChild(G),s.appendChild(w),s.setAttributeNS(null,"height",u*this._scale+"px"),s.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(s),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),mu(this._element,this._anchor,"marker"),e&&e.className)for(const s of e.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),C.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const d=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var s,u;if(!(!((s=this._map)===null||s===void 0)&&s.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,m=d.terrain.depthAtPoint(this._pos),w=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,w)-m<.006)return void(this._element.style.opacity=this._opacity);const S=-this._offset.y/d.transform._pixelPerMeter,k=Math.sin(d.getPitch()*Math.PI/180)*S,E=d.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),z=d.transform.lngLatToCameraDepth(this._lngLat,w+k)-E>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,s){return e===void 0&&s===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const cd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Bl=0,mr=!1;const Ol={maxWidth:100,unit:"metric"};function St(g,e,s){const u=s&&s.maxWidth||100,d=g._container.clientHeight/2,m=g.unproject([0,d]),w=g.unproject([u,d]),S=m.distanceTo(w);if(s&&s.unit==="imperial"){const k=3.2808*S;k>5280?Et(e,u,k/5280,g._getUIString("ScaleControl.Miles")):Et(e,u,k,g._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?Et(e,u,S/1852,g._getUIString("ScaleControl.NauticalMiles")):S>=1e3?Et(e,u,S/1e3,g._getUIString("ScaleControl.Kilometers")):Et(e,u,S,g._getUIString("ScaleControl.Meters"))}function Et(g,e,s,u){const d=function(m){const w=Math.pow(10,`${Math.floor(m)}`.length-1);let S=m/w;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(k){const E=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*E)/E}(S),w*S}(s);g.style.width=e*(d/s)+"px",g.innerHTML=`${d}&nbsp;${u}`}const Fl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},gu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Nl(g){if(g){if(typeof g=="number"){const e=Math.round(Math.abs(g)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,g),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-g),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(g,0),right:new c.P(-g,0)}}if(g instanceof c.P||Array.isArray(g)){const e=c.P.convert(g);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(g.center||[0,0]),top:c.P.convert(g.top||[0,0]),"top-left":c.P.convert(g["top-left"]||[0,0]),"top-right":c.P.convert(g["top-right"]||[0,0]),bottom:c.P.convert(g.bottom||[0,0]),"bottom-left":c.P.convert(g["bottom-left"]||[0,0]),"bottom-right":c.P.convert(g["bottom-right"]||[0,0]),left:c.P.convert(g.left||[0,0]),right:c.P.convert(g.right||[0,0])}}return Nl(new c.P(0,0))}const gr=M;_.AJAXError=c.bh,_.Evented=c.E,_.LngLat=c.N,_.MercatorCoordinate=c.Z,_.Point=c.P,_.addProtocol=c.bi,_.config=c.a,_.removeProtocol=c.bj,_.AttributionControl=hu,_.BoxZoomHandler=Pl,_.CanvasSource=Qn,_.CooperativeGesturesHandler=ca,_.DoubleClickZoomHandler=id,_.DragPanHandler=nd,_.DragRotateHandler=uu,_.EdgeInsets=Eo,_.FullscreenControl=class extends c.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var e;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=s==null?void 0:s.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){C.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=C.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);C.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},_.GeoJSONSource=dr,_.GeolocateControl=class extends c.E{constructor(g){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const s=new c.N(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,d=this._map.getBearing(),m=c.e({bearing:d},this.options.fitBoundsOptions),w=ke.fromLngLat(s,u);this._map.fitBounds(w,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const s=new c.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&mr)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=C.create("button","maplibregl-ctrl-geolocate",this._container),C.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=C.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Rl({element:this._dotElement}),this._circleElement=C.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},cd,g)}onAdd(g){return this._map=g,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(Pi!==void 0&&!e)return Pi;if(window.navigator.permissions===void 0)return Pi=!!window.navigator.geolocation,Pi;try{Pi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Pi=!!window.navigator.geolocation}return Pi})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),C.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Bl=0,mr=!1}_isOutOfMapMaxBounds(g){const e=this._map.getMaxBounds(),s=g.coords;return e&&(s.longitude<e.getWest()||s.longitude>e.getEast()||s.latitude<e.getSouth()||s.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),e=g.getSouthEast(),s=g.getNorthEast(),u=e.distanceTo(s),d=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Bl--,mr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Bl++,Bl>1?(g={maximumAge:6e5,timeout:0},mr=!0):(g=this.options.positionOptions,mr=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},_.Hash=Xh,_.ImageSource=Jn,_.KeyboardHandler=Zr,_.LngLatBounds=ke,_.LogoControl=li,_.Map=class extends Oo{constructor(g){c.bf.mark(c.bg.create);const e=Object.assign(Object.assign({},od),g);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ls(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new du,this._controls=[],this._mapId=c.a4(),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},sd),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ne.addThrottleControl(()=>this.isMoving()),this._requestManager=new _e(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const u=El(d=>{this._trackResize&&!this._removed&&(this.resize(d),this.redraw())},50);this._resizeObserver=new ResizeObserver(d=>{s?u(d):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ad(this,e),this._hash=e.hash&&new Xh(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,c.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new hu(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new li,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new c.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new c.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new c.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(g,e){if(e===void 0&&(e=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=g.onAdd(this);this._controls.push(g);const u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(s,u.firstChild):u.appendChild(s),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(g);return e>-1&&this._controls.splice(e,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,e,s,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,e,s,u)}resize(g){var e;const s=this._containerDimensions(),u=s[0],d=s[1],m=this._getClampedPixelRatio(u,d);if(this._resizeCanvas(u,d,m),this.painter.resize(u,d,m),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const k=this._getClampedPixelRatio(u,d);this._resizeCanvas(u,d,k),this.painter.resize(u,d,k)}this.transform.resize(u,d),(e=this._requestedCameraState)===null||e===void 0||e.resize(u,d);const w=!this._moving;return w&&(this.stop(),this.fire(new c.k("movestart",g)).fire(new c.k("move",g))),this.fire(new c.k("resize",g)),w&&this.fire(new c.k("moveend",g)),this}_getClampedPixelRatio(g,e){const{0:s,1:u}=this._maxCanvasSize,d=this.getPixelRatio(),m=g*d,w=e*d;return Math.min(m>s?s/m:1,w>u?u/w:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(ke.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(c.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(c.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,e,s){if(g==="mouseenter"||g==="mouseover"){let u=!1;return{layers:e,listener:s,delegates:{mousemove:m=>{const w=e.filter(k=>this.getLayer(k)),S=w.length!==0?this.queryRenderedFeatures(m.point,{layers:w}):[];S.length?u||(u=!0,s.call(this,new tr(g,this,m.originalEvent,{features:S}))):u=!1},mouseout:()=>{u=!1}}}}if(g==="mouseleave"||g==="mouseout"){let u=!1;return{layers:e,listener:s,delegates:{mousemove:w=>{const S=e.filter(k=>this.getLayer(k));(S.length!==0?this.queryRenderedFeatures(w.point,{layers:S}):[]).length?u=!0:u&&(u=!1,s.call(this,new tr(g,this,w.originalEvent)))},mouseout:w=>{u&&(u=!1,s.call(this,new tr(g,this,w.originalEvent)))}}}}{const u=d=>{const m=e.filter(S=>this.getLayer(S)),w=m.length!==0?this.queryRenderedFeatures(d.point,{layers:m}):[];w.length&&(d.features=w,s.call(this,d),delete d.features)};return{layers:e,listener:s,delegates:{[g]:u}}}}_saveDelegatedListener(g,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(e)}_removeDelegatedListener(g,e,s){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const u=this._delegatedListeners[g];for(let d=0;d<u.length;d++){const m=u[d];if(m.listener===s&&m.layers.length===e.length&&m.layers.every(w=>e.includes(w))){for(const w in m.delegates)this.off(w,m.delegates[w]);return void u.splice(d,1)}}}on(g,e,s){if(s===void 0)return super.on(g,e);const u=this._createDelegatedListener(g,typeof e=="string"?[e]:e,s);this._saveDelegatedListener(g,u);for(const d in u.delegates)this.on(d,u.delegates[d]);return this}once(g,e,s){if(s===void 0)return super.once(g,e);const u=typeof e=="string"?[e]:e,d=this._createDelegatedListener(g,u,s);for(const m in d.delegates){const w=d.delegates[m];d.delegates[m]=(...S)=>{this._removeDelegatedListener(g,u,s),w(...S)}}this._saveDelegatedListener(g,d);for(const m in d.delegates)this.once(m,d.delegates[m]);return this}off(g,e,s){return s===void 0?super.off(g,e):(this._removeDelegatedListener(g,typeof e=="string"?[e]:e,s),this)}queryRenderedFeatures(g,e){if(!this.style)return[];let s;const u=g instanceof c.P||Array.isArray(g),d=u?g:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:g)||{},d instanceof c.P||typeof d[0]=="number")s=[c.P.convert(d)];else{const m=c.P.convert(d[0]),w=c.P.convert(d[1]);s=[m,new c.P(w.x,m.y),w,new c.P(m.x,w.y),m]}return this.style.queryRenderedFeatures(s,e,this.transform)}querySourceFeatures(g,e){return this.style.querySourceFeatures(g,e)}setStyle(g,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(g,e))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const e=this._locale[g];if(e==null)throw new Error(`Missing UI string '${g}'`);return e}_updateStyle(g,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,e));const s=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new fl(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,e,s):this.style.loadJSON(g,e,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new fl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,e){if(typeof g=="string"){const s=this._requestManager.transformRequest(g,"Style");c.h(s,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new c.j(u))})}else typeof g=="object"&&this._updateDiff(g,e)}_updateDiff(g,e){try{this.style.setState(g,e)&&this._update(!0)}catch(s){c.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(g,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(g,e){return this._lazyInitEmptyStyle(),this.style.addSource(g,e),this._update(!0)}isSourceLoaded(g){const e=this.style&&this.style.sourceCaches[g];if(e!==void 0)return e.loaded();this.fire(new c.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const e=this.style.sourceCaches[g.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&e.reload();for(const s in this.style._layers){const u=this.style._layers[s];u.type==="hillshade"&&u.source===g.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new dp(this.painter,e,g),this.painter.renderToTexture=new pu(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:g})),this}getTerrain(){var g,e;return(e=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const e in g){const s=g[e]._tiles;for(const u in s){const d=s[u];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,e,s={}){const{pixelRatio:u=1,sdf:d=!1,stretchX:m,stretchY:w,content:S,textFitWidth:k,textFitHeight:E}=s;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:D,data:V}=e,H=e;return this.style.addImage(g,{data:new c.R({width:z,height:D},new Uint8Array(V)),pixelRatio:u,stretchX:m,stretchY:w,content:S,textFitWidth:k,textFitHeight:E,sdf:d,version:0,userImage:H}),H.onAdd&&H.onAdd(this,g),this}}{const{width:z,height:D,data:V}=R.getImageData(e);this.style.addImage(g,{data:new c.R({width:z,height:D},V),pixelRatio:u,stretchX:m,stretchY:w,content:S,textFitWidth:k,textFitHeight:E,sdf:d,version:0})}}updateImage(g,e){const s=this.style.getImage(g);if(!s)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=e instanceof HTMLImageElement||c.b(e)?R.getImageData(e):e,{width:d,height:m,data:w}=u;if(d===void 0||m===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==s.data.width||m!==s.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(e instanceof HTMLImageElement||c.b(e));return s.data.replace(w,S),this.style.updateImage(g,s),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return ne.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,e){return this._lazyInitEmptyStyle(),this.style.addLayer(g,e),this._update(!0)}moveLayer(g,e){return this.style.moveLayer(g,e),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,e,s){return this.style.setLayerZoomRange(g,e,s),this._update(!0)}setFilter(g,e,s={}){return this.style.setFilter(g,e,s),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,e,s,u={}){return this.style.setPaintProperty(g,e,s,u),this._update(!0)}getPaintProperty(g,e){return this.style.getPaintProperty(g,e)}setLayoutProperty(g,e,s,u={}){return this.style.setLayoutProperty(g,e,s,u),this._update(!0)}getLayoutProperty(g,e){return this.style.getLayoutProperty(g,e)}setGlyphs(g,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,e,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,e,s,u=>{u||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,e,s=>{s||this._update(!0)}),this}setLight(g,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(g){return this._lazyInitEmptyStyle(),this.style.setSky(g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,e){return this.style.setFeatureState(g,e),this._update()}removeFeatureState(g,e){return this.style.removeFeatureState(g,e),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,e=0;return this._container&&(g=this._container.clientWidth||400,e=this._container.clientHeight||300),[g,e]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const e=this._canvasContainer=C.create("div","maplibregl-canvas-container",g);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=C.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),u=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],u);const d=this._controlContainer=C.create("div","maplibregl-control-container",g),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{m[w]=C.create("div",`maplibregl-ctrl-${w} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,e,s){this._canvas.width=Math.floor(s*g),this._canvas.height=Math.floor(s*e),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:g},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});const s=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!s){const u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new Il(s,this.transform),Y.testSupport(s)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=R.now();this.style.zoomHistory.update(d,m);const w=new c.z(d,{now:m,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),S=w.crossFadingFactor();S===1&&S===this._crossFadingFactor||(s=!0,this._crossFadingFactor=S),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ne.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),C.remove(this._canvasContainer),C.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,R.frameAsync(this._frameRequest).then(g=>{c.bf.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return pp}getCameraTargetElevation(){return this.transform.elevation}},_.MapMouseEvent=tr,_.MapTouchEvent=zo,_.MapWheelEvent=iu,_.Marker=Rl,_.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const e=this._map.getZoom(),s=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,s)=>{const u=this._map._getUIString(`NavigationControl.${s}`);e.title=u,e.setAttribute("aria-label",u)},this.options=c.e({},mp,g),this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),C.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),C.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=C.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new rs(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){C.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,e){const s=C.create("button",g,this._container);return s.type="button",s.addEventListener("click",e),s}},_.Popup=class extends c.E{constructor(g){super(),this.remove=()=>(this._content&&C.remove(this._content),this._container&&(C.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var s;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=C.create("div","maplibregl-popup",this._map.getContainer()),this._tip=C.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Fo(this._lngLat,this._flatPos,this._map.transform):(s=this._lngLat)===null||s===void 0?void 0:s.wrap(),this._trackPointer&&!e)return;const u=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let d=this.options.anchor;const m=Nl(this.options.offset);if(!d){const S=this._container.offsetWidth,k=this._container.offsetHeight;let E;E=u.y+m.bottom.y<k?["top"]:u.y>this._map.transform.height-k?["bottom"]:[],u.x<S/2?E.push("left"):u.x>this._map.transform.width-S/2&&E.push("right"),d=E.length===0?"bottom":E.join("-")}let w=u.add(m[d]);this.options.subpixelPositioning||(w=w.round()),C.setTransform(this._container,`${No[d]} translate(${w.x}px,${w.y}px)`),mu(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Fl),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=c.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const e=document.createDocumentFragment(),s=document.createElement("body");let u;for(s.innerHTML=g;u=s.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=C.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=C.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(gu);g&&g.focus()}},_.RasterDEMTileSource=Ei,_.RasterTileSource=Kt,_.ScaleControl=class{constructor(g){this._onMove=()=>{St(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,St(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ol),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){C.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},_.ScrollZoomHandler=is,_.Style=fl,_.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=C.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=C.create("button","maplibregl-ctrl-terrain",this._container),C.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){C.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},_.TwoFingersTouchPitchHandler=cu,_.TwoFingersTouchRotateHandler=lu,_.TwoFingersTouchZoomHandler=su,_.TwoFingersTouchZoomRotateHandler=Bs,_.VectorTileSource=Ii,_.VideoSource=Ia,_.addSourceType=(g,e)=>c._(void 0,void 0,void 0,function*(){if(Tt(g))throw new Error(`A source type called "${g}" already exists.`);((s,u)=>{xt[s]=u})(g,e)}),_.clearPrewarmedResources=function(){const g=si;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(_t),si=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},_.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},_.getRTLTextPluginStatus=function(){return Qt().getRTLTextPluginStatus()},_.getVersion=function(){return gr},_.getWorkerCount=function(){return Xt.workerCount},_.getWorkerUrl=function(){return c.a.WORKER_URL},_.importScriptInWorkers=function(g){return Yt().broadcast("IS",g)},_.prewarm=function(){qt().acquire(_t)},_.setMaxParallelImageRequests=function(g){c.a.MAX_PARALLEL_IMAGE_REQUESTS=g},_.setRTLTextPlugin=function(g,e){return Qt().setRTLTextPlugin(g,e)},_.setWorkerCount=function(g){Xt.workerCount=g},_.setWorkerUrl=function(g){c.a.WORKER_URL=g}});var b=o;return b})})(b1);var qT=b1.exports;const Gd=HT(qT),GT=8,ZT="Basic",XT={"mapbox:autocomposite":!1,"mapbox:type":"template","maputnik:renderer":"mbgljs","openmaptiles:version":"3.x","openmaptiles:mapbox:owner":"openmaptiles","openmaptiles:mapbox:source:url":"mapbox://openmaptiles.4qljc88t"},YT={openmaptiles:{type:"vector",url:"pmtiles://basemap.pmtiles"}},KT="https://openmaptiles.github.io/maptiler-basic-gl-style/sprite",JT="https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=JICzlXTKRtx2xghzNelR",QT=[{id:"background",type:"background",paint:{"background-color":"rgba(255, 255, 255, 1)"}},{id:"landcover_grass",type:"fill",source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"rgba(160, 191, 128, 1)","fill-opacity":.45}},{id:"boundary",type:"line",source:"openmaptiles","source-layer":"boundary",paint:{"line-color":"rgba(0, 0, 0, 1)","line-opacity":.45,"line-width":4}},{id:"water",type:"fill",source:"openmaptiles","source-layer":"water",filter:["all",["==","$type","Polygon"],["!=","intermittent",1],["!=","brunnel","tunnel"]],layout:{visibility:"visible"},paint:{"fill-color":"#8EB5BA"}},{id:"water-outline",type:"line",source:"openmaptiles","source-layer":"water",paint:{"line-color":"rgba(95, 144, 150, 1)","line-width":{base:.2,stops:[[10,.5],[13,.5]]}}},{id:"waterway",type:"line",source:"openmaptiles","source-layer":"waterway",filter:["all",["==","$type","LineString"],["!in","brunnel","tunnel","bridge"],["!=","intermittent",1]],layout:{visibility:"visible"},paint:{"line-color":"#8EB5BA","line-opacity":1,"line-width":{base:1.4,stops:[[8,1],[20,8]]}}},{id:"road_minor",type:"line",source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["==","$type","LineString"],["in","class","minor","service","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(220, 217, 217, 1)","line-width":{base:1.55,stops:[[4,.25],[13,.5],[20,15]]}}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-color":"rgba(255, 255, 255, 1)","fill-opacity":{base:1,stops:[[13,0],[14,1]]}}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(255, 255, 255, 1)","line-opacity":1,"line-width":{base:1.5,stops:[[12,1],[17,10]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(255, 255, 255, 1)","line-opacity":1,"line-width":{base:1.5,stops:[[11,4],[17,50]]}}},{id:"road_trunk_primary",type:"line",source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["in","class","trunk","primary"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(220, 217, 217, 1)","line-width":{base:1.4,stops:[[6,.5],[20,30]]}}},{id:"road_secondary_tertiary",type:"line",source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["==","$type","LineString"],["in","class","secondary"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(220, 217, 217, 1)","line-width":{base:1.4,stops:[[6,.5],[20,12]]}}},{id:"road_major_motorway",type:"line",source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(220, 217, 217, 1)","line-offset":0,"line-width":{base:1.4,stops:[[8,1],[16,10]]}}},{id:"railway-transit",type:"line",source:"openmaptiles","source-layer":"transportation",filter:["all",["==","class","transit"],["!=","brunnel","tunnel"]],layout:{visibility:"visible"},paint:{"line-color":"hsl(34, 12%, 66%)","line-opacity":{base:1,stops:[[11,0],[16,1]]}}},{id:"railway",type:"line",source:"openmaptiles","source-layer":"transportation",filter:["==","class","rail"],layout:{visibility:"visible"},paint:{"line-color":"hsl(34, 12%, 66%)","line-opacity":{base:1,stops:[[11,0],[16,1]]}}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",minzoom:12,filter:["all",["!in","class","city","town","village","state","country","continent"]],layout:{"text-field":`{name:latin}
{name:nonlatin}`,"text-font":["Noto Sans Bold"],"text-letter-spacing":.1,"text-max-width":9,"text-allow-overlap":!1,"symbol-placement":"point","symbol-spacing":{stops:[[12,500],[13.5,500],[14,250],[15,150]]},"text-padding":{stops:[[12,50],[13.5,50],[14,25],[15,15]]},"text-size":{base:1.2,stops:[[12,10],[15,14]]},"symbol-sort-key":["get","name:latin"],"text-transform":"uppercase",visibility:"visible","symbol-z-order":"viewport-y"},paint:{"text-color":"rgba(47, 44, 44, 1)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"place-city",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","class","city"]],layout:{"text-field":`{name:latin}
{name:nonlatin}`,"text-font":["Noto Sans Bold"],"text-size":{base:1.2,stops:[[7,14],[11,20]]},"text-max-width":10,"symbol-placement":"point","text-padding":2,visibility:"visible","symbol-sort-key":["get","rank"],"text-transform":"uppercase"},paint:{"text-color":"rgba(47, 44, 44, 1)","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.5}},{id:"waterway_label",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name:latin"]],layout:{"text-field":"{name:latin}","text-font":["Noto Sans Bold Italic"],"text-size":14,"text-max-width":5,"symbol-placement":"line","text-pitch-alignment":"viewport","text-rotation-alignment":"map","symbol-spacing":500,visibility:"visible"},paint:{"text-color":"#497578","text-halo-color":"rgba(255,255,255,0.9)","text-halo-width":1.5}},{id:"water_name",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","lake"]],layout:{"text-field":"{name:latin}","text-font":["Noto Sans Italic"],"text-size":14,"text-max-width":8,"symbol-placement":"point","text-padding":2,visibility:"visible"},paint:{"text-color":"#497578","text-halo-color":"rgba(255,255,255,0.9)","text-halo-width":1.5}}],eS="basic",tS={version:GT,name:ZT,metadata:XT,sources:YT,sprite:KT,glyphs:JT,layers:QT,id:eS};var uc=Math.pow,cr=(i,n,o)=>new Promise((h,p)=>{var b=M=>{try{c(o.next(M))}catch(B){p(B)}},_=M=>{try{c(o.throw(M))}catch(B){p(B)}},c=M=>M.done?h(M.value):Promise.resolve(M.value).then(b,_);c((o=o.apply(i,n)).next())}),aa=Uint8Array,Ku=Uint16Array,iS=Int32Array,w1=new aa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),T1=new aa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nS=new aa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),S1=function(i,n){for(var o=new Ku(31),h=0;h<31;++h)o[h]=n+=1<<i[h-1];for(var p=new iS(o[30]),h=1;h<30;++h)for(var b=o[h];b<o[h+1];++b)p[b]=b-o[h]<<5|h;return{b:o,r:p}},k1=S1(w1,2),A1=k1.b,rS=k1.r;A1[28]=258,rS[258]=28;var aS=S1(T1,0),sS=aS.b,M1=new Ku(32768);for($i=0;$i<32768;++$i)ds=($i&43690)>>1|($i&21845)<<1,ds=(ds&52428)>>2|(ds&13107)<<2,ds=(ds&61680)>>4|(ds&3855)<<4,M1[$i]=((ds&65280)>>8|(ds&255)<<8)>>1;var ds,$i,Ju=function(i,n,o){for(var h=i.length,p=0,b=new Ku(n);p<h;++p)i[p]&&++b[i[p]-1];var _=new Ku(n);for(p=1;p<n;++p)_[p]=_[p-1]+b[p-1]<<1;var c;{c=new Ku(1<<n);var M=15-n;for(p=0;p<h;++p)if(i[p])for(var B=p<<4|i[p],O=n-i[p],R=_[i[p]-1]++<<O,C=R|(1<<O)-1;R<=C;++R)c[M1[R]>>M]=B}return c},mh=new aa(288);for($i=0;$i<144;++$i)mh[$i]=8;var $i;for($i=144;$i<256;++$i)mh[$i]=9;var $i;for($i=256;$i<280;++$i)mh[$i]=7;var $i;for($i=280;$i<288;++$i)mh[$i]=8;var $i,I1=new aa(32);for($i=0;$i<32;++$i)I1[$i]=5;var $i,oS=Ju(mh,9),lS=Ju(I1,5),um=function(i){for(var n=i[0],o=1;o<i.length;++o)i[o]>n&&(n=i[o]);return n},wa=function(i,n,o){var h=n/8|0;return(i[h]|i[h+1]<<8)>>(n&7)&o},hm=function(i,n){var o=n/8|0;return(i[o]|i[o+1]<<8|i[o+2]<<16)>>(n&7)},cS=function(i){return(i+7)/8|0},uS=function(i,n,o){(o==null||o>i.length)&&(o=i.length);var h=new aa(o-n);return h.set(i.subarray(n,o)),h},hS=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ra=function(i,n,o){var h=new Error(n||hS[i]);if(h.code=i,Error.captureStackTrace&&Error.captureStackTrace(h,ra),!o)throw h;return h},Hg=function(i,n,o,h){var p=i.length,b=0;if(!p||n.f&&!n.l)return o||new aa(0);var _=!o||n.i!=2,c=n.i;o||(o=new aa(p*3));var M=function(bi){var Yt=o.length;if(bi>Yt){var Bi=new aa(Math.max(Yt*2,bi));Bi.set(o),o=Bi}},B=n.f||0,O=n.p||0,R=n.b||0,C=n.l,Y=n.d,X=n.m,Z=n.n,se=p*8;do{if(!C){B=wa(i,O,1);var q=wa(i,O+1,3);if(O+=3,q)if(q==1)C=oS,Y=lS,X=9,Z=5;else if(q==2){var be=wa(i,O,31)+257,Ae=wa(i,O+10,15)+4,de=be+wa(i,O+5,31)+1;O+=14;for(var Be=new aa(de),Fe=new aa(19),Le=0;Le<Ae;++Le)Fe[nS[Le]]=wa(i,O+Le*3,7);O+=Ae*3;for(var we=um(Fe),Te=(1<<we)-1,fe=Ju(Fe,we),Le=0;Le<de;){var Me=fe[wa(i,O,Te)];O+=Me&15;var te=Me>>4;if(te<16)Be[Le++]=te;else{var Ee=0,$e=0;for(te==16?($e=3+wa(i,O,3),O+=2,Ee=Be[Le-1]):te==17?($e=3+wa(i,O,7),O+=3):te==18&&($e=11+wa(i,O,127),O+=7);$e--;)Be[Le++]=Ee}}var He=Be.subarray(0,be),Ge=Be.subarray(be);X=um(He),Z=um(Ge),C=Ju(He,X),Y=Ju(Ge,Z)}else ra(1);else{var te=cS(O)+4,ne=i[te-4]|i[te-3]<<8,_e=te+ne;if(_e>p){c&&ra(0);break}_&&M(R+ne),o.set(i.subarray(te,_e),R),n.b=R+=ne,n.p=O=_e*8,n.f=B;continue}if(O>se){c&&ra(0);break}}_&&M(R+131072);for(var Re=(1<<X)-1,Xe=(1<<Z)-1,Ue=O;;Ue=O){var Ee=C[hm(i,O)&Re],Mt=Ee>>4;if(O+=Ee&15,O>se){c&&ra(0);break}if(Ee||ra(2),Mt<256)o[R++]=Mt;else if(Mt==256){Ue=O,C=null;break}else{var Rt=Mt-254;if(Mt>264){var Le=Mt-257,_t=w1[Le];Rt=wa(i,O,(1<<_t)-1)+A1[Le],O+=_t}var Xt=Y[hm(i,O)&Xe],jt=Xt>>4;Xt||ra(3),O+=Xt&15;var Ge=sS[jt];if(jt>3){var _t=T1[jt];Ge+=hm(i,O)&(1<<_t)-1,O+=_t}if(O>se){c&&ra(0);break}_&&M(R+131072);var si=R+Rt;if(R<Ge){var fi=b-Ge,qt=Math.min(Ge,si);for(fi+R<0&&ra(3);R<qt;++R)o[R]=h[fi+R]}for(;R<si;R+=4)o[R]=o[R-Ge],o[R+1]=o[R+1-Ge],o[R+2]=o[R+2-Ge],o[R+3]=o[R+3-Ge];R=si}}n.l=C,n.p=Ue,n.b=R,n.f=B,C&&(B=1,n.m=X,n.d=Y,n.n=Z)}while(!B);return R==o.length?o:uS(o,0,R)},dS=new aa(0),fS=function(i){(i[0]!=31||i[1]!=139||i[2]!=8)&&ra(6,"invalid gzip data");var n=i[3],o=10;n&4&&(o+=(i[10]|i[11]<<8)+2);for(var h=(n>>3&1)+(n>>4&1);h>0;h-=!i[o++]);return o+(n&2)},pS=function(i){var n=i.length;return(i[n-4]|i[n-3]<<8|i[n-2]<<16|i[n-1]<<24)>>>0},mS=function(i,n){return((i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31)&&ra(6,"invalid zlib data"),(i[1]>>5&1)==+!n&&ra(6,"invalid zlib data: "+(i[1]&32?"need":"unexpected")+" dictionary"),(i[1]>>3&4)+2};function gS(i,n){return Hg(i,{i:2},n,n)}function yS(i,n){var o=fS(i);return o+8>i.length&&ra(6,"invalid gzip data"),Hg(i.subarray(o,-8),{i:2},new aa(pS(i)),n)}function _S(i,n){return Hg(i.subarray(mS(i,n),-4),{i:2},n,n)}function cg(i,n){return i[0]==31&&i[1]==139&&i[2]==8?yS(i,n):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?gS(i,n):_S(i,n)}var vS=typeof TextDecoder<"u"&&new TextDecoder,bS=0;try{vS.decode(dS,{stream:!0}),bS=1}catch{}var E1=(i,n)=>i*uc(2,n),Nu=(i,n)=>Math.floor(i/uc(2,n)),Zd=(i,n)=>E1(i.getUint16(n+1,!0),8)+i.getUint8(n),C1=(i,n)=>E1(i.getUint32(n+2,!0),16)+i.getUint16(n,!0),xS=(i,n,o,h,p)=>{if(i!==h.getUint8(p))return i-h.getUint8(p);const b=Zd(h,p+1);if(n!==b)return n-b;const _=Zd(h,p+4);return o!==_?o-_:0},wS=(i,n,o,h)=>{const p=P1(i,n|128,o,h);return p?{z:n,x:o,y:h,offset:p[0],length:p[1],isDir:!0}:null},m_=(i,n,o,h)=>{const p=P1(i,n,o,h);return p?{z:n,x:o,y:h,offset:p[0],length:p[1],isDir:!1}:null},P1=(i,n,o,h)=>{let p=0,b=i.byteLength/17-1;for(;p<=b;){const _=b+p>>1,c=xS(n,o,h,i,_*17);if(c>0)p=_+1;else if(c<0)b=_-1;else return[C1(i,_*17+7),i.getUint32(_*17+13,!0)]}return null},TS=(i,n)=>i.isDir&&!n.isDir?1:!i.isDir&&n.isDir?-1:i.z!==n.z?i.z-n.z:i.x!==n.x?i.x-n.x:i.y-n.y,z1=(i,n)=>{const o=i.getUint8(n*17);return{z:o&127,x:Zd(i,n*17+1),y:Zd(i,n*17+4),offset:C1(i,n*17+7),length:i.getUint32(n*17+13,!0),isDir:o>>7===1}},g_=i=>{const n=[],o=new DataView(i);for(let h=0;h<o.byteLength/17;h++)n.push(z1(o,h));return SS(n)},SS=i=>{i.sort(TS);const n=new ArrayBuffer(17*i.length),o=new Uint8Array(n);for(let h=0;h<i.length;h++){const p=i[h];let b=p.z;p.isDir&&(b=b|128),o[h*17]=b,o[h*17+1]=p.x&255,o[h*17+2]=p.x>>8&255,o[h*17+3]=p.x>>16&255,o[h*17+4]=p.y&255,o[h*17+5]=p.y>>8&255,o[h*17+6]=p.y>>16&255,o[h*17+7]=p.offset&255,o[h*17+8]=Nu(p.offset,8)&255,o[h*17+9]=Nu(p.offset,16)&255,o[h*17+10]=Nu(p.offset,24)&255,o[h*17+11]=Nu(p.offset,32)&255,o[h*17+12]=Nu(p.offset,48)&255,o[h*17+13]=p.length&255,o[h*17+14]=p.length>>8&255,o[h*17+15]=p.length>>16&255,o[h*17+16]=p.length>>24&255}return n},kS=(i,n)=>{if(i.byteLength<17)return null;const o=i.byteLength/17,h=z1(i,o-1);if(h.isDir){const p=h.z,b=n.z-p,_=Math.trunc(n.x/(1<<b)),c=Math.trunc(n.y/(1<<b));return{z:p,x:_,y:c}}return null};function AS(i){return cr(this,null,function*(){const n=yield i.getBytes(0,512e3),o=new DataView(n.data),h=o.getUint32(4,!0),p=o.getUint16(8,!0),b=new TextDecoder("utf-8"),_=JSON.parse(b.decode(new DataView(n.data,10,h)));let c=0;_.compression==="gzip"&&(c=2);let M=0;"minzoom"in _&&(M=+_.minzoom);let B=0;"maxzoom"in _&&(B=+_.maxzoom);let O=0,R=0,C=0,Y=-180,X=-85,Z=180,se=85;if(_.bounds){const te=_.bounds.split(",");Y=+te[0],X=+te[1],Z=+te[2],se=+te[3]}if(_.center){const te=_.center.split(",");O=+te[0],R=+te[1],C=+te[2]}return{specVersion:o.getUint16(2,!0),rootDirectoryOffset:10+h,rootDirectoryLength:p*17,jsonMetadataOffset:10,jsonMetadataLength:h,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:c,tileType:1,minZoom:M,maxZoom:B,minLon:Y,minLat:X,maxLon:Z,maxLat:se,centerZoom:C,centerLon:O,centerLat:R,etag:n.etag}})}function MS(i,n,o,h,p,b,_){return cr(this,null,function*(){let c=yield o.getArrayBuffer(n,i.rootDirectoryOffset,i.rootDirectoryLength,i);i.specVersion===1&&(c=g_(c));const M=m_(new DataView(c),h,p,b);if(M){let R=(yield n.getBytes(M.offset,M.length,_)).data;const C=new DataView(R);return C.getUint8(0)===31&&C.getUint8(1)===139&&(R=cg(new Uint8Array(R))),{data:R}}const B=kS(new DataView(c),{z:h,x:p,y:b});if(B){const O=wS(new DataView(c),B.z,B.x,B.y);if(O){let R=yield o.getArrayBuffer(n,O.offset,O.length,i);i.specVersion===1&&(R=g_(R));const C=m_(new DataView(R),h,p,b);if(C){let X=(yield n.getBytes(C.offset,C.length,_)).data;const Z=new DataView(X);return Z.getUint8(0)===31&&Z.getUint8(1)===139&&(X=cg(new Uint8Array(X))),{data:X}}}}})}var D1={getHeader:AS,getZxy:MS},IS=i=>(n,o)=>{if(o instanceof AbortController)return i(n,o);const h=new AbortController;return i(n,h).then(p=>o(void 0,p.data,p.cacheControl||"",p.expires||""),p=>o(p)).catch(p=>o(p)),{cancel:()=>h.abort()}},ES=class{constructor(i){this.tilev4=(n,o)=>cr(this,null,function*(){if(n.type==="json"){const C=n.url.substr(10);let Y=this.tiles.get(C);if(Y||(Y=new hg(C),this.tiles.set(C,Y)),this.metadata)return{data:yield Y.getTileJson(n.url)};const X=yield Y.getHeader();return{data:{tiles:[`${n.url}/{z}/{x}/{y}`],minzoom:X.minZoom,maxzoom:X.maxZoom,bounds:[X.minLon,X.minLat,X.maxLon,X.maxLat]}}}const h=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),p=n.url.match(h);if(!p)throw new Error("Invalid PMTiles protocol URL");const b=p[1];let _=this.tiles.get(b);_||(_=new hg(b),this.tiles.set(b,_));const c=p[2],M=p[3],B=p[4],O=yield _.getHeader(),R=yield _==null?void 0:_.getZxy(+c,+M,+B,o.signal);return R?{data:new Uint8Array(R.data),cacheControl:R.cacheControl,expires:R.expires}:O.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=IS(this.tilev4),this.tiles=new Map,this.metadata=(i==null?void 0:i.metadata)||!1}add(i){this.tiles.set(i.source.getKey(),i)}get(i){return this.tiles.get(i)}};function ic(i,n){return(n>>>0)*4294967296+(i>>>0)}function CS(i,n){const o=n.buf;let h=o[n.pos++],p=(h&112)>>4;if(h<128||(h=o[n.pos++],p|=(h&127)<<3,h<128)||(h=o[n.pos++],p|=(h&127)<<10,h<128)||(h=o[n.pos++],p|=(h&127)<<17,h<128)||(h=o[n.pos++],p|=(h&127)<<24,h<128)||(h=o[n.pos++],p|=(h&1)<<31,h<128))return ic(i,p);throw new Error("Expected varint not more than 10 bytes")}function ju(i){const n=i.buf;let o=n[i.pos++],h=o&127;return o<128||(o=n[i.pos++],h|=(o&127)<<7,o<128)||(o=n[i.pos++],h|=(o&127)<<14,o<128)||(o=n[i.pos++],h|=(o&127)<<21,o<128)?h:(o=n[i.pos],h|=(o&15)<<28,CS(h,i))}function PS(i,n,o,h){if(h===0){o===1&&(n[0]=i-1-n[0],n[1]=i-1-n[1]);const p=n[0];n[0]=n[1],n[1]=p}}var zS=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function DS(i,n,o){if(i>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(n>uc(2,i)-1||o>uc(2,i)-1)throw Error("tile x/y outside zoom level bounds");const h=zS[i],p=uc(2,i);let b=0,_=0,c=0;const M=[n,o];let B=p/2;for(;B>0;)b=(M[0]&B)>0?1:0,_=(M[1]&B)>0?1:0,c+=B*B*(3*b^_),PS(B,M,b,_),B=B/2;return h+c}function L1(i,n){return cr(this,null,function*(){if(n===1||n===0)return i;if(n===2){if(typeof globalThis.DecompressionStream>"u")return cg(new Uint8Array(i));const o=new Response(i).body;if(!o)throw Error("Failed to read response stream");const h=o.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(h).arrayBuffer()}throw Error("Compression method not supported")})}function LS(i){return i===1?".mvt":i===2?".png":i===3?".jpg":i===4?".webp":i===5?".avif":""}var RS=127;function BS(i,n){let o=0,h=i.length-1;for(;o<=h;){const p=h+o>>1,b=n-i[p].tileId;if(b>0)o=p+1;else if(b<0)h=p-1;else return i[p]}return h>=0&&(i[h].runLength===0||n-i[h].tileId<i[h].runLength)?i[h]:null}var OS=class{constructor(i,n=new Headers){this.url=i,this.customHeaders=n,this.mustReload=!1;let o="";"navigator"in globalThis&&(o=globalThis.navigator.userAgent||"");const h=o.indexOf("Windows")>-1,p=/Chrome|Chromium|Edg|OPR|Brave/.test(o);this.chromeWindowsNoCache=!1,h&&p&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(i){this.customHeaders=i}getBytes(i,n,o,h){return cr(this,null,function*(){let p,b;o?b=o:(p=new AbortController,b=p.signal);const _=new Headers(this.customHeaders);_.set("range",`bytes=${i}-${i+n-1}`);let c;this.mustReload?c="reload":this.chromeWindowsNoCache&&(c="no-store");let M=yield fetch(this.url,{signal:b,cache:c,headers:_});if(i===0&&M.status===416){const C=M.headers.get("Content-Range");if(!C||!C.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const Y=+C.substr(8);M=yield fetch(this.url,{signal:b,cache:"reload",headers:{range:`bytes=0-${Y-1}`}})}let B=M.headers.get("Etag");if(B!=null&&B.startsWith("W/")&&(B=null),M.status===416||h&&B&&B!==h)throw this.mustReload=!0,new ug(`Server returned non-matching ETag ${h} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(M.status>=300)throw Error(`Bad response code: ${M.status}`);const O=M.headers.get("Content-Length");if(M.status===200&&(!O||+O>n))throw p&&p.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield M.arrayBuffer(),etag:B||void 0,cacheControl:M.headers.get("Cache-Control")||void 0,expires:M.headers.get("Expires")||void 0}})}};function Ta(i,n){const o=i.getUint32(n+4,!0),h=i.getUint32(n+0,!0);return o*uc(2,32)+h}function FS(i,n){const o=new DataView(i),h=o.getUint8(7);if(h>3)throw Error(`Archive is spec version ${h} but this library supports up to spec version 3`);return{specVersion:h,rootDirectoryOffset:Ta(o,8),rootDirectoryLength:Ta(o,16),jsonMetadataOffset:Ta(o,24),jsonMetadataLength:Ta(o,32),leafDirectoryOffset:Ta(o,40),leafDirectoryLength:Ta(o,48),tileDataOffset:Ta(o,56),tileDataLength:Ta(o,64),numAddressedTiles:Ta(o,72),numTileEntries:Ta(o,80),numTileContents:Ta(o,88),clustered:o.getUint8(96)===1,internalCompression:o.getUint8(97),tileCompression:o.getUint8(98),tileType:o.getUint8(99),minZoom:o.getUint8(100),maxZoom:o.getUint8(101),minLon:o.getInt32(102,!0)/1e7,minLat:o.getInt32(106,!0)/1e7,maxLon:o.getInt32(110,!0)/1e7,maxLat:o.getInt32(114,!0)/1e7,centerZoom:o.getUint8(118),centerLon:o.getInt32(119,!0)/1e7,centerLat:o.getInt32(123,!0)/1e7,etag:n}}function R1(i){const n={buf:new Uint8Array(i),pos:0},o=ju(n),h=[];let p=0;for(let b=0;b<o;b++){const _=ju(n);h.push({tileId:p+_,offset:0,length:0,runLength:1}),p+=_}for(let b=0;b<o;b++)h[b].runLength=ju(n);for(let b=0;b<o;b++)h[b].length=ju(n);for(let b=0;b<o;b++){const _=ju(n);_===0&&b>0?h[b].offset=h[b-1].offset+h[b-1].length:h[b].offset=_-1}return h}function NS(i){const n=new DataView(i);return n.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):n.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ug=class extends Error{};function jS(i,n){return cr(this,null,function*(){const o=yield i.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(NS(o.data)<3)return[yield D1.getHeader(i)];const p=o.data.slice(0,RS),b=FS(p,o.etag),_=o.data.slice(b.rootDirectoryOffset,b.rootDirectoryOffset+b.rootDirectoryLength),c=`${i.getKey()}|${b.etag||""}|${b.rootDirectoryOffset}|${b.rootDirectoryLength}`,M=R1(yield n(_,b.internalCompression));return[b,[c,M.length,M]]})}function VS(i,n,o,h,p){return cr(this,null,function*(){const b=yield i.getBytes(o,h,void 0,p.etag),_=yield n(b.data,p.internalCompression),c=R1(_);if(c.length===0)throw new Error("Empty directory is invalid");return c})}var $S=class{constructor(i=100,n=!0,o=L1){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=i,this.counter=1,this.decompress=o}getHeader(i){return cr(this,null,function*(){const n=i.getKey(),o=this.cache.get(n);if(o)return o.lastUsed=this.counter++,yield o.data;const h=new Promise((p,b)=>{jS(i,this.decompress).then(_=>{_[1]&&this.cache.set(_[1][0],{lastUsed:this.counter++,data:Promise.resolve(_[1][2])}),p(_[0]),this.prune()}).catch(_=>{b(_)})});return this.cache.set(n,{lastUsed:this.counter++,data:h}),h})}getDirectory(i,n,o,h){return cr(this,null,function*(){const p=`${i.getKey()}|${h.etag||""}|${n}|${o}`,b=this.cache.get(p);if(b)return b.lastUsed=this.counter++,yield b.data;const _=new Promise((c,M)=>{VS(i,this.decompress,n,o,h).then(B=>{c(B),this.prune()}).catch(B=>{M(B)})});return this.cache.set(p,{lastUsed:this.counter++,data:_}),_})}getArrayBuffer(i,n,o,h){return cr(this,null,function*(){const p=`${i.getKey()}|${h.etag||""}|${n}|${o}`,b=this.cache.get(p);if(b)return b.lastUsed=this.counter++,yield b.data;const _=new Promise((c,M)=>{i.getBytes(n,o,void 0,h.etag).then(B=>{c(B.data),this.cache.has(p),this.prune()}).catch(B=>{M(B)})});return this.cache.set(p,{lastUsed:this.counter++,data:_}),_})}prune(){if(this.cache.size>=this.maxCacheEntries){let i=1/0,n;this.cache.forEach((o,h)=>{o.lastUsed<i&&(i=o.lastUsed,n=h)}),n&&this.cache.delete(n)}}invalidate(i){return cr(this,null,function*(){const n=i.getKey();if(this.invalidations.get(n))return yield this.invalidations.get(n);this.cache.delete(i.getKey());const o=new Promise((h,p)=>{this.getHeader(i).then(b=>{h(),this.invalidations.delete(n)}).catch(b=>{p(b)})});this.invalidations.set(n,o)})}},hg=class{constructor(i,n,o){typeof i=="string"?this.source=new OS(i):this.source=i,o?this.decompress=o:this.decompress=L1,n?this.cache=n:this.cache=new $S}getHeader(){return cr(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(i,n,o,h){return cr(this,null,function*(){const p=DS(i,n,o),b=yield this.cache.getHeader(this.source);if(b.specVersion<3)return D1.getZxy(b,this.source,this.cache,i,n,o,h);if(i<b.minZoom||i>b.maxZoom)return;let _=b.rootDirectoryOffset,c=b.rootDirectoryLength;for(let M=0;M<=3;M++){const B=yield this.cache.getDirectory(this.source,_,c,b),O=BS(B,p);if(O){if(O.runLength>0){const R=yield this.source.getBytes(b.tileDataOffset+O.offset,O.length,h,b.etag);return{data:yield this.decompress(R.data,b.tileCompression),cacheControl:R.cacheControl,expires:R.expires}}_=b.leafDirectoryOffset+O.offset,c=O.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(i,n,o,h){return cr(this,null,function*(){try{return yield this.getZxyAttempt(i,n,o,h)}catch(p){if(p instanceof ug)return this.cache.invalidate(this.source),yield this.getZxyAttempt(i,n,o,h);throw p}})}getMetadataAttempt(){return cr(this,null,function*(){const i=yield this.cache.getHeader(this.source),n=yield this.source.getBytes(i.jsonMetadataOffset,i.jsonMetadataLength,void 0,i.etag),o=yield this.decompress(n.data,i.internalCompression),h=new TextDecoder("utf-8");return JSON.parse(h.decode(o))})}getMetadata(){return cr(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(i){if(i instanceof ug)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw i}})}getTileJson(i){return cr(this,null,function*(){const n=yield this.getHeader(),o=yield this.getMetadata(),h=LS(n.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${i}/{z}/{x}/{y}${h}`],vector_layers:o.vector_layers,attribution:o.attribution,description:o.description,name:o.name,version:o.version,bounds:[n.minLon,n.minLat,n.maxLon,n.maxLat],center:[n.centerLon,n.centerLat,n.centerZoom],minzoom:n.minZoom,maxzoom:n.maxZoom}})}};class US{constructor(n){lr(this,"canvas");lr(this,"width",200);lr(this,"height",24);lr(this,"data");lr(this,"context",null);lr(this,"map");lr(this,"currentText","$19");lr(this,"SHADOW_BLUR",6);lr(this,"SHADOW_OFFSET",3);lr(this,"PADDING",16);lr(this,"LINE_HEIGHT",16);this.map=n,this.canvas=document.createElement("canvas");const o=window.devicePixelRatio||1;this.canvas.width=this.width*o,this.canvas.height=this.height*o,this.canvas.style.width=`${this.width}px`,this.canvas.style.height=`${this.height}px`,this.data=new Uint8Array(this.width*this.height*4)}drawPill(){if(!this.context)return;this.context.clearRect(-this.SHADOW_BLUR,-this.SHADOW_BLUR,this.width+this.SHADOW_BLUR*2,this.height+this.SHADOW_BLUR*2+this.SHADOW_OFFSET),this.context.shadowColor="rgba(0, 0, 0, 0.35)",this.context.shadowBlur=this.SHADOW_BLUR,this.context.shadowOffsetY=this.SHADOW_OFFSET;const n=this.height/2;this.context.beginPath(),this.context.moveTo(n,0),this.context.lineTo(this.width-n,0),this.context.arcTo(this.width,0,this.width,n,n),this.context.arcTo(this.width,this.height,this.width-n,this.height,n),this.context.lineTo(n,this.height),this.context.arcTo(0,this.height,0,n,n),this.context.arcTo(0,0,n,0,n),this.context.closePath(),this.context.fillStyle="#417d77",this.context.fill(),this.context.shadowColor="transparent",this.context.strokeStyle="#313E40",this.context.lineWidth=1,this.context.stroke()}render(n="$19"){if(!this.context)return!1;this.currentText=n;const o=window.devicePixelRatio||1;this.context.font="bold 14px Supreme-Regular";const h=n.split(" "),p=this.calculateLines(h);this.height=24+(p.length-1)*this.LINE_HEIGHT;const b=Math.max(...p.map(c=>this.context.measureText(c).width));this.width=Math.max(100,b+this.PADDING*2),this.canvas.width=(this.width+this.SHADOW_BLUR*2)*o,this.canvas.height=(this.height+this.SHADOW_BLUR*2+this.SHADOW_OFFSET)*o,this.canvas.style.width=`${this.width+this.SHADOW_BLUR*2}px`,this.canvas.style.height=`${this.height+this.SHADOW_BLUR*2+this.SHADOW_OFFSET}px`,this.context.scale(o,o),this.context.translate(this.SHADOW_BLUR,this.SHADOW_BLUR),this.drawPill(),this.context.fillStyle="#ffffff",this.context.font="bold 14.5px Supreme-Regular",this.context.textAlign="center",this.context.textBaseline="middle";const _=(this.height-p.length*this.LINE_HEIGHT)/2+this.LINE_HEIGHT/2;return p.forEach((c,M)=>{this.context.fillText(c,this.width/2,_+M*this.LINE_HEIGHT)}),this.context.setTransform(1,0,0,1,0,0),this.data=new Uint8Array(this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data),this.map.triggerRepaint(),!0}calculateLines(n){if(!this.context)return[];const o=this.width-this.PADDING*2;let h="";const p=[];for(let b of n){const _=h+(h?" ":"")+b;this.context.measureText(_).width>o&&h!==""?(p.push(h),h=b):h=_}return p.push(h),p}onAdd(){this.context=this.canvas.getContext("2d",{alpha:!0});const n=window.devicePixelRatio||1;return this.context&&this.context.scale(n,n),this.canvas}}const{min:WS,max:HS}=Math,tl=(i,n=0,o=1)=>WS(HS(n,i),o),qg=i=>{i._clipped=!1,i._unclipped=i.slice(0);for(let n=0;n<=3;n++)n<3?((i[n]<0||i[n]>255)&&(i._clipped=!0),i[n]=tl(i[n],0,255)):n===3&&(i[n]=tl(i[n],0,1));return i},B1={};for(let i of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])B1[`[object ${i}]`]=i.toLowerCase();function pi(i){return B1[Object.prototype.toString.call(i)]||"object"}const ai=(i,n=null)=>i.length>=3?Array.prototype.slice.call(i):pi(i[0])=="object"&&n?n.split("").filter(o=>i[0][o]!==void 0).map(o=>i[0][o]):i[0].slice(0),Tc=i=>{if(i.length<2)return null;const n=i.length-1;return pi(i[n])=="string"?i[n].toLowerCase():null},{PI:wf,min:O1,max:F1}=Math,pa=i=>Math.round(i*100)/100,dg=i=>Math.round(i*100)/100,gs=wf*2,dm=wf/3,qS=wf/180,GS=180/wf;function N1(i){return[...i.slice(0,3).reverse(),...i.slice(3)]}const ri={format:{},autodetect:[]};class Ye{constructor(...n){const o=this;if(pi(n[0])==="object"&&n[0].constructor&&n[0].constructor===this.constructor)return n[0];let h=Tc(n),p=!1;if(!h){p=!0,ri.sorted||(ri.autodetect=ri.autodetect.sort((b,_)=>_.p-b.p),ri.sorted=!0);for(let b of ri.autodetect)if(h=b.test(...n),h)break}if(ri.format[h]){const b=ri.format[h].apply(null,p?n:n.slice(0,-1));o._rgb=qg(b)}else throw new Error("unknown format: "+n);o._rgb.length===3&&o._rgb.push(1)}toString(){return pi(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const ZS="3.1.2",Si=(...i)=>new Ye(...i);Si.version=ZS;const bc={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},XS=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,YS=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,j1=i=>{if(i.match(XS)){(i.length===4||i.length===7)&&(i=i.substr(1)),i.length===3&&(i=i.split(""),i=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]);const n=parseInt(i,16),o=n>>16,h=n>>8&255,p=n&255;return[o,h,p,1]}if(i.match(YS)){(i.length===5||i.length===9)&&(i=i.substr(1)),i.length===4&&(i=i.split(""),i=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]+i[3]+i[3]);const n=parseInt(i,16),o=n>>24&255,h=n>>16&255,p=n>>8&255,b=Math.round((n&255)/255*100)/100;return[o,h,p,b]}throw new Error(`unknown hex color: ${i}`)},{round:Dd}=Math,V1=(...i)=>{let[n,o,h,p]=ai(i,"rgba"),b=Tc(i)||"auto";p===void 0&&(p=1),b==="auto"&&(b=p<1?"rgba":"rgb"),n=Dd(n),o=Dd(o),h=Dd(h);let c="000000"+(n<<16|o<<8|h).toString(16);c=c.substr(c.length-6);let M="0"+Dd(p*255).toString(16);switch(M=M.substr(M.length-2),b.toLowerCase()){case"rgba":return`#${c}${M}`;case"argb":return`#${M}${c}`;default:return`#${c}`}};Ye.prototype.name=function(){const i=V1(this._rgb,"rgb");for(let n of Object.keys(bc))if(bc[n]===i)return n.toLowerCase();return i};ri.format.named=i=>{if(i=i.toLowerCase(),bc[i])return j1(bc[i]);throw new Error("unknown color name: "+i)};ri.autodetect.push({p:5,test:(i,...n)=>{if(!n.length&&pi(i)==="string"&&bc[i.toLowerCase()])return"named"}});Ye.prototype.alpha=function(i,n=!1){return i!==void 0&&pi(i)==="number"?n?(this._rgb[3]=i,this):new Ye([this._rgb[0],this._rgb[1],this._rgb[2],i],"rgb"):this._rgb[3]};Ye.prototype.clipped=function(){return this._rgb._clipped||!1};const Va={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}},KS=new Map([["a",[1.0985,.35585]],["b",[1.0985,.35585]],["c",[.98074,1.18232]],["d50",[.96422,.82521]],["d55",[.95682,.92149]],["d65",[.95047,1.08883]],["e",[1,1,1]],["f2",[.99186,.67393]],["f7",[.95041,1.08747]],["f11",[1.00962,.6435]],["icc",[.96422,.82521]]]);function _s(i){const n=KS.get(String(i).toLowerCase());if(!n)throw new Error("unknown Lab illuminant "+i);Va.labWhitePoint=i,Va.Xn=n[0],Va.Zn=n[1]}function ah(){return Va.labWhitePoint}const Gg=(...i)=>{i=ai(i,"lab");const[n,o,h]=i,[p,b,_]=JS(n,o,h),[c,M,B]=$1(p,b,_);return[c,M,B,i.length>3?i[3]:1]},JS=(i,n,o)=>{const{kE:h,kK:p,kKE:b,Xn:_,Yn:c,Zn:M}=Va,B=(i+16)/116,O=.002*n+B,R=B-.005*o,C=O*O*O,Y=R*R*R,X=C>h?C:(116*O-16)/p,Z=i>b?Math.pow((i+16)/116,3):i/p,se=Y>h?Y:(116*R-16)/p,q=X*_,te=Z*c,ne=se*M;return[q,te,ne]},fm=i=>{const n=Math.sign(i);return i=Math.abs(i),(i<=.0031308?i*12.92:1.055*Math.pow(i,1/2.4)-.055)*n},$1=(i,n,o)=>{const{MtxAdaptMa:h,MtxAdaptMaI:p,MtxXYZ2RGB:b,RefWhiteRGB:_,Xn:c,Yn:M,Zn:B}=Va,O=c*h.m00+M*h.m10+B*h.m20,R=c*h.m01+M*h.m11+B*h.m21,C=c*h.m02+M*h.m12+B*h.m22,Y=_.X*h.m00+_.Y*h.m10+_.Z*h.m20,X=_.X*h.m01+_.Y*h.m11+_.Z*h.m21,Z=_.X*h.m02+_.Y*h.m12+_.Z*h.m22,se=(i*h.m00+n*h.m10+o*h.m20)*(Y/O),q=(i*h.m01+n*h.m11+o*h.m21)*(X/R),te=(i*h.m02+n*h.m12+o*h.m22)*(Z/C),ne=se*p.m00+q*p.m10+te*p.m20,_e=se*p.m01+q*p.m11+te*p.m21,be=se*p.m02+q*p.m12+te*p.m22,Ae=fm(ne*b.m00+_e*b.m10+be*b.m20),de=fm(ne*b.m01+_e*b.m11+be*b.m21),Be=fm(ne*b.m02+_e*b.m12+be*b.m22);return[Ae*255,de*255,Be*255]},Zg=(...i)=>{const[n,o,h,...p]=ai(i,"rgb"),[b,_,c]=U1(n,o,h),[M,B,O]=QS(b,_,c);return[M,B,O,...p.length>0&&p[0]<1?[p[0]]:[]]};function QS(i,n,o){const{Xn:h,Yn:p,Zn:b,kE:_,kK:c}=Va,M=i/h,B=n/p,O=o/b,R=M>_?Math.pow(M,1/3):(c*M+16)/116,C=B>_?Math.pow(B,1/3):(c*B+16)/116,Y=O>_?Math.pow(O,1/3):(c*O+16)/116;return[116*C-16,500*(R-C),200*(C-Y)]}function pm(i){const n=Math.sign(i);return i=Math.abs(i),(i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4))*n}const U1=(i,n,o)=>{i=pm(i/255),n=pm(n/255),o=pm(o/255);const{MtxRGB2XYZ:h,MtxAdaptMa:p,MtxAdaptMaI:b,Xn:_,Yn:c,Zn:M,As:B,Bs:O,Cs:R}=Va;let C=i*h.m00+n*h.m10+o*h.m20,Y=i*h.m01+n*h.m11+o*h.m21,X=i*h.m02+n*h.m12+o*h.m22;const Z=_*p.m00+c*p.m10+M*p.m20,se=_*p.m01+c*p.m11+M*p.m21,q=_*p.m02+c*p.m12+M*p.m22;let te=C*p.m00+Y*p.m10+X*p.m20,ne=C*p.m01+Y*p.m11+X*p.m21,_e=C*p.m02+Y*p.m12+X*p.m22;return te*=Z/B,ne*=se/O,_e*=q/R,C=te*b.m00+ne*b.m10+_e*b.m20,Y=te*b.m01+ne*b.m11+_e*b.m21,X=te*b.m02+ne*b.m12+_e*b.m22,[C,Y,X]};Ye.prototype.lab=function(){return Zg(this._rgb)};const e5=(...i)=>new Ye(...i,"lab");Object.assign(Si,{lab:e5,getLabWhitePoint:ah,setLabWhitePoint:_s});ri.format.lab=Gg;ri.autodetect.push({p:2,test:(...i)=>{if(i=ai(i,"lab"),pi(i)==="array"&&i.length===3)return"lab"}});Ye.prototype.darken=function(i=1){const n=this,o=n.lab();return o[0]-=Va.Kn*i,new Ye(o,"lab").alpha(n.alpha(),!0)};Ye.prototype.brighten=function(i=1){return this.darken(-i)};Ye.prototype.darker=Ye.prototype.darken;Ye.prototype.brighter=Ye.prototype.brighten;Ye.prototype.get=function(i){const[n,o]=i.split("."),h=this[n]();if(o){const p=n.indexOf(o)-(n.substr(0,2)==="ok"?2:0);if(p>-1)return h[p];throw new Error(`unknown channel ${o} in mode ${n}`)}else return h};const{pow:t5}=Math,i5=1e-7,n5=20;Ye.prototype.luminance=function(i,n="rgb"){if(i!==void 0&&pi(i)==="number"){if(i===0)return new Ye([0,0,0,this._rgb[3]],"rgb");if(i===1)return new Ye([255,255,255,this._rgb[3]],"rgb");let o=this.luminance(),h=n5;const p=(_,c)=>{const M=_.interpolate(c,.5,n),B=M.luminance();return Math.abs(i-B)<i5||!h--?M:B>i?p(_,M):p(M,c)},b=(o>i?p(new Ye([0,0,0]),this):p(this,new Ye([255,255,255]))).rgb();return new Ye([...b,this._rgb[3]])}return r5(...this._rgb.slice(0,3))};const r5=(i,n,o)=>(i=mm(i),n=mm(n),o=mm(o),.2126*i+.7152*n+.0722*o),mm=i=>(i/=255,i<=.03928?i/12.92:t5((i+.055)/1.055,2.4)),kr={},xc=(i,n,o=.5,...h)=>{let p=h[0]||"lrgb";if(!kr[p]&&!h.length&&(p=Object.keys(kr)[0]),!kr[p])throw new Error(`interpolation mode ${p} is not defined`);return pi(i)!=="object"&&(i=new Ye(i)),pi(n)!=="object"&&(n=new Ye(n)),kr[p](i,n,o).alpha(i.alpha()+o*(n.alpha()-i.alpha()))};Ye.prototype.mix=Ye.prototype.interpolate=function(i,n=.5,...o){return xc(this,i,n,...o)};Ye.prototype.premultiply=function(i=!1){const n=this._rgb,o=n[3];return i?(this._rgb=[n[0]*o,n[1]*o,n[2]*o,o],this):new Ye([n[0]*o,n[1]*o,n[2]*o,o],"rgb")};const{sin:a5,cos:s5}=Math,W1=(...i)=>{let[n,o,h]=ai(i,"lch");return isNaN(h)&&(h=0),h=h*qS,[n,s5(h)*o,a5(h)*o]},Xg=(...i)=>{i=ai(i,"lch");const[n,o,h]=i,[p,b,_]=W1(n,o,h),[c,M,B]=Gg(p,b,_);return[c,M,B,i.length>3?i[3]:1]},o5=(...i)=>{const n=N1(ai(i,"hcl"));return Xg(...n)},{sqrt:l5,atan2:c5,round:u5}=Math,H1=(...i)=>{const[n,o,h]=ai(i,"lab"),p=l5(o*o+h*h);let b=(c5(h,o)*GS+360)%360;return u5(p*1e4)===0&&(b=Number.NaN),[n,p,b]},Yg=(...i)=>{const[n,o,h,...p]=ai(i,"rgb"),[b,_,c]=Zg(n,o,h),[M,B,O]=H1(b,_,c);return[M,B,O,...p.length>0&&p[0]<1?[p[0]]:[]]};Ye.prototype.lch=function(){return Yg(this._rgb)};Ye.prototype.hcl=function(){return N1(Yg(this._rgb))};const h5=(...i)=>new Ye(...i,"lch"),d5=(...i)=>new Ye(...i,"hcl");Object.assign(Si,{lch:h5,hcl:d5});ri.format.lch=Xg;ri.format.hcl=o5;["lch","hcl"].forEach(i=>ri.autodetect.push({p:2,test:(...n)=>{if(n=ai(n,i),pi(n)==="array"&&n.length===3)return i}}));Ye.prototype.saturate=function(i=1){const n=this,o=n.lch();return o[1]+=Va.Kn*i,o[1]<0&&(o[1]=0),new Ye(o,"lch").alpha(n.alpha(),!0)};Ye.prototype.desaturate=function(i=1){return this.saturate(-i)};Ye.prototype.set=function(i,n,o=!1){const[h,p]=i.split("."),b=this[h]();if(p){const _=h.indexOf(p)-(h.substr(0,2)==="ok"?2:0);if(_>-1){if(pi(n)=="string")switch(n.charAt(0)){case"+":b[_]+=+n;break;case"-":b[_]+=+n;break;case"*":b[_]*=+n.substr(1);break;case"/":b[_]/=+n.substr(1);break;default:b[_]=+n}else if(pi(n)==="number")b[_]=n;else throw new Error("unsupported value for Color.set");const c=new Ye(b,h);return o?(this._rgb=c._rgb,this):c}throw new Error(`unknown channel ${p} in mode ${h}`)}else return b};Ye.prototype.tint=function(i=.5,...n){return xc(this,"white",i,...n)};Ye.prototype.shade=function(i=.5,...n){return xc(this,"black",i,...n)};const f5=(i,n,o)=>{const h=i._rgb,p=n._rgb;return new Ye(h[0]+o*(p[0]-h[0]),h[1]+o*(p[1]-h[1]),h[2]+o*(p[2]-h[2]),"rgb")};kr.rgb=f5;const{sqrt:gm,pow:nc}=Math,p5=(i,n,o)=>{const[h,p,b]=i._rgb,[_,c,M]=n._rgb;return new Ye(gm(nc(h,2)*(1-o)+nc(_,2)*o),gm(nc(p,2)*(1-o)+nc(c,2)*o),gm(nc(b,2)*(1-o)+nc(M,2)*o),"rgb")};kr.lrgb=p5;const m5=(i,n,o)=>{const h=i.lab(),p=n.lab();return new Ye(h[0]+o*(p[0]-h[0]),h[1]+o*(p[1]-h[1]),h[2]+o*(p[2]-h[2]),"lab")};kr.lab=m5;const Sc=(i,n,o,h)=>{let p,b;h==="hsl"?(p=i.hsl(),b=n.hsl()):h==="hsv"?(p=i.hsv(),b=n.hsv()):h==="hcg"?(p=i.hcg(),b=n.hcg()):h==="hsi"?(p=i.hsi(),b=n.hsi()):h==="lch"||h==="hcl"?(h="hcl",p=i.hcl(),b=n.hcl()):h==="oklch"&&(p=i.oklch().reverse(),b=n.oklch().reverse());let _,c,M,B,O,R;(h.substr(0,1)==="h"||h==="oklch")&&([_,M,O]=p,[c,B,R]=b);let C,Y,X,Z;return!isNaN(_)&&!isNaN(c)?(c>_&&c-_>180?Z=c-(_+360):c<_&&_-c>180?Z=c+360-_:Z=c-_,Y=_+o*Z):isNaN(_)?isNaN(c)?Y=Number.NaN:(Y=c,(O==1||O==0)&&h!="hsv"&&(C=B)):(Y=_,(R==1||R==0)&&h!="hsv"&&(C=M)),C===void 0&&(C=M+o*(B-M)),X=O+o*(R-O),h==="oklch"?new Ye([X,C,Y],h):new Ye([Y,C,X],h)},q1=(i,n,o)=>Sc(i,n,o,"lch");kr.lch=q1;kr.hcl=q1;const g5=i=>{if(pi(i)=="number"&&i>=0&&i<=16777215){const n=i>>16,o=i>>8&255,h=i&255;return[n,o,h,1]}throw new Error("unknown num color: "+i)},y5=(...i)=>{const[n,o,h]=ai(i,"rgb");return(n<<16)+(o<<8)+h};Ye.prototype.num=function(){return y5(this._rgb)};const _5=(...i)=>new Ye(...i,"num");Object.assign(Si,{num:_5});ri.format.num=g5;ri.autodetect.push({p:5,test:(...i)=>{if(i.length===1&&pi(i[0])==="number"&&i[0]>=0&&i[0]<=16777215)return"num"}});const v5=(i,n,o)=>{const h=i.num(),p=n.num();return new Ye(h+o*(p-h),"num")};kr.num=v5;const{floor:b5}=Math,x5=(...i)=>{i=ai(i,"hcg");let[n,o,h]=i,p,b,_;h=h*255;const c=o*255;if(o===0)p=b=_=h;else{n===360&&(n=0),n>360&&(n-=360),n<0&&(n+=360),n/=60;const M=b5(n),B=n-M,O=h*(1-o),R=O+c*(1-B),C=O+c*B,Y=O+c;switch(M){case 0:[p,b,_]=[Y,C,O];break;case 1:[p,b,_]=[R,Y,O];break;case 2:[p,b,_]=[O,Y,C];break;case 3:[p,b,_]=[O,R,Y];break;case 4:[p,b,_]=[C,O,Y];break;case 5:[p,b,_]=[Y,O,R];break}}return[p,b,_,i.length>3?i[3]:1]},w5=(...i)=>{const[n,o,h]=ai(i,"rgb"),p=O1(n,o,h),b=F1(n,o,h),_=b-p,c=_*100/255,M=p/(255-_)*100;let B;return _===0?B=Number.NaN:(n===b&&(B=(o-h)/_),o===b&&(B=2+(h-n)/_),h===b&&(B=4+(n-o)/_),B*=60,B<0&&(B+=360)),[B,c,M]};Ye.prototype.hcg=function(){return w5(this._rgb)};const T5=(...i)=>new Ye(...i,"hcg");Si.hcg=T5;ri.format.hcg=x5;ri.autodetect.push({p:1,test:(...i)=>{if(i=ai(i,"hcg"),pi(i)==="array"&&i.length===3)return"hcg"}});const S5=(i,n,o)=>Sc(i,n,o,"hcg");kr.hcg=S5;const{cos:rc}=Math,k5=(...i)=>{i=ai(i,"hsi");let[n,o,h]=i,p,b,_;return isNaN(n)&&(n=0),isNaN(o)&&(o=0),n>360&&(n-=360),n<0&&(n+=360),n/=360,n<1/3?(_=(1-o)/3,p=(1+o*rc(gs*n)/rc(dm-gs*n))/3,b=1-(_+p)):n<2/3?(n-=1/3,p=(1-o)/3,b=(1+o*rc(gs*n)/rc(dm-gs*n))/3,_=1-(p+b)):(n-=2/3,b=(1-o)/3,_=(1+o*rc(gs*n)/rc(dm-gs*n))/3,p=1-(b+_)),p=tl(h*p*3),b=tl(h*b*3),_=tl(h*_*3),[p*255,b*255,_*255,i.length>3?i[3]:1]},{min:A5,sqrt:M5,acos:I5}=Math,E5=(...i)=>{let[n,o,h]=ai(i,"rgb");n/=255,o/=255,h/=255;let p;const b=A5(n,o,h),_=(n+o+h)/3,c=_>0?1-b/_:0;return c===0?p=NaN:(p=(n-o+(n-h))/2,p/=M5((n-o)*(n-o)+(n-h)*(o-h)),p=I5(p),h>o&&(p=gs-p),p/=gs),[p*360,c,_]};Ye.prototype.hsi=function(){return E5(this._rgb)};const C5=(...i)=>new Ye(...i,"hsi");Si.hsi=C5;ri.format.hsi=k5;ri.autodetect.push({p:2,test:(...i)=>{if(i=ai(i,"hsi"),pi(i)==="array"&&i.length===3)return"hsi"}});const P5=(i,n,o)=>Sc(i,n,o,"hsi");kr.hsi=P5;const fg=(...i)=>{i=ai(i,"hsl");const[n,o,h]=i;let p,b,_;if(o===0)p=b=_=h*255;else{const c=[0,0,0],M=[0,0,0],B=h<.5?h*(1+o):h+o-h*o,O=2*h-B,R=n/360;c[0]=R+1/3,c[1]=R,c[2]=R-1/3;for(let C=0;C<3;C++)c[C]<0&&(c[C]+=1),c[C]>1&&(c[C]-=1),6*c[C]<1?M[C]=O+(B-O)*6*c[C]:2*c[C]<1?M[C]=B:3*c[C]<2?M[C]=O+(B-O)*(2/3-c[C])*6:M[C]=O;[p,b,_]=[M[0]*255,M[1]*255,M[2]*255]}return i.length>3?[p,b,_,i[3]]:[p,b,_,1]},G1=(...i)=>{i=ai(i,"rgba");let[n,o,h]=i;n/=255,o/=255,h/=255;const p=O1(n,o,h),b=F1(n,o,h),_=(b+p)/2;let c,M;return b===p?(c=0,M=Number.NaN):c=_<.5?(b-p)/(b+p):(b-p)/(2-b-p),n==b?M=(o-h)/(b-p):o==b?M=2+(h-n)/(b-p):h==b&&(M=4+(n-o)/(b-p)),M*=60,M<0&&(M+=360),i.length>3&&i[3]!==void 0?[M,c,_,i[3]]:[M,c,_]};Ye.prototype.hsl=function(){return G1(this._rgb)};const z5=(...i)=>new Ye(...i,"hsl");Si.hsl=z5;ri.format.hsl=fg;ri.autodetect.push({p:2,test:(...i)=>{if(i=ai(i,"hsl"),pi(i)==="array"&&i.length===3)return"hsl"}});const D5=(i,n,o)=>Sc(i,n,o,"hsl");kr.hsl=D5;const{floor:L5}=Math,R5=(...i)=>{i=ai(i,"hsv");let[n,o,h]=i,p,b,_;if(h*=255,o===0)p=b=_=h;else{n===360&&(n=0),n>360&&(n-=360),n<0&&(n+=360),n/=60;const c=L5(n),M=n-c,B=h*(1-o),O=h*(1-o*M),R=h*(1-o*(1-M));switch(c){case 0:[p,b,_]=[h,R,B];break;case 1:[p,b,_]=[O,h,B];break;case 2:[p,b,_]=[B,h,R];break;case 3:[p,b,_]=[B,O,h];break;case 4:[p,b,_]=[R,B,h];break;case 5:[p,b,_]=[h,B,O];break}}return[p,b,_,i.length>3?i[3]:1]},{min:B5,max:O5}=Math,F5=(...i)=>{i=ai(i,"rgb");let[n,o,h]=i;const p=B5(n,o,h),b=O5(n,o,h),_=b-p;let c,M,B;return B=b/255,b===0?(c=Number.NaN,M=0):(M=_/b,n===b&&(c=(o-h)/_),o===b&&(c=2+(h-n)/_),h===b&&(c=4+(n-o)/_),c*=60,c<0&&(c+=360)),[c,M,B]};Ye.prototype.hsv=function(){return F5(this._rgb)};const N5=(...i)=>new Ye(...i,"hsv");Si.hsv=N5;ri.format.hsv=R5;ri.autodetect.push({p:2,test:(...i)=>{if(i=ai(i,"hsv"),pi(i)==="array"&&i.length===3)return"hsv"}});const j5=(i,n,o)=>Sc(i,n,o,"hsv");kr.hsv=j5;function Xd(i,n){let o=i.length;Array.isArray(i[0])||(i=[i]),Array.isArray(n[0])||(n=n.map(_=>[_]));let h=n[0].length,p=n[0].map((_,c)=>n.map(M=>M[c])),b=i.map(_=>p.map(c=>Array.isArray(_)?_.reduce((M,B,O)=>M+B*(c[O]||0),0):c.reduce((M,B)=>M+B*_,0)));return o===1&&(b=b[0]),h===1?b.map(_=>_[0]):b}const Kg=(...i)=>{i=ai(i,"lab");const[n,o,h,...p]=i,[b,_,c]=V5([n,o,h]),[M,B,O]=$1(b,_,c);return[M,B,O,...p.length>0&&p[0]<1?[p[0]]:[]]};function V5(i){var n=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],o=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],h=Xd(o,i);return Xd(n,h.map(p=>p**3))}const Jg=(...i)=>{const[n,o,h,...p]=ai(i,"rgb"),b=U1(n,o,h);return[...$5(b),...p.length>0&&p[0]<1?[p[0]]:[]]};function $5(i){const n=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],o=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],h=Xd(n,i);return Xd(o,h.map(p=>Math.cbrt(p)))}Ye.prototype.oklab=function(){return Jg(this._rgb)};const U5=(...i)=>new Ye(...i,"oklab");Object.assign(Si,{oklab:U5});ri.format.oklab=Kg;ri.autodetect.push({p:2,test:(...i)=>{if(i=ai(i,"oklab"),pi(i)==="array"&&i.length===3)return"oklab"}});const W5=(i,n,o)=>{const h=i.oklab(),p=n.oklab();return new Ye(h[0]+o*(p[0]-h[0]),h[1]+o*(p[1]-h[1]),h[2]+o*(p[2]-h[2]),"oklab")};kr.oklab=W5;const H5=(i,n,o)=>Sc(i,n,o,"oklch");kr.oklch=H5;const{pow:ym,sqrt:_m,PI:vm,cos:y_,sin:__,atan2:q5}=Math,G5=(i,n="lrgb",o=null)=>{const h=i.length;o||(o=Array.from(new Array(h)).map(()=>1));const p=h/o.reduce(function(R,C){return R+C});if(o.forEach((R,C)=>{o[C]*=p}),i=i.map(R=>new Ye(R)),n==="lrgb")return Z5(i,o);const b=i.shift(),_=b.get(n),c=[];let M=0,B=0;for(let R=0;R<_.length;R++)if(_[R]=(_[R]||0)*o[0],c.push(isNaN(_[R])?0:o[0]),n.charAt(R)==="h"&&!isNaN(_[R])){const C=_[R]/180*vm;M+=y_(C)*o[0],B+=__(C)*o[0]}let O=b.alpha()*o[0];i.forEach((R,C)=>{const Y=R.get(n);O+=R.alpha()*o[C+1];for(let X=0;X<_.length;X++)if(!isNaN(Y[X]))if(c[X]+=o[C+1],n.charAt(X)==="h"){const Z=Y[X]/180*vm;M+=y_(Z)*o[C+1],B+=__(Z)*o[C+1]}else _[X]+=Y[X]*o[C+1]});for(let R=0;R<_.length;R++)if(n.charAt(R)==="h"){let C=q5(B/c[R],M/c[R])/vm*180;for(;C<0;)C+=360;for(;C>=360;)C-=360;_[R]=C}else _[R]=_[R]/c[R];return O/=h,new Ye(_,n).alpha(O>.99999?1:O,!0)},Z5=(i,n)=>{const o=i.length,h=[0,0,0,0];for(let p=0;p<i.length;p++){const b=i[p],_=n[p]/o,c=b._rgb;h[0]+=ym(c[0],2)*_,h[1]+=ym(c[1],2)*_,h[2]+=ym(c[2],2)*_,h[3]+=c[3]*_}return h[0]=_m(h[0]),h[1]=_m(h[1]),h[2]=_m(h[2]),h[3]>.9999999&&(h[3]=1),new Ye(qg(h))},{pow:X5}=Math;function Yd(i){let n="rgb",o=Si("#ccc"),h=0,p=[0,1],b=[],_=[0,0],c=!1,M=[],B=!1,O=0,R=1,C=!1,Y={},X=!0,Z=1;const se=function(de){if(de=de||["#fff","#000"],de&&pi(de)==="string"&&Si.brewer&&Si.brewer[de.toLowerCase()]&&(de=Si.brewer[de.toLowerCase()]),pi(de)==="array"){de.length===1&&(de=[de[0],de[0]]),de=de.slice(0);for(let Be=0;Be<de.length;Be++)de[Be]=Si(de[Be]);b.length=0;for(let Be=0;Be<de.length;Be++)b.push(Be/(de.length-1))}return be(),M=de},q=function(de){if(c!=null){const Be=c.length-1;let Fe=0;for(;Fe<Be&&de>=c[Fe];)Fe++;return Fe-1}return 0};let te=de=>de,ne=de=>de;const _e=function(de,Be){let Fe,Le;if(Be==null&&(Be=!1),isNaN(de)||de===null)return o;Be?Le=de:c&&c.length>2?Le=q(de)/(c.length-2):R!==O?Le=(de-O)/(R-O):Le=1,Le=ne(Le),Be||(Le=te(Le)),Z!==1&&(Le=X5(Le,Z)),Le=_[0]+Le*(1-_[0]-_[1]),Le=tl(Le,0,1);const we=Math.floor(Le*1e4);if(X&&Y[we])Fe=Y[we];else{if(pi(M)==="array")for(let Te=0;Te<b.length;Te++){const fe=b[Te];if(Le<=fe){Fe=M[Te];break}if(Le>=fe&&Te===b.length-1){Fe=M[Te];break}if(Le>fe&&Le<b[Te+1]){Le=(Le-fe)/(b[Te+1]-fe),Fe=Si.interpolate(M[Te],M[Te+1],Le,n);break}}else pi(M)==="function"&&(Fe=M(Le));X&&(Y[we]=Fe)}return Fe};var be=()=>Y={};se(i);const Ae=function(de){const Be=Si(_e(de));return B&&Be[B]?Be[B]():Be};return Ae.classes=function(de){if(de!=null){if(pi(de)==="array")c=de,p=[de[0],de[de.length-1]];else{const Be=Si.analyze(p);de===0?c=[Be.min,Be.max]:c=Si.limits(Be,"e",de)}return Ae}return c},Ae.domain=function(de){if(!arguments.length)return p;O=de[0],R=de[de.length-1],b=[];const Be=M.length;if(de.length===Be&&O!==R)for(let Fe of Array.from(de))b.push((Fe-O)/(R-O));else{for(let Fe=0;Fe<Be;Fe++)b.push(Fe/(Be-1));if(de.length>2){const Fe=de.map((we,Te)=>Te/(de.length-1)),Le=de.map(we=>(we-O)/(R-O));Le.every((we,Te)=>Fe[Te]===we)||(ne=we=>{if(we<=0||we>=1)return we;let Te=0;for(;we>=Le[Te+1];)Te++;const fe=(we-Le[Te])/(Le[Te+1]-Le[Te]);return Fe[Te]+fe*(Fe[Te+1]-Fe[Te])})}}return p=[O,R],Ae},Ae.mode=function(de){return arguments.length?(n=de,be(),Ae):n},Ae.range=function(de,Be){return se(de),Ae},Ae.out=function(de){return B=de,Ae},Ae.spread=function(de){return arguments.length?(h=de,Ae):h},Ae.correctLightness=function(de){return de==null&&(de=!0),C=de,be(),C?te=function(Be){const Fe=_e(0,!0).lab()[0],Le=_e(1,!0).lab()[0],we=Fe>Le;let Te=_e(Be,!0).lab()[0];const fe=Fe+(Le-Fe)*Be;let Me=Te-fe,Ee=0,$e=1,He=20;for(;Math.abs(Me)>.01&&He-- >0;)(function(){return we&&(Me*=-1),Me<0?(Ee=Be,Be+=($e-Be)*.5):($e=Be,Be+=(Ee-Be)*.5),Te=_e(Be,!0).lab()[0],Me=Te-fe})();return Be}:te=Be=>Be,Ae},Ae.padding=function(de){return de!=null?(pi(de)==="number"&&(de=[de,de]),_=de,Ae):_},Ae.colors=function(de,Be){arguments.length<2&&(Be="hex");let Fe=[];if(arguments.length===0)Fe=M.slice(0);else if(de===1)Fe=[Ae(.5)];else if(de>1){const Le=p[0],we=p[1]-Le;Fe=Y5(0,de).map(Te=>Ae(Le+Te/(de-1)*we))}else{i=[];let Le=[];if(c&&c.length>2)for(let we=1,Te=c.length,fe=1<=Te;fe?we<Te:we>Te;fe?we++:we--)Le.push((c[we-1]+c[we])*.5);else Le=p;Fe=Le.map(we=>Ae(we))}return Si[Be]&&(Fe=Fe.map(Le=>Le[Be]())),Fe},Ae.cache=function(de){return de!=null?(X=de,Ae):X},Ae.gamma=function(de){return de!=null?(Z=de,Ae):Z},Ae.nodata=function(de){return de!=null?(o=Si(de),Ae):o},Ae}function Y5(i,n,o){let h=[],p=i<n,b=n;for(let _=i;p?_<b:_>b;p?_++:_--)h.push(_);return h}const K5=function(i){let n=[1,1];for(let o=1;o<i;o++){let h=[1];for(let p=1;p<=n.length;p++)h[p]=(n[p]||0)+n[p-1];n=h}return n},J5=function(i){let n,o,h,p;if(i=i.map(b=>new Ye(b)),i.length===2)[o,h]=i.map(b=>b.lab()),n=function(b){const _=[0,1,2].map(c=>o[c]+b*(h[c]-o[c]));return new Ye(_,"lab")};else if(i.length===3)[o,h,p]=i.map(b=>b.lab()),n=function(b){const _=[0,1,2].map(c=>(1-b)*(1-b)*o[c]+2*(1-b)*b*h[c]+b*b*p[c]);return new Ye(_,"lab")};else if(i.length===4){let b;[o,h,p,b]=i.map(_=>_.lab()),n=function(_){const c=[0,1,2].map(M=>(1-_)*(1-_)*(1-_)*o[M]+3*(1-_)*(1-_)*_*h[M]+3*(1-_)*_*_*p[M]+_*_*_*b[M]);return new Ye(c,"lab")}}else if(i.length>=5){let b,_,c;b=i.map(M=>M.lab()),c=i.length-1,_=K5(c),n=function(M){const B=1-M,O=[0,1,2].map(R=>b.reduce((C,Y,X)=>C+_[X]*B**(c-X)*M**X*Y[R],0));return new Ye(O,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return n},Q5=i=>{const n=J5(i);return n.scale=()=>Yd(n),n},{round:Z1}=Math;Ye.prototype.rgb=function(i=!0){return i===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Z1)};Ye.prototype.rgba=function(i=!0){return this._rgb.slice(0,4).map((n,o)=>o<3?i===!1?n:Z1(n):n)};const ek=(...i)=>new Ye(...i,"rgb");Object.assign(Si,{rgb:ek});ri.format.rgb=(...i)=>{const n=ai(i,"rgba");return n[3]===void 0&&(n[3]=1),n};ri.autodetect.push({p:3,test:(...i)=>{if(i=ai(i,"rgba"),pi(i)==="array"&&(i.length===3||i.length===4&&pi(i[3])=="number"&&i[3]>=0&&i[3]<=1))return"rgb"}});const Aa=(i,n,o)=>{if(!Aa[o])throw new Error("unknown blend mode "+o);return Aa[o](i,n)},ho=i=>(n,o)=>{const h=Si(o).rgb(),p=Si(n).rgb();return Si.rgb(i(h,p))},fo=i=>(n,o)=>{const h=[];return h[0]=i(n[0],o[0]),h[1]=i(n[1],o[1]),h[2]=i(n[2],o[2]),h},tk=i=>i,ik=(i,n)=>i*n/255,nk=(i,n)=>i>n?n:i,rk=(i,n)=>i>n?i:n,ak=(i,n)=>255*(1-(1-i/255)*(1-n/255)),sk=(i,n)=>n<128?2*i*n/255:255*(1-2*(1-i/255)*(1-n/255)),ok=(i,n)=>255*(1-(1-n/255)/(i/255)),lk=(i,n)=>i===255?255:(i=255*(n/255)/(1-i/255),i>255?255:i);Aa.normal=ho(fo(tk));Aa.multiply=ho(fo(ik));Aa.screen=ho(fo(ak));Aa.overlay=ho(fo(sk));Aa.darken=ho(fo(nk));Aa.lighten=ho(fo(rk));Aa.dodge=ho(fo(lk));Aa.burn=ho(fo(ok));const{pow:ck,sin:uk,cos:hk}=Math;function dk(i=300,n=-1.5,o=1,h=1,p=[0,1]){let b=0,_;pi(p)==="array"?_=p[1]-p[0]:(_=0,p=[p,p]);const c=function(M){const B=gs*((i+120)/360+n*M),O=ck(p[0]+_*M,h),C=(b!==0?o[0]+M*b:o)*O*(1-O)/2,Y=hk(B),X=uk(B),Z=O+C*(-.14861*Y+1.78277*X),se=O+C*(-.29227*Y-.90649*X),q=O+C*(1.97294*Y);return Si(qg([Z*255,se*255,q*255,1]))};return c.start=function(M){return M==null?i:(i=M,c)},c.rotations=function(M){return M==null?n:(n=M,c)},c.gamma=function(M){return M==null?h:(h=M,c)},c.hue=function(M){return M==null?o:(o=M,pi(o)==="array"?(b=o[1]-o[0],b===0&&(o=o[1])):b=0,c)},c.lightness=function(M){return M==null?p:(pi(M)==="array"?(p=M,_=M[1]-M[0]):(p=[M,M],_=0),c)},c.scale=()=>Si.scale(c),c.hue(o),c}const fk="0123456789abcdef",{floor:pk,random:mk}=Math,gk=()=>{let i="#";for(let n=0;n<6;n++)i+=fk.charAt(pk(mk()*16));return new Ye(i,"hex")},{log:v_,pow:yk,floor:_k,abs:vk}=Math;function X1(i,n=null){const o={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return pi(i)==="object"&&(i=Object.values(i)),i.forEach(h=>{n&&pi(h)==="object"&&(h=h[n]),h!=null&&!isNaN(h)&&(o.values.push(h),o.sum+=h,h<o.min&&(o.min=h),h>o.max&&(o.max=h),o.count+=1)}),o.domain=[o.min,o.max],o.limits=(h,p)=>Y1(o,h,p),o}function Y1(i,n="equal",o=7){pi(i)=="array"&&(i=X1(i));const{min:h,max:p}=i,b=i.values.sort((c,M)=>c-M);if(o===1)return[h,p];const _=[];if(n.substr(0,1)==="c"&&(_.push(h),_.push(p)),n.substr(0,1)==="e"){_.push(h);for(let c=1;c<o;c++)_.push(h+c/o*(p-h));_.push(p)}else if(n.substr(0,1)==="l"){if(h<=0)throw new Error("Logarithmic scales are only possible for values > 0");const c=Math.LOG10E*v_(h),M=Math.LOG10E*v_(p);_.push(h);for(let B=1;B<o;B++)_.push(yk(10,c+B/o*(M-c)));_.push(p)}else if(n.substr(0,1)==="q"){_.push(h);for(let c=1;c<o;c++){const M=(b.length-1)*c/o,B=_k(M);if(B===M)_.push(b[B]);else{const O=M-B;_.push(b[B]*(1-O)+b[B+1]*O)}}_.push(p)}else if(n.substr(0,1)==="k"){let c;const M=b.length,B=new Array(M),O=new Array(o);let R=!0,C=0,Y=null;Y=[],Y.push(h);for(let se=1;se<o;se++)Y.push(h+se/o*(p-h));for(Y.push(p);R;){for(let q=0;q<o;q++)O[q]=0;for(let q=0;q<M;q++){const te=b[q];let ne=Number.MAX_VALUE,_e;for(let be=0;be<o;be++){const Ae=vk(Y[be]-te);Ae<ne&&(ne=Ae,_e=be),O[_e]++,B[q]=_e}}const se=new Array(o);for(let q=0;q<o;q++)se[q]=null;for(let q=0;q<M;q++)c=B[q],se[c]===null?se[c]=b[q]:se[c]+=b[q];for(let q=0;q<o;q++)se[q]*=1/O[q];R=!1;for(let q=0;q<o;q++)if(se[q]!==Y[q]){R=!0;break}Y=se,C++,C>200&&(R=!1)}const X={};for(let se=0;se<o;se++)X[se]=[];for(let se=0;se<M;se++)c=B[se],X[c].push(b[se]);let Z=[];for(let se=0;se<o;se++)Z.push(X[se][0]),Z.push(X[se][X[se].length-1]);Z=Z.sort((se,q)=>se-q),_.push(Z[0]);for(let se=1;se<Z.length;se+=2){const q=Z[se];!isNaN(q)&&_.indexOf(q)===-1&&_.push(q)}}return _}const bk=(i,n)=>{i=new Ye(i),n=new Ye(n);const o=i.luminance(),h=n.luminance();return o>h?(o+.05)/(h+.05):(h+.05)/(o+.05)};/**
 * @license
 *
 * The APCA contrast prediction algorithm is based of the formulas published
 * in the APCA-1.0.98G specification by Myndex. The specification is available at:
 * https://raw.githubusercontent.com/Myndex/apca-w3/master/images/APCAw3_0.1.17_APCA0.0.98G.svg
 *
 * Note that the APCA implementation is still beta, so please update to
 * future versions of chroma.js when they become available.
 *
 * You can read more about the APCA Readability Criterion at
 * https://readtech.org/ARC/
 */const b_=.027,xk=5e-4,wk=.1,x_=1.14,Ld=.022,w_=1.414,Tk=(i,n)=>{i=new Ye(i),n=new Ye(n),i.alpha()<1&&(i=xc(n,i,i.alpha(),"rgb"));const o=T_(...i.rgb()),h=T_(...n.rgb()),p=o>=Ld?o:o+Math.pow(Ld-o,w_),b=h>=Ld?h:h+Math.pow(Ld-h,w_),_=Math.pow(b,.56)-Math.pow(p,.57),c=Math.pow(b,.65)-Math.pow(p,.62),M=Math.abs(b-p)<xk?0:p<b?_*x_:c*x_;return(Math.abs(M)<wk?0:M>0?M-b_:M+b_)*100};function T_(i,n,o){return .2126729*Math.pow(i/255,2.4)+.7151522*Math.pow(n/255,2.4)+.072175*Math.pow(o/255,2.4)}const{sqrt:fs,pow:Ln,min:Sk,max:kk,atan2:S_,abs:k_,cos:Rd,sin:A_,exp:Ak,PI:M_}=Math;function Mk(i,n,o=1,h=1,p=1){var b=function(Rt){return 360*Rt/(2*M_)},_=function(Rt){return 2*M_*Rt/360};i=new Ye(i),n=new Ye(n);const[c,M,B]=Array.from(i.lab()),[O,R,C]=Array.from(n.lab()),Y=(c+O)/2,X=fs(Ln(M,2)+Ln(B,2)),Z=fs(Ln(R,2)+Ln(C,2)),se=(X+Z)/2,q=.5*(1-fs(Ln(se,7)/(Ln(se,7)+Ln(25,7)))),te=M*(1+q),ne=R*(1+q),_e=fs(Ln(te,2)+Ln(B,2)),be=fs(Ln(ne,2)+Ln(C,2)),Ae=(_e+be)/2,de=b(S_(B,te)),Be=b(S_(C,ne)),Fe=de>=0?de:de+360,Le=Be>=0?Be:Be+360,we=k_(Fe-Le)>180?(Fe+Le+360)/2:(Fe+Le)/2,Te=1-.17*Rd(_(we-30))+.24*Rd(_(2*we))+.32*Rd(_(3*we+6))-.2*Rd(_(4*we-63));let fe=Le-Fe;fe=k_(fe)<=180?fe:Le<=Fe?fe+360:fe-360,fe=2*fs(_e*be)*A_(_(fe)/2);const Me=O-c,Ee=be-_e,$e=1+.015*Ln(Y-50,2)/fs(20+Ln(Y-50,2)),He=1+.045*Ae,Ge=1+.015*Ae*Te,Re=30*Ak(-Ln((we-275)/25,2)),Ue=-(2*fs(Ln(Ae,7)/(Ln(Ae,7)+Ln(25,7))))*A_(2*_(Re)),Mt=fs(Ln(Me/(o*$e),2)+Ln(Ee/(h*He),2)+Ln(fe/(p*Ge),2)+Ue*(Ee/(h*He))*(fe/(p*Ge)));return kk(0,Sk(100,Mt))}function Ik(i,n,o="lab"){i=new Ye(i),n=new Ye(n);const h=i.get(o),p=n.get(o);let b=0;for(let _ in h){const c=(h[_]||0)-(p[_]||0);b+=c*c}return Math.sqrt(b)}const Ek=(...i)=>{try{return new Ye(...i),!0}catch{return!1}},Ck={cool(){return Yd([Si.hsl(180,1,.9),Si.hsl(250,.7,.4)])},hot(){return Yd(["#000","#f00","#ff0","#fff"]).mode("rgb")}},pg={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},K1=Object.keys(pg),I_=new Map(K1.map(i=>[i.toLowerCase(),i])),Pk=typeof Proxy=="function"?new Proxy(pg,{get(i,n){const o=n.toLowerCase();if(I_.has(o))return i[I_.get(o)]},getOwnPropertyNames(){return Object.getOwnPropertyNames(K1)}}):pg,zk=(...i)=>{i=ai(i,"cmyk");const[n,o,h,p]=i,b=i.length>4?i[4]:1;return p===1?[0,0,0,b]:[n>=1?0:255*(1-n)*(1-p),o>=1?0:255*(1-o)*(1-p),h>=1?0:255*(1-h)*(1-p),b]},{max:E_}=Math,Dk=(...i)=>{let[n,o,h]=ai(i,"rgb");n=n/255,o=o/255,h=h/255;const p=1-E_(n,E_(o,h)),b=p<1?1/(1-p):0,_=(1-n-p)*b,c=(1-o-p)*b,M=(1-h-p)*b;return[_,c,M,p]};Ye.prototype.cmyk=function(){return Dk(this._rgb)};const Lk=(...i)=>new Ye(...i,"cmyk");Object.assign(Si,{cmyk:Lk});ri.format.cmyk=zk;ri.autodetect.push({p:2,test:(...i)=>{if(i=ai(i,"cmyk"),pi(i)==="array"&&i.length===4)return"cmyk"}});const Rk=(...i)=>{const n=ai(i,"hsla");let o=Tc(i)||"lsa";return n[0]=pa(n[0]||0)+"deg",n[1]=pa(n[1]*100)+"%",n[2]=pa(n[2]*100)+"%",o==="hsla"||n.length>3&&n[3]<1?(n[3]="/ "+(n.length>3?n[3]:1),o="hsla"):n.length=3,`${o.substr(0,3)}(${n.join(" ")})`},Bk=(...i)=>{const n=ai(i,"lab");let o=Tc(i)||"lab";return n[0]=pa(n[0])+"%",n[1]=pa(n[1]),n[2]=pa(n[2]),o==="laba"||n.length>3&&n[3]<1?n[3]="/ "+(n.length>3?n[3]:1):n.length=3,`lab(${n.join(" ")})`},Ok=(...i)=>{const n=ai(i,"lch");let o=Tc(i)||"lab";return n[0]=pa(n[0])+"%",n[1]=pa(n[1]),n[2]=isNaN(n[2])?"none":pa(n[2])+"deg",o==="lcha"||n.length>3&&n[3]<1?n[3]="/ "+(n.length>3?n[3]:1):n.length=3,`lch(${n.join(" ")})`},Fk=(...i)=>{const n=ai(i,"lab");return n[0]=pa(n[0]*100)+"%",n[1]=dg(n[1]),n[2]=dg(n[2]),n.length>3&&n[3]<1?n[3]="/ "+(n.length>3?n[3]:1):n.length=3,`oklab(${n.join(" ")})`},J1=(...i)=>{const[n,o,h,...p]=ai(i,"rgb"),[b,_,c]=Jg(n,o,h),[M,B,O]=H1(b,_,c);return[M,B,O,...p.length>0&&p[0]<1?[p[0]]:[]]},Nk=(...i)=>{const n=ai(i,"lch");return n[0]=pa(n[0]*100)+"%",n[1]=dg(n[1]),n[2]=isNaN(n[2])?"none":pa(n[2])+"deg",n.length>3&&n[3]<1?n[3]="/ "+(n.length>3?n[3]:1):n.length=3,`oklch(${n.join(" ")})`},{round:bm}=Math,jk=(...i)=>{const n=ai(i,"rgba");let o=Tc(i)||"rgb";if(o.substr(0,3)==="hsl")return Rk(G1(n),o);if(o.substr(0,3)==="lab"){const h=ah();_s("d50");const p=Bk(Zg(n),o);return _s(h),p}if(o.substr(0,3)==="lch"){const h=ah();_s("d50");const p=Ok(Yg(n),o);return _s(h),p}return o.substr(0,5)==="oklab"?Fk(Jg(n)):o.substr(0,5)==="oklch"?Nk(J1(n)):(n[0]=bm(n[0]),n[1]=bm(n[1]),n[2]=bm(n[2]),(o==="rgba"||n.length>3&&n[3]<1)&&(n[3]="/ "+(n.length>3?n[3]:1),o="rgba"),`${o.substr(0,3)}(${n.slice(0,o==="rgb"?3:4).join(" ")})`)},Q1=(...i)=>{i=ai(i,"lch");const[n,o,h,...p]=i,[b,_,c]=W1(n,o,h),[M,B,O]=Kg(b,_,c);return[M,B,O,...p.length>0&&p[0]<1?[p[0]]:[]]},vs=/((?:-?\d+)|(?:-?\d+(?:\.\d+)?)%|none)/.source,ka=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%?)|none)/.source,Kd=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%)|none)/.source,ma=/\s*/.source,kc=/\s+/.source,Qg=/\s*,\s*/.source,Tf=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)(?:deg)?)|none)/.source,Ac=/\s*(?:\/\s*((?:[01]|[01]?\.\d+)|\d+(?:\.\d+)?%))?/.source,eb=new RegExp("^rgba?\\("+ma+[vs,vs,vs].join(kc)+Ac+"\\)$"),tb=new RegExp("^rgb\\("+ma+[vs,vs,vs].join(Qg)+ma+"\\)$"),ib=new RegExp("^rgba\\("+ma+[vs,vs,vs,ka].join(Qg)+ma+"\\)$"),nb=new RegExp("^hsla?\\("+ma+[Tf,Kd,Kd].join(kc)+Ac+"\\)$"),rb=new RegExp("^hsl?\\("+ma+[Tf,Kd,Kd].join(Qg)+ma+"\\)$"),ab=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,sb=new RegExp("^lab\\("+ma+[ka,ka,ka].join(kc)+Ac+"\\)$"),ob=new RegExp("^lch\\("+ma+[ka,ka,Tf].join(kc)+Ac+"\\)$"),lb=new RegExp("^oklab\\("+ma+[ka,ka,ka].join(kc)+Ac+"\\)$"),cb=new RegExp("^oklch\\("+ma+[ka,ka,Tf].join(kc)+Ac+"\\)$"),{round:ub}=Math,ac=i=>i.map((n,o)=>o<=2?tl(ub(n),0,255):n),Rn=(i,n=0,o=100,h=!1)=>(typeof i=="string"&&i.endsWith("%")&&(i=parseFloat(i.substring(0,i.length-1))/100,h?i=n+(i+1)*.5*(o-n):i=n+i*(o-n)),+i),Lr=(i,n)=>i==="none"?n:i,e0=i=>{if(i=i.toLowerCase().trim(),i==="transparent")return[0,0,0,0];let n;if(ri.format.named)try{return ri.format.named(i)}catch{}if((n=i.match(eb))||(n=i.match(tb))){let o=n.slice(1,4);for(let p=0;p<3;p++)o[p]=+Rn(Lr(o[p],0),0,255);o=ac(o);const h=n[4]!==void 0?+Rn(n[4],0,1):1;return o[3]=h,o}if(n=i.match(ib)){const o=n.slice(1,5);for(let h=0;h<4;h++)o[h]=+Rn(o[h],0,255);return o}if((n=i.match(nb))||(n=i.match(rb))){const o=n.slice(1,4);o[0]=+Lr(o[0].replace("deg",""),0),o[1]=+Rn(Lr(o[1],0),0,100)*.01,o[2]=+Rn(Lr(o[2],0),0,100)*.01;const h=ac(fg(o)),p=n[4]!==void 0?+Rn(n[4],0,1):1;return h[3]=p,h}if(n=i.match(ab)){const o=n.slice(1,4);o[1]*=.01,o[2]*=.01;const h=fg(o);for(let p=0;p<3;p++)h[p]=ub(h[p]);return h[3]=+n[4],h}if(n=i.match(sb)){const o=n.slice(1,4);o[0]=Rn(Lr(o[0],0),0,100),o[1]=Rn(Lr(o[1],0),-125,125,!0),o[2]=Rn(Lr(o[2],0),-125,125,!0);const h=ah();_s("d50");const p=ac(Gg(o));_s(h);const b=n[4]!==void 0?+Rn(n[4],0,1):1;return p[3]=b,p}if(n=i.match(ob)){const o=n.slice(1,4);o[0]=Rn(o[0],0,100),o[1]=Rn(Lr(o[1],0),0,150,!1),o[2]=+Lr(o[2].replace("deg",""),0);const h=ah();_s("d50");const p=ac(Xg(o));_s(h);const b=n[4]!==void 0?+Rn(n[4],0,1):1;return p[3]=b,p}if(n=i.match(lb)){const o=n.slice(1,4);o[0]=Rn(Lr(o[0],0),0,1),o[1]=Rn(Lr(o[1],0),-.4,.4,!0),o[2]=Rn(Lr(o[2],0),-.4,.4,!0);const h=ac(Kg(o)),p=n[4]!==void 0?+Rn(n[4],0,1):1;return h[3]=p,h}if(n=i.match(cb)){const o=n.slice(1,4);o[0]=Rn(Lr(o[0],0),0,1),o[1]=Rn(Lr(o[1],0),0,.4,!1),o[2]=+Lr(o[2].replace("deg",""),0);const h=ac(Q1(o)),p=n[4]!==void 0?+Rn(n[4],0,1):1;return h[3]=p,h}};e0.test=i=>eb.test(i)||nb.test(i)||sb.test(i)||ob.test(i)||lb.test(i)||cb.test(i)||tb.test(i)||ib.test(i)||rb.test(i)||ab.test(i)||i==="transparent";Ye.prototype.css=function(i){return jk(this._rgb,i)};const Vk=(...i)=>new Ye(...i,"css");Si.css=Vk;ri.format.css=e0;ri.autodetect.push({p:5,test:(i,...n)=>{if(!n.length&&pi(i)==="string"&&e0.test(i))return"css"}});ri.format.gl=(...i)=>{const n=ai(i,"rgba");return n[0]*=255,n[1]*=255,n[2]*=255,n};const $k=(...i)=>new Ye(...i,"gl");Si.gl=$k;Ye.prototype.gl=function(){const i=this._rgb;return[i[0]/255,i[1]/255,i[2]/255,i[3]]};Ye.prototype.hex=function(i){return V1(this._rgb,i)};const Uk=(...i)=>new Ye(...i,"hex");Si.hex=Uk;ri.format.hex=j1;ri.autodetect.push({p:4,test:(i,...n)=>{if(!n.length&&pi(i)==="string"&&[3,4,5,6,7,8,9].indexOf(i.length)>=0)return"hex"}});const{log:Bd}=Math,hb=i=>{const n=i/100;let o,h,p;return n<66?(o=255,h=n<6?0:-155.25485562709179-.44596950469579133*(h=n-2)+104.49216199393888*Bd(h),p=n<20?0:-254.76935184120902+.8274096064007395*(p=n-10)+115.67994401066147*Bd(p)):(o=351.97690566805693+.114206453784165*(o=n-55)-40.25366309332127*Bd(o),h=325.4494125711974+.07943456536662342*(h=n-50)-28.0852963507957*Bd(h),p=255),[o,h,p,1]},{round:Wk}=Math,Hk=(...i)=>{const n=ai(i,"rgb"),o=n[0],h=n[2];let p=1e3,b=4e4;const _=.4;let c;for(;b-p>_;){c=(b+p)*.5;const M=hb(c);M[2]/M[0]>=h/o?b=c:p=c}return Wk(c)};Ye.prototype.temp=Ye.prototype.kelvin=Ye.prototype.temperature=function(){return Hk(this._rgb)};const xm=(...i)=>new Ye(...i,"temp");Object.assign(Si,{temp:xm,kelvin:xm,temperature:xm});ri.format.temp=ri.format.kelvin=ri.format.temperature=hb;Ye.prototype.oklch=function(){return J1(this._rgb)};const qk=(...i)=>new Ye(...i,"oklch");Object.assign(Si,{oklch:qk});ri.format.oklch=Q1;ri.autodetect.push({p:2,test:(...i)=>{if(i=ai(i,"oklch"),pi(i)==="array"&&i.length===3)return"oklch"}});Object.assign(Si,{analyze:X1,average:G5,bezier:Q5,blend:Aa,brewer:Pk,Color:Ye,colors:bc,contrast:bk,contrastAPCA:Tk,cubehelix:dk,deltaE:Mk,distance:Ik,input:ri,interpolate:xc,limits:Y1,mix:xc,random:gk,scale:Yd,scales:Ck,valid:Ek});const Gs={DARKEST_FLOOD_COLOR:"#519EA2",PMTILES_URL:"tiles.pmtiles",CONFIG:{center:[78.475,17.375],maxZoom:15,hash:!0,minZoom:12,pitch:45,antialias:!0,zoom:12.7,maxBounds:[[78.2,17.2],[78.6,17.6]]}},Gk=()=>{const i=new ES;Gd.addProtocol("pmtiles",i.tile);const n=new hg("basemap.pmtiles");return i.add(n),n},Zk=Gk(),ao=vn(null);let Xk=class{constructor(){lr(this,"map");lr(this,"markers",[])}initializeLayers(){this.map&&(this.map.addSource("pmtiles-source",{type:"vector",url:`pmtiles://${Gs.PMTILES_URL}`,attribution:'© <a href="https://openstreetmap.org">OpenStreetMap</a>'}),this.map.addLayer({id:"pmtiles-layer",type:"fill",source:"pmtiles-source","source-layer":"stream_influence_reclass",paint:{"fill-color":["interpolate",["linear"],["get","VALUE"],2,"#C4CDD020",3,"#abced0",4,"#519ea2"],"fill-opacity":.8}},"landcover_grass"))}setupEventListeners(){this.map&&(this.map.addControl(new Gd.NavigationControl,"bottom-right"),this.map.on("click",()=>ao.set(null)),ao.subscribe(n=>{if(n&&this.map){const o=this.markers.find(h=>h.name===n);o&&this.map.flyTo({center:o.coordinates,zoom:14,duration:2e3})}}))}createMarker(n){if(!this.map)return;const o=n.geometry.coordinates,h=n.properties.name;this.markers.push({name:h,coordinates:o});const p=new US(this.map),b=p.onAdd();b.addEventListener("click",_=>{_.stopPropagation(),ao.set(h)}),new Gd.Marker({element:b,anchor:"left",offset:[0,-10],clickTolerance:10,pitchAlignment:"viewport",rotationAlignment:"viewport"}).setLngLat(o).addTo(this.map),p.render(h)}initializeMarkers(){v1.features.reduce((o,h)=>{const p=o.findIndex(b=>b.properties.name===h.properties.name);return p===-1?o.push(h):parseInt(h.properties.date)>parseInt(o[p].properties.date)&&(o[p]=h),o},[]).forEach(o=>this.createMarker(o))}addBlinkingCircle(n){if(!this.map)return;this.map.addSource("pulse-point",{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:n},properties:{}}}),this.map.addLayer({id:"pulse-point-outer",type:"circle",source:"pulse-point",paint:{"circle-radius":15,"circle-color":Gs.DARKEST_FLOOD_COLOR,"circle-opacity":.2}}),this.map.addLayer({id:"pulse-point-inner",type:"circle",source:"pulse-point",paint:{"circle-radius":8,"circle-color":Gs.DARKEST_FLOOD_COLOR,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}});const o=3e3,h=performance.now(),p=30,b=15,_=c=>{if(!this.map)return;const M=c-h,B=M/o,O=(p-b)/2,C=b+O+O*Math.sin(B*Math.PI*6);this.map.setPaintProperty("pulse-point-outer","circle-radius",C),M<o?requestAnimationFrame(_):(this.map.getLayer("pulse-point-outer")&&this.map.removeLayer("pulse-point-outer"),this.map.getLayer("pulse-point-inner")&&this.map.removeLayer("pulse-point-inner"),this.map.getSource("pulse-point")&&this.map.removeSource("pulse-point"))};requestAnimationFrame(_)}init(n){Zk.getHeader().then(()=>{this.map=new Gd.Map({container:n,style:tS,...Gs.CONFIG}),this.map.on("load",()=>{this.initializeLayers(),this.setupEventListeners(),this.initializeMarkers()})})}cleanup(){this.map&&this.map.remove()}setLayerOpacity(n){this.map&&this.map.setPaintProperty("pmtiles-layer","fill-opacity",n)}locate(){if(!this.map)return Promise.resolve({type:"error",message:"Map not initialized"});const n=new Promise(h=>{setTimeout(()=>{h({type:"error",message:"Location request timed out. Please try again."})},5e3)}),o=new Promise(h=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(p=>{var M;const{longitude:b,latitude:_}=p.coords,c=[b,_];b>=Gs.CONFIG.maxBounds[0][0]&&b<=Gs.CONFIG.maxBounds[1][0]&&_>=Gs.CONFIG.maxBounds[0][1]&&_<=Gs.CONFIG.maxBounds[1][1]?((M=this.map)==null||M.flyTo({center:c,zoom:15,pitch:0,duration:2e3}),this.addBlinkingCircle(c),h({type:"success"})):h({type:"error",message:"We couldn't locate you, you seem to be outside the map bounds of Bangalore. Bet the traffic is better."})},p=>{console.error("Error getting location:",p),h({type:"error",message:"Unable to get your location. Please check your browser permissions."})},{enableHighAccuracy:!0,timeout:8e3,maximumAge:0}):h({type:"error",message:"Geolocation is not supported by your browser"})});return Promise.race([o,n])}};/**
 * @license lucide-svelte v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Kk=Jv("<svg><!><!></svg>");function po(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);un(n,!1);let p=tt(n,"name",8,void 0),b=tt(n,"color",8,"currentColor"),_=tt(n,"size",8,24),c=tt(n,"strokeWidth",8,2),M=tt(n,"absoluteStrokeWidth",8,!1),B=tt(n,"iconNode",24,()=>[]);const O=(...Z)=>Z.filter((se,q,te)=>!!se&&te.indexOf(se)===q).join(" ");cn();var R=Kk();let C;var Y=pt(R);vc(Y,1,B,_c,(Z,se)=>{let q=()=>De(se)[0],te=()=>De(se)[1];var ne=vi(),_e=ni(ne);IT(_e,q,!0,(be,Ae)=>{let de;Mi(()=>de=Br(be,de,{...te()},void 0,be.namespaceURI===l1,be.nodeName.includes("-")))}),rt(Z,ne)});var X=Wt(Y);zi(X,n,"default",{},null),ut(R),Mi(()=>C=Br(R,C,{...Yk,...h,width:_(),height:_(),stroke:b(),"stroke-width":M()?Number(c())*24/Number(_()):c(),class:O("lucide-icon","lucide",p()?`lucide-${p()}`:"",o.class)},void 0,!0)),rt(i,R),hn()}function Jk(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"arrow-left-from-line"},()=>o,{iconNode:[["path",{d:"m9 6-6 6 6 6"}],["path",{d:"M3 12h14"}],["path",{d:"M21 19V5"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}function Qk(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"arrow-right-from-line"},()=>o,{iconNode:[["path",{d:"M3 5v14"}],["path",{d:"M21 12H7"}],["path",{d:"m15 18 6-6-6-6"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}function eA(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"arrow-right"},()=>o,{iconNode:[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}function tA(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"circle-help"},()=>o,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}],["path",{d:"M12 17h.01"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}function iA(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"external-link"},()=>o,{iconNode:[["path",{d:"M15 3h6v6"}],["path",{d:"M10 14 21 3"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}function nA(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"loader-circle"},()=>o,{iconNode:[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}function rA(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"locate"},()=>o,{iconNode:[["line",{x1:"2",x2:"5",y1:"12",y2:"12"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22"}],["circle",{cx:"12",cy:"12",r:"7"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}function aA(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);po(i,$r({name:"waves"},()=>o,{iconNode:[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"}]],children:(p,b)=>{var _=vi(),c=ni(_);zi(c,n,"default",{},null),rt(p,_)},$$slots:{default:!0}}))}var sA=Ht('<div class="bubble svelte-6l9yru"></div>'),oA=Ht('<header class="absolute top-0 left-0 right-0 w-full min-h-[60px] p-3 md:p-4 svelte-6l9yru"><div class="flex pointer-events-none justify-center items-center md:ml-0 ml-[72px] relative flex-col gap-2 svelte-6l9yru"><div class="relative max-w-[300px] bg-white px-2 flex md:flex-col gap-1 flex-row items-center md:h-full h-[66px] p-2 md:p-3 rounded-lg shadow-md overflow-hidden w-full md:w-auto svelte-6l9yru"><h1 class="font-khand-bold w-[90%] md:text-4xl text-2xl md:text-center font-bold uppercase svelte-6l9yru">Telangana Water Log</h1> <p class="md:text-sm md:w-full w-[90%] text-xs md:text-center font-semibold svelte-6l9yru">Mapping where water drains and flows</p> <div class="absolute bottom-0 left-0 right-0 min-h-[3.5rem] overflow-hidden svelte-6l9yru"><div class="water-level h-full svelte-6l9yru"><div class="paper-boat svelte-6l9yru"></div></div> <div class="bubbles svelte-6l9yru"></div></div></div> <div class="w-full max-w-[300px] flex justify-end svelte-6l9yru"><button class="bg-white p-2 rounded-md shadow-md hover:bg-zinc-50 transition-colors duration-200 pointer-events-auto md:absolute md:right-0 md:top-0 svelte-6l9yru" aria-label="Show methodology"><!></button></div></div></header>');function db(i,n){un(n,!1);const o=cl(),h=30;cn();var p=oA(),b=pt(p),_=pt(b),c=Wt(pt(_),4),M=pt(c);Ti(M,"style",`animation-duration: ${h}s;`);var B=Wt(M,2);vc(B,4,()=>Array(10),_c,(Y,X,Z)=>{var se=sA();Ti(se,"style",`--delay: ${Z*.2}s; --position: ${Math.random()*100}%`),rt(Y,se)}),ut(B),ut(c),ut(_);var O=Wt(_,2),R=pt(O),C=pt(R);tA(C,{class:"w-5 h-5 text-zinc-700"}),ut(R),ut(O),ut(b),ut(p),Ct("click",R,()=>o("showMethodology")),rt(i,p),hn()}function lA(i){return i[i.length-1]}function mg(i){return Object.keys(i).reduce((n,o)=>i[o]===void 0?n:n+`${o}:${i[o]};`,"")}mg({position:"absolute",opacity:0,"pointer-events":"none",margin:0,transform:"translateX(-100%)"});function cA(i){if(i!==null)return""}function C_(i){function n(o){return o(i),()=>{}}return{subscribe:n}}const Od=i=>new Proxy(i,{get(n,o,h){return Reflect.get(n,o,h)},ownKeys(n){return Reflect.ownKeys(n).filter(o=>o!=="action")}}),P_=i=>typeof i=="function";Js("empty");function Js(i,n){const{stores:o,action:h,returned:p}=n??{},b=(()=>{if(o&&p)return Vr(o,c=>{const M=p(c);if(P_(M)){const B=(...O)=>Od({...M(...O),[`data-melt-${i}`]:"",action:h??Bn});return B.action=h??Bn,B}return Od({...M,[`data-melt-${i}`]:"",action:h??Bn})});{const c=p,M=c==null?void 0:c();if(P_(M)){const B=(...O)=>Od({...M(...O),[`data-melt-${i}`]:"",action:h??Bn});return B.action=h??Bn,C_(B)}return C_(Od({...M,[`data-melt-${i}`]:"",action:h??Bn}))}})(),_=h??(()=>{});return _.subscribe=b.subscribe,_}function uA(i){const n=b=>b?`${i}-${b}`:i,o=b=>`data-melt-${i}${b?`-${b}`:""}`,h=b=>`[data-melt-${i}${b?`-${b}`:""}]`;return{name:n,attribute:o,selector:h,getEl:b=>document.querySelector(h(b))}}const hA=typeof document<"u",fb=i=>typeof i=="function";function t0(i){return i instanceof Element}function oo(i){return i instanceof HTMLElement}function dA(i){return i!==null&&typeof i=="object"}function fA(i){return dA(i)&&"subscribe"in i}function hc(...i){return(...n)=>{for(const o of i)typeof o=="function"&&o(...n)}}function Bn(){}function ms(i,n,o,h){const p=Array.isArray(n)?n:[n];return p.forEach(b=>i.addEventListener(b,o,h)),()=>{p.forEach(b=>i.removeEventListener(b,o,h))}}function Fd(i,n,o,h){const p=Array.isArray(n)?n:[n];if(typeof o=="function"){const b=mA(_=>o(_));return p.forEach(_=>i.addEventListener(_,b,h)),()=>{p.forEach(_=>i.removeEventListener(_,b,h))}}return()=>void 0}function pA(i){const n=i.currentTarget;if(!oo(n))return null;const o=new CustomEvent(`m-${i.type}`,{detail:{originalEvent:i},cancelable:!0});return n.dispatchEvent(o),o}function mA(i){return n=>{const o=pA(n);if(!(o!=null&&o.defaultPrevented))return i(n)}}const gA=i=>{try{d1(i)}catch{return i}};function pb(i,...n){const o={};for(const h of Object.keys(i))n.includes(h)||(o[h]=i[h]);return o}function gh(i){return{...i,get:()=>ot(i)}}gh.writable=function(i){const n=vn(i);let o=i;return{subscribe:n.subscribe,set(h){n.set(h),o=h},update(h){const p=h(o);n.set(p),o=p},get(){return o}}};gh.derived=function(i,n){const o=new Map,h=()=>{const b=Array.isArray(i)?i.map(_=>_.get()):i.get();return n(b)};return{get:h,subscribe:b=>{const _=[];return(Array.isArray(i)?i:[i]).forEach(M=>{_.push(M.subscribe(()=>{b(h())}))}),b(h()),o.set(b,_),()=>{const M=o.get(b);if(M)for(const B of M)B();o.delete(b)}}}};const yA=(i,n)=>{const o=gh(i),h=(b,_)=>{o.update(c=>{const M=b(c);let B=M;return n&&(B=n({curr:c,next:M})),_==null||_(B),B})};return{...o,update:h,set:b=>{h(()=>b)}}};function mb(i){return new Promise(n=>setTimeout(n,i))}let _A="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",vA=(i=21)=>{let n="",o=i|0;for(;o--;)n+=_A[Math.random()*64|0];return n};function bA(){return vA(10)}function xA(i){return i.reduce((n,o)=>(n[o]=bA(),n),{})}const Zu={ALT:"Alt",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",BACKSPACE:"Backspace",CAPS_LOCK:"CapsLock",CONTROL:"Control",DELETE:"Delete",END:"End",ENTER:"Enter",ESCAPE:"Escape",F1:"F1",F10:"F10",F11:"F11",F12:"F12",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",HOME:"Home",META:"Meta",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",SHIFT:"Shift",SPACE:" ",TAB:"Tab",CTRL:"Control",ASTERISK:"*",A:"a",P:"p"},gb=()=>typeof window<"u";function wA(){const i=navigator.userAgentData;return(i==null?void 0:i.platform)??navigator.platform}const yb=i=>gb()&&i.test(wA().toLowerCase()),TA=()=>gb()&&!!navigator.maxTouchPoints,SA=()=>yb(/^mac/)&&!TA(),kA=()=>yb(/mac|iphone|ipad|ipod/i),AA=()=>kA()&&!SA(),wm="data-melt-scroll-lock";function z_(i,n){if(!i)return;const o=i.style.cssText;return Object.assign(i.style,n),()=>{i.style.cssText=o}}function MA(i,n,o){if(!i)return;const h=i.style.getPropertyValue(n);return i.style.setProperty(n,o),()=>{h?i.style.setProperty(n,h):i.style.removeProperty(n)}}function IA(i){const n=i.getBoundingClientRect().left;return Math.round(n)+i.scrollLeft?"paddingLeft":"paddingRight"}function EA(i){const n=document,o=n.defaultView??window,{documentElement:h,body:p}=n;if(p.hasAttribute(wm))return Bn;p.setAttribute(wm,"");const _=o.innerWidth-h.clientWidth,c=()=>MA(h,"--scrollbar-width",`${_}px`),M=IA(h),B=o.getComputedStyle(p)[M],O=()=>z_(p,{overflow:"hidden",[M]:`calc(${B} + ${_}px)`}),R=()=>{const{scrollX:Y,scrollY:X,visualViewport:Z}=o,se=(Z==null?void 0:Z.offsetLeft)??0,q=(Z==null?void 0:Z.offsetTop)??0,te=z_(p,{position:"fixed",overflow:"hidden",top:`${-(X-Math.floor(q))}px`,left:`${-(Y-Math.floor(se))}px`,right:"0",[M]:`calc(${B} + ${_}px)`});return()=>{te==null||te(),o.scrollTo(Y,X)}},C=[c(),AA()?R():O()];return()=>{C.forEach(Y=>Y==null?void 0:Y()),p.removeAttribute(wm)}}function Ko(i,n){let o;const h=Vr(i,b=>{o==null||o(),o=n(b)}).subscribe(Bn),p=()=>{h(),o==null||o()};return gA(p),p}function D_(i){const n={};return Object.keys(i).forEach(o=>{const h=o,p=i[h];n[h]=gh(vn(p))}),n}function CA(i){let n=i.parentElement;for(;oo(n)&&!n.hasAttribute("data-portal");)n=n.parentElement;return n||"body"}function PA(i,n){return n!==void 0?n:CA(i)==="body"?document.body:null}async function L_(i){const{prop:n,defaultEl:o}=i;if(await Promise.all([mb(1),xf]),n===void 0){o==null||o.focus();return}const h=fb(n)?n(o):n;if(typeof h=="string"){const p=document.querySelector(h);if(!oo(p))return;p.focus()}else oo(h)&&h.focus()}ro(void 0,i=>{function n(h){i(h),i(void 0)}return ms(document,"pointerup",n,{passive:!1,capture:!0})});const zA=ro(void 0,i=>{function n(h){h&&h.key===Zu.ESCAPE&&i(h),i(void 0)}return ms(document,"keydown",n,{passive:!1})}),R_=(i,n={})=>{let o=Bn;function h(p={}){o();const b={enabled:!0,...p},_=fA(b.enabled)?b.enabled:ro(b.enabled);o=hc(zA.subscribe(c=>{var B;if(!c||!ot(_))return;const M=c.target;if(!(!oo(M)||M.closest("[data-escapee]")!==i)){if(c.preventDefault(),b.ignore){if(fb(b.ignore)){if(b.ignore(c))return}else if(Array.isArray(b.ignore)&&b.ignore.length>0&&b.ignore.some(O=>O&&M===O))return}(B=b.handler)==null||B.call(b,c)}}),Ko(_,c=>{c?i.dataset.escapee="":delete i.dataset.escapee}))}return h(n),{update:h,destroy(){i.removeAttribute("data-escapee"),o()}}};/*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var _b=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Jd=_b.join(","),vb=typeof Element>"u",nl=vb?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Qd=!vb&&Element.prototype.getRootNode?function(i){var n;return i==null||(n=i.getRootNode)===null||n===void 0?void 0:n.call(i)}:function(i){return i==null?void 0:i.ownerDocument},ef=function i(n,o){var h;o===void 0&&(o=!0);var p=n==null||(h=n.getAttribute)===null||h===void 0?void 0:h.call(n,"inert"),b=p===""||p==="true",_=b||o&&n&&i(n.parentNode);return _},DA=function(n){var o,h=n==null||(o=n.getAttribute)===null||o===void 0?void 0:o.call(n,"contenteditable");return h===""||h==="true"},bb=function(n,o,h){if(ef(n))return[];var p=Array.prototype.slice.apply(n.querySelectorAll(Jd));return o&&nl.call(n,Jd)&&p.unshift(n),p=p.filter(h),p},xb=function i(n,o,h){for(var p=[],b=Array.from(n);b.length;){var _=b.shift();if(!ef(_,!1))if(_.tagName==="SLOT"){var c=_.assignedElements(),M=c.length?c:_.children,B=i(M,!0,h);h.flatten?p.push.apply(p,B):p.push({scopeParent:_,candidates:B})}else{var O=nl.call(_,Jd);O&&h.filter(_)&&(o||!n.includes(_))&&p.push(_);var R=_.shadowRoot||typeof h.getShadowRoot=="function"&&h.getShadowRoot(_),C=!ef(R,!1)&&(!h.shadowRootFilter||h.shadowRootFilter(_));if(R&&C){var Y=i(R===!0?_.children:R.children,!0,h);h.flatten?p.push.apply(p,Y):p.push({scopeParent:_,candidates:Y})}else b.unshift.apply(b,_.children)}}return p},wb=function(n){return!isNaN(parseInt(n.getAttribute("tabindex"),10))},Qo=function(n){if(!n)throw new Error("No node provided");return n.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(n.tagName)||DA(n))&&!wb(n)?0:n.tabIndex},LA=function(n,o){var h=Qo(n);return h<0&&o&&!wb(n)?0:h},RA=function(n,o){return n.tabIndex===o.tabIndex?n.documentOrder-o.documentOrder:n.tabIndex-o.tabIndex},Tb=function(n){return n.tagName==="INPUT"},BA=function(n){return Tb(n)&&n.type==="hidden"},OA=function(n){var o=n.tagName==="DETAILS"&&Array.prototype.slice.apply(n.children).some(function(h){return h.tagName==="SUMMARY"});return o},FA=function(n,o){for(var h=0;h<n.length;h++)if(n[h].checked&&n[h].form===o)return n[h]},NA=function(n){if(!n.name)return!0;var o=n.form||Qd(n),h=function(c){return o.querySelectorAll('input[type="radio"][name="'+c+'"]')},p;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")p=h(window.CSS.escape(n.name));else try{p=h(n.name)}catch(_){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",_.message),!1}var b=FA(p,n.form);return!b||b===n},jA=function(n){return Tb(n)&&n.type==="radio"},VA=function(n){return jA(n)&&!NA(n)},$A=function(n){var o,h=n&&Qd(n),p=(o=h)===null||o===void 0?void 0:o.host,b=!1;if(h&&h!==n){var _,c,M;for(b=!!((_=p)!==null&&_!==void 0&&(c=_.ownerDocument)!==null&&c!==void 0&&c.contains(p)||n!=null&&(M=n.ownerDocument)!==null&&M!==void 0&&M.contains(n));!b&&p;){var B,O,R;h=Qd(p),p=(B=h)===null||B===void 0?void 0:B.host,b=!!((O=p)!==null&&O!==void 0&&(R=O.ownerDocument)!==null&&R!==void 0&&R.contains(p))}}return b},B_=function(n){var o=n.getBoundingClientRect(),h=o.width,p=o.height;return h===0&&p===0},UA=function(n,o){var h=o.displayCheck,p=o.getShadowRoot;if(getComputedStyle(n).visibility==="hidden")return!0;var b=nl.call(n,"details>summary:first-of-type"),_=b?n.parentElement:n;if(nl.call(_,"details:not([open]) *"))return!0;if(!h||h==="full"||h==="legacy-full"){if(typeof p=="function"){for(var c=n;n;){var M=n.parentElement,B=Qd(n);if(M&&!M.shadowRoot&&p(M)===!0)return B_(n);n.assignedSlot?n=n.assignedSlot:!M&&B!==n.ownerDocument?n=B.host:n=M}n=c}if($A(n))return!n.getClientRects().length;if(h!=="legacy-full")return!0}else if(h==="non-zero-area")return B_(n);return!1},WA=function(n){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(n.tagName))for(var o=n.parentElement;o;){if(o.tagName==="FIELDSET"&&o.disabled){for(var h=0;h<o.children.length;h++){var p=o.children.item(h);if(p.tagName==="LEGEND")return nl.call(o,"fieldset[disabled] *")?!0:!p.contains(n)}return!0}o=o.parentElement}return!1},tf=function(n,o){return!(o.disabled||ef(o)||BA(o)||UA(o,n)||OA(o)||WA(o))},gg=function(n,o){return!(VA(o)||Qo(o)<0||!tf(n,o))},HA=function(n){var o=parseInt(n.getAttribute("tabindex"),10);return!!(isNaN(o)||o>=0)},qA=function i(n){var o=[],h=[];return n.forEach(function(p,b){var _=!!p.scopeParent,c=_?p.scopeParent:p,M=LA(c,_),B=_?i(p.candidates):c;M===0?_?o.push.apply(o,B):o.push(c):h.push({documentOrder:b,tabIndex:M,item:p,isScope:_,content:B})}),h.sort(RA).reduce(function(p,b){return b.isScope?p.push.apply(p,b.content):p.push(b.content),p},[]).concat(o)},GA=function(n,o){o=o||{};var h;return o.getShadowRoot?h=xb([n],o.includeContainer,{filter:gg.bind(null,o),flatten:!1,getShadowRoot:o.getShadowRoot,shadowRootFilter:HA}):h=bb(n,o.includeContainer,gg.bind(null,o)),qA(h)},ZA=function(n,o){o=o||{};var h;return o.getShadowRoot?h=xb([n],o.includeContainer,{filter:tf.bind(null,o),flatten:!0,getShadowRoot:o.getShadowRoot}):h=bb(n,o.includeContainer,tf.bind(null,o)),h},sc=function(n,o){if(o=o||{},!n)throw new Error("No node provided");return nl.call(n,Jd)===!1?!1:gg(o,n)},XA=_b.concat("iframe").join(","),Tm=function(n,o){if(o=o||{},!n)throw new Error("No node provided");return nl.call(n,XA)===!1?!1:tf(o,n)};/*!
* focus-trap 7.6.2
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function yg(i,n){(n==null||n>i.length)&&(n=i.length);for(var o=0,h=Array(n);o<n;o++)h[o]=i[o];return h}function YA(i){if(Array.isArray(i))return yg(i)}function KA(i,n,o){return(n=iM(n))in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o,i}function JA(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function QA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O_(i,n){var o=Object.keys(i);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(i);n&&(h=h.filter(function(p){return Object.getOwnPropertyDescriptor(i,p).enumerable})),o.push.apply(o,h)}return o}function F_(i){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?O_(Object(o),!0).forEach(function(h){KA(i,h,o[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):O_(Object(o)).forEach(function(h){Object.defineProperty(i,h,Object.getOwnPropertyDescriptor(o,h))})}return i}function eM(i){return YA(i)||JA(i)||nM(i)||QA()}function tM(i,n){if(typeof i!="object"||!i)return i;var o=i[Symbol.toPrimitive];if(o!==void 0){var h=o.call(i,n||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(i)}function iM(i){var n=tM(i,"string");return typeof n=="symbol"?n:n+""}function nM(i,n){if(i){if(typeof i=="string")return yg(i,n);var o={}.toString.call(i).slice(8,-1);return o==="Object"&&i.constructor&&(o=i.constructor.name),o==="Map"||o==="Set"?Array.from(i):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?yg(i,n):void 0}}var N_={activateTrap:function(n,o){if(n.length>0){var h=n[n.length-1];h!==o&&h.pause()}var p=n.indexOf(o);p===-1||n.splice(p,1),n.push(o)},deactivateTrap:function(n,o){var h=n.indexOf(o);h!==-1&&n.splice(h,1),n.length>0&&n[n.length-1].unpause()}},rM=function(n){return n.tagName&&n.tagName.toLowerCase()==="input"&&typeof n.select=="function"},aM=function(n){return(n==null?void 0:n.key)==="Escape"||(n==null?void 0:n.key)==="Esc"||(n==null?void 0:n.keyCode)===27},Qu=function(n){return(n==null?void 0:n.key)==="Tab"||(n==null?void 0:n.keyCode)===9},sM=function(n){return Qu(n)&&!n.shiftKey},oM=function(n){return Qu(n)&&n.shiftKey},j_=function(n){return setTimeout(n,0)},Vu=function(n){for(var o=arguments.length,h=new Array(o>1?o-1:0),p=1;p<o;p++)h[p-1]=arguments[p];return typeof n=="function"?n.apply(void 0,h):n},Nd=function(n){return n.target.shadowRoot&&typeof n.composedPath=="function"?n.composedPath()[0]:n.target},lM=[],cM=function(n,o){var h=(o==null?void 0:o.document)||document,p=(o==null?void 0:o.trapStack)||lM,b=F_({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:sM,isKeyBackward:oM},o),_={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},c,M=function(fe,Me,Ee){return fe&&fe[Me]!==void 0?fe[Me]:b[Ee||Me]},B=function(fe,Me){var Ee=typeof(Me==null?void 0:Me.composedPath)=="function"?Me.composedPath():void 0;return _.containerGroups.findIndex(function($e){var He=$e.container,Ge=$e.tabbableNodes;return He.contains(fe)||(Ee==null?void 0:Ee.includes(He))||Ge.find(function(Re){return Re===fe})})},O=function(fe){var Me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ee=Me.hasFallback,$e=Ee===void 0?!1:Ee,He=Me.params,Ge=He===void 0?[]:He,Re=b[fe];if(typeof Re=="function"&&(Re=Re.apply(void 0,eM(Ge))),Re===!0&&(Re=void 0),!Re){if(Re===void 0||Re===!1)return Re;throw new Error("`".concat(fe,"` was specified but was not a node, or did not return a node"))}var Xe=Re;if(typeof Re=="string"){try{Xe=h.querySelector(Re)}catch(Ue){throw new Error("`".concat(fe,'` appears to be an invalid selector; error="').concat(Ue.message,'"'))}if(!Xe&&!$e)throw new Error("`".concat(fe,"` as selector refers to no known node"))}return Xe},R=function(){var fe=O("initialFocus",{hasFallback:!0});if(fe===!1)return!1;if(fe===void 0||fe&&!Tm(fe,b.tabbableOptions))if(B(h.activeElement)>=0)fe=h.activeElement;else{var Me=_.tabbableGroups[0],Ee=Me&&Me.firstTabbableNode;fe=Ee||O("fallbackFocus")}else fe===null&&(fe=O("fallbackFocus"));if(!fe)throw new Error("Your focus-trap needs to have at least one focusable element");return fe},C=function(){if(_.containerGroups=_.containers.map(function(fe){var Me=GA(fe,b.tabbableOptions),Ee=ZA(fe,b.tabbableOptions),$e=Me.length>0?Me[0]:void 0,He=Me.length>0?Me[Me.length-1]:void 0,Ge=Ee.find(function(Ue){return sc(Ue)}),Re=Ee.slice().reverse().find(function(Ue){return sc(Ue)}),Xe=!!Me.find(function(Ue){return Qo(Ue)>0});return{container:fe,tabbableNodes:Me,focusableNodes:Ee,posTabIndexesFound:Xe,firstTabbableNode:$e,lastTabbableNode:He,firstDomTabbableNode:Ge,lastDomTabbableNode:Re,nextTabbableNode:function(Mt){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_t=Me.indexOf(Mt);return _t<0?Rt?Ee.slice(Ee.indexOf(Mt)+1).find(function(Xt){return sc(Xt)}):Ee.slice(0,Ee.indexOf(Mt)).reverse().find(function(Xt){return sc(Xt)}):Me[_t+(Rt?1:-1)]}}}),_.tabbableGroups=_.containerGroups.filter(function(fe){return fe.tabbableNodes.length>0}),_.tabbableGroups.length<=0&&!O("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(_.containerGroups.find(function(fe){return fe.posTabIndexesFound})&&_.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},Y=function(fe){var Me=fe.activeElement;if(Me)return Me.shadowRoot&&Me.shadowRoot.activeElement!==null?Y(Me.shadowRoot):Me},X=function(fe){if(fe!==!1&&fe!==Y(document)){if(!fe||!fe.focus){X(R());return}fe.focus({preventScroll:!!b.preventScroll}),_.mostRecentlyFocusedNode=fe,rM(fe)&&fe.select()}},Z=function(fe){var Me=O("setReturnFocus",{params:[fe]});return Me||(Me===!1?!1:fe)},se=function(fe){var Me=fe.target,Ee=fe.event,$e=fe.isBackward,He=$e===void 0?!1:$e;Me=Me||Nd(Ee),C();var Ge=null;if(_.tabbableGroups.length>0){var Re=B(Me,Ee),Xe=Re>=0?_.containerGroups[Re]:void 0;if(Re<0)He?Ge=_.tabbableGroups[_.tabbableGroups.length-1].lastTabbableNode:Ge=_.tabbableGroups[0].firstTabbableNode;else if(He){var Ue=_.tabbableGroups.findIndex(function(si){var fi=si.firstTabbableNode;return Me===fi});if(Ue<0&&(Xe.container===Me||Tm(Me,b.tabbableOptions)&&!sc(Me,b.tabbableOptions)&&!Xe.nextTabbableNode(Me,!1))&&(Ue=Re),Ue>=0){var Mt=Ue===0?_.tabbableGroups.length-1:Ue-1,Rt=_.tabbableGroups[Mt];Ge=Qo(Me)>=0?Rt.lastTabbableNode:Rt.lastDomTabbableNode}else Qu(Ee)||(Ge=Xe.nextTabbableNode(Me,!1))}else{var _t=_.tabbableGroups.findIndex(function(si){var fi=si.lastTabbableNode;return Me===fi});if(_t<0&&(Xe.container===Me||Tm(Me,b.tabbableOptions)&&!sc(Me,b.tabbableOptions)&&!Xe.nextTabbableNode(Me))&&(_t=Re),_t>=0){var Xt=_t===_.tabbableGroups.length-1?0:_t+1,jt=_.tabbableGroups[Xt];Ge=Qo(Me)>=0?jt.firstTabbableNode:jt.firstDomTabbableNode}else Qu(Ee)||(Ge=Xe.nextTabbableNode(Me))}}else Ge=O("fallbackFocus");return Ge},q=function(fe){var Me=Nd(fe);if(!(B(Me,fe)>=0)){if(Vu(b.clickOutsideDeactivates,fe)){c.deactivate({returnFocus:b.returnFocusOnDeactivate});return}Vu(b.allowOutsideClick,fe)||fe.preventDefault()}},te=function(fe){var Me=Nd(fe),Ee=B(Me,fe)>=0;if(Ee||Me instanceof Document)Ee&&(_.mostRecentlyFocusedNode=Me);else{fe.stopImmediatePropagation();var $e,He=!0;if(_.mostRecentlyFocusedNode)if(Qo(_.mostRecentlyFocusedNode)>0){var Ge=B(_.mostRecentlyFocusedNode),Re=_.containerGroups[Ge].tabbableNodes;if(Re.length>0){var Xe=Re.findIndex(function(Ue){return Ue===_.mostRecentlyFocusedNode});Xe>=0&&(b.isKeyForward(_.recentNavEvent)?Xe+1<Re.length&&($e=Re[Xe+1],He=!1):Xe-1>=0&&($e=Re[Xe-1],He=!1))}}else _.containerGroups.some(function(Ue){return Ue.tabbableNodes.some(function(Mt){return Qo(Mt)>0})})||(He=!1);else He=!1;He&&($e=se({target:_.mostRecentlyFocusedNode,isBackward:b.isKeyBackward(_.recentNavEvent)})),X($e||_.mostRecentlyFocusedNode||R())}_.recentNavEvent=void 0},ne=function(fe){var Me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;_.recentNavEvent=fe;var Ee=se({event:fe,isBackward:Me});Ee&&(Qu(fe)&&fe.preventDefault(),X(Ee))},_e=function(fe){(b.isKeyForward(fe)||b.isKeyBackward(fe))&&ne(fe,b.isKeyBackward(fe))},be=function(fe){aM(fe)&&Vu(b.escapeDeactivates,fe)!==!1&&(fe.preventDefault(),c.deactivate())},Ae=function(fe){var Me=Nd(fe);B(Me,fe)>=0||Vu(b.clickOutsideDeactivates,fe)||Vu(b.allowOutsideClick,fe)||(fe.preventDefault(),fe.stopImmediatePropagation())},de=function(){if(_.active)return N_.activateTrap(p,c),_.delayInitialFocusTimer=b.delayInitialFocus?j_(function(){X(R())}):X(R()),h.addEventListener("focusin",te,!0),h.addEventListener("mousedown",q,{capture:!0,passive:!1}),h.addEventListener("touchstart",q,{capture:!0,passive:!1}),h.addEventListener("click",Ae,{capture:!0,passive:!1}),h.addEventListener("keydown",_e,{capture:!0,passive:!1}),h.addEventListener("keydown",be),c},Be=function(){if(_.active)return h.removeEventListener("focusin",te,!0),h.removeEventListener("mousedown",q,!0),h.removeEventListener("touchstart",q,!0),h.removeEventListener("click",Ae,!0),h.removeEventListener("keydown",_e,!0),h.removeEventListener("keydown",be),c},Fe=function(fe){var Me=fe.some(function(Ee){var $e=Array.from(Ee.removedNodes);return $e.some(function(He){return He===_.mostRecentlyFocusedNode})});Me&&X(R())},Le=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(Fe):void 0,we=function(){Le&&(Le.disconnect(),_.active&&!_.paused&&_.containers.map(function(fe){Le.observe(fe,{subtree:!0,childList:!0})}))};return c={get active(){return _.active},get paused(){return _.paused},activate:function(fe){if(_.active)return this;var Me=M(fe,"onActivate"),Ee=M(fe,"onPostActivate"),$e=M(fe,"checkCanFocusTrap");$e||C(),_.active=!0,_.paused=!1,_.nodeFocusedBeforeActivation=h.activeElement,Me==null||Me();var He=function(){$e&&C(),de(),we(),Ee==null||Ee()};return $e?($e(_.containers.concat()).then(He,He),this):(He(),this)},deactivate:function(fe){if(!_.active)return this;var Me=F_({onDeactivate:b.onDeactivate,onPostDeactivate:b.onPostDeactivate,checkCanReturnFocus:b.checkCanReturnFocus},fe);clearTimeout(_.delayInitialFocusTimer),_.delayInitialFocusTimer=void 0,Be(),_.active=!1,_.paused=!1,we(),N_.deactivateTrap(p,c);var Ee=M(Me,"onDeactivate"),$e=M(Me,"onPostDeactivate"),He=M(Me,"checkCanReturnFocus"),Ge=M(Me,"returnFocus","returnFocusOnDeactivate");Ee==null||Ee();var Re=function(){j_(function(){Ge&&X(Z(_.nodeFocusedBeforeActivation)),$e==null||$e()})};return Ge&&He?(He(Z(_.nodeFocusedBeforeActivation)).then(Re,Re),this):(Re(),this)},pause:function(fe){if(_.paused||!_.active)return this;var Me=M(fe,"onPause"),Ee=M(fe,"onPostPause");return _.paused=!0,Me==null||Me(),Be(),we(),Ee==null||Ee(),this},unpause:function(fe){if(!_.paused||!_.active)return this;var Me=M(fe,"onUnpause"),Ee=M(fe,"onPostUnpause");return _.paused=!1,Me==null||Me(),C(),de(),we(),Ee==null||Ee(),this},updateContainerElements:function(fe){var Me=[].concat(fe).filter(Boolean);return _.containers=Me.map(function(Ee){return typeof Ee=="string"?h.querySelector(Ee):Ee}),_.active&&C(),we(),this}},c.updateContainerElements(n),c};function uM(i={}){let n;const{immediate:o,...h}=i,p=vn(!1),b=vn(!1),_=R=>n==null?void 0:n.activate(R),c=R=>{n==null||n.deactivate(R)},M=()=>{n&&(n.pause(),b.set(!0))},B=()=>{n&&(n.unpause(),b.set(!1))};return{useFocusTrap:R=>(n=cM(R,{...h,onActivate(){var C;p.set(!0),(C=i.onActivate)==null||C.call(i)},onDeactivate(){var C;p.set(!1),(C=i.onDeactivate)==null||C.call(i)}}),o&&_(),{destroy(){c(),n=void 0}}),hasFocus:u_(p),isPaused:u_(b),activate:_,deactivate:c,pause:M,unpause:B}}const jd=[],hM=(i,n)=>{let o=Bn;function h(){const b=jd.indexOf(i);b>=0&&jd.splice(b,1)}function p(b){o();const{open:_,onClose:c,shouldCloseOnInteractOutside:M,closeOnInteractOutside:B}=b;mb(100).then(()=>{_?jd.push(i):h()});function O(){return lA(jd)===i}function R(){O()&&c&&(c(),h())}function C(X){const Z=X.target;t0(Z)&&Z&&O()&&(X.preventDefault(),X.stopPropagation(),X.stopImmediatePropagation())}function Y(X){M!=null&&M(X)&&O()&&(X.preventDefault(),X.stopPropagation(),X.stopImmediatePropagation(),R())}o=fM(i,{onInteractOutsideStart:C,onInteractOutside:B?Y:void 0,enabled:_}).destroy}return p(n),{update:p,destroy(){h(),o()}}},dM=(i,n="body")=>{let o;if(!oo(n)&&typeof n!="string")return{destroy:Bn};async function h(b){if(n=b,typeof n=="string"){if(o=document.querySelector(n),o===null&&(await xf(),o=document.querySelector(n)),o===null)throw new Error(`No element found matching css selector: "${n}"`)}else if(n instanceof HTMLElement)o=n;else throw new TypeError(`Unknown portal target type: ${n===null?"null":typeof n}. Allowed types: string (CSS selector) or HTMLElement.`);i.dataset.portal="",o.appendChild(i),i.hidden=!1}function p(){i.remove()}return h(n),{update:h,destroy:p}},fM=(i,n)=>{let o=Bn,h=Bn,p=!1,b=!1,_=!1;function c(O){o(),h();const{onInteractOutside:R,onInteractOutsideStart:C,enabled:Y}=O;if(!Y)return;function X(q){R&&V_(q,i)&&(C==null||C(q));const te=q.target;t0(te)&&Sb(i,te)&&(b=!0),p=!0}function Z(q){R==null||R(q)}const se=pM(i);if(typeof PointerEvent<"u"){const q=te=>{h();const ne=_e=>{M(_e)&&Z(_e),B()};if(te.pointerType==="touch"){h=ms(se,"click",ne,{capture:!0,once:!0});return}ne(te)};o=hc(ms(se,"pointerdown",X,!0),ms(se,"pointerup",q,!0))}else{const q=ne=>{_?_=!1:M(ne)&&Z(ne),B()},te=ne=>{_=!0,M(ne)&&Z(ne),B()};o=hc(ms(se,"mousedown",X,!0),ms(se,"mouseup",q,!0),ms(se,"touchstart",X,!0),ms(se,"touchend",te,!0))}}function M(O){return!!(p&&!b&&V_(O,i))}function B(){p=!1,b=!1}return c(n),{update:c,destroy(){o(),h()}}};function V_(i,n){if("button"in i&&i.button>0)return!1;const o=i.target;if(!t0(o))return!1;const h=o.ownerDocument;return!h||!h.documentElement.contains(o)?!1:n&&!Sb(n,o)}function Sb(i,n){return i===n||i.contains(n)}function pM(i){return(i==null?void 0:i.ownerDocument)??document}ro(!1),ro(!1),ro(void 0);const mM={isDateDisabled:void 0,isDateUnavailable:void 0,value:void 0,preventDeselect:!1,numberOfMonths:1,pagedNavigation:!1,weekStartsOn:0,fixedWeeks:!1,calendarLabel:"Event Date",locale:"en",minValue:void 0,maxValue:void 0,disabled:!1,readonly:!1,weekdayFormat:"narrow"};({...pb(mM,"isDateDisabled","isDateUnavailable","value","locale","disabled","readonly","minValue","maxValue","weekdayFormat")});const{name:Xo}=uA("dialog"),gM={preventScroll:!0,closeOnEscape:!0,closeOnOutsideClick:!0,role:"dialog",defaultOpen:!1,portal:void 0,forceVisible:!1,openFocus:void 0,closeFocus:void 0,onOutsideClick:void 0},yM=["content","title","description"];function _M(i){const n={...gM,...i},o=D_(pb(n,"ids")),{preventScroll:h,closeOnEscape:p,closeOnOutsideClick:b,role:_,portal:c,forceVisible:M,openFocus:B,closeFocus:O,onOutsideClick:R}=o,C=gh.writable(null),Y=D_({...xA(yM),...n.ids}),X=n.open??vn(n.defaultOpen),Z=yA(X,n==null?void 0:n.onOpenChange),se=Vr([Z,M],([we,Te])=>we||Te);let q=Bn;function te(we){const Te=we.currentTarget,fe=we.currentTarget;!oo(Te)||!oo(fe)||(Z.set(!0),C.set(fe))}function ne(){Z.set(!1),L_({prop:O.get(),defaultEl:C.get()})}const _e=Js(Xo("trigger"),{stores:[Z],returned:([we])=>({"aria-haspopup":"dialog","aria-expanded":we,type:"button"}),action:we=>({destroy:hc(Fd(we,"click",fe=>{te(fe)}),Fd(we,"keydown",fe=>{fe.key!==Zu.ENTER&&fe.key!==Zu.SPACE||(fe.preventDefault(),te(fe))}))})}),be=Js(Xo("overlay"),{stores:[se,Z],returned:([we,Te])=>({hidden:we?void 0:!0,tabindex:-1,style:mg({display:we?void 0:"none"}),"aria-hidden":!0,"data-state":Te?"open":"closed"}),action:we=>{let Te=Bn;return p.get()&&(Te=R_(we,{handler:()=>{ne()}}).destroy),{destroy(){Te()}}}}),Ae=Js(Xo("content"),{stores:[se,Y.content,Y.description,Y.title,Z],returned:([we,Te,fe,Me,Ee])=>({id:Te,role:_.get(),"aria-describedby":fe,"aria-labelledby":Me,"aria-modal":we?"true":void 0,"data-state":Ee?"open":"closed",tabindex:-1,hidden:we?void 0:!0,style:mg({display:we?void 0:"none"})}),action:we=>{let Te=Bn,fe=Bn;const Me=hc(Ko([Z,b,p],([Ee,$e,He])=>{if(!Ee)return;const Ge=uM({immediate:!1,escapeDeactivates:He,clickOutsideDeactivates:$e,allowOutsideClick:!0,returnFocusOnDeactivate:!1,fallbackFocus:we});Te=Ge.activate,fe=Ge.deactivate;const Re=Ge.useFocusTrap(we);return Re&&Re.destroy?Re.destroy:Ge.deactivate}),Ko([b,Z],([Ee,$e])=>hM(we,{open:$e,closeOnInteractOutside:Ee,onClose(){ne()},shouldCloseOnInteractOutside(He){var Ge;return(Ge=R.get())==null||Ge(He),!He.defaultPrevented}}).destroy),Ko([p],([Ee])=>Ee?R_(we,{handler:ne}).destroy:Bn),Ko([se],([Ee])=>{xf().then(()=>{Ee?Te():fe()})}));return{destroy:()=>{q(),Me()}}}}),de=Js(Xo("portalled"),{stores:c,returned:we=>({"data-portal":cA(we)}),action:we=>{const Te=Ko([c],([fe])=>{if(fe===null)return Bn;const Me=PA(we,fe);return Me===null?Bn:dM(we,Me).destroy});return{destroy(){Te()}}}}),Be=Js(Xo("title"),{stores:[Y.title],returned:([we])=>({id:we})}),Fe=Js(Xo("description"),{stores:[Y.description],returned:([we])=>({id:we})}),Le=Js(Xo("close"),{returned:()=>({type:"button"}),action:we=>({destroy:hc(Fd(we,"click",()=>{ne()}),Fd(we,"keydown",fe=>{fe.key!==Zu.SPACE&&fe.key!==Zu.ENTER||(fe.preventDefault(),ne())}))})});return Ko([Z,h],([we,Te])=>{if(hA){if(Te&&we&&(q=EA()),we){const fe=document.getElementById(Y.content.get());L_({prop:B.get(),defaultEl:fe})}return()=>{M.get()||q()}}}),{ids:Y,elements:{content:Ae,trigger:_e,title:Be,description:Fe,overlay:be,close:Le,portalled:de},states:{open:Z},options:o}}function vM(i,n){const o={};return n.forEach(h=>{o[h]={[`data-${i}-${h}`]:""}}),h=>o[h]}function bM(){const i=cl();return n=>{const{originalEvent:o}=n.detail,{cancelable:h}=n,p=o.type;i(p,{originalEvent:o,currentTarget:o.currentTarget},{cancelable:h})||n.preventDefault()}}function xM(i){const n={};for(const o in i){const h=i[o];h!==void 0&&(n[o]=h)}return n}function wM(i){return function(n,o){if(o===void 0)return;const h=i[n];h&&h.set(o)}}function kb(){return{NAME:"dialog",PARTS:["close","content","description","overlay","portal","title","trigger"]}}function TM(i){const{NAME:n,PARTS:o}=kb(),h=vM(n,o),p={..._M({...xM(i),role:"dialog",forceVisible:!0}),getAttrs:h};return u1(n,p),{...p,updateOption:wM(p.options)}}function Sf(){const{NAME:i}=kb();return Wg(i)}function SM(i,n){un(n,!1);const o=Ma(),h=()=>kn(se,"$idValues",o);let p=tt(n,"preventScroll",24,()=>{}),b=tt(n,"closeOnEscape",24,()=>{}),_=tt(n,"closeOnOutsideClick",24,()=>{}),c=tt(n,"portal",24,()=>{}),M=tt(n,"open",28,()=>{}),B=tt(n,"onOpenChange",24,()=>{}),O=tt(n,"openFocus",24,()=>{}),R=tt(n,"closeFocus",24,()=>{}),C=tt(n,"onOutsideClick",24,()=>{});const{states:{open:Y},updateOption:X,ids:Z}=TM({closeOnEscape:b(),preventScroll:p(),closeOnOutsideClick:_(),portal:c(),forceVisible:!0,defaultOpen:M(),openFocus:O(),closeFocus:R(),onOutsideClick:C(),onOpenChange:({next:ne})=>{var _e;return M()!==ne&&((_e=B())==null||_e(ne),M(ne)),ne}}),se=Vr([Z.content,Z.description,Z.title],([ne,_e,be])=>({content:ne,description:_e,title:be}));ei(()=>Ai(M()),()=>{M()!==void 0&&Y.set(M())}),ei(()=>Ai(p()),()=>{X("preventScroll",p())}),ei(()=>Ai(b()),()=>{X("closeOnEscape",b())}),ei(()=>Ai(_()),()=>{X("closeOnOutsideClick",_())}),ei(()=>Ai(c()),()=>{X("portal",c())}),ei(()=>Ai(O()),()=>{X("openFocus",O())}),ei(()=>Ai(R()),()=>{X("closeFocus",R())}),ei(()=>Ai(C()),()=>{X("onOutsideClick",C())}),Or(),cn();var q=vi(),te=ni(q);zi(te,n,"default",{get ids(){return h()}},null),rt(i,q),hn()}var kM=Ht("<div><!></div>");function AM(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["asChild","el"]);un(n,!1);const p=Ma(),b=()=>kn(B,"$portalled",p),_=Hi();let c=tt(n,"asChild",8,!1),M=tt(n,"el",28,()=>{});const{elements:{portalled:B},getAttrs:O}=Sf(),R=O("portal");ei(()=>b(),()=>{di(_,b())}),ei(()=>De(_),()=>{Object.assign(De(_),R)}),Or(),cn();var C=vi(),Y=ni(C);{var X=se=>{var q=vi(),te=ni(q);zi(te,n,"default",{get builder(){return De(_)}},null),rt(se,q)},Z=se=>{var q=kM();let te;var ne=pt(q);zi(ne,n,"default",{get builder(){return De(_)}},null),ut(q),Rr(q,_e=>M(_e),()=>M()),Tr(q,_e=>{var be,Ae;return(Ae=(be=De(_)).action)==null?void 0:Ae.call(be,_e)}),Mi(()=>te=Br(q,te,{...De(_),...h})),rt(se,q)};Vi(Y,se=>{c()?se(X):se(Z,!1)})}rt(i,C),hn()}var MM=Ht("<div><!></div>"),IM=Ht("<div><!></div>"),EM=Ht("<div><!></div>"),CM=Ht("<div><!></div>"),PM=Ht("<div><!></div>");function zM(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","el"]);un(n,!1);const p=Ma(),b=()=>kn(q,"$content",p),_=()=>kn(te,"$open",p),c=Hi();let M=tt(n,"transition",24,()=>{}),B=tt(n,"transitionConfig",24,()=>{}),O=tt(n,"inTransition",24,()=>{}),R=tt(n,"inTransitionConfig",24,()=>{}),C=tt(n,"outTransition",24,()=>{}),Y=tt(n,"outTransitionConfig",24,()=>{}),X=tt(n,"asChild",8,!1),Z=tt(n,"id",24,()=>{}),se=tt(n,"el",28,()=>{});const{elements:{content:q},states:{open:te},ids:ne,getAttrs:_e}=Sf(),be=_e("content");ei(()=>Ai(Z()),()=>{Z()&&ne.content.set(Z())}),ei(()=>b(),()=>{di(c,b())}),ei(()=>De(c),()=>{Object.assign(De(c),be)}),Or(),cn();var Ae=vi(),de=ni(Ae);{var Be=Le=>{var we=vi(),Te=ni(we);zi(Te,n,"default",{get builder(){return De(c)}},null),rt(Le,we)},Fe=Le=>{var we=vi(),Te=ni(we);{var fe=Ee=>{var $e=MM();let He;var Ge=pt($e);zi(Ge,n,"default",{get builder(){return De(c)}},null),ut($e),Rr($e,Re=>se(Re),()=>se()),Tr($e,Re=>{var Xe,Ue;return(Ue=(Xe=De(c)).action)==null?void 0:Ue.call(Xe,Re)}),Lt(()=>Ct("pointerdown",$e,function(Re){Nt.call(this,n,Re)})),Lt(()=>Ct("pointermove",$e,function(Re){Nt.call(this,n,Re)})),Lt(()=>Ct("pointerup",$e,function(Re){Nt.call(this,n,Re)})),Lt(()=>Ct("touchcancel",$e,function(Re){Nt.call(this,n,Re)})),Lt(()=>Ct("touchend",$e,function(Re){Nt.call(this,n,Re)})),Lt(()=>Ct("touchmove",$e,function(Re){Nt.call(this,n,Re)},void 0,!1)),Lt(()=>Ct("touchstart",$e,function(Re){Nt.call(this,n,Re)},void 0,!1)),Mi(()=>He=Br($e,He,{...De(c),...h})),$n(3,$e,M,B),rt(Ee,$e)},Me=Ee=>{var $e=vi(),He=ni($e);{var Ge=Xe=>{var Ue=IM();let Mt;var Rt=pt(Ue);zi(Rt,n,"default",{get builder(){return De(c)}},null),ut(Ue),Rr(Ue,_t=>se(_t),()=>se()),Tr(Ue,_t=>{var Xt,jt;return(jt=(Xt=De(c)).action)==null?void 0:jt.call(Xt,_t)}),Lt(()=>Ct("pointerdown",Ue,function(_t){Nt.call(this,n,_t)})),Lt(()=>Ct("pointermove",Ue,function(_t){Nt.call(this,n,_t)})),Lt(()=>Ct("pointerup",Ue,function(_t){Nt.call(this,n,_t)})),Lt(()=>Ct("touchcancel",Ue,function(_t){Nt.call(this,n,_t)})),Lt(()=>Ct("touchend",Ue,function(_t){Nt.call(this,n,_t)})),Lt(()=>Ct("touchmove",Ue,function(_t){Nt.call(this,n,_t)},void 0,!1)),Lt(()=>Ct("touchstart",Ue,function(_t){Nt.call(this,n,_t)},void 0,!1)),Mi(()=>Mt=Br(Ue,Mt,{...De(c),...h})),$n(1,Ue,O,R),$n(2,Ue,C,Y),rt(Xe,Ue)},Re=Xe=>{var Ue=vi(),Mt=ni(Ue);{var Rt=Xt=>{var jt=EM();let si;var fi=pt(jt);zi(fi,n,"default",{get builder(){return De(c)}},null),ut(jt),Rr(jt,qt=>se(qt),()=>se()),Tr(jt,qt=>{var bi,Yt;return(Yt=(bi=De(c)).action)==null?void 0:Yt.call(bi,qt)}),Lt(()=>Ct("pointerdown",jt,function(qt){Nt.call(this,n,qt)})),Lt(()=>Ct("pointermove",jt,function(qt){Nt.call(this,n,qt)})),Lt(()=>Ct("pointerup",jt,function(qt){Nt.call(this,n,qt)})),Lt(()=>Ct("touchcancel",jt,function(qt){Nt.call(this,n,qt)})),Lt(()=>Ct("touchend",jt,function(qt){Nt.call(this,n,qt)})),Lt(()=>Ct("touchmove",jt,function(qt){Nt.call(this,n,qt)},void 0,!1)),Lt(()=>Ct("touchstart",jt,function(qt){Nt.call(this,n,qt)},void 0,!1)),Mi(()=>si=Br(jt,si,{...De(c),...h})),$n(1,jt,O,R),rt(Xt,jt)},_t=Xt=>{var jt=vi(),si=ni(jt);{var fi=bi=>{var Yt=CM();let Bi;var Qi=pt(Yt);zi(Qi,n,"default",{get builder(){return De(c)}},null),ut(Yt),Rr(Yt,hi=>se(hi),()=>se()),Tr(Yt,hi=>{var xi,ke;return(ke=(xi=De(c)).action)==null?void 0:ke.call(xi,hi)}),Lt(()=>Ct("pointerdown",Yt,function(hi){Nt.call(this,n,hi)})),Lt(()=>Ct("pointermove",Yt,function(hi){Nt.call(this,n,hi)})),Lt(()=>Ct("pointerup",Yt,function(hi){Nt.call(this,n,hi)})),Lt(()=>Ct("touchcancel",Yt,function(hi){Nt.call(this,n,hi)})),Lt(()=>Ct("touchend",Yt,function(hi){Nt.call(this,n,hi)})),Lt(()=>Ct("touchmove",Yt,function(hi){Nt.call(this,n,hi)},void 0,!1)),Lt(()=>Ct("touchstart",Yt,function(hi){Nt.call(this,n,hi)},void 0,!1)),Mi(()=>Bi=Br(Yt,Bi,{...De(c),...h})),$n(2,Yt,C,Y),rt(bi,Yt)},qt=bi=>{var Yt=vi(),Bi=ni(Yt);{var Qi=hi=>{var xi=PM();let ke;var dn=pt(xi);zi(dn,n,"default",{get builder(){return De(c)}},null),ut(xi),Rr(xi,Ii=>se(Ii),()=>se()),Tr(xi,Ii=>{var Kt,Ei;return(Ei=(Kt=De(c)).action)==null?void 0:Ei.call(Kt,Ii)}),Lt(()=>Ct("pointerdown",xi,function(Ii){Nt.call(this,n,Ii)})),Lt(()=>Ct("pointermove",xi,function(Ii){Nt.call(this,n,Ii)})),Lt(()=>Ct("pointerup",xi,function(Ii){Nt.call(this,n,Ii)})),Lt(()=>Ct("touchcancel",xi,function(Ii){Nt.call(this,n,Ii)})),Lt(()=>Ct("touchend",xi,function(Ii){Nt.call(this,n,Ii)})),Lt(()=>Ct("touchmove",xi,function(Ii){Nt.call(this,n,Ii)},void 0,!1)),Lt(()=>Ct("touchstart",xi,function(Ii){Nt.call(this,n,Ii)},void 0,!1)),Mi(()=>ke=Br(xi,ke,{...De(c),...h})),rt(hi,xi)};Vi(Bi,hi=>{_()&&hi(Qi)},!0)}rt(bi,Yt)};Vi(si,bi=>{C()&&_()?bi(fi):bi(qt,!1)},!0)}rt(Xt,jt)};Vi(Mt,Xt=>{O()&&_()?Xt(Rt):Xt(_t,!1)},!0)}rt(Xe,Ue)};Vi(He,Xe=>{O()&&C()&&_()?Xe(Ge):Xe(Re,!1)},!0)}rt(Ee,$e)};Vi(Te,Ee=>{M()&&_()?Ee(fe):Ee(Me,!1)},!0)}rt(Le,we)};Vi(de,Le=>{X()&&_()?Le(Be):Le(Fe,!1)})}rt(i,Ae),hn()}var DM=Ht("<div></div>"),LM=Ht("<div></div>"),RM=Ht("<div></div>"),BM=Ht("<div></div>"),OM=Ht("<div></div>");function FM(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","el"]);un(n,!1);const p=Ma(),b=()=>kn(se,"$overlay",p),_=()=>kn(q,"$open",p),c=Hi();let M=tt(n,"transition",24,()=>{}),B=tt(n,"transitionConfig",24,()=>{}),O=tt(n,"inTransition",24,()=>{}),R=tt(n,"inTransitionConfig",24,()=>{}),C=tt(n,"outTransition",24,()=>{}),Y=tt(n,"outTransitionConfig",24,()=>{}),X=tt(n,"asChild",8,!1),Z=tt(n,"el",28,()=>{});const{elements:{overlay:se},states:{open:q},getAttrs:te}=Sf(),ne=te("overlay");ei(()=>b(),()=>{di(c,b())}),ei(()=>De(c),()=>{Object.assign(De(c),ne)}),Or(),cn();var _e=vi(),be=ni(_e);{var Ae=Be=>{var Fe=vi(),Le=ni(Fe);zi(Le,n,"default",{get builder(){return De(c)}},null),rt(Be,Fe)},de=Be=>{var Fe=vi(),Le=ni(Fe);{var we=fe=>{var Me=DM();let Ee;Lt(()=>Ct("mouseup",Me,function($e){Nt.call(this,n,$e)})),Rr(Me,$e=>Z($e),()=>Z()),Tr(Me,$e=>{var He,Ge;return(Ge=(He=De(c)).action)==null?void 0:Ge.call(He,$e)}),Mi(()=>Ee=Br(Me,Ee,{...De(c),...h})),$n(3,Me,M,B),rt(fe,Me)},Te=fe=>{var Me=vi(),Ee=ni(Me);{var $e=Ge=>{var Re=LM();let Xe;Rr(Re,Ue=>Z(Ue),()=>Z()),Tr(Re,Ue=>{var Mt,Rt;return(Rt=(Mt=De(c)).action)==null?void 0:Rt.call(Mt,Ue)}),Lt(()=>Ct("mouseup",Re,function(Ue){Nt.call(this,n,Ue)})),Mi(()=>Xe=Br(Re,Xe,{...De(c),...h})),$n(1,Re,O,R),$n(2,Re,C,Y),rt(Ge,Re)},He=Ge=>{var Re=vi(),Xe=ni(Re);{var Ue=Rt=>{var _t=RM();let Xt;Rr(_t,jt=>Z(jt),()=>Z()),Tr(_t,jt=>{var si,fi;return(fi=(si=De(c)).action)==null?void 0:fi.call(si,jt)}),Lt(()=>Ct("mouseup",_t,function(jt){Nt.call(this,n,jt)})),Mi(()=>Xt=Br(_t,Xt,{...De(c),...h})),$n(1,_t,O,R),rt(Rt,_t)},Mt=Rt=>{var _t=vi(),Xt=ni(_t);{var jt=fi=>{var qt=BM();let bi;Rr(qt,Yt=>Z(Yt),()=>Z()),Tr(qt,Yt=>{var Bi,Qi;return(Qi=(Bi=De(c)).action)==null?void 0:Qi.call(Bi,Yt)}),Lt(()=>Ct("mouseup",qt,function(Yt){Nt.call(this,n,Yt)})),Mi(()=>bi=Br(qt,bi,{...De(c),...h})),$n(2,qt,C,Y),rt(fi,qt)},si=fi=>{var qt=vi(),bi=ni(qt);{var Yt=Bi=>{var Qi=OM();let hi;Rr(Qi,xi=>Z(xi),()=>Z()),Tr(Qi,xi=>{var ke,dn;return(dn=(ke=De(c)).action)==null?void 0:dn.call(ke,xi)}),Lt(()=>Ct("mouseup",Qi,function(xi){Nt.call(this,n,xi)})),Mi(()=>hi=Br(Qi,hi,{...De(c),...h})),rt(Bi,Qi)};Vi(bi,Bi=>{_()&&Bi(Yt)},!0)}rt(fi,qt)};Vi(Xt,fi=>{C()&&_()?fi(jt):fi(si,!1)},!0)}rt(Rt,_t)};Vi(Xe,Rt=>{O()&&_()?Rt(Ue):Rt(Mt,!1)},!0)}rt(Ge,Re)};Vi(Ee,Ge=>{O()&&C()&&_()?Ge($e):Ge(He,!1)},!0)}rt(fe,Me)};Vi(Le,fe=>{M()&&_()?fe(we):fe(Te,!1)},!0)}rt(Be,Fe)};Vi(be,Be=>{X()&&_()?Be(Ae):Be(de,!1)})}rt(i,_e),hn()}var NM=Ht("<button><!></button>");function $_(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["asChild","el"]);un(n,!1);const p=Ma(),b=()=>kn(B,"$trigger",p),_=Hi();let c=tt(n,"asChild",8,!1),M=tt(n,"el",28,()=>{});const{elements:{trigger:B},getAttrs:O}=Sf(),R=bM(),C=O("trigger");ei(()=>b(),()=>{di(_,b())}),ei(()=>De(_),()=>{Object.assign(De(_),C)}),Or(),cn();var Y=vi(),X=ni(Y);{var Z=q=>{var te=vi(),ne=ni(te);zi(ne,n,"default",{get builder(){return De(_)}},null),rt(q,te)},se=q=>{var te=NM();let ne;var _e=pt(te);zi(_e,n,"default",{get builder(){return De(_)}},null),ut(te),Rr(te,be=>M(be),()=>M()),Tr(te,be=>{var Ae,de;return(de=(Ae=De(_)).action)==null?void 0:de.call(Ae,be)}),Lt(()=>Ct("m-click",te,R)),Lt(()=>Ct("m-keydown",te,R)),Mi(()=>ne=Br(te,ne,{...De(_),type:"button",...h})),rt(q,te)};Vi(X,q=>{c()?q(Z):q(se,!1)})}rt(i,Y),hn()}function jM(i){return function(n,o){if(o===void 0)return;const h=i[n];h&&h.set(o)}}const tn={DURATION:.5,EASE:[.32,.72,0,1]},Ab=.4;function Sa(i,n){if(typeof document>"u")return()=>{};const o=VM(i,(h,p)=>({stores:h,onUnsubscribe:p})).subscribe(({stores:h,onUnsubscribe:p})=>{const b=n(h);b&&p(b)});return Mb(o),o}function VM(i,n){let o=[];const h=c=>{o.push(c)},p=()=>{o.forEach(c=>c()),o=[]},b=Vr(i,c=>(p(),n(c,h)));return Mb(p),{...b,subscribe:(...c)=>{const M=b.subscribe(...c);return()=>{M(),p()}}}}const Mb=i=>{try{d1(i)}catch{return i()}},U_=(i,n)=>{const o=(p,b)=>{i.update(_=>{const c=p(_);let M=c;return n&&(M=n({curr:_,next:c})),b==null||b(M),M})};return{...i,update:o,set:p=>{o(()=>p)}}};function $M(i){const n={};return Object.keys(i).forEach(o=>{const h=o,p=i[h];n[h]=vn(p)}),n}function UM(i,...n){const o={};for(const h of Object.keys(i))n.includes(h)||(o[h]=i[h]);return o}function WM(i){const n={};for(const o in i){const h=i[o];h!==void 0&&(n[o]=h)}return n}const Ib=new WeakMap;function on(i,n,o=!1){if(!i||!(i instanceof HTMLElement)||!n)return;const h={};Object.entries(n).forEach(([p,b])=>{if(p.startsWith("--")){i.style.setProperty(p,b);return}h[p]=i.style[p],i.style[p]=b}),!o&&Ib.set(i,h)}function $u(i,n){if(!i||!(i instanceof HTMLElement))return;const o=Ib.get(i);o&&(n?i.style[n]=o[n]:Object.entries(o).forEach(([h,p])=>{i.style[h]=p}))}function Vd(i,n){const o=window.getComputedStyle(i),h=o.transform||o.webkitTransform||o.mozTransform;let p=h.match(/^matrix3d\((.+)\)$/);return p?parseFloat(p[1].split(", ")[Vn(n)?13:12]):(p=h.match(/^matrix\((.+)\)$/),p?parseFloat(p[1].split(", ")[Vn(n)?5:4]):null)}function HM(i){return Object.keys(i).reduce((n,o)=>i[o]===void 0?n:n+`${o}:${i[o]};`,"")}function _g(){}function eo(i,n,o,h){const p=Array.isArray(n)?n:[n];return p.forEach(b=>i.addEventListener(b,o,h)),()=>{p.forEach(b=>i.removeEventListener(b,o,h))}}const qM=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]),GM=typeof document<"u";function nf(i){return i instanceof HTMLInputElement&&!qM.has(i.type)||i instanceof HTMLTextAreaElement||i instanceof HTMLElement&&i.isContentEditable}function Vn(i){return i==="top"||i==="bottom"}function W_(i){return i==="bottom"||i==="right"}function rf(...i){return(...n)=>{for(const o of i)typeof o=="function"&&o(...n)}}function ZM(i){return new Promise(n=>setTimeout(n,i))}function XM({activeSnapPoint:i,snapPoints:n,drawerRef:o,overlayRef:h,fadeFromIndex:p,openTime:b,direction:_}){const c=Vr([n,i],([q,te])=>te===(q==null?void 0:q[q.length-1])),M=Vr([n,p,i],([q,te,ne])=>q&&q.length>0&&(te||te===0)&&!Number.isNaN(te)&&q[te]===ne||!q),B=Vr([n,i],([q,te])=>(q==null?void 0:q.findIndex(ne=>ne===te))??null),O=Vr(n,q=>q?q.map(te=>{const ne=typeof window<"u",_e=typeof te=="string";let be=0;_e&&(be=parseInt(te,10));const Ae=ot(_);if(Vn(Ae)){const Be=_e?be:ne?te*window.innerHeight:0;return ne?Ae==="bottom"?window.innerHeight-Be:window.innerHeight+Be:Be}const de=_e?be:ne?te*window.innerWidth:0;return ne?Ae==="right"?window.innerWidth-de:window.innerWidth+de:de}):[]),R=Vr([O,B],([q,te])=>te!==null?q==null?void 0:q[te]:null);Sa([i,o],([q,te])=>{if(q&&te){const ne=ot(n),_e=ot(O),be=(ne==null?void 0:ne.findIndex(Ae=>Ae===q))??-1;_e&&be!==-1&&typeof _e[be]=="number"&&C(_e[be])}});function C(q){xf().then(()=>{const te=ot(O),ne=(te==null?void 0:te.findIndex(Be=>Be===q))??null,_e=ot(o),be=ot(_);se(ne),on(_e,{transition:`transform ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`,transform:Vn(be)?`translate3d(0, ${q}px, 0)`:`translate3d(${q}px, 0, 0)`});const Ae=ot(p),de=ot(h);ne!==te.length-1&&ne!==Ae?on(de,{transition:`opacity ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`,opacity:"0"}):on(de,{transition:`opacity ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`,opacity:"1"}),i.update(()=>{const Be=ot(n);return ne===null||!Be?null:Be[ne]})})}function Y({draggedDistance:q,closeDrawer:te,velocity:ne,dismissible:_e}){const be=ot(p);if(be===void 0)return;const Ae=ot(R),de=ot(B),Be=ot(h),Fe=ot(O),Le=ot(n),we=ot(_),Te=we==="bottom"||we==="right"?(Ae??0)-q:(Ae??0)+q,fe=de===be-1,Me=de===0,Ee=q>0;if(fe&&on(Be,{transition:`opacity ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`}),ne>2&&!Ee){_e?te():C(Fe[0]);return}if(ne>2&&Ee&&Fe&&Le){C(Fe[Le.length-1]);return}const $e=Fe==null?void 0:Fe.reduce((Ge,Re)=>typeof Ge!="number"||typeof Re!="number"?Ge:Math.abs(Re-Te)<Math.abs(Ge-Te)?Re:Ge),He=Vn(we)?window.innerHeight:window.innerWidth;if(ne>Ab&&Math.abs(q)<He*.4){const Ge=Ee?1:-1;if(Ge>0&&ot(c)&&Le){C(Fe[Le.length-1]);return}if(Me&&Ge<0&&_e&&te(),de===null)return;C(Fe[de+Ge]);return}C($e)}function X({draggedDistance:q}){const te=ot(o),ne=ot(R);if(ne===null)return;const _e=ot(O),be=ot(_),Ae=be==="bottom"||be==="right"?ne-q:ne+q,de=_e[_e.length-1];W_(be)&&Ae<de||!W_(be)&&Ae>de||on(te,{transform:Vn(be)?`translate3d(0, ${Ae}px, 0)`:`translate3d(${Ae}px, 0, 0)`})}function Z(q,te){const ne=ot(B),_e=ot(O),be=ot(n),Ae=ot(p);if(!be||typeof ne!="number"||!_e||Ae===void 0)return null;const de=ne===Ae-1;if(ne>=Ae&&te)return 0;if(de&&!te)return 1;if(!ot(M)&&!de)return null;const Fe=de?ne+1:ne-1,Le=de?_e[Fe]-_e[Fe-1]:_e[Fe+1]-_e[Fe],we=q/Math.abs(Le);return de?1-we:we}function se(q){const te=ot(n),ne=ot(O);te&&q===ne.length-1&&b.set(new Date)}return{isLastSnapPoint:c,shouldFade:M,getPercentageDragged:Z,activeSnapPointIndex:B,onRelease:Y,onDrag:X,snapPointsOffset:O}}function YM(){return i0(/^Mac/)}function KM(){return i0(/^iPhone/)}function JM(){return i0(/^iPad/)||YM()&&navigator.maxTouchPoints>1}function Eb(){return KM()||JM()}function i0(i){return typeof window<"u"&&window.navigator!=null?i.test(window.navigator.platform):void 0}const Sm=typeof document<"u"&&window.visualViewport;function H_(i){const n=window.getComputedStyle(i);return/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY)}function Cb(i){for(H_(i)&&(i=i.parentElement);i&&!H_(i);)i=i.parentElement;return i||document.scrollingElement||document.documentElement}let $d=0,km;function QM(){return typeof document>"u"?()=>{}:($d++,$d===1&&(Eb()?km=n3():km=i3()),()=>{$d--,$d===0&&km()})}function e3(i){const n=i.getBoundingClientRect().left;return Math.round(n)+i.scrollLeft?"paddingLeft":"paddingRight"}function t3(i,n,o){if(!i)return;const h=i.style.getPropertyValue(n);return i.style.setProperty(n,o),()=>{h?i.style.setProperty(n,h):i.style.removeProperty(n)}}function i3(){if(typeof document>"u")return()=>{};const i=document.defaultView??window,{documentElement:n,body:o}=document,h=i.innerWidth-n.clientWidth,p=()=>t3(n,"--scrollbar-width",`${h}px`),b=e3(n),_=i.getComputedStyle(o)[b];return rf(p(),af(o,b,`calc(${_} + ${h}px)`),af(o,"overflow","hidden"))}function n3(){let i,n=0;const{documentElement:o,body:h,activeElement:p}=document;function b(X){i=Cb(X.target),!(i===o&&i===h)&&(n=X.changedTouches[0].pageY)}function _(X){if(!i||i===o||i===h){X.preventDefault();return}const Z=X.changedTouches[0].pageY,se=i.scrollTop,q=i.scrollHeight-i.clientHeight;q!==0&&((se<=0&&Z>n||se>=q&&Z<n)&&X.preventDefault(),n=Z)}function c(X){const Z=X.target;nf(Z)&&Z!==p&&(X.preventDefault(),Z.style.transform="translateY(-2000px)",Z.focus(),requestAnimationFrame(()=>{Z.style.transform=""}))}function M(X){const Z=X.target;nf(Z)&&(Z.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{Z.style.transform="",Sm&&(Sm.height<window.innerHeight?requestAnimationFrame(()=>{q_(Z)}):Sm.addEventListener("resize",()=>q_(Z),{once:!0}))}))}function B(){window.scrollTo(0,0)}const O=window.pageXOffset,R=window.pageYOffset,C=rf(af(o,"paddingRight",`${window.innerWidth-o.clientWidth}px`),af(o,"overflow","hidden"));window.scrollTo(0,0);const Y=rf(eo(document,"touchstart",b,{passive:!1,capture:!0}),eo(document,"touchmove",_,{passive:!1,capture:!0}),eo(document,"touchend",c,{passive:!1,capture:!0}),eo(document,"focus",M,!0),eo(window,"scroll",B));return()=>{C(),Y(),window.scrollTo(O,R)}}function af(i,n,o){const h=i.style[n];return i.style[n]=o,()=>{i.style[n]=h}}function q_(i){const{documentElement:n,body:o,scrollingElement:h}=document,p=h||n;for(;i&&i!==p;){const b=Cb(i);if(b!==n&&b!==o&&b!==i){const _=b.getBoundingClientRect().top,c=i.getBoundingClientRect().top,M=i.getBoundingClientRect().bottom,B=b.getBoundingClientRect().bottom;M>B&&(b.scrollTop+=c-_)}i=b.parentElement}}const r3=ro(void 0,i=>{function n(h){h&&h.key==="Escape"&&i(h),i(void 0)}return eo(document,"keydown",n,{passive:!1})});function a3(i,n){let o=_g;function h(p){o(),o=rf(r3.subscribe(b=>{if(!b)return;const _=b.target;!s3(_)||_.closest("[data-escapee]")!==i||(b.preventDefault(),p(b))})),i.setAttribute("data-escapee","")}return h(n),()=>{o(),i.removeAttribute("data-escapee")}}function s3(i){return i instanceof HTMLElement}let Zs=null;function o3({isOpen:i,modal:n,nested:o,hasBeenOpened:h}){const p=vn(typeof window<"u"?window.location.href:"");let b=0;function _(M){if(!(Zs===null&&M))return;Zs={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height};const{scrollX:B,innerHeight:O}=window;document.body.style.setProperty("position","fixed","important"),document.body.style.top=`${-b}px`,document.body.style.left=`${-B}px`,document.body.style.right="0px",document.body.style.height="auto",setTimeout(()=>requestAnimationFrame(()=>{const R=O-window.innerHeight;R&&b>=O&&(document.body.style.top=`${-(b+R)}px`)}),300)}function c(){if(Zs===null)return;const M=ot(p),B=-parseInt(document.body.style.top,10),O=-parseInt(document.body.style.left,10);document.body.style.position=Zs.position,document.body.style.top=Zs.top,document.body.style.left=Zs.left,document.body.style.height=Zs.height,document.body.style.right="unset",requestAnimationFrame(()=>{if(M!==window.location.href){p.set(window.location.href);return}window.scrollTo(O,B)}),Zs=null}return ph(()=>{function M(){b=window.scrollY}return M(),eo(window,"scroll",M),()=>{}}),Sa([i,p],([M,B])=>{typeof document>"u"||ot(o)||!ot(h)||(M?(_(M),ot(n)||setTimeout(()=>{c()},500)):c())}),{restorePositionSetting:c}}const l3=.25,c3=100,G_=8,Yo=16,Pb=26,Z_="vaul-dragging",Am=vn([]),u3={closeThreshold:l3,shouldScaleBackground:!0,scrollLockTimeout:c3,onDrag:void 0,onRelease:void 0,snapPoints:void 0,fadeFromIndex:void 0,defaultActiveSnapPoint:void 0,onActiveSnapPointChange:void 0,defaultOpen:!1,onOpenChange:void 0,fixed:void 0,dismissible:!0,modal:!0,nested:!1,onClose:void 0,direction:"bottom"},h3=["defaultOpen","onOpenChange","defaultActiveSnapPoint","onActiveSnapPointChange","onDrag","onRelease","onClose"];function d3(i){var Qn;const{snapPoints:n,fadeFromIndex:o=n&&n.length-1,...h}={...u3,...WM(i)},p=$M(UM({...h,snapPoints:n,fadeFromIndex:o},...h3)),b=vn(void 0),{onDrag:_,onRelease:c,onClose:M,onOpenChange:B}=h,{snapPoints:O,fadeFromIndex:R,fixed:C,dismissible:Y,modal:X,nested:Z,shouldScaleBackground:se,scrollLockTimeout:q,closeThreshold:te,direction:ne}=p,_e=vn(h.defaultOpen),be=U_(_e,h.onOpenChange),Ae=vn(!1),de=vn(!1),Be=vn(!1),Fe=vn(void 0),Le=vn(null),we=vn(!1),Te=vn(void 0),fe=vn(void 0);let Me=!1,Ee=null,$e=!1,He=0,Ge=null,Re=null,Xe=!1,Ue=((Qn=ot(Te))==null?void 0:Qn.getBoundingClientRect().height)||0,Mt=0,Rt=0,_t=null;const Xt=U_(vn(h.defaultActiveSnapPoint),h.onActiveSnapPointChange),{activeSnapPointIndex:jt,getPercentageDragged:si,onDrag:fi,onRelease:qt,shouldFade:bi,snapPointsOffset:Yt}=XM({snapPoints:O,activeSnapPoint:Xt,drawerRef:Te,fadeFromIndex:R,overlayRef:Fe,openTime:Le,direction:ne}),Bi=Vr([Yt],([xt])=>(Tt="")=>{if(xt&&xt.length>0){const ze=HM({"--snap-point-height":`${xt[0]}px`});return Tt+ze}return Tt});Sa([Te],([xt])=>{xt&&fe.set(xt.id)}),Sa([be],([xt])=>{ZM(100).then(()=>{const Tt=ot(fe);xt&&Tt?Am.update(ze=>(ze.includes(Tt)||ze.push(Tt),ze)):Am.update(ze=>ze.filter(Vt=>Vt!==Vt))})}),Sa([be],([xt])=>{if(!xt&&ot(se)){const Tt=setTimeout(()=>{$u(document.body,"background")},200);return()=>clearTimeout(Tt)}}),Sa([be],([xt])=>{let Tt=()=>{};return xt&&(Tt=QM()),Tt});const{restorePositionSetting:Qi}=o3({isOpen:be,modal:X,nested:Z,hasBeenOpened:Ae});Sa([Te],([xt])=>{let Tt=_g;return xt&&(Tt=a3(xt,()=>{Kt(!0)})),()=>{Tt()}});function hi(){$e||(Ae.set(!0),be.set(!0))}function xi(xt){const Tt=ot(Te);!ot(Y)&&!ot(O)||Tt&&!Tt.contains(xt.target)||(Ue=(Tt==null?void 0:Tt.getBoundingClientRect().height)||0,Me=!0,Ee=new Date,Eb()&&window.addEventListener("touchend",()=>Xe=!1,{once:!0}),xt.target.setPointerCapture(xt.pointerId),He=Vn(ot(ne))?xt.screenY:xt.screenX)}function ke(xt,Tt){var Di;const ze=ot(Te);let Vt=xt;const Ut=(Di=window.getSelection())==null?void 0:Di.toString(),Qt=ot(ne),Oi=ze?Vd(ze,Qt):null,qe=new Date;if(Vt.hasAttribute("data-vaul-no-drag")||Vt.closest("[data-vaul-no-drag]"))return!1;const Dt=ot(Le);if(Dt&&qe.getTime()-Dt.getTime()<500)return!1;if(Oi!==null&&(Qt==="bottom"||Qt==="right"?Oi>0:Oi<0)||Oi!==null&&Oi>0)return!0;if(Ut&&Ut.length>0)return!1;const kt=ot(q);if(Re&&qe.getTime()-Re.getTime()<kt&&Oi===0||Tt)return Re=qe,!1;for(;Vt;){if(Vt.scrollHeight>Vt.clientHeight){if(Vt.scrollTop!==0)return Re=new Date,!1;if(Vt.getAttribute("role")==="dialog")return!0}Vt=Vt.parentNode}return!0}function dn(xt){const Tt=ot(Te);if(!Tt||!Me)return;const ze=ot(ne),Vt=Y_(ze),Ut=X_(He,ze,xt)*Vt,Qt=Ut>0,Oi=ot(jt),qe=ot(O);if(qe&&Oi===0&&!ot(Y)||!Xe&&!ke(xt.target,Qt))return;Tt.classList.add(Z_),Xe=!0,on(Tt,{transition:"none"});const Dt=ot(Fe);if(on(Dt,{transition:"none"}),qe&&fi({draggedDistance:Ut}),Qt&&!qe){const En=f3(Ut),ie=Math.min(En*-1,0)*Vt;on(Tt,{transform:Vn(ze)?`translate3d(0, ${ie}px, 0)`:`translate3d(${ie}px, 0, 0)`});return}const kt=Math.abs(Ut);let Di=kt/Ue;const Fn=si(kt,Qt);Fn!==null&&(Di=Fn);const Bt=1-Di,An=ot(R);(ot(bi)||An&&Oi===An-1)&&(_==null||_(xt,Di),on(Dt,{opacity:`${Bt}`,transition:"none"},!0));const Ur=document.querySelector("[data-vaul-drawer-wrapper]");if(Ur&&Dt&&ot(se)){const En=Math.min(oc()+Di*(1-oc()),1),ie=8-Di*8,F=Math.max(0,14-Di*14);on(Ur,{borderRadius:`${ie}px`,transform:Vn(ze)?`scale(${En}) translate3d(0, ${F}px, 0)`:`scale(${En}) translate3d(${F}px, 0, 0)`,transition:"none"},!0)}if(!qe){const En=kt*Vt;on(Tt,{transform:Vn(ze)?`translate3d(0, ${En}px, 0)`:`translate3d(${En}px, 0, 0)`})}}function Ii(xt,Tt="black"){const ze=document.querySelector("[data-vaul-drawer-wrapper]");if(!ze||!ot(se))return;const Vt=ot(ne);xt?(on(document.body,{background:document.body.style.backgroundColor||document.body.style.background}),on(document.body,{background:Tt},!0),on(ze,{borderRadius:`${G_}px`,overflow:"hidden",...Vn(Vt)?{transform:`scale(${oc()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${oc()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${tn.DURATION}s`,transitionTimingFunction:`cubic-bezier(${tn.EASE.join(",")})`})):($u(ze,"overflow"),$u(ze,"transform"),$u(ze,"borderRadius"),on(ze,{transitionProperty:"transform, border-radius",transitionDuration:`${tn.DURATION}s`,transitionTimingFunction:`cubic-bezier(${tn.EASE.join(",")})`}))}Sa([jt,O,Yt],([xt,Tt,ze])=>{function Vt(){var Dt;const Qt=ot(Te);if(!Qt)return;const Oi=ot(we),qe=document.activeElement;if(nf(qe)||Oi){const kt=((Dt=window.visualViewport)==null?void 0:Dt.height)||0;let Di=window.innerHeight-kt;const Fn=Qt.getBoundingClientRect().height||0;Rt||(Rt=Fn);const Bt=Qt.getBoundingClientRect().top;if(Math.abs(Mt-Di)>60&&we.set(!Oi),Tt&&Tt.length>0&&ze&&xt){const An=ze[xt]||0;Di+=An}if(Mt=Di,Fn>kt||Oi){const An=Qt.getBoundingClientRect().height;let Ar=An;An>kt&&(Ar=kt-Pb),ot(C)?Qt.style.height=`${An-Math.max(Di,0)}px`:Qt.style.height=`${Math.max(Ar,kt-Bt)}px`}else Qt.style.height=`${Rt}px`;Tt&&Tt.length>0&&!Oi?Qt.style.bottom="0px":Qt.style.bottom=`${Math.max(Di,0)}px`}}let Ut=_g;return window.visualViewport&&(Ut=eo(window.visualViewport,"resize",Vt)),()=>{Ut()}});function Kt(xt=!1){if($e)return;const Tt=ot(Te);if(!Tt)return;const ze=ot(ne);M==null||M(),on(Tt,{transform:Vn(ze)?`translate3d(0, ${ze==="bottom"?"100%":"-100%"}, 0)`:`translate3d(${ze==="right"?"100%":"-100%"}, 0, 0)`,transition:`transform ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`}),on(ot(Fe),{opacity:"0",transition:`opacity ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`}),Ii(!1),$e=!0,setTimeout(()=>{var Ut;de.set(!1),be.set(!1),$e=!1,xt&&((Ut=ot(b))==null||Ut.focus())},300);const Vt=ot(O);setTimeout(()=>{$u(document.documentElement,"scrollBehavior"),Vt&&Xt.set(Vt[0])},tn.DURATION*1e3)}Sa([be],([xt])=>{xt?Ae.set(!0):Kt()});function Ei(){const xt=ot(Te);if(!xt)return;const Tt=ot(Fe),ze=document.querySelector("[data-vaul-drawer-wrapper]"),Vt=ot(ne),Ut=Vd(xt,Vt);on(xt,{transform:"translate3d(0, 0, 0)",transition:`transform ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`}),on(Tt,{transition:`opacity ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`,opacity:"1"});const Qt=ot(se),Oi=ot(be);Qt&&Ut&&Ut>0&&Oi&&on(ze,{borderRadius:`${G_}px`,overflow:"hidden",...Vn(Vt)?{transform:`scale(${oc()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${oc()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${tn.DURATION}s`,transitionTimingFunction:`cubic-bezier(${tn.EASE.join(",")})`},!0)}function dr(xt){var Dt;const Tt=ot(Te);if(!Me||!Tt)return;Xe&&nf(xt.target)&&xt.target.blur(),Tt.classList.remove(Z_),Xe=!1,Me=!1,Ge=new Date;const ze=ot(ne),Vt=Vd(Tt,ze);if(xt.target&&!ke(xt.target,!1)||!Vt||Number.isNaN(Vt)||Ee===null)return;const Ut=Ge.getTime()-Ee.getTime(),Qt=X_(He,ze,xt),Oi=Math.abs(Qt)/Ut;if(Oi>.05&&(Be.set(!0),setTimeout(()=>{Be.set(!1)},200)),ot(O)){qt({draggedDistance:Qt*Y_(ze),closeDrawer:Kt,velocity:Oi,dismissible:ot(Y)}),c==null||c(xt,!0);return}if(ze==="bottom"||ze==="right"?Qt>0:Qt<0){Ei(),c==null||c(xt,!0);return}if(Oi>Ab){Kt(),c==null||c(xt,!1);return}const qe=Math.min(((Dt=ot(Te))==null?void 0:Dt.getBoundingClientRect().height)??0,window.innerHeight);if(Vt>=qe*ot(te)){Kt(),c==null||c(xt,!1);return}c==null||c(xt,!0),Ei()}Sa([be],([xt])=>{xt&&(GM&&on(document.documentElement,{scrollBehavior:"auto"}),Le.set(new Date),Ii(!0,i.backgroundColor))}),Sa([de],([xt])=>{if(!xt)return;const Tt=ot(Te);if(!Tt)return;Tt.querySelectorAll("*").forEach(Vt=>{const Ut=Vt;(Ut.scrollHeight>Ut.clientHeight||Ut.scrollWidth>Ut.clientWidth)&&Ut.classList.add("vaul-scrollable")})});function bn(xt){const Tt=ot(Te),ze=xt?(window.innerWidth-Yo)/window.innerWidth:1,Vt=xt?-Yo:0;_t&&window.clearTimeout(_t),on(Tt,{transition:`transform ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`,transform:`scale(${ze}) translate3d(0, ${Vt}px, 0)`}),!xt&&Tt&&(_t=setTimeout(()=>{const Ut=ot(ne),Qt=Vd(Tt,Ut);on(Tt,{transition:"none",transform:Vn(Ut)?`translate3d(0, ${Qt}px, 0)`:`translate3d(${Qt}px, 0, 0)`})},500))}function Jn(xt,Tt){if(Tt<0)return;const ze=(window.innerWidth-Yo)/window.innerWidth,Vt=ze+Tt*(1-ze),Ut=-Yo+Tt*Yo,Qt=ot(ne);on(ot(Te),{transform:Vn(Qt)?`scale(${Vt}) translate3d(0, ${Ut}px, 0)`:`scale(${Vt}) translate3d(${Ut}px, 0, 0)`,transition:"none"})}function Ia(xt,Tt){const ze=ot(ne),Vt=Vn(ze)?window.innerHeight:window.innerWidth,Ut=Tt?(Vt-Yo)/Vt:1,Qt=Tt?-Yo:0;Tt&&on(ot(Te),{transition:`transform ${tn.DURATION}s cubic-bezier(${tn.EASE.join(",")})`,transform:Vn(ze)?`scale(${Ut}) translate3d(0, ${Qt}px, 0)`:`scale(${Ut}) translate3d(${Qt}px, 0, 0)`})}return{states:{isOpen:be,hasBeenOpened:Ae,snapPoints:O,activeSnapPoint:Xt,snapPointsOffset:Yt,keyboardIsOpen:we,shouldFade:bi,visible:de,drawerId:fe,openDrawerIds:Am},helpers:{getContentStyle:Bi},methods:{closeDrawer:Kt,onOpenChange:B,onPress:xi,onRelease:dr,onDrag:dn,scaleBackground:Ii,onNestedDrag:Jn,onNestedOpenChange:bn,onNestedRelease:Ia,restorePositionSetting:Qi,openDrawer:hi},refs:{drawerRef:Te,overlayRef:Fe,triggerRef:b},options:p}}function f3(i){return 8*(Math.log(i+1)-2)}function oc(){return(window.innerWidth-Pb)/window.innerWidth}function X_(i,n,o){return o.type.startsWith("touch")?m3(i,n,o):p3(i,n,o)}function p3(i,n,o){return i-(Vn(n)?o.screenY:o.screenX)}function m3(i,n,o){return i-(Vn(n)?o.changedTouches[0].screenY:o.changedTouches[0].screenX)}function Y_(i){return i==="bottom"||i==="right"?1:-1}const zb=Symbol("VAUL_ROOT");function g3(i={}){const n=d3(i),o=jM(n.options);return u1(zb,{...n,updateOption:o}),{...n,updateOption:o}}function yh(){return Wg(zb)}function y3(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["open","onOpenChange","closeThreshold","scrollLockTimeout","snapPoints","fadeFromIndex","openFocus","onOutsideClick","closeOnOutsideClick","backgroundColor","nested","shouldScaleBackground","activeSnapPoint","onActiveSnapPointChange","onRelease","onDrag","onClose","dismissible","direction"]);un(n,!1);const p=Ma(),b=()=>kn(Ee,"$isOpen",p),_=()=>kn(we,"$keyboardIsOpen",p),c=()=>kn(Ge,"$localDismissible",p);let M=tt(n,"open",12,!1),B=tt(n,"onOpenChange",24,()=>{}),O=tt(n,"closeThreshold",24,()=>{}),R=tt(n,"scrollLockTimeout",24,()=>{}),C=tt(n,"snapPoints",24,()=>{}),Y=tt(n,"fadeFromIndex",24,()=>{}),X=tt(n,"openFocus",24,()=>{}),Z=tt(n,"onOutsideClick",24,()=>{}),se=tt(n,"closeOnOutsideClick",8,!0),q=tt(n,"backgroundColor",8,"black"),te=tt(n,"nested",8,!1),ne=tt(n,"shouldScaleBackground",8,!1),_e=tt(n,"activeSnapPoint",28,()=>{}),be=tt(n,"onActiveSnapPointChange",24,()=>{}),Ae=tt(n,"onRelease",24,()=>{}),de=tt(n,"onDrag",24,()=>{}),Be=tt(n,"onClose",24,()=>{}),Fe=tt(n,"dismissible",24,()=>{}),Le=tt(n,"direction",8,"bottom");const{states:{keyboardIsOpen:we,activeSnapPoint:Te,drawerId:fe,openDrawerIds:Me,isOpen:Ee},methods:{closeDrawer:$e,openDrawer:He},options:{dismissible:Ge},updateOption:Re}=g3({defaultOpen:M(),defaultActiveSnapPoint:_e(),onOpenChange:({next:Xe})=>{var Ue;return M()!==Xe&&((Ue=B())==null||Ue(Xe),M(Xe)),Xe},onActiveSnapPointChange:({next:Xe})=>{var Ue,Mt;if(Xe===void 0&&C()&&_e()!==Xe){const Rt=C()[0];return(Ue=be())==null||Ue(Rt),_e(Rt),Rt}return _e()!==Xe&&((Mt=be())==null||Mt(Xe),_e(Xe)),Xe},closeThreshold:O(),scrollLockTimeout:R(),snapPoints:C(),fadeFromIndex:Y(),nested:te(),onDrag:de(),onClose:Be(),onRelease:Ae(),shouldScaleBackground:ne(),backgroundColor:q(),dismissible:Fe(),direction:Le()});ei(()=>Ai(_e()),()=>{_e()!==void 0&&Te.set(_e())}),ei(()=>Ai(O()),()=>{Re("closeThreshold",O())}),ei(()=>Ai(R()),()=>{Re("scrollLockTimeout",R())}),ei(()=>Ai(C()),()=>{Re("snapPoints",C())}),ei(()=>Ai(Y()),()=>{Re("fadeFromIndex",Y())}),ei(()=>Ai(X()),()=>{Re("openFocus",X())}),ei(()=>Ai(ne()),()=>{Re("shouldScaleBackground",ne())}),ei(()=>Ai(q()),()=>{Re("backgroundColor",q())}),ei(()=>Ai(Fe()),()=>{Re("dismissible",Fe())}),ei(()=>Ai(Le()),()=>{Re("direction",Le())}),ei(()=>(Ai(M()),b()),()=>{M()&&!b()&&He()}),ei(()=>(Ai(M()),b()),()=>{!M()&&b()&&$e()}),Or(),cn(),SM(i,$r({get closeOnOutsideClick(){return se()},closeOnEscape:!1,preventScroll:!1,onOpenChange:Xe=>{var Ue;(Ue=B())==null||Ue(Xe),Xe?Xe&&He():$e()},onOutsideClick:Xe=>{var Rt,_t;if(!se()||((Rt=Z())==null||Rt(Xe),Xe!=null&&Xe.defaultPrevented)||(_()&&we.set(!1),Xe.preventDefault(),!c()))return;const Ue=ot(Me);Ue[Ue.length-1]===ot(fe)&&((_t=B())==null||_t(!1),$e())}},()=>h,{get open(){return M()},set open(Xe){M(Xe)},children:(Xe,Ue)=>{var Mt=vi(),Rt=ni(Mt);zi(Rt,n,"default",{},null),rt(Xe,Mt)},$$slots:{default:!0},$$legacy:!0})),hn()}function _3(i,n){un(n,!1);const{states:{visible:o},methods:{scaleBackground:h,restorePositionSetting:p}}=yh();ph(()=>(o.set(!0),()=>{h(!1),p()})),cn(),hn()}var v3=Ht("<!> <!>",1);function b3(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["style"]);un(n,!1);const p=Ma(),b=()=>kn(B,"$drawerRef",p),_=()=>kn(R,"$getContentStyle",p),c=()=>kn(Z,"$direction",p),M=()=>kn(O,"$visible",p),{refs:{drawerRef:B},states:{visible:O},helpers:{getContentStyle:R},methods:{onPress:C,onDrag:Y,onRelease:X},options:{direction:Z}}=yh();let se=tt(n,"style",8,"");cn();var q=ur(()=>_()(se())),te=ur(()=>M()?"true":"false");zM(i,$r({get style(){return De(q)},"data-vaul-drawer":"",get"data-vaul-drawer-direction"(){return c()},get"data-vaul-drawer-visible"(){return De(te)}},()=>h,{get el(){return h1(),b()},set el(ne){rh(B,ne)},$$events:{pointerdown:ne=>{C(ne)},pointerup:ne=>{X(ne)},pointermove:ne=>{Y(ne)},touchend:ne=>{X(ne)},touchmove:ne=>{Y(ne)}},children:(ne,_e)=>{var be=v3(),Ae=ni(be);_3(Ae,{});var de=Wt(Ae,2);zi(de,n,"default",{},null),rt(ne,be)},$$slots:{default:!0},$$legacy:!0})),hn()}function x3(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,[]);un(n,!1);const p=Ma(),b=()=>kn(X,"$snapPoints",p),_=()=>kn(R,"$overlayRef",p),c=()=>kn(Y,"$visible",p),M=()=>kn(C,"$isOpen",p),B=()=>kn(Z,"$shouldFade",p),O=Hi(),{refs:{overlayRef:R},states:{isOpen:C,visible:Y,snapPoints:X,shouldFade:Z},methods:{onRelease:se}}=yh();ei(()=>b(),()=>{di(O,b()&&b().length>0)}),Or(),cn();var q=ur(()=>c()?"true":"false"),te=ur(()=>M()&&De(O)?"true":"false"),ne=ur(()=>M()&&B()?"true":"false");FM(i,$r({get"data-vaul-drawer-visible"(){return De(q)},"data-vaul-overlay":"",get"data-vaul-snap-points"(){return De(te)},get"data-vaul-snap-points-overlay"(){return De(ne)}},()=>h,{get el(){return h1(),_()},set el(_e){rh(R,_e)},$$events:{mouseup:se},$$legacy:!0})),hn()}function w3(i,n){un(n,!1);const o=Hi(),h=Hi();let p=tt(n,"meltBuilder",8);const{refs:{triggerRef:b}}=yh(),_=B=>(b.set(B),De(o)(B));ei(()=>(De(o),De(h),Ai(p())),()=>{(B=>(di(o,B.action),di(h,uT(B,["action"]))))(p())}),ei(()=>De(h),()=>{Object.assign(De(h),{action:_})}),Or(),cn();var c=vi(),M=ni(c);zi(M,n,"default",{get newBuilder(){return De(h)}},null),rt(i,c),hn()}function T3(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]),h=Ji(o,["el","asChild"]);un(n,!1);const{refs:{triggerRef:p}}=yh();let b=tt(n,"el",28,()=>{}),_=tt(n,"asChild",8,!1);ei(()=>Ai(b()),()=>{b()&&p.set(b())}),Or(),cn();var c=vi(),M=ni(c);{var B=R=>{$_(R,$r({get asChild(){return _()}},()=>h,{get el(){return b()},set el(C){b(C)},$$events:{click(C){Nt.call(this,n,C)},keydown(C){Nt.call(this,n,C)}},children:om,$$slots:{default:(C,Y)=>{const X=ur(()=>Y.builder);w3(C,{get meltBuilder(){return De(X)},children:om,$$slots:{default:(Z,se)=>{const q=ur(()=>se.newBuilder);var te=vi(),ne=ni(te);zi(ne,n,"default",{get builder(){return De(q)}},null),rt(Z,te)}}})}},$$legacy:!0}))},O=R=>{$_(R,$r(()=>h,{get el(){return b()},set el(C){b(C)},$$events:{click(C){Nt.call(this,n,C)},keydown(C){Nt.call(this,n,C)}},children:om,$$slots:{default:(C,Y)=>{const X=ur(()=>Y.builder);var Z=vi(),se=ni(Z);zi(se,n,"default",{get builder(){return De(X)}},null),rt(C,Z)}},$$legacy:!0}))};Vi(M,R=>{_()?R(B):R(O,!1)})}rt(i,c),hn()}const S3=AM;function K_(i){return i<.5?4*i*i*i:.5*Math.pow(2*i-2,3)+1}function J_(i){return i*i}const k3=i=>i;function A3(i){const n=i-1;return n*n*n+1}function sf(i,{delay:n=0,duration:o=400,easing:h=k3}={}){const p=+getComputedStyle(i).opacity;return{delay:n,duration:o,easing:h,css:b=>`opacity: ${b*p}`}}function Q_(i,{delay:n=0,duration:o=400,easing:h=A3,start:p=0,opacity:b=0}={}){const _=getComputedStyle(i),c=+_.opacity,M=_.transform==="none"?"":_.transform,B=1-p,O=c*(1-b);return{delay:n,duration:o,easing:h,css:(R,C)=>`
			transform: ${M} scale(${1-B*C});
			opacity: ${c-O*C}
		`}}function Db(i,n,o){i=+i,n=+n,o=(p=arguments.length)<2?(n=i,i=0,1):p<3?1:+o;for(var h=-1,p=Math.max(0,Math.ceil((n-i)/o))|0,b=new Array(p);++h<p;)b[h]=i+h*o;return b}function M3(i){return new Promise(n=>setTimeout(n,i))}function Mm(i,n={restoreFocus:!1,delay:0,disabled:!1}){if(!n.disabled){let o=document.activeElement;return i.tabIndex=-1,M3(n.delay??0).then(()=>{i.focus()}),{destroy(){!n.disabled&&n.restoreFocus&&o instanceof HTMLElement&&o.focus()}}}return{}}const dc=(i,n)=>{const o={fallbackTarget:i.closest(".PortalTarget")??document.querySelector(".PortalTarget"),originalParent:i.parentElement};let h=ev(i,n,o);return{update(p){h=ev(i,p,o)},destroy(){h&&i.parentElement===h&&h.removeChild(i)}}};function ev(i,n={},o){var b;if((typeof n=="boolean"?n:n.enabled)===!1)return o.originalParent!==i.parentElement&&((b=o.originalParent)==null||b.appendChild(i)),o.originalParent;const p=I3(n,o.fallbackTarget);return p==null||p.appendChild(i),p}function I3(i={},n){const o=typeof i=="object"?i.target:void 0;return o instanceof HTMLElement?o:typeof o=="string"?document.querySelector(o):n??document.body}const Im=(i,n)=>{function p(c){const M=c.currentTarget??c.target;if(!M)return;const{clientWidth:B,clientHeight:O,scrollWidth:R,scrollHeight:C,scrollTop:Y,scrollLeft:X}=M,Z=Y/(C-O),se=X/(R-B);let q=null;if(C!=O){const te=[];if(Z>0){const ne=Math.min(Y/5,50);te.push(`rgba(0, 0, 0, 0), rgba(0, 0, 0, 1) ${ne}px`)}if(Z<1){const ne=Math.min((C-O-Y)/5,50);te.push(`rgba(0, 0, 0, 1) calc(100% - ${ne}px), rgba(0, 0, 0, 0)`)}q=`linear-gradient(to bottom, ${te.join(",")})`}else if(R!==B){const te=[];if(se>0){const ne=Math.min(X/5,50);te.push(`rgba(0, 0, 0, 0), rgba(0, 0, 0, 1) ${ne}px`)}if(se<1){const ne=Math.min((R-B-X)/5,50);te.push(`rgba(0, 0, 0, 1) calc(100% - ${ne}px), rgba(0, 0, 0, 0)`)}q=`linear-gradient(to right, ${te.join(",")})`}i.style.webkitMaskImage=q??"",i.style.maskImage=q??""}i.classList.add("overflow-auto"),i.addEventListener("scroll",p,{passive:!0}),i.addEventListener("transitionend",p),i.addEventListener("animationend",p);let b=new ResizeObserver((c,M)=>{p({target:i})});b.observe(i);let _=new MutationObserver((c,M)=>{p({target:i})});return _.observe(i,{childList:!0,subtree:!0}),{destroy(){i.removeEventListener("scroll",p),i.removeEventListener("transitionend",p),i.removeEventListener("animationend",p),b.disconnect(),_.disconnect()}}};function E3(i){return Object.keys(i)}function Lb(i){return i instanceof Map?Array.from(i.entries()):Object.entries(i)}function Rb(i){return Object.fromEntries(i)}function C3(i){throw new Error(`Unhandled enum case: ${i}`)}var Bb=typeof global=="object"&&global&&global.Object===Object&&global,P3=typeof self=="object"&&self&&self.Object===Object&&self,Mc=Bb||P3||Function("return this")(),of=Mc.Symbol,Ob=Object.prototype,z3=Ob.hasOwnProperty,D3=Ob.toString,Uu=of?of.toStringTag:void 0;function L3(i){var n=z3.call(i,Uu),o=i[Uu];try{i[Uu]=void 0;var h=!0}catch{}var p=D3.call(i);return h&&(n?i[Uu]=o:delete i[Uu]),p}var R3=Object.prototype,B3=R3.toString;function O3(i){return B3.call(i)}var F3="[object Null]",N3="[object Undefined]",tv=of?of.toStringTag:void 0;function kf(i){return i==null?i===void 0?N3:F3:tv&&tv in Object(i)?L3(i):O3(i)}function _h(i){return i!=null&&typeof i=="object"}var vg=Array.isArray;function bs(i){var n=typeof i;return i!=null&&(n=="object"||n=="function")}function Fb(i){return i}var j3="[object AsyncFunction]",V3="[object Function]",$3="[object GeneratorFunction]",U3="[object Proxy]";function n0(i){if(!bs(i))return!1;var n=kf(i);return n==V3||n==$3||n==j3||n==U3}var Em=Mc["__core-js_shared__"],iv=function(){var i=/[^.]+$/.exec(Em&&Em.keys&&Em.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function W3(i){return!!iv&&iv in i}var H3=Function.prototype,q3=H3.toString;function G3(i){if(i!=null){try{return q3.call(i)}catch{}try{return i+""}catch{}}return""}var Z3=/[\\^$.*+?()[\]{}|]/g,X3=/^\[object .+?Constructor\]$/,Y3=Function.prototype,K3=Object.prototype,J3=Y3.toString,Q3=K3.hasOwnProperty,eI=RegExp("^"+J3.call(Q3).replace(Z3,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tI(i){if(!bs(i)||W3(i))return!1;var n=n0(i)?eI:X3;return n.test(G3(i))}function iI(i,n){return i==null?void 0:i[n]}function r0(i,n){var o=iI(i,n);return tI(o)?o:void 0}var nv=Object.create,nI=function(){function i(){}return function(n){if(!bs(n))return{};if(nv)return nv(n);i.prototype=n;var o=new i;return i.prototype=void 0,o}}();function Nb(i,n,o){switch(o.length){case 0:return i.call(n);case 1:return i.call(n,o[0]);case 2:return i.call(n,o[0],o[1]);case 3:return i.call(n,o[0],o[1],o[2])}return i.apply(n,o)}function rI(i,n){var o=-1,h=i.length;for(n||(n=Array(h));++o<h;)n[o]=i[o];return n}var aI=800,sI=16,oI=Date.now;function lI(i){var n=0,o=0;return function(){var h=oI(),p=sI-(h-o);if(o=h,p>0){if(++n>=aI)return arguments[0]}else n=0;return i.apply(void 0,arguments)}}function cI(i){return function(){return i}}var lf=function(){try{var i=r0(Object,"defineProperty");return i({},"",{}),i}catch{}}(),uI=lf?function(i,n){return lf(i,"toString",{configurable:!0,enumerable:!1,value:cI(n),writable:!0})}:Fb,hI=lI(uI),dI=9007199254740991,fI=/^(?:0|[1-9]\d*)$/;function jb(i,n){var o=typeof i;return n=n??dI,!!n&&(o=="number"||o!="symbol"&&fI.test(i))&&i>-1&&i%1==0&&i<n}function a0(i,n,o){n=="__proto__"&&lf?lf(i,n,{configurable:!0,enumerable:!0,value:o,writable:!0}):i[n]=o}function Af(i,n){return i===n||i!==i&&n!==n}var pI=Object.prototype,mI=pI.hasOwnProperty;function gI(i,n,o){var h=i[n];(!(mI.call(i,n)&&Af(h,o))||o===void 0&&!(n in i))&&a0(i,n,o)}function yI(i,n,o,h){var p=!o;o||(o={});for(var b=-1,_=n.length;++b<_;){var c=n[b],M=void 0;M===void 0&&(M=i[c]),p?a0(o,c,M):gI(o,c,M)}return o}var rv=Math.max;function _I(i,n,o){return n=rv(n===void 0?i.length-1:n,0),function(){for(var h=arguments,p=-1,b=rv(h.length-n,0),_=Array(b);++p<b;)_[p]=h[n+p];p=-1;for(var c=Array(n+1);++p<n;)c[p]=h[p];return c[n]=o(_),Nb(i,this,c)}}function Vb(i,n){return hI(_I(i,n,Fb),i+"")}var vI=9007199254740991;function $b(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=vI}function s0(i){return i!=null&&$b(i.length)&&!n0(i)}function bI(i,n,o){if(!bs(o))return!1;var h=typeof n;return(h=="number"?s0(o)&&jb(n,o.length):h=="string"&&n in o)?Af(o[n],i):!1}function xI(i){return Vb(function(n,o){var h=-1,p=o.length,b=p>1?o[p-1]:void 0,_=p>2?o[2]:void 0;for(b=i.length>3&&typeof b=="function"?(p--,b):void 0,_&&bI(o[0],o[1],_)&&(b=p<3?void 0:b,p=1),n=Object(n);++h<p;){var c=o[h];c&&i(n,c,h,b)}return n})}var wI=Object.prototype;function Ub(i){var n=i&&i.constructor,o=typeof n=="function"&&n.prototype||wI;return i===o}function TI(i,n){for(var o=-1,h=Array(i);++o<i;)h[o]=n(o);return h}var SI="[object Arguments]";function av(i){return _h(i)&&kf(i)==SI}var Wb=Object.prototype,kI=Wb.hasOwnProperty,AI=Wb.propertyIsEnumerable,bg=av(function(){return arguments}())?av:function(i){return _h(i)&&kI.call(i,"callee")&&!AI.call(i,"callee")};function MI(){return!1}var Hb=typeof exports=="object"&&exports&&!exports.nodeType&&exports,sv=Hb&&typeof module=="object"&&module&&!module.nodeType&&module,II=sv&&sv.exports===Hb,ov=II?Mc.Buffer:void 0,EI=ov?ov.isBuffer:void 0,qb=EI||MI,CI="[object Arguments]",PI="[object Array]",zI="[object Boolean]",DI="[object Date]",LI="[object Error]",RI="[object Function]",BI="[object Map]",OI="[object Number]",FI="[object Object]",NI="[object RegExp]",jI="[object Set]",VI="[object String]",$I="[object WeakMap]",UI="[object ArrayBuffer]",WI="[object DataView]",HI="[object Float32Array]",qI="[object Float64Array]",GI="[object Int8Array]",ZI="[object Int16Array]",XI="[object Int32Array]",YI="[object Uint8Array]",KI="[object Uint8ClampedArray]",JI="[object Uint16Array]",QI="[object Uint32Array]",ln={};ln[HI]=ln[qI]=ln[GI]=ln[ZI]=ln[XI]=ln[YI]=ln[KI]=ln[JI]=ln[QI]=!0;ln[CI]=ln[PI]=ln[UI]=ln[zI]=ln[WI]=ln[DI]=ln[LI]=ln[RI]=ln[BI]=ln[OI]=ln[FI]=ln[NI]=ln[jI]=ln[VI]=ln[$I]=!1;function e4(i){return _h(i)&&$b(i.length)&&!!ln[kf(i)]}function t4(i){return function(n){return i(n)}}var Gb=typeof exports=="object"&&exports&&!exports.nodeType&&exports,eh=Gb&&typeof module=="object"&&module&&!module.nodeType&&module,i4=eh&&eh.exports===Gb,Cm=i4&&Bb.process,lv=function(){try{var i=eh&&eh.require&&eh.require("util").types;return i||Cm&&Cm.binding&&Cm.binding("util")}catch{}}(),cv=lv&&lv.isTypedArray,Zb=cv?t4(cv):e4;function n4(i,n){var o=vg(i),h=!o&&bg(i),p=!o&&!h&&qb(i),b=!o&&!h&&!p&&Zb(i),_=o||h||p||b,c=_?TI(i.length,String):[],M=c.length;for(var B in i)_&&(B=="length"||p&&(B=="offset"||B=="parent")||b&&(B=="buffer"||B=="byteLength"||B=="byteOffset")||jb(B,M))||c.push(B);return c}function r4(i,n){return function(o){return i(n(o))}}function a4(i){var n=[];if(i!=null)for(var o in Object(i))n.push(o);return n}var s4=Object.prototype,o4=s4.hasOwnProperty;function l4(i){if(!bs(i))return a4(i);var n=Ub(i),o=[];for(var h in i)h=="constructor"&&(n||!o4.call(i,h))||o.push(h);return o}function Xb(i){return s0(i)?n4(i):l4(i)}var sh=r0(Object,"create");function c4(){this.__data__=sh?sh(null):{},this.size=0}function u4(i){var n=this.has(i)&&delete this.__data__[i];return this.size-=n?1:0,n}var h4="__lodash_hash_undefined__",d4=Object.prototype,f4=d4.hasOwnProperty;function p4(i){var n=this.__data__;if(sh){var o=n[i];return o===h4?void 0:o}return f4.call(n,i)?n[i]:void 0}var m4=Object.prototype,g4=m4.hasOwnProperty;function y4(i){var n=this.__data__;return sh?n[i]!==void 0:g4.call(n,i)}var _4="__lodash_hash_undefined__";function v4(i,n){var o=this.__data__;return this.size+=this.has(i)?0:1,o[i]=sh&&n===void 0?_4:n,this}function rl(i){var n=-1,o=i==null?0:i.length;for(this.clear();++n<o;){var h=i[n];this.set(h[0],h[1])}}rl.prototype.clear=c4;rl.prototype.delete=u4;rl.prototype.get=p4;rl.prototype.has=y4;rl.prototype.set=v4;function b4(){this.__data__=[],this.size=0}function Mf(i,n){for(var o=i.length;o--;)if(Af(i[o][0],n))return o;return-1}var x4=Array.prototype,w4=x4.splice;function T4(i){var n=this.__data__,o=Mf(n,i);if(o<0)return!1;var h=n.length-1;return o==h?n.pop():w4.call(n,o,1),--this.size,!0}function S4(i){var n=this.__data__,o=Mf(n,i);return o<0?void 0:n[o][1]}function k4(i){return Mf(this.__data__,i)>-1}function A4(i,n){var o=this.__data__,h=Mf(o,i);return h<0?(++this.size,o.push([i,n])):o[h][1]=n,this}function xs(i){var n=-1,o=i==null?0:i.length;for(this.clear();++n<o;){var h=i[n];this.set(h[0],h[1])}}xs.prototype.clear=b4;xs.prototype.delete=T4;xs.prototype.get=S4;xs.prototype.has=k4;xs.prototype.set=A4;var Yb=r0(Mc,"Map");function M4(){this.size=0,this.__data__={hash:new rl,map:new(Yb||xs),string:new rl}}function I4(i){var n=typeof i;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?i!=="__proto__":i===null}function If(i,n){var o=i.__data__;return I4(n)?o[typeof n=="string"?"string":"hash"]:o.map}function E4(i){var n=If(this,i).delete(i);return this.size-=n?1:0,n}function C4(i){return If(this,i).get(i)}function P4(i){return If(this,i).has(i)}function z4(i,n){var o=If(this,i),h=o.size;return o.set(i,n),this.size+=o.size==h?0:1,this}function Ic(i){var n=-1,o=i==null?0:i.length;for(this.clear();++n<o;){var h=i[n];this.set(h[0],h[1])}}Ic.prototype.clear=M4;Ic.prototype.delete=E4;Ic.prototype.get=C4;Ic.prototype.has=P4;Ic.prototype.set=z4;var Kb=r4(Object.getPrototypeOf,Object),D4="[object Object]",L4=Function.prototype,R4=Object.prototype,Jb=L4.toString,B4=R4.hasOwnProperty,O4=Jb.call(Object);function F4(i){if(!_h(i)||kf(i)!=D4)return!1;var n=Kb(i);if(n===null)return!0;var o=B4.call(n,"constructor")&&n.constructor;return typeof o=="function"&&o instanceof o&&Jb.call(o)==O4}function N4(){this.__data__=new xs,this.size=0}function j4(i){var n=this.__data__,o=n.delete(i);return this.size=n.size,o}function V4(i){return this.__data__.get(i)}function $4(i){return this.__data__.has(i)}var U4=200;function W4(i,n){var o=this.__data__;if(o instanceof xs){var h=o.__data__;if(!Yb||h.length<U4-1)return h.push([i,n]),this.size=++o.size,this;o=this.__data__=new Ic(h)}return o.set(i,n),this.size=o.size,this}function Ec(i){var n=this.__data__=new xs(i);this.size=n.size}Ec.prototype.clear=N4;Ec.prototype.delete=j4;Ec.prototype.get=V4;Ec.prototype.has=$4;Ec.prototype.set=W4;var Qb=typeof exports=="object"&&exports&&!exports.nodeType&&exports,uv=Qb&&typeof module=="object"&&module&&!module.nodeType&&module,H4=uv&&uv.exports===Qb,hv=H4?Mc.Buffer:void 0;hv&&hv.allocUnsafe;function q4(i,n){return i.slice()}var dv=Mc.Uint8Array;function G4(i){var n=new i.constructor(i.byteLength);return new dv(n).set(new dv(i)),n}function Z4(i,n){var o=G4(i.buffer);return new i.constructor(o,i.byteOffset,i.length)}function X4(i){return typeof i.constructor=="function"&&!Ub(i)?nI(Kb(i)):{}}function Y4(i){return function(n,o,h){for(var p=-1,b=Object(n),_=h(n),c=_.length;c--;){var M=_[++p];if(o(b[M],M,b)===!1)break}return n}}var K4=Y4();function xg(i,n,o){(o!==void 0&&!Af(i[n],o)||o===void 0&&!(n in i))&&a0(i,n,o)}function J4(i){return _h(i)&&s0(i)}function wg(i,n){if(!(n==="constructor"&&typeof i[n]=="function")&&n!="__proto__")return i[n]}function Q4(i){return yI(i,Xb(i))}function eE(i,n,o,h,p,b,_){var c=wg(i,o),M=wg(n,o),B=_.get(M);if(B){xg(i,o,B);return}var O=b?b(c,M,o+"",i,n,_):void 0,R=O===void 0;if(R){var C=vg(M),Y=!C&&qb(M),X=!C&&!Y&&Zb(M);O=M,C||Y||X?vg(c)?O=c:J4(c)?O=rI(c):Y?(R=!1,O=q4(M)):X?(R=!1,O=Z4(M)):O=[]:F4(M)||bg(M)?(O=c,bg(c)?O=Q4(c):(!bs(c)||n0(c))&&(O=X4(M))):R=!1}R&&(_.set(M,O),p(O,M,h,b,_),_.delete(M)),xg(i,o,O)}function o0(i,n,o,h,p){i!==n&&K4(n,function(b,_){if(p||(p=new Ec),bs(b))eE(i,n,_,o,o0,h,p);else{var c=h?h(wg(i,_),b,_+"",i,n,p):void 0;c===void 0&&(c=b),xg(i,_,c)}},Xb)}function ex(i,n,o,h,p,b){return bs(i)&&bs(n)&&(b.set(n,i),o0(i,n,void 0,ex,b),b.delete(n)),i}var tE=xI(function(i,n,o,h){o0(i,n,o,h)}),fv=Vb(function(i){return i.push(void 0,ex),Nb(tE,void 0,i)});const iE=864e5,tx=6e4,ix=36e5,pv=Symbol.for("constructDateFrom");function Ef(i,n){return typeof i=="function"?i(n):i&&typeof i=="object"&&pv in i?i[pv](n):i instanceof Date?new i.constructor(n):new Date(n)}function $a(i,n){return Ef(n||i,i)}function Tg(i,n,o){const h=$a(i,o==null?void 0:o.in);return isNaN(n)?Ef(i,NaN):(n&&h.setDate(h.getDate()+n),h)}let nE={};function nx(){return nE}function rE(i,n){var c,M,B,O;const o=nx(),h=(n==null?void 0:n.weekStartsOn)??((M=(c=n==null?void 0:n.locale)==null?void 0:c.options)==null?void 0:M.weekStartsOn)??o.weekStartsOn??((O=(B=o.locale)==null?void 0:B.options)==null?void 0:O.weekStartsOn)??0,p=$a(i,n==null?void 0:n.in),b=p.getDay(),_=(b<h?7:0)+b-h;return p.setDate(p.getDate()-_),p.setHours(0,0,0,0),p}function mv(i){const n=$a(i),o=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return o.setUTCFullYear(n.getFullYear()),+i-+o}function rx(i,...n){const o=Ef.bind(null,n.find(h=>typeof h=="object"));return n.map(o)}function gv(i,n){const o=$a(i,n==null?void 0:n.in);return o.setHours(0,0,0,0),o}function aE(i,n,o){const[h,p]=rx(o==null?void 0:o.in,i,n),b=gv(h),_=gv(p),c=+b-mv(b),M=+_-mv(_);return Math.round((c-M)/iE)}function sE(i,n,o){const[h,p]=rx(o==null?void 0:o.in,i,n),b=yv(h,p),_=Math.abs(aE(h,p));h.setDate(h.getDate()-b*_);const c=+(yv(h,p)===-b),M=b*(_-c);return M===0?0:M}function yv(i,n){const o=i.getFullYear()-n.getFullYear()||i.getMonth()-n.getMonth()||i.getDate()-n.getDate()||i.getHours()-n.getHours()||i.getMinutes()-n.getMinutes()||i.getSeconds()-n.getSeconds()||i.getMilliseconds()-n.getMilliseconds();return o<0?-1:o>0?1:o}function oE(i,n){const o=$a(i,n==null?void 0:n.in),h=o.getMonth(),p=h-h%3;return o.setMonth(p,1),o.setHours(0,0,0,0),o}function lE(i,n){var c,M,B,O;const o=nx(),h=(n==null?void 0:n.weekStartsOn)??((M=(c=n==null?void 0:n.locale)==null?void 0:c.options)==null?void 0:M.weekStartsOn)??o.weekStartsOn??((O=(B=o.locale)==null?void 0:B.options)==null?void 0:O.weekStartsOn)??0,p=$a(i,n==null?void 0:n.in),b=p.getDay(),_=(b<h?-7:0)+6-(b-h);return p.setDate(p.getDate()+_),p.setHours(23,59,59,999),p}function cE(i,n){const o=$a(i,n==null?void 0:n.in),h=o.getMonth(),p=h-h%3+3;return o.setMonth(p,0),o.setHours(23,59,59,999),o}function Xs(i,n){const o=i<0?"-":"",h=Math.abs(i).toString().padStart(n,"0");return o+h}function uE(i,n){const o=$a(i,n==null?void 0:n.in);if(isNaN(+o))throw new RangeError("Invalid time value");let h="",p="";const b="-",_=":";{const c=Xs(o.getDate(),2),M=Xs(o.getMonth()+1,2);h=`${Xs(o.getFullYear(),4)}${b}${M}${b}${c}`}{const c=o.getTimezoneOffset();if(c!==0){const Y=Math.abs(c),X=Xs(Math.trunc(Y/60),2),Z=Xs(Y%60,2);p=`${c<0?"+":"-"}${X}:${Z}`}else p="Z";const M=Xs(o.getHours(),2),B=Xs(o.getMinutes(),2),O=Xs(o.getSeconds(),2),R=h===""?"":"T",C=[M,B,O].join(_);h=`${h}${R}${C}${p}`}return h}function hE(i,n){const o=()=>Ef(n==null?void 0:n.in,NaN),p=mE(i);let b;if(p.date){const B=gE(p.date,2);b=yE(B.restDateString,B.year)}if(!b||isNaN(+b))return o();const _=+b;let c=0,M;if(p.time&&(c=_E(p.time),isNaN(c)))return o();if(p.timezone){if(M=vE(p.timezone),isNaN(M))return o()}else{const B=new Date(_+c),O=$a(0,n==null?void 0:n.in);return O.setFullYear(B.getUTCFullYear(),B.getUTCMonth(),B.getUTCDate()),O.setHours(B.getUTCHours(),B.getUTCMinutes(),B.getUTCSeconds(),B.getUTCMilliseconds()),O}return $a(_+c+M,n==null?void 0:n.in)}const Ud={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},dE=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,fE=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,pE=/^([+-])(\d{2})(?::?(\d{2}))?$/;function mE(i){const n={},o=i.split(Ud.dateTimeDelimiter);let h;if(o.length>2)return n;if(/:/.test(o[0])?h=o[0]:(n.date=o[0],h=o[1],Ud.timeZoneDelimiter.test(n.date)&&(n.date=i.split(Ud.timeZoneDelimiter)[0],h=i.substr(n.date.length,i.length))),h){const p=Ud.timezone.exec(h);p?(n.time=h.replace(p[1],""),n.timezone=p[1]):n.time=h}return n}function gE(i,n){const o=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),h=i.match(o);if(!h)return{year:NaN,restDateString:""};const p=h[1]?parseInt(h[1]):null,b=h[2]?parseInt(h[2]):null;return{year:b===null?p:b*100,restDateString:i.slice((h[1]||h[2]).length)}}function yE(i,n){if(n===null)return new Date(NaN);const o=i.match(dE);if(!o)return new Date(NaN);const h=!!o[4],p=Wu(o[1]),b=Wu(o[2])-1,_=Wu(o[3]),c=Wu(o[4]),M=Wu(o[5])-1;if(h)return SE(n,c,M)?bE(n,c,M):new Date(NaN);{const B=new Date(0);return!wE(n,b,_)||!TE(n,p)?new Date(NaN):(B.setUTCFullYear(n,b,Math.max(p,_)),B)}}function Wu(i){return i?parseInt(i):1}function _E(i){const n=i.match(fE);if(!n)return NaN;const o=Pm(n[1]),h=Pm(n[2]),p=Pm(n[3]);return kE(o,h,p)?o*ix+h*tx+p*1e3:NaN}function Pm(i){return i&&parseFloat(i.replace(",","."))||0}function vE(i){if(i==="Z")return 0;const n=i.match(pE);if(!n)return 0;const o=n[1]==="+"?-1:1,h=parseInt(n[2]),p=n[3]&&parseInt(n[3])||0;return AE(h,p)?o*(h*ix+p*tx):NaN}function bE(i,n,o){const h=new Date(0);h.setUTCFullYear(i,0,4);const p=h.getUTCDay()||7,b=(n-1)*7+o+1-p;return h.setUTCDate(h.getUTCDate()+b),h}const xE=[31,null,31,30,31,30,31,31,30,31,30,31];function ax(i){return i%400===0||i%4===0&&i%100!==0}function wE(i,n,o){return n>=0&&n<=11&&o>=1&&o<=(xE[n]||(ax(i)?29:28))}function TE(i,n){return n>=1&&n<=(ax(i)?366:365)}function SE(i,n,o){return n>=1&&n<=53&&o>=0&&o<=6}function kE(i,n,o){return i===24?n===0&&o===0:o>=0&&o<60&&n>=0&&n<60&&i>=0&&i<25}function AE(i,n){return n>=0&&n<=59}var Ne;(function(i){i[i.Custom=1]="Custom",i[i.Day=10]="Day",i[i.DayTime=11]="DayTime",i[i.TimeOnly=15]="TimeOnly",i[i.Week=20]="Week",i[i.WeekSun=21]="WeekSun",i[i.WeekMon=22]="WeekMon",i[i.WeekTue=23]="WeekTue",i[i.WeekWed=24]="WeekWed",i[i.WeekThu=25]="WeekThu",i[i.WeekFri=26]="WeekFri",i[i.WeekSat=27]="WeekSat",i[i.Month=30]="Month",i[i.MonthYear=31]="MonthYear",i[i.Quarter=40]="Quarter",i[i.CalendarYear=50]="CalendarYear",i[i.FiscalYearOctober=60]="FiscalYearOctober",i[i.BiWeek1=70]="BiWeek1",i[i.BiWeek1Sun=71]="BiWeek1Sun",i[i.BiWeek1Mon=72]="BiWeek1Mon",i[i.BiWeek1Tue=73]="BiWeek1Tue",i[i.BiWeek1Wed=74]="BiWeek1Wed",i[i.BiWeek1Thu=75]="BiWeek1Thu",i[i.BiWeek1Fri=76]="BiWeek1Fri",i[i.BiWeek1Sat=77]="BiWeek1Sat",i[i.BiWeek2=80]="BiWeek2",i[i.BiWeek2Sun=81]="BiWeek2Sun",i[i.BiWeek2Mon=82]="BiWeek2Mon",i[i.BiWeek2Tue=83]="BiWeek2Tue",i[i.BiWeek2Wed=84]="BiWeek2Wed",i[i.BiWeek2Thu=85]="BiWeek2Thu",i[i.BiWeek2Fri=86]="BiWeek2Fri",i[i.BiWeek2Sat=87]="BiWeek2Sat"})(Ne||(Ne={}));var oh;(function(i){i[i.Sunday=0]="Sunday",i[i.Monday=1]="Monday",i[i.Tuesday=2]="Tuesday",i[i.Wednesday=3]="Wednesday",i[i.Thursday=4]="Thursday",i[i.Friday=5]="Friday",i[i.Saturday=6]="Saturday"})(oh||(oh={}));var mt;(function(i){i.Year_numeric="yyy",i.Year_2Digit="yy",i.Month_long="MMMM",i.Month_short="MMM",i.Month_2Digit="MM",i.Month_numeric="M",i.Hour_numeric="h",i.Hour_2Digit="hh",i.Hour_wAMPM="a",i.Hour_woAMPM="aaaaaa",i.Minute_numeric="m",i.Minute_2Digit="mm",i.Second_numeric="s",i.Second_2Digit="ss",i.MiliSecond_3="SSS",i.DayOfMonth_numeric="d",i.DayOfMonth_2Digit="dd",i.DayOfMonth_withOrdinal="do",i.DayOfWeek_narrow="eeeee",i.DayOfWeek_long="eeee",i.DayOfWeek_short="eee"})(mt||(mt={}));const l0="-",ME=i=>{const n=EE(i),{conflictingClassGroups:o,conflictingClassGroupModifiers:h}=i;return{getClassGroupId:_=>{const c=_.split(l0);return c[0]===""&&c.length!==1&&c.shift(),sx(c,n)||IE(_)},getConflictingClassGroupIds:(_,c)=>{const M=o[_]||[];return c&&h[_]?[...M,...h[_]]:M}}},sx=(i,n)=>{var _;if(i.length===0)return n.classGroupId;const o=i[0],h=n.nextPart.get(o),p=h?sx(i.slice(1),h):void 0;if(p)return p;if(n.validators.length===0)return;const b=i.join(l0);return(_=n.validators.find(({validator:c})=>c(b)))==null?void 0:_.classGroupId},_v=/^\[(.+)\]$/,IE=i=>{if(_v.test(i)){const n=_v.exec(i)[1],o=n==null?void 0:n.substring(0,n.indexOf(":"));if(o)return"arbitrary.."+o}},EE=i=>{const{theme:n,prefix:o}=i,h={nextPart:new Map,validators:[]};return PE(Object.entries(i.classGroups),o).forEach(([b,_])=>{Sg(_,h,b,n)}),h},Sg=(i,n,o,h)=>{i.forEach(p=>{if(typeof p=="string"){const b=p===""?n:vv(n,p);b.classGroupId=o;return}if(typeof p=="function"){if(CE(p)){Sg(p(h),n,o,h);return}n.validators.push({validator:p,classGroupId:o});return}Object.entries(p).forEach(([b,_])=>{Sg(_,vv(n,b),o,h)})})},vv=(i,n)=>{let o=i;return n.split(l0).forEach(h=>{o.nextPart.has(h)||o.nextPart.set(h,{nextPart:new Map,validators:[]}),o=o.nextPart.get(h)}),o},CE=i=>i.isThemeGetter,PE=(i,n)=>n?i.map(([o,h])=>{const p=h.map(b=>typeof b=="string"?n+b:typeof b=="object"?Object.fromEntries(Object.entries(b).map(([_,c])=>[n+_,c])):b);return[o,p]}):i,zE=i=>{if(i<1)return{get:()=>{},set:()=>{}};let n=0,o=new Map,h=new Map;const p=(b,_)=>{o.set(b,_),n++,n>i&&(n=0,h=o,o=new Map)};return{get(b){let _=o.get(b);if(_!==void 0)return _;if((_=h.get(b))!==void 0)return p(b,_),_},set(b,_){o.has(b)?o.set(b,_):p(b,_)}}},ox="!",DE=i=>{const{separator:n,experimentalParseClassName:o}=i,h=n.length===1,p=n[0],b=n.length,_=c=>{const M=[];let B=0,O=0,R;for(let se=0;se<c.length;se++){let q=c[se];if(B===0){if(q===p&&(h||c.slice(se,se+b)===n)){M.push(c.slice(O,se)),O=se+b;continue}if(q==="/"){R=se;continue}}q==="["?B++:q==="]"&&B--}const C=M.length===0?c:c.substring(O),Y=C.startsWith(ox),X=Y?C.substring(1):C,Z=R&&R>O?R-O:void 0;return{modifiers:M,hasImportantModifier:Y,baseClassName:X,maybePostfixModifierPosition:Z}};return o?c=>o({className:c,parseClassName:_}):_},LE=i=>{if(i.length<=1)return i;const n=[];let o=[];return i.forEach(h=>{h[0]==="["?(n.push(...o.sort(),h),o=[]):o.push(h)}),n.push(...o.sort()),n},RE=i=>({cache:zE(i.cacheSize),parseClassName:DE(i),...ME(i)}),BE=/\s+/,OE=(i,n)=>{const{parseClassName:o,getClassGroupId:h,getConflictingClassGroupIds:p}=n,b=[],_=i.trim().split(BE);let c="";for(let M=_.length-1;M>=0;M-=1){const B=_[M],{modifiers:O,hasImportantModifier:R,baseClassName:C,maybePostfixModifierPosition:Y}=o(B);let X=!!Y,Z=h(X?C.substring(0,Y):C);if(!Z){if(!X){c=B+(c.length>0?" "+c:c);continue}if(Z=h(C),!Z){c=B+(c.length>0?" "+c:c);continue}X=!1}const se=LE(O).join(":"),q=R?se+ox:se,te=q+Z;if(b.includes(te))continue;b.push(te);const ne=p(Z,X);for(let _e=0;_e<ne.length;++_e){const be=ne[_e];b.push(q+be)}c=B+(c.length>0?" "+c:c)}return c};function FE(){let i=0,n,o,h="";for(;i<arguments.length;)(n=arguments[i++])&&(o=lx(n))&&(h&&(h+=" "),h+=o);return h}const lx=i=>{if(typeof i=="string")return i;let n,o="";for(let h=0;h<i.length;h++)i[h]&&(n=lx(i[h]))&&(o&&(o+=" "),o+=n);return o};function bv(i,...n){let o,h,p,b=_;function _(M){const B=n.reduce((O,R)=>R(O),i());return o=RE(B),h=o.cache.get,p=o.cache.set,b=c,c(M)}function c(M){const B=h(M);if(B)return B;const O=OE(M,o);return p(M,O),O}return function(){return b(FE.apply(null,arguments))}}const sn=i=>{const n=o=>o[i]||[];return n.isThemeGetter=!0,n},cx=/^\[(?:([a-z-]+):)?(.+)\]$/i,NE=/^\d+\/\d+$/,jE=new Set(["px","full","screen"]),VE=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,$E=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,UE=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,WE=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,HE=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ps=i=>fc(i)||jE.has(i)||NE.test(i),Ys=i=>Cc(i,"length",QE),fc=i=>!!i&&!Number.isNaN(Number(i)),zm=i=>Cc(i,"number",fc),Hu=i=>!!i&&Number.isInteger(Number(i)),qE=i=>i.endsWith("%")&&fc(i.slice(0,-1)),ui=i=>cx.test(i),Ks=i=>VE.test(i),GE=new Set(["length","size","percentage"]),ZE=i=>Cc(i,GE,ux),XE=i=>Cc(i,"position",ux),YE=new Set(["image","url"]),KE=i=>Cc(i,YE,tC),JE=i=>Cc(i,"",eC),qu=()=>!0,Cc=(i,n,o)=>{const h=cx.exec(i);return h?h[1]?typeof n=="string"?h[1]===n:n.has(h[1]):o(h[2]):!1},QE=i=>$E.test(i)&&!UE.test(i),ux=()=>!1,eC=i=>WE.test(i),tC=i=>HE.test(i),xv=()=>{const i=sn("colors"),n=sn("spacing"),o=sn("blur"),h=sn("brightness"),p=sn("borderColor"),b=sn("borderRadius"),_=sn("borderSpacing"),c=sn("borderWidth"),M=sn("contrast"),B=sn("grayscale"),O=sn("hueRotate"),R=sn("invert"),C=sn("gap"),Y=sn("gradientColorStops"),X=sn("gradientColorStopPositions"),Z=sn("inset"),se=sn("margin"),q=sn("opacity"),te=sn("padding"),ne=sn("saturate"),_e=sn("scale"),be=sn("sepia"),Ae=sn("skew"),de=sn("space"),Be=sn("translate"),Fe=()=>["auto","contain","none"],Le=()=>["auto","hidden","clip","visible","scroll"],we=()=>["auto",ui,n],Te=()=>[ui,n],fe=()=>["",ps,Ys],Me=()=>["auto",fc,ui],Ee=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],$e=()=>["solid","dashed","dotted","double","none"],He=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ge=()=>["start","end","center","between","around","evenly","stretch"],Re=()=>["","0",ui],Xe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Ue=()=>[fc,ui];return{cacheSize:500,separator:":",theme:{colors:[qu],spacing:[ps,Ys],blur:["none","",Ks,ui],brightness:Ue(),borderColor:[i],borderRadius:["none","","full",Ks,ui],borderSpacing:Te(),borderWidth:fe(),contrast:Ue(),grayscale:Re(),hueRotate:Ue(),invert:Re(),gap:Te(),gradientColorStops:[i],gradientColorStopPositions:[qE,Ys],inset:we(),margin:we(),opacity:Ue(),padding:Te(),saturate:Ue(),scale:Ue(),sepia:Re(),skew:Ue(),space:Te(),translate:Te()},classGroups:{aspect:[{aspect:["auto","square","video",ui]}],container:["container"],columns:[{columns:[Ks]}],"break-after":[{"break-after":Xe()}],"break-before":[{"break-before":Xe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Ee(),ui]}],overflow:[{overflow:Le()}],"overflow-x":[{"overflow-x":Le()}],"overflow-y":[{"overflow-y":Le()}],overscroll:[{overscroll:Fe()}],"overscroll-x":[{"overscroll-x":Fe()}],"overscroll-y":[{"overscroll-y":Fe()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[Z]}],"inset-x":[{"inset-x":[Z]}],"inset-y":[{"inset-y":[Z]}],start:[{start:[Z]}],end:[{end:[Z]}],top:[{top:[Z]}],right:[{right:[Z]}],bottom:[{bottom:[Z]}],left:[{left:[Z]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Hu,ui]}],basis:[{basis:we()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ui]}],grow:[{grow:Re()}],shrink:[{shrink:Re()}],order:[{order:["first","last","none",Hu,ui]}],"grid-cols":[{"grid-cols":[qu]}],"col-start-end":[{col:["auto",{span:["full",Hu,ui]},ui]}],"col-start":[{"col-start":Me()}],"col-end":[{"col-end":Me()}],"grid-rows":[{"grid-rows":[qu]}],"row-start-end":[{row:["auto",{span:[Hu,ui]},ui]}],"row-start":[{"row-start":Me()}],"row-end":[{"row-end":Me()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ui]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ui]}],gap:[{gap:[C]}],"gap-x":[{"gap-x":[C]}],"gap-y":[{"gap-y":[C]}],"justify-content":[{justify:["normal",...Ge()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ge(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ge(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[te]}],px:[{px:[te]}],py:[{py:[te]}],ps:[{ps:[te]}],pe:[{pe:[te]}],pt:[{pt:[te]}],pr:[{pr:[te]}],pb:[{pb:[te]}],pl:[{pl:[te]}],m:[{m:[se]}],mx:[{mx:[se]}],my:[{my:[se]}],ms:[{ms:[se]}],me:[{me:[se]}],mt:[{mt:[se]}],mr:[{mr:[se]}],mb:[{mb:[se]}],ml:[{ml:[se]}],"space-x":[{"space-x":[de]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[de]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ui,n]}],"min-w":[{"min-w":[ui,n,"min","max","fit"]}],"max-w":[{"max-w":[ui,n,"none","full","min","max","fit","prose",{screen:[Ks]},Ks]}],h:[{h:[ui,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ui,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ui,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ui,n,"auto","min","max","fit"]}],"font-size":[{text:["base",Ks,Ys]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",zm]}],"font-family":[{font:[qu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ui]}],"line-clamp":[{"line-clamp":["none",fc,zm]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ps,ui]}],"list-image":[{"list-image":["none",ui]}],"list-style-type":[{list:["none","disc","decimal",ui]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[i]}],"placeholder-opacity":[{"placeholder-opacity":[q]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[i]}],"text-opacity":[{"text-opacity":[q]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...$e(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ps,Ys]}],"underline-offset":[{"underline-offset":["auto",ps,ui]}],"text-decoration-color":[{decoration:[i]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Te()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ui]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ui]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[q]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Ee(),XE]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ZE]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},KE]}],"bg-color":[{bg:[i]}],"gradient-from-pos":[{from:[X]}],"gradient-via-pos":[{via:[X]}],"gradient-to-pos":[{to:[X]}],"gradient-from":[{from:[Y]}],"gradient-via":[{via:[Y]}],"gradient-to":[{to:[Y]}],rounded:[{rounded:[b]}],"rounded-s":[{"rounded-s":[b]}],"rounded-e":[{"rounded-e":[b]}],"rounded-t":[{"rounded-t":[b]}],"rounded-r":[{"rounded-r":[b]}],"rounded-b":[{"rounded-b":[b]}],"rounded-l":[{"rounded-l":[b]}],"rounded-ss":[{"rounded-ss":[b]}],"rounded-se":[{"rounded-se":[b]}],"rounded-ee":[{"rounded-ee":[b]}],"rounded-es":[{"rounded-es":[b]}],"rounded-tl":[{"rounded-tl":[b]}],"rounded-tr":[{"rounded-tr":[b]}],"rounded-br":[{"rounded-br":[b]}],"rounded-bl":[{"rounded-bl":[b]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[q]}],"border-style":[{border:[...$e(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[q]}],"divide-style":[{divide:$e()}],"border-color":[{border:[p]}],"border-color-x":[{"border-x":[p]}],"border-color-y":[{"border-y":[p]}],"border-color-s":[{"border-s":[p]}],"border-color-e":[{"border-e":[p]}],"border-color-t":[{"border-t":[p]}],"border-color-r":[{"border-r":[p]}],"border-color-b":[{"border-b":[p]}],"border-color-l":[{"border-l":[p]}],"divide-color":[{divide:[p]}],"outline-style":[{outline:["",...$e()]}],"outline-offset":[{"outline-offset":[ps,ui]}],"outline-w":[{outline:[ps,Ys]}],"outline-color":[{outline:[i]}],"ring-w":[{ring:fe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[i]}],"ring-opacity":[{"ring-opacity":[q]}],"ring-offset-w":[{"ring-offset":[ps,Ys]}],"ring-offset-color":[{"ring-offset":[i]}],shadow:[{shadow:["","inner","none",Ks,JE]}],"shadow-color":[{shadow:[qu]}],opacity:[{opacity:[q]}],"mix-blend":[{"mix-blend":[...He(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":He()}],filter:[{filter:["","none"]}],blur:[{blur:[o]}],brightness:[{brightness:[h]}],contrast:[{contrast:[M]}],"drop-shadow":[{"drop-shadow":["","none",Ks,ui]}],grayscale:[{grayscale:[B]}],"hue-rotate":[{"hue-rotate":[O]}],invert:[{invert:[R]}],saturate:[{saturate:[ne]}],sepia:[{sepia:[be]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[o]}],"backdrop-brightness":[{"backdrop-brightness":[h]}],"backdrop-contrast":[{"backdrop-contrast":[M]}],"backdrop-grayscale":[{"backdrop-grayscale":[B]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[O]}],"backdrop-invert":[{"backdrop-invert":[R]}],"backdrop-opacity":[{"backdrop-opacity":[q]}],"backdrop-saturate":[{"backdrop-saturate":[ne]}],"backdrop-sepia":[{"backdrop-sepia":[be]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[_]}],"border-spacing-x":[{"border-spacing-x":[_]}],"border-spacing-y":[{"border-spacing-y":[_]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ui]}],duration:[{duration:Ue()}],ease:[{ease:["linear","in","out","in-out",ui]}],delay:[{delay:Ue()}],animate:[{animate:["none","spin","ping","pulse","bounce",ui]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_e]}],"scale-x":[{"scale-x":[_e]}],"scale-y":[{"scale-y":[_e]}],rotate:[{rotate:[Hu,ui]}],"translate-x":[{"translate-x":[Be]}],"translate-y":[{"translate-y":[Be]}],"skew-x":[{"skew-x":[Ae]}],"skew-y":[{"skew-y":[Ae]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ui]}],accent:[{accent:["auto",i]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ui]}],"caret-color":[{caret:[i]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Te()}],"scroll-mx":[{"scroll-mx":Te()}],"scroll-my":[{"scroll-my":Te()}],"scroll-ms":[{"scroll-ms":Te()}],"scroll-me":[{"scroll-me":Te()}],"scroll-mt":[{"scroll-mt":Te()}],"scroll-mr":[{"scroll-mr":Te()}],"scroll-mb":[{"scroll-mb":Te()}],"scroll-ml":[{"scroll-ml":Te()}],"scroll-p":[{"scroll-p":Te()}],"scroll-px":[{"scroll-px":Te()}],"scroll-py":[{"scroll-py":Te()}],"scroll-ps":[{"scroll-ps":Te()}],"scroll-pe":[{"scroll-pe":Te()}],"scroll-pt":[{"scroll-pt":Te()}],"scroll-pr":[{"scroll-pr":Te()}],"scroll-pb":[{"scroll-pb":Te()}],"scroll-pl":[{"scroll-pl":Te()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ui]}],fill:[{fill:[i,"none"]}],"stroke-w":[{stroke:[ps,Ys,zm]}],stroke:[{stroke:[i,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},iC=(i,{cacheSize:n,prefix:o,separator:h,experimentalParseClassName:p,extend:b={},override:_={}})=>{Xu(i,"cacheSize",n),Xu(i,"prefix",o),Xu(i,"separator",h),Xu(i,"experimentalParseClassName",p);for(const c in _)nC(i[c],_[c]);for(const c in b)rC(i[c],b[c]);return i},Xu=(i,n,o)=>{o!==void 0&&(i[n]=o)},nC=(i,n)=>{if(n)for(const o in n)Xu(i,o,n[o])},rC=(i,n)=>{if(n)for(const o in n){const h=n[o];h!==void 0&&(i[o]=(i[o]||[]).concat(h))}},aC=(i,...n)=>typeof i=="function"?bv(xv,i,...n):bv(()=>iC(xv(),i),...n),sC=aC({extend:{classGroups:{shadow:["shadow-border-l","shadow-border-r","shadow-border-t","shadow-border-b","elevation-none",...Db(1,25).map(i=>`elevation-${i}`)]}}}),to=(...i)=>sC(m1(...i));class Dm{constructor(n,o){lr(this,"theme");lr(this,"dark");this.theme=n,this.dark=o}get resolvedTheme(){return this.theme?this.theme:this.dark?"dark":"light"}}function oC(i){let n=vn(new Dm(null,!1)),o=window.matchMedia("(prefers-color-scheme: dark)");function h({matches:_}){_&&i.dark.length?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),n.set(new Dm(null,_))}function p(_){if(_==="system")localStorage.removeItem("theme"),delete document.documentElement.dataset.theme,h(o),o.addEventListener("change",h);else{o.removeEventListener("change",h),localStorage.theme=_,document.documentElement.dataset.theme=_;let c=i.dark.includes(_);c?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),n.set(new Dm(_,c))}}let b=localStorage.getItem("theme")||"system";return p(b),{subscribe:n.subscribe,setTheme:p}}function lC(i){var h;if(!i)return oh.Sunday;const n=new Intl.Locale(i),o=n.weekInfo??((h=n.getWeekInfo)==null?void 0:h.call(n));return((o==null?void 0:o.firstDay)??0)%7}function cC(i,n){return Vr(i,o=>{let h;return o!=null&&o.length&&(Array.isArray(o)?h=o[0]:h=o),h??n??"en"})}function uC(i,n){let o=vn(i??null);return{...cC(o,n),set(p){o.set(p)}}}const hC={locale:"en",dictionary:{Ok:"Ok",Cancel:"Cancel",Date:{Start:"Start",End:"End",Empty:"Empty",Day:"Day",DayTime:"Day Time",Time:"Time",Week:"Week",BiWeek:"Bi-Week",Month:"Month",Quarter:"Quarter",CalendarYear:"Calendar Year",FiscalYearOct:"Fiscal Year (Oct)",PeriodDay:{Current:"Today",Last:"Yesterday",LastX:"Last {0} days"},PeriodWeek:{Current:"This week",Last:"Last week",LastX:"Last {0} weeks"},PeriodBiWeek:{Current:"This bi-week",Last:"Last bi-week",LastX:"Last {0} bi-weeks"},PeriodMonth:{Current:"This month",Last:"Last month",LastX:"Last {0} months"},PeriodQuarter:{Current:"This quarter",Last:"Last quarter",LastX:"Last {0} quarters"},PeriodQuarterSameLastyear:"Same quarter last year",PeriodYear:{Current:"This year",Last:"Last year",LastX:"Last {0} years"},PeriodFiscalYear:{Current:"This fiscal year",Last:"Last fiscal year",LastX:"Last {0} fiscal years"}}},formats:{numbers:{defaults:{currency:"USD",fractionDigits:2,currencyDisplay:"symbol"}},dates:{baseParsing:"MM/dd/yyyy",weekStartsOn:oh.Sunday,ordinalSuffixes:{one:"st",two:"nd",few:"rd",other:"th"},presets:{day:{short:[mt.DayOfMonth_numeric,mt.Month_numeric],default:[mt.DayOfMonth_numeric,mt.Month_numeric,mt.Year_numeric],long:[mt.DayOfMonth_numeric,mt.Month_short,mt.Year_numeric]},dayTime:{short:[mt.DayOfMonth_numeric,mt.Month_numeric,mt.Year_numeric,mt.Hour_numeric,mt.Minute_numeric],default:[mt.DayOfMonth_numeric,mt.Month_numeric,mt.Year_numeric,mt.Hour_2Digit,mt.Minute_2Digit],long:[mt.DayOfMonth_numeric,mt.Month_numeric,mt.Year_numeric,mt.Hour_2Digit,mt.Minute_2Digit,mt.Second_2Digit]},timeOnly:{short:[mt.Hour_numeric,mt.Minute_numeric],default:[mt.Hour_2Digit,mt.Minute_2Digit,mt.Second_2Digit],long:[mt.Hour_2Digit,mt.Minute_2Digit,mt.Second_2Digit,mt.MiliSecond_3]},week:{short:[mt.DayOfMonth_numeric,mt.Month_numeric],default:[mt.DayOfMonth_numeric,mt.Month_numeric,mt.Year_numeric],long:[mt.DayOfMonth_numeric,mt.Month_numeric,mt.Year_numeric]},month:{short:mt.Month_short,default:mt.Month_short,long:mt.Month_long},monthsYear:{short:[mt.Month_short,mt.Year_2Digit],default:[mt.Month_long,mt.Year_numeric],long:[mt.Month_long,mt.Year_numeric]},year:{short:mt.Year_2Digit,default:mt.Year_numeric,long:mt.Year_numeric}}}}};function hx(i,n=hC){var o,h,p,b;return(h=(o=i.formats)==null?void 0:o.dates)!=null&&h.ordinalSuffixes&&(i.formats.dates.ordinalSuffixes={one:"",two:"",few:"",other:"",zero:"",many:"",...i.formats.dates.ordinalSuffixes}),((b=(p=i.formats)==null?void 0:p.dates)==null?void 0:b.weekStartsOn)===void 0&&(i=fv(i,{formats:{dates:{weekStartsOn:lC(i.locale)}}})),fv(i,n)}const dC=hx({locale:"en"});function fC(i){const n=i?Lb(i).map(([o,h])=>[o,hx(h)]):[];return{en:dC,...Rb(n)}}function pC(i){return E3.length===0?i:Rb(Lb(i).filter(([n,o])=>o!=null))}function Sn(i,n){const o=new Date(2024,0,7+i);return new Intl.DateTimeFormat(n,{weekday:"short"}).format(o)}function mC(i,n){const{locale:o,dictionary:{Date:h}}=i;switch(n){case Ne.Custom:return"Custom";case Ne.Day:return h.Day;case Ne.DayTime:return h.DayTime;case Ne.TimeOnly:return h.Time;case Ne.WeekSun:return`${h.Week} (${Sn(oh.Sunday,o)})`;case Ne.WeekMon:return`${h.Week} (${Sn(1,o)})`;case Ne.WeekTue:return`${h.Week} (${Sn(2,o)})`;case Ne.WeekWed:return`${h.Week} (${Sn(3,o)})`;case Ne.WeekThu:return`${h.Week} (${Sn(4,o)})`;case Ne.WeekFri:return`${h.Week} (${Sn(5,o)})`;case Ne.WeekSat:return`${h.Week} (${Sn(6,o)})`;case Ne.Week:return h.Week;case Ne.Month:return h.Month;case Ne.MonthYear:return h.Month;case Ne.Quarter:return h.Quarter;case Ne.CalendarYear:return h.CalendarYear;case Ne.FiscalYearOctober:return h.FiscalYearOct;case Ne.BiWeek1Sun:return`${h.BiWeek} (${Sn(0,o)})`;case Ne.BiWeek1Mon:return`${h.BiWeek} (${Sn(1,o)})`;case Ne.BiWeek1Tue:return`${h.BiWeek} (${Sn(2,o)})`;case Ne.BiWeek1Wed:return`${h.BiWeek} (${Sn(3,o)})`;case Ne.BiWeek1Thu:return`${h.BiWeek} (${Sn(4,o)})`;case Ne.BiWeek1Fri:return`${h.BiWeek} (${Sn(5,o)})`;case Ne.BiWeek1Sat:return`${h.BiWeek} (${Sn(6,o)})`;case Ne.BiWeek1:return h.BiWeek;case Ne.BiWeek2Sun:return`${h.BiWeek} 2 (${Sn(0,o)})`;case Ne.BiWeek2Mon:return`${h.BiWeek} 2 (${Sn(1,o)})`;case Ne.BiWeek2Tue:return`${h.BiWeek} 2 (${Sn(2,o)})`;case Ne.BiWeek2Wed:return`${h.BiWeek} 2 (${Sn(3,o)})`;case Ne.BiWeek2Thu:return`${h.BiWeek} 2 (${Sn(4,o)})`;case Ne.BiWeek2Fri:return`${h.BiWeek} 2 (${Sn(5,o)})`;case Ne.BiWeek2Sat:return`${h.BiWeek} 2 (${Sn(6,o)})`;case Ne.BiWeek2:return`${h.BiWeek} 2`;default:C3(n)}}Ne.Custom+"",Ne.Day+"",Ne.DayTime+"",Ne.TimeOnly+"",Ne.WeekSun+"",Ne.WeekMon+"",Ne.WeekTue+"",Ne.WeekWed+"",Ne.WeekThu+"",Ne.WeekFri+"",Ne.WeekSat+"",Ne.Week+"",Ne.Month+"",Ne.MonthYear+"",Ne.Quarter+"",Ne.CalendarYear+"",Ne.FiscalYearOctober+"",Ne.BiWeek1Sun+"",Ne.BiWeek1Mon+"",Ne.BiWeek1Tue+"",Ne.BiWeek1Wed+"",Ne.BiWeek1Thu+"",Ne.BiWeek1Fri+"",Ne.BiWeek1Sat+"",Ne.BiWeek1+"",Ne.BiWeek2Sun+"",Ne.BiWeek2Mon+"",Ne.BiWeek2Tue+"",Ne.BiWeek2Wed+"",Ne.BiWeek2Thu+"",Ne.BiWeek2Fri+"",Ne.BiWeek2Sat+"",Ne.BiWeek2+"";function gC(i=new Date,n){return i===null?NaN:i.getMonth()>=10-1?i.getFullYear()+1:i.getFullYear()}const yC=[new Date("1799-12-22T00:00"),new Date("1799-12-15T00:00")];function dx(i,n,o){var h=yC[n-1],p=Tg(h,o),b=Math.floor(sE(i,p)/14);return Tg(p,b*14)}function _C(i,n,o){return Tg(dx(i,n,o),13)}function fa(i,n,o){const{locale:h,formats:{dates:{ordinalSuffixes:p}}}=i;function b(M,B=!1){if(B){const O=new Intl.PluralRules(h,{type:"ordinal"});return M.formatToParts(n).map(C=>{if(C.type==="day"){const Y=O.select(parseInt(C.value,10)),X=p[Y];return`${C.value}${X}`}return C.value}).join("")}return M.format(n)}if(typeof o!="string"&&!Array.isArray(o))return b(new Intl.DateTimeFormat(h,o),o.withOrdinal);const _=Array.isArray(o)?o.join(""):o,c=new Intl.DateTimeFormat(h,{year:_.includes(mt.Year_numeric)?"numeric":_.includes(mt.Year_2Digit)?"2-digit":void 0,month:_.includes(mt.Month_long)?"long":_.includes(mt.Month_short)?"short":_.includes(mt.Month_2Digit)?"2-digit":_.includes(mt.Month_numeric)?"numeric":void 0,day:_.includes(mt.DayOfMonth_2Digit)?"2-digit":_.includes(mt.DayOfMonth_numeric)?"numeric":void 0,hour:_.includes(mt.Hour_2Digit)?"2-digit":_.includes(mt.Hour_numeric)?"numeric":void 0,hour12:_.includes(mt.Hour_woAMPM)?!1:_.includes(mt.Hour_wAMPM)?!0:void 0,minute:_.includes(mt.Minute_2Digit)?"2-digit":_.includes(mt.Minute_numeric)?"numeric":void 0,second:_.includes(mt.Second_2Digit)?"2-digit":_.includes(mt.Second_numeric)?"numeric":void 0,fractionalSecondDigits:_.includes(mt.MiliSecond_3)?3:void 0,weekday:_.includes(mt.DayOfWeek_narrow)?"narrow":_.includes(mt.DayOfWeek_long)?"long":_.includes(mt.DayOfWeek_short)?"short":void 0});return b(c,_.includes(mt.DayOfMonth_withOrdinal))}function In(i,n,o,h,p=void 0){const b=p===void 0?rE(n,{weekStartsOn:o}):dx(n,p,o),_=p===void 0?lE(n,{weekStartsOn:o}):_C(n,p,o);return fa(i,b,h)+" - "+fa(i,_,h)}function vC(i,n){return n===Ne.Week?n=[Ne.WeekSun,Ne.WeekMon,Ne.WeekTue,Ne.WeekWed,Ne.WeekThu,Ne.WeekFri,Ne.WeekSat][i]:n===Ne.BiWeek1?n=[Ne.BiWeek1Sun,Ne.BiWeek1Mon,Ne.BiWeek1Tue,Ne.BiWeek1Wed,Ne.BiWeek1Thu,Ne.BiWeek1Fri,Ne.BiWeek1Sat][i]:n===Ne.BiWeek2&&(n=[Ne.BiWeek2Sun,Ne.BiWeek2Mon,Ne.BiWeek2Tue,Ne.BiWeek2Wed,Ne.BiWeek2Thu,Ne.BiWeek2Fri,Ne.BiWeek2Sat][i]),n}function bC(i,n,o,h={}){if(typeof n=="string"&&(n=hE(n)),n==null||isNaN(n))return"";const p=h.weekStartsOn??i.formats.dates.weekStartsOn,{day:b,dayTime:_,timeOnly:c,week:M,month:B,monthsYear:O,year:R}=i.formats.dates.presets;o=vC(p,o)??o;function C(Y){return h.variant==="custom"?h.custom??Y.default:h.custom&&!h.variant?h.custom:Y[h.variant??"default"]}switch(o){case Ne.Custom:return fa(i,n,h.custom);case Ne.Day:return fa(i,n,C(b));case Ne.DayTime:return fa(i,n,C(_));case Ne.TimeOnly:return fa(i,n,C(c));case Ne.Week:case Ne.WeekSun:return In(i,n,0,C(M));case Ne.WeekMon:return In(i,n,1,C(M));case Ne.WeekTue:return In(i,n,2,C(M));case Ne.WeekWed:return In(i,n,3,C(M));case Ne.WeekThu:return In(i,n,4,C(M));case Ne.WeekFri:return In(i,n,5,C(M));case Ne.WeekSat:return In(i,n,6,C(M));case Ne.Month:return fa(i,n,C(B));case Ne.MonthYear:return fa(i,n,C(O));case Ne.Quarter:return[fa(i,oE(n),C(B)),fa(i,cE(n),C(O))].join(" - ");case Ne.CalendarYear:return fa(i,n,C(R));case Ne.FiscalYearOctober:const Y=new Date(gC(n),0,1);return fa(i,Y,C(R));case Ne.BiWeek1:case Ne.BiWeek1Sun:return In(i,n,0,C(M),1);case Ne.BiWeek1Mon:return In(i,n,1,C(M),1);case Ne.BiWeek1Tue:return In(i,n,2,C(M),1);case Ne.BiWeek1Wed:return In(i,n,3,C(M),1);case Ne.BiWeek1Thu:return In(i,n,4,C(M),1);case Ne.BiWeek1Fri:return In(i,n,5,C(M),1);case Ne.BiWeek1Sat:return In(i,n,6,C(M),1);case Ne.BiWeek2:case Ne.BiWeek2Sun:return In(i,n,0,C(M),2);case Ne.BiWeek2Mon:return In(i,n,1,C(M),2);case Ne.BiWeek2Tue:return In(i,n,2,C(M),2);case Ne.BiWeek2Wed:return In(i,n,3,C(M),2);case Ne.BiWeek2Thu:return In(i,n,4,C(M),2);case Ne.BiWeek2Fri:return In(i,n,5,C(M),2);case Ne.BiWeek2Sat:return In(i,n,6,C(M),2);default:return uE(n)}}const xC=/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(.\d+|)(Z|(-|\+)\d{2}:\d{2}))?$/;function wC(i){return xC.test(i)}function TC(i,n){const{numbers:o}=i.formats,h=n&&n!="none"?o[n]:{};return{...o.defaults,...h}}function SC(i,n,o,h={}){if(n==null)return"";if(o==="none")return`${n}`;o==null&&(o=Number.isInteger(n)?"integer":"decimal");const p=TC(i,o),_=Intl.NumberFormat(i.locale,{...p,...o!=="default"&&{style:o},minimumFractionDigits:h.fractionDigits??p.fractionDigits,maximumFractionDigits:h.fractionDigits??p.fractionDigits,...pC(h),...o==="currencyRound"&&{style:"currency",minimumFractionDigits:0,maximumFractionDigits:0},...o==="percentRound"&&{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0},...o==="metric"&&{style:"decimal",notation:"compact",minimumFractionDigits:0,maximumFractionDigits:0},...o==="integer"&&{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}}).format(n);let c=h.suffix??"";return c&&Math.abs(n)>=2&&h.suffixExtraIfMany!==""&&(c+=h.suffixExtraIfMany??"s"),`${_}${c}`}function kC(i,n,o,h){return typeof o=="function"?o(n):n instanceof Date||wC(n)||o&&o in Ne?bC(i,n,o??Ne.Day,h):typeof n=="number"?SC(i,n,o,h):typeof n=="string"?n:n==null?"":`${n}`}function AC(i){const n=(o,h,p)=>kC(i,o,h,p);return n.settings=i,n.getDayOfWeekName=o=>Sn(o,i.locale),n.getPeriodTypeName=o=>mC(i,o),n}function mo(i){{const n=window.matchMedia(i);return ro(n.matches,o=>{const h=p=>o(p.matches);return n.addEventListener("change",h),()=>n.removeEventListener("change",h)})}}const vh=i=>mo(`(min-width: ${i}px)`),Pc={sm:640,md:768,lg:1024,xl:1280,xxl:1536},MC=vh(Pc.sm);vh(Pc.md);vh(Pc.lg);vh(Pc.xl);vh(Pc.xxl);mo("screen");mo("print");mo("(prefers-color-scheme: dark)");mo("(prefers-color-scheme: light)");mo("(prefers-reduced-motion: reduce)");mo("(orientation: landscape)");mo("(orientation: portrait)");const IC=Symbol();function EC(i){if(i.locale&&i.localeSettings&&i.format)return{locale:i.locale,localeSettings:i.localeSettings,format:i.format};let n=fC(i.localeFormats),o=uC(i.forceLocale,i.fallbackLocale),h=Vr(o,p=>{let b=n[p];return b||{...n.en,locale:p}});return{locale:o,localeSettings:h,format:Vr(h,AC)}}function CC(){return vn(window.innerWidth>=Pc.md)}let Lm=null;function wv(){return Lm=Lm??{currentTheme:oC({light:["light"],dark:["dark"]}),componentSettingsCache:{},showDrawer:CC(),...EC({})},Lm}function PC(){try{return Wg(IC)??wv()}catch{return wv()}}function zC(i){return typeof i=="string"?{root:i}:i??{}}function Cf(i){var o,h;const n=PC();return zC((h=(o=n==null?void 0:n.components)==null?void 0:o[i])==null?void 0:h.classes)}var DC=Jv('<circle class="track svelte-c2dy19" fill="transparent"></circle>'),LC=Ht('<div><svg xmlns="http://www.w3.org/2000/svg" class="svelte-c2dy19"><!><circle class="path svelte-c2dy19" fill="transparent"></circle></svg> <div class="info svelte-c2dy19"><!></div></div>');function RC(i,n){const o=Ji(n,["children","$$slots","$$events","$$legacy"]);un(n,!1);const h=Hi(),p=Hi(),b=Hi(),_=Hi(),c=Hi(),M=Hi();let B=tt(n,"value",8,null),O=tt(n,"rotate",8,0),R=tt(n,"size",8,40),C=tt(n,"width",8,4),Y=tt(n,"track",8,!1),X=tt(n,"class",8,void 0);const Z=Cf("ProgressCircle"),se=20;ei(()=>Ai(B()),()=>{di(h,B()==null)}),ei(()=>{},()=>{di(p,2*Math.PI*se)}),ei(()=>De(p),()=>{di(b,Math.round(De(p)*1e3)/1e3)}),ei(()=>(Ai(B()),De(p)),()=>{di(_,(100-(B()??0))/100*De(p)+"px")}),ei(()=>(Ai(C()),Ai(R())),()=>{di(c,se/(1-C()/R()))}),ei(()=>(Ai(C()),Ai(R()),De(c)),()=>{di(M,C()/R()*De(c)*2)}),Or(),cn();var q=LC();let te;var ne=pt(q),_e=pt(ne);{var be=Fe=>{var Le=DC();Ti(Le,"r",se),Ti(Le,"stroke-dashoffset",0),Mi(()=>{Ti(Le,"cx",2*De(c)),Ti(Le,"cy",2*De(c)),Ti(Le,"stroke-width",De(M)),Ti(Le,"stroke-dasharray",De(b))}),rt(Fe,Le)};Vi(_e,Fe=>{Y()&&Fe(be)})}var Ae=Wt(_e);Ti(Ae,"r",se),ut(ne);var de=Wt(ne,2),Be=pt(de);zi(Be,n,"default",{},null),ut(de),ut(q),Mi(()=>{te=Br(q,te,{...o,class:to("ProgressCircular","relative inline-flex justify-center items-center align-middle",Z.root,X()),style:`height: ${R()??""}px; width: ${R()??""}px; ${o.style??""}`},"svelte-c2dy19"),zT(q,"indeterminate",De(h)),Ti(ne,"style",`transform: rotate(${O()-(De(h)?0:90)}deg)`),Ti(ne,"viewBox",`${De(c)??""}
    ${De(c)??""}
    ${2*De(c)}
    ${2*De(c)}`),Ti(Ae,"cx",2*De(c)),Ti(Ae,"cy",2*De(c)),Ti(Ae,"stroke-width",De(M)),Ti(Ae,"stroke-dasharray",De(b)),Ti(Ae,"stroke-dashoffset",De(_))}),rt(i,q),hn()}var BC=Ht("<div><!></div>");function OC(i,n){un(n,!1);const o=Hi(),h=Hi();let p=tt(n,"center",8,!1),b=tt(n,"transition",24,()=>[sf,{duration:100}]),_=tt(n,"class",8,void 0);const c=Cf("Overlay");ei(()=>(De(o),De(h),Ai(b())),()=>{(R=>(di(o,R[0]),di(h,R[1])))(b())}),Or(),cn();var M=BC();const B=ur(()=>el(to("Overlay","absolute top-0 bottom-0 left-0 right-0 z-30 bg-surface-100/75",p()&&"flex items-center justify-center",c.root,_())));var O=pt(M);zi(O,n,"default",{},null),ut(M),Mi(()=>lc(M,De(B),"")),$n(3,M,()=>De(o),()=>De(h)),rt(i,M),hn()}var FC=Ht('<div role="none"><!></div>');function NC(i,n){un(n,!1);let o=tt(n,"blur",8,!1),h=tt(n,"portal",8,!1),p=tt(n,"class",8,void 0),b=tt(n,"fadeParams",24,()=>({duration:300}));const _=Cf("Backdrop");cn();var c=FC();const M=ur(()=>el(to("Backdrop","fixed top-0 bottom-0 left-0 right-0 flex items-center justify-center bg-surface-content/50 dark:bg-surface-300/70",o()&&"backdrop-blur-sm",_.root,p())));var B=pt(c);zi(B,n,"default",{},null),ut(c),Lt(()=>Ct("keydown",c,function(O){Nt.call(this,n,O)})),Lt(()=>Ct("keyup",c,function(O){Nt.call(this,n,O)})),Lt(()=>Ct("keypress",c,function(O){Nt.call(this,n,O)})),Lt(()=>Ct("click",c,function(O){Nt.call(this,n,O)})),Lt(()=>Ct("mousedown",c,function(O){Nt.call(this,n,O)})),Lt(()=>Ct("mouseup",c,function(O){Nt.call(this,n,O)})),Tr(c,(O,R)=>dc==null?void 0:dc(O,R),h),Mi(()=>lc(c,De(M),"")),$n(5,c,()=>sf,b),$n(2,c,()=>sf,b),rt(i,c),hn()}var jC=Ht("<div><!></div>"),VC=Ht("<div><!></div>"),$C=Ht('<div role="presentation"><div role="dialog"><!> <!> <!> <!></div></div>'),UC=Ht("<!> <!>",1);function WC(i,n){const o=MT(n),h=Ji(n,["children","$$slots","$$events","$$legacy"]);un(n,!1);const p=cl();let b=tt(n,"open",12,!1),_=tt(n,"portal",8,!0),c=tt(n,"persistent",8,!1),M=tt(n,"loading",8,null),B=tt(n,"classes",24,()=>({}));const O=Cf("Dialog");let R=Hi(),C=Hi();function Y(_e){try{if(!(_e.target instanceof Element))return;De(C)==null||De(C).contains(_e.target)&&_e.target!=De(C)&&!_e.target.hasAttribute("slot")&&X()}catch(be){console.error(be)}}function X(_e){const be=(_e==null?void 0:_e.force)??!1;b()&&(!c()||be?b(!1):p("closeAttempt"))}ei(()=>Ai(b()),()=>{b()?p("open"):p("close")}),Or(),cn();var Z=UC(),se=ni(Z);{var q=_e=>{var be=ur(()=>to("z-50",O.backdrop,B().backdrop));NC(_e,{get class(){return De(be)},fadeParams:{duration:150},get portal(){return _()},$$events:{click:()=>X(),mouseup:Ae=>{Ae.stopPropagation()}}})};Vi(se,_e=>{b()&&_e(q)})}var te=Wt(se,2);{var ne=_e=>{var be=$C();const Ae=ur(()=>el(to("Dialog","fixed top-0 left-0 w-full h-full z-50 flex items-center justify-center pointer-events-none",O.root,B().root)));var de=pt(be);const Be=ur(()=>el(to("dialog rounded bg-surface-100 elevation-4 overflow-y-auto pointer-events-auto relative outline-none",O.dialog,B().dialog,h.class)));var Fe=pt(de);{var Le=Ee=>{OC(Ee,{center:!0,class:"rounded",children:($e,He)=>{RC($e,{})},$$slots:{default:!0}})};Vi(Fe,Ee=>{M()&&Ee(Le)})}var we=Wt(Fe,2);zi(we,n,"header",{get open(){return b()},close:X},Ee=>{var $e=vi(),He=ni($e);{var Ge=Re=>{var Xe=jC();const Ue=ur(()=>el(to("text-xl font-bold pt-4 pb-2 px-6",O.title,B().title)));var Mt=pt(Xe);zi(Mt,n,"title",{get open(){return b()},close:X},null),ut(Xe),Mi(()=>lc(Xe,De(Ue),"")),rt(Re,Xe)};Vi(He,Re=>{o.title&&Re(Ge)})}rt(Ee,$e)});var Te=Wt(we,2);zi(Te,n,"default",{get open(){return b()},close:X},null);var fe=Wt(Te,2);{var Me=Ee=>{var $e=VC();const He=ur(()=>el(to("actions flex w-full justify-end p-2 bg-surface-content/5 border-t",O.actions,B().actions)));var Ge=pt($e);zi(Ge,n,"actions",{get open(){return b()},close:X},null),ut($e),Rr($e,Re=>di(C,Re),()=>De(C)),Mi(()=>lc($e,De(He),"")),rt(Ee,$e)};Vi(fe,Ee=>{o.actions&&Ee(Me)})}ut(de),Lt(()=>Ct("introstart",de,function(Ee){Nt.call(this,n,Ee)})),Lt(()=>Ct("outrostart",de,function(Ee){Nt.call(this,n,Ee)})),Lt(()=>Ct("introend",de,function(Ee){Nt.call(this,n,Ee)})),Lt(()=>Ct("outroend",de,function(Ee){Nt.call(this,n,Ee)})),Rr(de,Ee=>di(R,Ee),()=>De(R)),Tr(de,(Ee,$e)=>Mm==null?void 0:Mm(Ee,$e),()=>({restoreFocus:!0})),ut(be),Lt(()=>Ct("click",be,Y)),Lt(()=>Ct("keydown",be,Ee=>{Ee.key==="Escape"&&(Ee.stopPropagation(),X())})),Tr(be,(Ee,$e)=>dc==null?void 0:dc(Ee,$e),_),Mi(()=>{lc(be,De(Ae),""),lc(de,De(Be),""),Ti(de,"style",h.style)}),$n(5,de,()=>Q_,()=>({duration:150,easing:J_})),$n(2,de,()=>Q_,()=>({duration:150,easing:J_})),rt(_e,be)};Vi(te,_e=>{b()&&_e(ne)})}rt(i,Z),hn()}var Tv;(function(i){i[i.Year=0]="Year",i[i.Day=1]="Day",i[i.Hour=2]="Hour",i[i.Minute=3]="Minute",i[i.Second=4]="Second",i[i.Millisecond=5]="Millisecond"})(Tv||(Tv={}));var c0=Symbol.for("immer-nothing"),th=Symbol.for("immer-draftable"),sa=Symbol.for("immer-state");function Sr(i,...n){throw new Error(`[Immer] minified error nr: ${i}. Full error at: https://bit.ly/3cXEKWf`)}var al=Object.getPrototypeOf;function sl(i){return!!i&&!!i[sa]}function lo(i){var n;return i?fx(i)||Array.isArray(i)||!!i[th]||!!((n=i.constructor)!=null&&n[th])||bh(i)||xh(i):!1}var HC=Object.prototype.constructor.toString();function fx(i){if(!i||typeof i!="object")return!1;const n=al(i);if(n===null)return!0;const o=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return o===Object?!0:typeof o=="function"&&Function.toString.call(o)===HC}function lh(i,n){ol(i)===0?Reflect.ownKeys(i).forEach(o=>{n(o,i[o],i)}):i.forEach((o,h)=>n(h,o,i))}function ol(i){const n=i[sa];return n?n.type_:Array.isArray(i)?1:bh(i)?2:xh(i)?3:0}function ch(i,n){return ol(i)===2?i.has(n):Object.prototype.hasOwnProperty.call(i,n)}function Rm(i,n){return ol(i)===2?i.get(n):i[n]}function px(i,n,o){const h=ol(i);h===2?i.set(n,o):h===3?i.add(o):i[n]=o}function qC(i,n){return i===n?i!==0||1/i===1/n:i!==i&&n!==n}function bh(i){return i instanceof Map}function xh(i){return i instanceof Set}function Jo(i){return i.copy_||i.base_}function kg(i,n){if(bh(i))return new Map(i);if(xh(i))return new Set(i);if(Array.isArray(i))return Array.prototype.slice.call(i);const o=fx(i);if(n===!0||n==="class_only"&&!o){const h=Object.getOwnPropertyDescriptors(i);delete h[sa];let p=Reflect.ownKeys(h);for(let b=0;b<p.length;b++){const _=p[b],c=h[_];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(h[_]={configurable:!0,writable:!0,enumerable:c.enumerable,value:i[_]})}return Object.create(al(i),h)}else{const h=al(i);if(h!==null&&o)return{...i};const p=Object.create(h);return Object.assign(p,i)}}function u0(i,n=!1){return Pf(i)||sl(i)||!lo(i)||(ol(i)>1&&(i.set=i.add=i.clear=i.delete=GC),Object.freeze(i),n&&Object.entries(i).forEach(([o,h])=>u0(h,!0))),i}function GC(){Sr(2)}function Pf(i){return Object.isFrozen(i)}var Ag={};function ll(i){const n=Ag[i];return n||Sr(0,i),n}function ZC(i,n){Ag[i]||(Ag[i]=n)}var uh;function mx(){return uh}function XC(i,n){return{drafts_:[],parent_:i,immer_:n,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Sv(i,n){n&&(ll("Patches"),i.patches_=[],i.inversePatches_=[],i.patchListener_=n)}function Mg(i){Ig(i),i.drafts_.forEach(YC),i.drafts_=null}function Ig(i){i===uh&&(uh=i.parent_)}function kv(i){return uh=XC(uh,i)}function YC(i){const n=i[sa];n.type_===0||n.type_===1?n.revoke_():n.revoked_=!0}function Av(i,n){n.unfinalizedDrafts_=n.drafts_.length;const o=n.drafts_[0];return i!==void 0&&i!==o?(o[sa].modified_&&(Mg(n),Sr(4)),lo(i)&&(i=cf(n,i),n.parent_||uf(n,i)),n.patches_&&ll("Patches").generateReplacementPatches_(o[sa].base_,i,n.patches_,n.inversePatches_)):i=cf(n,o,[]),Mg(n),n.patches_&&n.patchListener_(n.patches_,n.inversePatches_),i!==c0?i:void 0}function cf(i,n,o){if(Pf(n))return n;const h=n[sa];if(!h)return lh(n,(p,b)=>Mv(i,h,n,p,b,o)),n;if(h.scope_!==i)return n;if(!h.modified_)return uf(i,h.base_,!0),h.base_;if(!h.finalized_){h.finalized_=!0,h.scope_.unfinalizedDrafts_--;const p=h.copy_;let b=p,_=!1;h.type_===3&&(b=new Set(p),p.clear(),_=!0),lh(b,(c,M)=>Mv(i,h,p,c,M,o,_)),uf(i,p,!1),o&&i.patches_&&ll("Patches").generatePatches_(h,o,i.patches_,i.inversePatches_)}return h.copy_}function Mv(i,n,o,h,p,b,_){if(sl(p)){const c=b&&n&&n.type_!==3&&!ch(n.assigned_,h)?b.concat(h):void 0,M=cf(i,p,c);if(px(o,h,M),sl(M))i.canAutoFreeze_=!1;else return}else _&&o.add(p);if(lo(p)&&!Pf(p)){if(!i.immer_.autoFreeze_&&i.unfinalizedDrafts_<1)return;cf(i,p),(!n||!n.scope_.parent_)&&typeof h!="symbol"&&Object.prototype.propertyIsEnumerable.call(o,h)&&uf(i,p)}}function uf(i,n,o=!1){!i.parent_&&i.immer_.autoFreeze_&&i.canAutoFreeze_&&u0(n,o)}function KC(i,n){const o=Array.isArray(i),h={type_:o?1:0,scope_:n?n.scope_:mx(),modified_:!1,finalized_:!1,assigned_:{},parent_:n,base_:i,draft_:null,copy_:null,revoke_:null,isManual_:!1};let p=h,b=h0;o&&(p=[h],b=hh);const{revoke:_,proxy:c}=Proxy.revocable(p,b);return h.draft_=c,h.revoke_=_,c}var h0={get(i,n){if(n===sa)return i;const o=Jo(i);if(!ch(o,n))return JC(i,o,n);const h=o[n];return i.finalized_||!lo(h)?h:h===Bm(i.base_,n)?(Om(i),i.copy_[n]=Cg(h,i)):h},has(i,n){return n in Jo(i)},ownKeys(i){return Reflect.ownKeys(Jo(i))},set(i,n,o){const h=gx(Jo(i),n);if(h!=null&&h.set)return h.set.call(i.draft_,o),!0;if(!i.modified_){const p=Bm(Jo(i),n),b=p==null?void 0:p[sa];if(b&&b.base_===o)return i.copy_[n]=o,i.assigned_[n]=!1,!0;if(qC(o,p)&&(o!==void 0||ch(i.base_,n)))return!0;Om(i),Eg(i)}return i.copy_[n]===o&&(o!==void 0||n in i.copy_)||Number.isNaN(o)&&Number.isNaN(i.copy_[n])||(i.copy_[n]=o,i.assigned_[n]=!0),!0},deleteProperty(i,n){return Bm(i.base_,n)!==void 0||n in i.base_?(i.assigned_[n]=!1,Om(i),Eg(i)):delete i.assigned_[n],i.copy_&&delete i.copy_[n],!0},getOwnPropertyDescriptor(i,n){const o=Jo(i),h=Reflect.getOwnPropertyDescriptor(o,n);return h&&{writable:!0,configurable:i.type_!==1||n!=="length",enumerable:h.enumerable,value:o[n]}},defineProperty(){Sr(11)},getPrototypeOf(i){return al(i.base_)},setPrototypeOf(){Sr(12)}},hh={};lh(h0,(i,n)=>{hh[i]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}});hh.deleteProperty=function(i,n){return hh.set.call(this,i,n,void 0)};hh.set=function(i,n,o){return h0.set.call(this,i[0],n,o,i[0])};function Bm(i,n){const o=i[sa];return(o?Jo(o):i)[n]}function JC(i,n,o){var p;const h=gx(n,o);return h?"value"in h?h.value:(p=h.get)==null?void 0:p.call(i.draft_):void 0}function gx(i,n){if(!(n in i))return;let o=al(i);for(;o;){const h=Object.getOwnPropertyDescriptor(o,n);if(h)return h;o=al(o)}}function Eg(i){i.modified_||(i.modified_=!0,i.parent_&&Eg(i.parent_))}function Om(i){i.copy_||(i.copy_=kg(i.base_,i.scope_.immer_.useStrictShallowCopy_))}var QC=class{constructor(i){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(n,o,h)=>{if(typeof n=="function"&&typeof o!="function"){const b=o;o=n;const _=this;return function(M=b,...B){return _.produce(M,O=>o.call(this,O,...B))}}typeof o!="function"&&Sr(6),h!==void 0&&typeof h!="function"&&Sr(7);let p;if(lo(n)){const b=kv(this),_=Cg(n,void 0);let c=!0;try{p=o(_),c=!1}finally{c?Mg(b):Ig(b)}return Sv(b,h),Av(p,b)}else if(!n||typeof n!="object"){if(p=o(n),p===void 0&&(p=n),p===c0&&(p=void 0),this.autoFreeze_&&u0(p,!0),h){const b=[],_=[];ll("Patches").generateReplacementPatches_(n,p,b,_),h(b,_)}return p}else Sr(1,n)},this.produceWithPatches=(n,o)=>{if(typeof n=="function")return(_,...c)=>this.produceWithPatches(_,M=>n(M,...c));let h,p;return[this.produce(n,o,(_,c)=>{h=_,p=c}),h,p]},typeof(i==null?void 0:i.autoFreeze)=="boolean"&&this.setAutoFreeze(i.autoFreeze),typeof(i==null?void 0:i.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(i.useStrictShallowCopy)}createDraft(i){lo(i)||Sr(8),sl(i)&&(i=eP(i));const n=kv(this),o=Cg(i,void 0);return o[sa].isManual_=!0,Ig(n),o}finishDraft(i,n){const o=i&&i[sa];(!o||!o.isManual_)&&Sr(9);const{scope_:h}=o;return Sv(h,n),Av(void 0,h)}setAutoFreeze(i){this.autoFreeze_=i}setUseStrictShallowCopy(i){this.useStrictShallowCopy_=i}applyPatches(i,n){let o;for(o=n.length-1;o>=0;o--){const p=n[o];if(p.path.length===0&&p.op==="replace"){i=p.value;break}}o>-1&&(n=n.slice(o+1));const h=ll("Patches").applyPatches_;return sl(i)?h(i,n):this.produce(i,p=>h(p,n))}};function Cg(i,n){const o=bh(i)?ll("MapSet").proxyMap_(i,n):xh(i)?ll("MapSet").proxySet_(i,n):KC(i,n);return(n?n.scope_:mx()).drafts_.push(o),o}function eP(i){return sl(i)||Sr(10,i),yx(i)}function yx(i){if(!lo(i)||Pf(i))return i;const n=i[sa];let o;if(n){if(!n.modified_)return n.base_;n.finalized_=!0,o=kg(i,n.scope_.immer_.useStrictShallowCopy_)}else o=kg(i,!0);return lh(o,(h,p)=>{px(o,h,yx(p))}),n&&(n.finalized_=!1),o}function tP(){const n="replace",o="add",h="remove";function p(C,Y,X,Z){switch(C.type_){case 0:case 2:return _(C,Y,X,Z);case 1:return b(C,Y,X,Z);case 3:return c(C,Y,X,Z)}}function b(C,Y,X,Z){let{base_:se,assigned_:q}=C,te=C.copy_;te.length<se.length&&([se,te]=[te,se],[X,Z]=[Z,X]);for(let ne=0;ne<se.length;ne++)if(q[ne]&&te[ne]!==se[ne]){const _e=Y.concat([ne]);X.push({op:n,path:_e,value:R(te[ne])}),Z.push({op:n,path:_e,value:R(se[ne])})}for(let ne=se.length;ne<te.length;ne++){const _e=Y.concat([ne]);X.push({op:o,path:_e,value:R(te[ne])})}for(let ne=te.length-1;se.length<=ne;--ne){const _e=Y.concat([ne]);Z.push({op:h,path:_e})}}function _(C,Y,X,Z){const{base_:se,copy_:q}=C;lh(C.assigned_,(te,ne)=>{const _e=Rm(se,te),be=Rm(q,te),Ae=ne?ch(se,te)?n:o:h;if(_e===be&&Ae===n)return;const de=Y.concat(te);X.push(Ae===h?{op:Ae,path:de}:{op:Ae,path:de,value:be}),Z.push(Ae===o?{op:h,path:de}:Ae===h?{op:o,path:de,value:R(_e)}:{op:n,path:de,value:R(_e)})})}function c(C,Y,X,Z){let{base_:se,copy_:q}=C,te=0;se.forEach(ne=>{if(!q.has(ne)){const _e=Y.concat([te]);X.push({op:h,path:_e,value:ne}),Z.unshift({op:o,path:_e,value:ne})}te++}),te=0,q.forEach(ne=>{if(!se.has(ne)){const _e=Y.concat([te]);X.push({op:o,path:_e,value:ne}),Z.unshift({op:h,path:_e,value:ne})}te++})}function M(C,Y,X,Z){X.push({op:n,path:[],value:Y===c0?void 0:Y}),Z.push({op:n,path:[],value:C})}function B(C,Y){return Y.forEach(X=>{const{path:Z,op:se}=X;let q=C;for(let be=0;be<Z.length-1;be++){const Ae=ol(q);let de=Z[be];typeof de!="string"&&typeof de!="number"&&(de=""+de),(Ae===0||Ae===1)&&(de==="__proto__"||de==="constructor")&&Sr(19),typeof q=="function"&&de==="prototype"&&Sr(19),q=Rm(q,de),typeof q!="object"&&Sr(18,Z.join("/"))}const te=ol(q),ne=O(X.value),_e=Z[Z.length-1];switch(se){case n:switch(te){case 2:return q.set(_e,ne);case 3:Sr(16);default:return q[_e]=ne}case o:switch(te){case 1:return _e==="-"?q.push(ne):q.splice(_e,0,ne);case 2:return q.set(_e,ne);case 3:return q.add(ne);default:return q[_e]=ne}case h:switch(te){case 1:return q.splice(_e,1);case 2:return q.delete(_e);case 3:return q.delete(X.value);default:return delete q[_e]}default:Sr(17,se)}}),C}function O(C){if(!lo(C))return C;if(Array.isArray(C))return C.map(O);if(bh(C))return new Map(Array.from(C.entries()).map(([X,Z])=>[X,O(Z)]));if(xh(C))return new Set(Array.from(C).map(O));const Y=Object.create(al(C));for(const X in C)Y[X]=O(C[X]);return ch(C,th)&&(Y[th]=C[th]),Y}function R(C){return sl(C)?O(C):C}ZC("Patches",{applyPatches_:B,generatePatches_:p,generateReplacementPatches_:M})}var oa=new QC;oa.produce;oa.produceWithPatches.bind(oa);var iP=oa.setAutoFreeze.bind(oa);oa.setUseStrictShallowCopy.bind(oa);oa.applyPatches.bind(oa);oa.createDraft.bind(oa);oa.finishDraft.bind(oa);tP();iP(!1);const _x=(i,n)=>{if(typeof i=="number"){if(n===3)return{mode:"rgb",r:(i>>8&15|i>>4&240)/255,g:(i>>4&15|i&240)/255,b:(i&15|i<<4&240)/255};if(n===4)return{mode:"rgb",r:(i>>12&15|i>>8&240)/255,g:(i>>8&15|i>>4&240)/255,b:(i>>4&15|i&240)/255,alpha:(i&15|i<<4&240)/255};if(n===6)return{mode:"rgb",r:(i>>16&255)/255,g:(i>>8&255)/255,b:(i&255)/255};if(n===8)return{mode:"rgb",r:(i>>24&255)/255,g:(i>>16&255)/255,b:(i>>8&255)/255,alpha:(i&255)/255}}},nP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},rP=i=>_x(nP[i.toLowerCase()],6),aP=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,sP=i=>{let n;return(n=i.match(aP))?_x(parseInt(n[1],16),n[1].length):void 0},so="([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)",ih=`${so}%`,d0=`(?:${so}%|${so})`,oP=`(?:${so}(deg|grad|rad|turn)|${so})`,wc="\\s*,\\s*",lP=new RegExp(`^rgba?\\(\\s*${so}${wc}${so}${wc}${so}\\s*(?:,\\s*${d0}\\s*)?\\)$`),cP=new RegExp(`^rgba?\\(\\s*${ih}${wc}${ih}${wc}${ih}\\s*(?:,\\s*${d0}\\s*)?\\)$`),uP=i=>{let n={mode:"rgb"},o;if(o=i.match(lP))o[1]!==void 0&&(n.r=o[1]/255),o[2]!==void 0&&(n.g=o[2]/255),o[3]!==void 0&&(n.b=o[3]/255);else if(o=i.match(cP))o[1]!==void 0&&(n.r=o[1]/100),o[2]!==void 0&&(n.g=o[2]/100),o[3]!==void 0&&(n.b=o[3]/100);else return;return o[4]!==void 0?n.alpha=Math.max(0,Math.min(1,o[4]/100)):o[5]!==void 0&&(n.alpha=Math.max(0,Math.min(1,+o[5]))),n},hP=(i,n)=>i===void 0?void 0:typeof i!="object"?wP(i):i.mode!==void 0?i:n?{...i,mode:n}:void 0,dP=(i="rgb")=>n=>(n=hP(n,i))!==void 0?n.mode===i?n:ja[n.mode][i]?ja[n.mode][i](n):i==="rgb"?ja[n.mode].rgb(n):ja.rgb[i](ja[n.mode].rgb(n)):void 0,ja={},vx={},hf=[],bx={},fP=i=>i,qi=i=>(ja[i.mode]={...ja[i.mode],...i.toMode},Object.keys(i.fromMode||{}).forEach(n=>{ja[n]||(ja[n]={}),ja[n][i.mode]=i.fromMode[n]}),i.ranges||(i.ranges={}),i.difference||(i.difference={}),i.channels.forEach(n=>{if(i.ranges[n]===void 0&&(i.ranges[n]=[0,1]),!i.interpolate[n])throw new Error(`Missing interpolator for: ${n}`);typeof i.interpolate[n]=="function"&&(i.interpolate[n]={use:i.interpolate[n]}),i.interpolate[n].fixup||(i.interpolate[n].fixup=fP)}),vx[i.mode]=i,(i.parse||[]).forEach(n=>{mP(n,i.mode)}),dP(i.mode)),pP=i=>vx[i],mP=(i,n)=>{if(typeof i=="string"){if(!n)throw new Error("'mode' required when 'parser' is a string");bx[i]=n}else typeof i=="function"&&hf.indexOf(i)<0&&hf.push(i)},Pg=/[^\x00-\x7F]|[a-zA-Z_]/,gP=/[^\x00-\x7F]|[-\w]/,et={Function:"function",Ident:"ident",Number:"number",Percentage:"percentage",ParenClose:")",None:"none",Hue:"hue",Alpha:"alpha"};let Zt=0;function Wd(i){let n=i[Zt],o=i[Zt+1];return n==="-"||n==="+"?/\d/.test(o)||o==="."&&/\d/.test(i[Zt+2]):n==="."?/\d/.test(o):/\d/.test(n)}function zg(i){if(Zt>=i.length)return!1;let n=i[Zt];if(Pg.test(n))return!0;if(n==="-"){if(i.length-Zt<2)return!1;let o=i[Zt+1];return!!(o==="-"||Pg.test(o))}return!1}const yP={deg:1,rad:180/Math.PI,grad:9/10,turn:360};function Gu(i){let n="";if((i[Zt]==="-"||i[Zt]==="+")&&(n+=i[Zt++]),n+=Hd(i),i[Zt]==="."&&/\d/.test(i[Zt+1])&&(n+=i[Zt++]+Hd(i)),(i[Zt]==="e"||i[Zt]==="E")&&((i[Zt+1]==="-"||i[Zt+1]==="+")&&/\d/.test(i[Zt+2])?n+=i[Zt++]+i[Zt++]+Hd(i):/\d/.test(i[Zt+1])&&(n+=i[Zt++]+Hd(i))),zg(i)){let o=df(i);return o==="deg"||o==="rad"||o==="turn"||o==="grad"?{type:et.Hue,value:n*yP[o]}:void 0}return i[Zt]==="%"?(Zt++,{type:et.Percentage,value:+n}):{type:et.Number,value:+n}}function Hd(i){let n="";for(;/\d/.test(i[Zt]);)n+=i[Zt++];return n}function df(i){let n="";for(;Zt<i.length&&gP.test(i[Zt]);)n+=i[Zt++];return n}function _P(i){let n=df(i);return i[Zt]==="("?(Zt++,{type:et.Function,value:n}):n==="none"?{type:et.None,value:void 0}:{type:et.Ident,value:n}}function vP(i=""){let n=i.trim(),o=[],h;for(Zt=0;Zt<n.length;){if(h=n[Zt++],h===`
`||h==="	"||h===" "){for(;Zt<n.length&&(n[Zt]===`
`||n[Zt]==="	"||n[Zt]===" ");)Zt++;continue}if(h===",")return;if(h===")"){o.push({type:et.ParenClose});continue}if(h==="+"){if(Zt--,Wd(n)){o.push(Gu(n));continue}return}if(h==="-"){if(Zt--,Wd(n)){o.push(Gu(n));continue}if(zg(n)){o.push({type:et.Ident,value:df(n)});continue}return}if(h==="."){if(Zt--,Wd(n)){o.push(Gu(n));continue}return}if(h==="/"){for(;Zt<n.length&&(n[Zt]===`
`||n[Zt]==="	"||n[Zt]===" ");)Zt++;let p;if(Wd(n)&&(p=Gu(n),p.type!==et.Hue)){o.push({type:et.Alpha,value:p});continue}if(zg(n)&&df(n)==="none"){o.push({type:et.Alpha,value:{type:et.None,value:void 0}});continue}return}if(/\d/.test(h)){Zt--,o.push(Gu(n));continue}if(Pg.test(h)){Zt--,o.push(_P(n));continue}return}return o}function bP(i){i._i=0;let n=i[i._i++];if(!n||n.type!==et.Function||n.value!=="color"||(n=i[i._i++],n.type!==et.Ident))return;const o=bx[n.value];if(!o)return;const h={mode:o},p=xx(i,!1);if(!p)return;const b=pP(o).channels;for(let _=0,c,M;_<b.length;_++)c=p[_],M=b[_],c.type!==et.None&&(h[M]=c.type===et.Number?c.value:c.value/100,M==="alpha"&&(h[M]=Math.max(0,Math.min(1,h[M]))));return h}function xx(i,n){const o=[];let h;for(;i._i<i.length;){if(h=i[i._i++],h.type===et.None||h.type===et.Number||h.type===et.Alpha||h.type===et.Percentage||n&&h.type===et.Hue){o.push(h);continue}if(h.type===et.ParenClose){if(i._i<i.length)return;continue}return}if(!(o.length<3||o.length>4)){if(o.length===4){if(o[3].type!==et.Alpha)return;o[3]=o[3].value}return o.length===3&&o.push({type:et.None,value:void 0}),o.every(p=>p.type!==et.Alpha)?o:void 0}}function xP(i,n){i._i=0;let o=i[i._i++];if(!o||o.type!==et.Function)return;let h=xx(i,n);if(h)return h.unshift(o.value),h}const wP=i=>{if(typeof i!="string")return;const n=vP(i),o=n?xP(n,!0):void 0;let h,p=0,b=hf.length;for(;p<b;)if((h=hf[p++](i,o))!==void 0)return h;return n?bP(n):void 0};function TP(i,n){if(!n||n[0]!=="rgb"&&n[0]!=="rgba")return;const o={mode:"rgb"},[,h,p,b,_]=n;if(!(h.type===et.Hue||p.type===et.Hue||b.type===et.Hue))return h.type!==et.None&&(o.r=h.type===et.Number?h.value/255:h.value/100),p.type!==et.None&&(o.g=p.type===et.Number?p.value/255:p.value/100),b.type!==et.None&&(o.b=b.type===et.Number?b.value/255:b.value/100),_.type!==et.None&&(o.alpha=Math.min(1,Math.max(0,_.type===et.Number?_.value:_.value/100))),o}const SP=i=>i==="transparent"?{mode:"rgb",r:0,g:0,b:0,alpha:0}:void 0,kP=(i,n,o)=>i+o*(n-i),AP=i=>{let n=[];for(let o=0;o<i.length-1;o++){let h=i[o],p=i[o+1];h===void 0&&p===void 0?n.push(void 0):h!==void 0&&p!==void 0?n.push([h,p]):n.push(h!==void 0?[h,h]:[p,p])}return n},MP=i=>n=>{let o=AP(n);return h=>{let p=h*o.length,b=h>=1?o.length-1:Math.max(Math.floor(p),0),_=o[b];return _===void 0?void 0:i(_[0],_[1],p-b)}},gt=MP(kP),Un=i=>{let n=!1,o=i.map(h=>h!==void 0?(n=!0,h):1);return n?o:i},zc={mode:"rgb",channels:["r","g","b","alpha"],parse:[TP,sP,uP,rP,SP,"srgb"],serialize:"srgb",interpolate:{r:gt,g:gt,b:gt,alpha:{use:gt,fixup:Un}},gamut:!0,white:{r:1,g:1,b:1},black:{r:0,g:0,b:0}},Fm=(i=0)=>Math.pow(Math.abs(i),563/256)*Math.sign(i),Iv=i=>{let n=Fm(i.r),o=Fm(i.g),h=Fm(i.b),p={mode:"xyz65",x:.5766690429101305*n+.1855582379065463*o+.1882286462349947*h,y:.297344975250536*n+.6273635662554661*o+.0752914584939979*h,z:.0270313613864123*n+.0706888525358272*o+.9913375368376386*h};return i.alpha!==void 0&&(p.alpha=i.alpha),p},Nm=i=>Math.pow(Math.abs(i),256/563)*Math.sign(i),Ev=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p={mode:"a98",r:Nm(i*2.0415879038107465-n*.5650069742788597-.3447313507783297*o),g:Nm(i*-.9692436362808798+n*1.8759675015077206+.0415550574071756*o),b:Nm(i*.0134442806320312-n*.1183623922310184+1.0151749943912058*o)};return h!==void 0&&(p.alpha=h),p},jm=(i=0)=>{const n=Math.abs(i);return n<=.04045?i/12.92:(Math.sign(i)||1)*Math.pow((n+.055)/1.055,2.4)},Dc=({r:i,g:n,b:o,alpha:h})=>{let p={mode:"lrgb",r:jm(i),g:jm(n),b:jm(o)};return h!==void 0&&(p.alpha=h),p},ul=i=>{let{r:n,g:o,b:h,alpha:p}=Dc(i),b={mode:"xyz65",x:.4123907992659593*n+.357584339383878*o+.1804807884018343*h,y:.2126390058715102*n+.715168678767756*o+.0721923153607337*h,z:.0193308187155918*n+.119194779794626*o+.9505321522496607*h};return p!==void 0&&(b.alpha=p),b},Vm=(i=0)=>{const n=Math.abs(i);return n>.0031308?(Math.sign(i)||1)*(1.055*Math.pow(n,1/2.4)-.055):i*12.92},Lc=({r:i,g:n,b:o,alpha:h},p="rgb")=>{let b={mode:p,r:Vm(i),g:Vm(n),b:Vm(o)};return h!==void 0&&(b.alpha=h),b},hl=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Lc({r:i*3.2409699419045226-n*1.537383177570094-.4986107602930034*o,g:i*-.9692436362808796+n*1.8759675015077204+.0415550574071756*o,b:i*.0556300796969936-n*.2039769588889765+1.0569715142428784*o});return h!==void 0&&(p.alpha=h),p},IP={...zc,mode:"a98",parse:["a98-rgb"],serialize:"a98-rgb",fromMode:{rgb:i=>Ev(ul(i)),xyz65:Ev},toMode:{rgb:i=>hl(Iv(i)),xyz65:Iv}},hr=i=>(i=i%360)<0?i+360:i,EP=(i,n)=>i.map((o,h,p)=>{if(o===void 0)return o;let b=hr(o);return h===0||i[h-1]===void 0?b:n(b-hr(p[h-1]))}).reduce((o,h)=>!o.length||h===void 0||o[o.length-1]===void 0?(o.push(h),o):(o.push(h+o[o.length-1]),o),[]),ws=i=>EP(i,n=>Math.abs(n)<=180?n:n-360*Math.sign(n)),Kn=[-.14861,1.78277,-.29227,-.90649,1.97294,0],CP=Math.PI/180,PP=180/Math.PI;let Cv=Kn[3]*Kn[4],Pv=Kn[1]*Kn[4],zv=Kn[1]*Kn[2]-Kn[0]*Kn[3];const zP=({r:i,g:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=(zv*o+i*Cv-n*Pv)/(zv+Cv-Pv),b=o-p,_=(Kn[4]*(n-p)-Kn[2]*b)/Kn[3],c={mode:"cubehelix",l:p,s:p===0||p===1?void 0:Math.sqrt(b*b+_*_)/(Kn[4]*p*(1-p))};return c.s&&(c.h=Math.atan2(_,b)*PP-120),h!==void 0&&(c.alpha=h),c},DP=({h:i,s:n,l:o,alpha:h})=>{let p={mode:"rgb"};i=(i===void 0?0:i+120)*CP,o===void 0&&(o=0);let b=n===void 0?0:n*o*(1-o),_=Math.cos(i),c=Math.sin(i);return p.r=o+b*(Kn[0]*_+Kn[1]*c),p.g=o+b*(Kn[2]*_+Kn[3]*c),p.b=o+b*(Kn[4]*_+Kn[5]*c),h!==void 0&&(p.alpha=h),p},zf=(i,n)=>{if(i.h===void 0||n.h===void 0||!i.s||!n.s)return 0;let o=hr(i.h),h=hr(n.h),p=Math.sin((h-o+360)/2*Math.PI/180);return 2*Math.sqrt(i.s*n.s)*p},LP=(i,n)=>{if(i.h===void 0||n.h===void 0)return 0;let o=hr(i.h),h=hr(n.h);return Math.abs(h-o)>180?o-(h-360*Math.sign(h-o)):h-o},Df=(i,n)=>{if(i.h===void 0||n.h===void 0||!i.c||!n.c)return 0;let o=hr(i.h),h=hr(n.h),p=Math.sin((h-o+360)/2*Math.PI/180);return 2*Math.sqrt(i.c*n.c)*p},Ts=i=>{let n=i.reduce((h,p)=>{if(p!==void 0){let b=p*Math.PI/180;h.sin+=Math.sin(b),h.cos+=Math.cos(b)}return h},{sin:0,cos:0}),o=Math.atan2(n.sin,n.cos)*180/Math.PI;return o<0?360+o:o},RP={mode:"cubehelix",channels:["h","s","l","alpha"],parse:["--cubehelix"],serialize:"--cubehelix",ranges:{h:[0,360],s:[0,4.614],l:[0,1]},fromMode:{rgb:zP},toMode:{rgb:DP},interpolate:{h:{use:gt,fixup:ws},s:gt,l:gt,alpha:{use:gt,fixup:Un}},difference:{h:zf},average:{h:Ts}},co=({l:i,a:n,b:o,alpha:h},p="lch")=>{n===void 0&&(n=0),o===void 0&&(o=0);let b=Math.sqrt(n*n+o*o),_={mode:p,l:i,c:b};return b&&(_.h=hr(Math.atan2(o,n)*180/Math.PI)),h!==void 0&&(_.alpha=h),_},uo=({l:i,c:n,h:o,alpha:h},p="lab")=>{o===void 0&&(o=0);let b={mode:p,l:i,a:n?n*Math.cos(o/180*Math.PI):0,b:n?n*Math.sin(o/180*Math.PI):0};return h!==void 0&&(b.alpha=h),b},wx=Math.pow(29,3)/Math.pow(3,3),Tx=Math.pow(6,3)/Math.pow(29,3),On={X:.3457/.3585,Y:1,Z:(1-.3457-.3585)/.3585},pc={X:.3127/.329,Y:1,Z:(1-.3127-.329)/.329};let $m=i=>Math.pow(i,3)>Tx?Math.pow(i,3):(116*i-16)/wx;const Sx=({l:i,a:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=(i+16)/116,b=n/500+p,_=p-o/200,c={mode:"xyz65",x:$m(b)*pc.X,y:$m(p)*pc.Y,z:$m(_)*pc.Z};return h!==void 0&&(c.alpha=h),c},Lf=i=>hl(Sx(i)),Um=i=>i>Tx?Math.cbrt(i):(wx*i+16)/116,kx=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Um(i/pc.X),b=Um(n/pc.Y),_=Um(o/pc.Z),c={mode:"lab65",l:116*b-16,a:500*(p-b),b:200*(b-_)};return h!==void 0&&(c.alpha=h),c},Rf=i=>{let n=kx(ul(i));return i.r===i.b&&i.b===i.g&&(n.a=n.b=0),n},ff=1,Ax=1,dh=26/180*Math.PI,pf=Math.cos(dh),mf=Math.sin(dh),Mx=100/Math.log(139/100),Dg=({l:i,c:n,h:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p={mode:"lab65",l:(Math.exp(i*ff/Mx)-1)/.0039},b=(Math.exp(.0435*n*Ax*ff)-1)/.075,_=b*Math.cos(o/180*Math.PI-dh),c=b*Math.sin(o/180*Math.PI-dh);return p.a=_*pf-c/.83*mf,p.b=_*mf+c/.83*pf,h!==void 0&&(p.alpha=h),p},Lg=({l:i,a:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=n*pf+o*mf,b=.83*(o*pf-n*mf),_=Math.sqrt(p*p+b*b),c={mode:"dlch",l:Mx/ff*Math.log(1+.0039*i),c:Math.log(1+.075*_)/(.0435*Ax*ff)};return c.c&&(c.h=hr((Math.atan2(b,p)+dh)/Math.PI*180)),h!==void 0&&(c.alpha=h),c},Dv=i=>Dg(co(i,"dlch")),Lv=i=>uo(Lg(i),"dlab"),BP={mode:"dlab",parse:["--din99o-lab"],serialize:"--din99o-lab",toMode:{lab65:Dv,rgb:i=>Lf(Dv(i))},fromMode:{lab65:Lv,rgb:i=>Lv(Rf(i))},channels:["l","a","b","alpha"],ranges:{l:[0,100],a:[-40.09,45.501],b:[-40.469,44.344]},interpolate:{l:gt,a:gt,b:gt,alpha:{use:gt,fixup:Un}}},OP={mode:"dlch",parse:["--din99o-lch"],serialize:"--din99o-lch",toMode:{lab65:Dg,dlab:i=>uo(i,"dlab"),rgb:i=>Lf(Dg(i))},fromMode:{lab65:Lg,dlab:i=>co(i,"dlch"),rgb:i=>Lg(Rf(i))},channels:["l","c","h","alpha"],ranges:{l:[0,100],c:[0,51.484],h:[0,360]},interpolate:{l:gt,c:gt,h:{use:gt,fixup:ws},alpha:{use:gt,fixup:Un}},difference:{h:Df},average:{h:Ts}};function FP({h:i,s:n,i:o,alpha:h}){i=hr(i!==void 0?i:0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.abs(i/60%2-1),b;switch(Math.floor(i/60)){case 0:b={r:o*(1+n*(3/(2-p)-1)),g:o*(1+n*(3*(1-p)/(2-p)-1)),b:o*(1-n)};break;case 1:b={r:o*(1+n*(3*(1-p)/(2-p)-1)),g:o*(1+n*(3/(2-p)-1)),b:o*(1-n)};break;case 2:b={r:o*(1-n),g:o*(1+n*(3/(2-p)-1)),b:o*(1+n*(3*(1-p)/(2-p)-1))};break;case 3:b={r:o*(1-n),g:o*(1+n*(3*(1-p)/(2-p)-1)),b:o*(1+n*(3/(2-p)-1))};break;case 4:b={r:o*(1+n*(3*(1-p)/(2-p)-1)),g:o*(1-n),b:o*(1+n*(3/(2-p)-1))};break;case 5:b={r:o*(1+n*(3/(2-p)-1)),g:o*(1-n),b:o*(1+n*(3*(1-p)/(2-p)-1))};break;default:b={r:o*(1-n),g:o*(1-n),b:o*(1-n)}}return b.mode="rgb",h!==void 0&&(b.alpha=h),b}function NP({r:i,g:n,b:o,alpha:h}){i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.max(i,n,o),b=Math.min(i,n,o),_={mode:"hsi",s:i+n+o===0?0:1-3*b/(i+n+o),i:(i+n+o)/3};return p-b!==0&&(_.h=(p===i?(n-o)/(p-b)+(n<o)*6:p===n?(o-i)/(p-b)+2:(i-n)/(p-b)+4)*60),h!==void 0&&(_.alpha=h),_}const jP={mode:"hsi",toMode:{rgb:FP},parse:["--hsi"],serialize:"--hsi",fromMode:{rgb:NP},channels:["h","s","i","alpha"],ranges:{h:[0,360]},gamut:"rgb",interpolate:{h:{use:gt,fixup:ws},s:gt,i:gt,alpha:{use:gt,fixup:Un}},difference:{h:zf},average:{h:Ts}};function VP({h:i,s:n,l:o,alpha:h}){i=hr(i!==void 0?i:0),n===void 0&&(n=0),o===void 0&&(o=0);let p=o+n*(o<.5?o:1-o),b=p-(p-o)*2*Math.abs(i/60%2-1),_;switch(Math.floor(i/60)){case 0:_={r:p,g:b,b:2*o-p};break;case 1:_={r:b,g:p,b:2*o-p};break;case 2:_={r:2*o-p,g:p,b};break;case 3:_={r:2*o-p,g:b,b:p};break;case 4:_={r:b,g:2*o-p,b:p};break;case 5:_={r:p,g:2*o-p,b};break;default:_={r:2*o-p,g:2*o-p,b:2*o-p}}return _.mode="rgb",h!==void 0&&(_.alpha=h),_}function $P({r:i,g:n,b:o,alpha:h}){i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.max(i,n,o),b=Math.min(i,n,o),_={mode:"hsl",s:p===b?0:(p-b)/(1-Math.abs(p+b-1)),l:.5*(p+b)};return p-b!==0&&(_.h=(p===i?(n-o)/(p-b)+(n<o)*6:p===n?(o-i)/(p-b)+2:(i-n)/(p-b)+4)*60),h!==void 0&&(_.alpha=h),_}const UP=(i,n)=>{switch(n){case"deg":return+i;case"rad":return i/Math.PI*180;case"grad":return i/10*9;case"turn":return i*360}},WP=new RegExp(`^hsla?\\(\\s*${oP}${wc}${ih}${wc}${ih}\\s*(?:,\\s*${d0}\\s*)?\\)$`),HP=i=>{let n=i.match(WP);if(!n)return;let o={mode:"hsl"};return n[3]!==void 0?o.h=+n[3]:n[1]!==void 0&&n[2]!==void 0&&(o.h=UP(n[1],n[2])),n[4]!==void 0&&(o.s=Math.min(Math.max(0,n[4]/100),1)),n[5]!==void 0&&(o.l=Math.min(Math.max(0,n[5]/100),1)),n[6]!==void 0?o.alpha=Math.max(0,Math.min(1,n[6]/100)):n[7]!==void 0&&(o.alpha=Math.max(0,Math.min(1,+n[7]))),o};function qP(i,n){if(!n||n[0]!=="hsl"&&n[0]!=="hsla")return;const o={mode:"hsl"},[,h,p,b,_]=n;if(h.type!==et.None){if(h.type===et.Percentage)return;o.h=h.value}if(p.type!==et.None){if(p.type===et.Hue)return;o.s=p.value/100}if(b.type!==et.None){if(b.type===et.Hue)return;o.l=b.value/100}return _.type!==et.None&&(o.alpha=Math.min(1,Math.max(0,_.type===et.Number?_.value:_.value/100))),o}const Ix={mode:"hsl",toMode:{rgb:VP},fromMode:{rgb:$P},channels:["h","s","l","alpha"],ranges:{h:[0,360]},gamut:"rgb",parse:[qP,HP],serialize:i=>`hsl(${i.h!==void 0?i.h:"none"} ${i.s!==void 0?i.s*100+"%":"none"} ${i.l!==void 0?i.l*100+"%":"none"}${i.alpha<1?` / ${i.alpha}`:""})`,interpolate:{h:{use:gt,fixup:ws},s:gt,l:gt,alpha:{use:gt,fixup:Un}},difference:{h:zf},average:{h:Ts}};function Ex({h:i,s:n,v:o,alpha:h}){i=hr(i!==void 0?i:0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.abs(i/60%2-1),b;switch(Math.floor(i/60)){case 0:b={r:o,g:o*(1-n*p),b:o*(1-n)};break;case 1:b={r:o*(1-n*p),g:o,b:o*(1-n)};break;case 2:b={r:o*(1-n),g:o,b:o*(1-n*p)};break;case 3:b={r:o*(1-n),g:o*(1-n*p),b:o};break;case 4:b={r:o*(1-n*p),g:o*(1-n),b:o};break;case 5:b={r:o,g:o*(1-n),b:o*(1-n*p)};break;default:b={r:o*(1-n),g:o*(1-n),b:o*(1-n)}}return b.mode="rgb",h!==void 0&&(b.alpha=h),b}function Cx({r:i,g:n,b:o,alpha:h}){i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.max(i,n,o),b=Math.min(i,n,o),_={mode:"hsv",s:p===0?0:1-b/p,v:p};return p-b!==0&&(_.h=(p===i?(n-o)/(p-b)+(n<o)*6:p===n?(o-i)/(p-b)+2:(i-n)/(p-b)+4)*60),h!==void 0&&(_.alpha=h),_}const Px={mode:"hsv",toMode:{rgb:Ex},parse:["--hsv"],serialize:"--hsv",fromMode:{rgb:Cx},channels:["h","s","v","alpha"],ranges:{h:[0,360]},gamut:"rgb",interpolate:{h:{use:gt,fixup:ws},s:gt,v:gt,alpha:{use:gt,fixup:Un}},difference:{h:zf},average:{h:Ts}};function GP({h:i,w:n,b:o,alpha:h}){if(n===void 0&&(n=0),o===void 0&&(o=0),n+o>1){let p=n+o;n/=p,o/=p}return Ex({h:i,s:o===1?1:1-n/(1-o),v:1-o,alpha:h})}function ZP(i){let n=Cx(i);if(n===void 0)return;let o=n.s!==void 0?n.s:0,h=n.v!==void 0?n.v:0,p={mode:"hwb",w:(1-o)*h,b:1-h};return n.h!==void 0&&(p.h=n.h),n.alpha!==void 0&&(p.alpha=n.alpha),p}function XP(i,n){if(!n||n[0]!=="hwb")return;const o={mode:"hwb"},[,h,p,b,_]=n;if(h.type!==et.None){if(h.type===et.Percentage)return;o.h=h.value}if(p.type!==et.None){if(p.type===et.Hue)return;o.w=p.value/100}if(b.type!==et.None){if(b.type===et.Hue)return;o.b=b.value/100}return _.type!==et.None&&(o.alpha=Math.min(1,Math.max(0,_.type===et.Number?_.value:_.value/100))),o}const YP={mode:"hwb",toMode:{rgb:GP},fromMode:{rgb:ZP},channels:["h","w","b","alpha"],ranges:{h:[0,360]},gamut:"rgb",parse:[XP],serialize:i=>`hwb(${i.h!==void 0?i.h:"none"} ${i.w!==void 0?i.w*100+"%":"none"} ${i.b!==void 0?i.b*100+"%":"none"}${i.alpha<1?` / ${i.alpha}`:""})`,interpolate:{h:{use:gt,fixup:ws},w:gt,b:gt,alpha:{use:gt,fixup:Un}},difference:{h:LP},average:{h:Ts}},zx=203,Bf=.1593017578125,Dx=78.84375,Of=.8359375,Ff=18.8515625,Nf=18.6875;function Wm(i){if(i<0)return 0;const n=Math.pow(i,1/Dx);return 1e4*Math.pow(Math.max(0,n-Of)/(Ff-Nf*n),1/Bf)}function Hm(i){if(i<0)return 0;const n=Math.pow(i/1e4,Bf);return Math.pow((Of+Ff*n)/(1+Nf*n),Dx)}const qm=i=>Math.max(i/zx,0),Rv=({i,t:n,p:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);const p=Wm(i+.008609037037932761*n+.11102962500302593*o),b=Wm(i-.00860903703793275*n-.11102962500302599*o),_=Wm(i+.5600313357106791*n-.32062717498731885*o),c={mode:"xyz65",x:qm(2.070152218389422*p-1.3263473389671556*b+.2066510476294051*_),y:qm(.3647385209748074*p+.680566024947227*b-.0453045459220346*_),z:qm(-.049747207535812*p-.0492609666966138*b+1.1880659249923042*_)};return h!==void 0&&(c.alpha=h),c},Gm=(i=0)=>Math.max(i*zx,0),Bv=({x:i,y:n,z:o,alpha:h})=>{const p=Gm(i),b=Gm(n),_=Gm(o),c=Hm(.3592832590121217*p+.6976051147779502*b-.0358915932320289*_),M=Hm(-.1920808463704995*p+1.1004767970374323*b+.0753748658519118*_),B=Hm(.0070797844607477*p+.0748396662186366*b+.8433265453898765*_),O=.5*c+.5*M,R=1.61376953125*c-3.323486328125*M+1.709716796875*B,C=4.378173828125*c-4.24560546875*M-.132568359375*B,Y={mode:"itp",i:O,t:R,p:C};return h!==void 0&&(Y.alpha=h),Y},KP={mode:"itp",channels:["i","t","p","alpha"],parse:["--ictcp"],serialize:"--ictcp",toMode:{xyz65:Rv,rgb:i=>hl(Rv(i))},fromMode:{xyz65:Bv,rgb:i=>Bv(ul(i))},ranges:{i:[0,.581],t:[-.369,.272],p:[-.164,.331]},interpolate:{i:gt,t:gt,p:gt,alpha:{use:gt,fixup:Un}}},JP=134.03437499999998,QP=16295499532821565e-27,Zm=i=>{if(i<0)return 0;let n=Math.pow(i/1e4,Bf);return Math.pow((Of+Ff*n)/(1+Nf*n),JP)},Xm=(i=0)=>Math.max(i*203,0),Lx=({x:i,y:n,z:o,alpha:h})=>{i=Xm(i),n=Xm(n),o=Xm(o);let p=1.15*i-.15*o,b=.66*n+.34*i,_=Zm(.41478972*p+.579999*b+.014648*o),c=Zm(-.20151*p+1.120649*b+.0531008*o),M=Zm(-.0166008*p+.2648*b+.6684799*o),B=(_+c)/2,O={mode:"jab",j:.44*B/(1-.56*B)-QP,a:3.524*_-4.066708*c+.542708*M,b:.199076*_+1.096799*c-1.295875*M};return h!==void 0&&(O.alpha=h),O},ez=134.03437499999998,Ov=16295499532821565e-27,Ym=i=>{if(i<0)return 0;let n=Math.pow(i,1/ez);return 1e4*Math.pow((Of-n)/(Nf*n-Ff),1/Bf)},Km=i=>i/203,Rx=({j:i,a:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=(i+Ov)/(.44+.56*(i+Ov)),b=Ym(p+.13860504*n+.058047316*o),_=Ym(p-.13860504*n-.058047316*o),c=Ym(p-.096019242*n-.8118919*o),M={mode:"xyz65",x:Km(1.661373024652174*b-.914523081304348*_+.23136208173913045*c),y:Km(-.3250758611844533*b+1.571847026732543*_-.21825383453227928*c),z:Km(-.090982811*b-.31272829*_+1.5227666*c)};return h!==void 0&&(M.alpha=h),M},Bx=i=>{let n=Lx(ul(i));return i.r===i.b&&i.b===i.g&&(n.a=n.b=0),n},Ox=i=>hl(Rx(i)),tz={mode:"jab",channels:["j","a","b","alpha"],parse:["--jzazbz"],serialize:"--jzazbz",fromMode:{rgb:Bx,xyz65:Lx},toMode:{rgb:Ox,xyz65:Rx},ranges:{j:[0,.222],a:[-.109,.129],b:[-.185,.134]},interpolate:{j:gt,a:gt,b:gt,alpha:{use:gt,fixup:Un}}},Fv=({j:i,a:n,b:o,alpha:h})=>{n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.sqrt(n*n+o*o),b={mode:"jch",j:i,c:p};return p&&(b.h=hr(Math.atan2(o,n)*180/Math.PI)),h!==void 0&&(b.alpha=h),b},Nv=({j:i,c:n,h:o,alpha:h})=>{o===void 0&&(o=0);let p={mode:"jab",j:i,a:n?n*Math.cos(o/180*Math.PI):0,b:n?n*Math.sin(o/180*Math.PI):0};return h!==void 0&&(p.alpha=h),p},iz={mode:"jch",parse:["--jzczhz"],serialize:"--jzczhz",toMode:{jab:Nv,rgb:i=>Ox(Nv(i))},fromMode:{rgb:i=>Fv(Bx(i)),jab:Fv},channels:["j","c","h","alpha"],ranges:{j:[0,.221],c:[0,.19],h:[0,360]},interpolate:{h:{use:gt,fixup:ws},c:gt,j:gt,alpha:{use:gt,fixup:Un}},difference:{h:Df},average:{h:Ts}},jf=Math.pow(29,3)/Math.pow(3,3),f0=Math.pow(6,3)/Math.pow(29,3);let Jm=i=>Math.pow(i,3)>f0?Math.pow(i,3):(116*i-16)/jf;const p0=({l:i,a:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=(i+16)/116,b=n/500+p,_=p-o/200,c={mode:"xyz50",x:Jm(b)*On.X,y:Jm(p)*On.Y,z:Jm(_)*On.Z};return h!==void 0&&(c.alpha=h),c},wh=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Lc({r:i*3.1341359569958707-n*1.6173863321612538-.4906619460083532*o,g:i*-.978795502912089+n*1.916254567259524+.03344273116131949*o,b:i*.07195537988411677-n*.2289768264158322+1.405386058324125*o});return h!==void 0&&(p.alpha=h),p},Fx=i=>wh(p0(i)),Th=i=>{let{r:n,g:o,b:h,alpha:p}=Dc(i),b={mode:"xyz50",x:.436065742824811*n+.3851514688337912*o+.14307845442264197*h,y:.22249319175623702*n+.7168870538238823*o+.06061979053616537*h,z:.013923904500943465*n+.09708128566574634*o+.7140993584005155*h};return p!==void 0&&(b.alpha=p),b},Qm=i=>i>f0?Math.cbrt(i):(jf*i+16)/116,m0=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Qm(i/On.X),b=Qm(n/On.Y),_=Qm(o/On.Z),c={mode:"lab",l:116*b-16,a:500*(p-b),b:200*(b-_)};return h!==void 0&&(c.alpha=h),c},Nx=i=>{let n=m0(Th(i));return i.r===i.b&&i.b===i.g&&(n.a=n.b=0),n};function nz(i,n){if(!n||n[0]!=="lab")return;const o={mode:"lab"},[,h,p,b,_]=n;if(!(h.type===et.Hue||p.type===et.Hue||b.type===et.Hue))return h.type!==et.None&&(o.l=Math.min(Math.max(0,h.value),100)),p.type!==et.None&&(o.a=p.type===et.Number?p.value:p.value*125/100),b.type!==et.None&&(o.b=b.type===et.Number?b.value:b.value*125/100),_.type!==et.None&&(o.alpha=Math.min(1,Math.max(0,_.type===et.Number?_.value:_.value/100))),o}const g0={mode:"lab",toMode:{xyz50:p0,rgb:Fx},fromMode:{xyz50:m0,rgb:Nx},channels:["l","a","b","alpha"],ranges:{l:[0,100],a:[-100,100],b:[-100,100]},parse:[nz],serialize:i=>`lab(${i.l!==void 0?i.l:"none"} ${i.a!==void 0?i.a:"none"} ${i.b!==void 0?i.b:"none"}${i.alpha<1?` / ${i.alpha}`:""})`,interpolate:{l:gt,a:gt,b:gt,alpha:{use:gt,fixup:Un}}},rz={...g0,mode:"lab65",parse:["--lab-d65"],serialize:"--lab-d65",toMode:{xyz65:Sx,rgb:Lf},fromMode:{xyz65:kx,rgb:Rf},ranges:{l:[0,100],a:[-86.182,98.234],b:[-107.86,94.477]}};function az(i,n){if(!n||n[0]!=="lch")return;const o={mode:"lch"},[,h,p,b,_]=n;if(h.type!==et.None){if(h.type===et.Hue)return;o.l=Math.min(Math.max(0,h.value),100)}if(p.type!==et.None&&(o.c=Math.max(0,p.type===et.Number?p.value:p.value*150/100)),b.type!==et.None){if(b.type===et.Percentage)return;o.h=b.value}return _.type!==et.None&&(o.alpha=Math.min(1,Math.max(0,_.type===et.Number?_.value:_.value/100))),o}const y0={mode:"lch",toMode:{lab:uo,rgb:i=>Fx(uo(i))},fromMode:{rgb:i=>co(Nx(i)),lab:co},channels:["l","c","h","alpha"],ranges:{l:[0,100],c:[0,150],h:[0,360]},parse:[az],serialize:i=>`lch(${i.l!==void 0?i.l:"none"} ${i.c!==void 0?i.c:"none"} ${i.h!==void 0?i.h:"none"}${i.alpha<1?` / ${i.alpha}`:""})`,interpolate:{h:{use:gt,fixup:ws},c:gt,l:gt,alpha:{use:gt,fixup:Un}},difference:{h:Df},average:{h:Ts}},sz={...y0,mode:"lch65",parse:["--lch-d65"],serialize:"--lch-d65",toMode:{lab65:i=>uo(i,"lab65"),rgb:i=>Lf(uo(i,"lab65"))},fromMode:{rgb:i=>co(Rf(i),"lch65"),lab65:i=>co(i,"lch65")},ranges:{l:[0,100],c:[0,133.807],h:[0,360]}},jx=({l:i,u:n,v:o,alpha:h})=>{n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.sqrt(n*n+o*o),b={mode:"lchuv",l:i,c:p};return p&&(b.h=hr(Math.atan2(o,n)*180/Math.PI)),h!==void 0&&(b.alpha=h),b},Vx=({l:i,c:n,h:o,alpha:h})=>{o===void 0&&(o=0);let p={mode:"luv",l:i,u:n?n*Math.cos(o/180*Math.PI):0,v:n?n*Math.sin(o/180*Math.PI):0};return h!==void 0&&(p.alpha=h),p},$x=(i,n,o)=>4*i/(i+15*n+3*o),Ux=(i,n,o)=>9*n/(i+15*n+3*o),oz=$x(On.X,On.Y,On.Z),lz=Ux(On.X,On.Y,On.Z),cz=i=>i<=f0?jf*i:116*Math.cbrt(i)-16,Rg=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=cz(n/On.Y),b=$x(i,n,o),_=Ux(i,n,o);!isFinite(b)||!isFinite(_)?p=b=_=0:(b=13*p*(b-oz),_=13*p*(_-lz));let c={mode:"luv",l:p,u:b,v:_};return h!==void 0&&(c.alpha=h),c},uz=(i,n,o)=>4*i/(i+15*n+3*o),hz=(i,n,o)=>9*n/(i+15*n+3*o),dz=uz(On.X,On.Y,On.Z),fz=hz(On.X,On.Y,On.Z),Bg=({l:i,u:n,v:o,alpha:h})=>{if(i===void 0&&(i=0),i===0)return{mode:"xyz50",x:0,y:0,z:0};n===void 0&&(n=0),o===void 0&&(o=0);let p=n/(13*i)+dz,b=o/(13*i)+fz,_=On.Y*(i<=8?i/jf:Math.pow((i+16)/116,3)),c=_*(9*p)/(4*b),M=_*(12-3*p-20*b)/(4*b),B={mode:"xyz50",x:c,y:_,z:M};return h!==void 0&&(B.alpha=h),B},pz=i=>jx(Rg(Th(i))),mz=i=>wh(Bg(Vx(i))),gz={mode:"lchuv",toMode:{luv:Vx,rgb:mz},fromMode:{rgb:pz,luv:jx},channels:["l","c","h","alpha"],parse:["--lchuv"],serialize:"--lchuv",ranges:{l:[0,100],c:[0,176.956],h:[0,360]},interpolate:{h:{use:gt,fixup:ws},c:gt,l:gt,alpha:{use:gt,fixup:Un}},difference:{h:Df},average:{h:Ts}},yz={...zc,mode:"lrgb",toMode:{rgb:Lc},fromMode:{rgb:Dc},parse:["srgb-linear"],serialize:"srgb-linear"},_z={mode:"luv",toMode:{xyz50:Bg,rgb:i=>wh(Bg(i))},fromMode:{xyz50:Rg,rgb:i=>Rg(Th(i))},channels:["l","u","v","alpha"],parse:["--luv"],serialize:"--luv",ranges:{l:[0,100],u:[-84.936,175.042],v:[-125.882,87.243]},interpolate:{l:gt,u:gt,v:gt,alpha:{use:gt,fixup:Un}}},Wx=({r:i,g:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.cbrt(.41222147079999993*i+.5363325363*n+.0514459929*o),b=Math.cbrt(.2119034981999999*i+.6806995450999999*n+.1073969566*o),_=Math.cbrt(.08830246189999998*i+.2817188376*n+.6299787005000002*o),c={mode:"oklab",l:.2104542553*p+.793617785*b-.0040720468*_,a:1.9779984951*p-2.428592205*b+.4505937099*_,b:.0259040371*p+.7827717662*b-.808675766*_};return h!==void 0&&(c.alpha=h),c},Vf=i=>{let n=Wx(Dc(i));return i.r===i.b&&i.b===i.g&&(n.a=n.b=0),n},Sh=({l:i,a:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Math.pow(i*.9999999984505198+.39633779217376786*n+.2158037580607588*o,3),b=Math.pow(i*1.0000000088817609-.10556134232365635*n-.06385417477170591*o,3),_=Math.pow(i*1.0000000546724108-.08948418209496575*n-1.2914855378640917*o,3),c={mode:"lrgb",r:4.076741661347994*p-3.307711590408193*b+.230969928729428*_,g:-1.2684380040921763*p+2.6097574006633715*b-.3413193963102197*_,b:-.004196086541837188*p-.7034186144594493*b+1.7076147009309444*_};return h!==void 0&&(c.alpha=h),c},$f=i=>Lc(Sh(i));function Og(i){const h=1.170873786407767;return .5*(h*i-.206+Math.sqrt((h*i-.206)*(h*i-.206)+4*.03*h*i))}function gf(i){return(i*i+.206*i)/(1.170873786407767*(i+.03))}function vz(i,n){let o,h,p,b,_,c,M,B;-1.88170328*i-.80936493*n>1?(o=1.19086277,h=1.76576728,p=.59662641,b=.75515197,_=.56771245,c=4.0767416621,M=-3.3077115913,B=.2309699292):1.81444104*i-1.19445276*n>1?(o=.73956515,h=-.45954404,p=.08285427,b=.1254107,_=.14503204,c=-1.2684380046,M=2.6097574011,B=-.3413193965):(o=1.35733652,h=-.00915799,p=-1.1513021,b=-.50559606,_=.00692167,c=-.0041960863,M=-.7034186147,B=1.707614701);let O=o+h*i+p*n+b*i*i+_*i*n,R=.3963377774*i+.2158037573*n,C=-.1055613458*i-.0638541728*n,Y=-.0894841775*i-1.291485548*n;{let X=1+O*R,Z=1+O*C,se=1+O*Y,q=X*X*X,te=Z*Z*Z,ne=se*se*se,_e=3*R*X*X,be=3*C*Z*Z,Ae=3*Y*se*se,de=6*R*R*X,Be=6*C*C*Z,Fe=6*Y*Y*se,Le=c*q+M*te+B*ne,we=c*_e+M*be+B*Ae,Te=c*de+M*Be+B*Fe;O=O-Le*we/(we*we-.5*Le*Te)}return O}function _0(i,n){let o=vz(i,n),h=Sh({l:1,a:o*i,b:o*n}),p=Math.cbrt(1/Math.max(h.r,h.g,h.b)),b=p*o;return[p,b]}function bz(i,n,o,h,p,b=null){b||(b=_0(i,n));let _;if((o-p)*b[1]-(b[0]-p)*h<=0)_=b[1]*p/(h*b[0]+b[1]*(p-o));else{_=b[1]*(p-1)/(h*(b[0]-1)+b[1]*(p-o));{let c=o-p,M=h,B=.3963377774*i+.2158037573*n,O=-.1055613458*i-.0638541728*n,R=-.0894841775*i-1.291485548*n,C=c+M*B,Y=c+M*O,X=c+M*R;{let Z=p*(1-_)+_*o,se=_*h,q=Z+se*B,te=Z+se*O,ne=Z+se*R,_e=q*q*q,be=te*te*te,Ae=ne*ne*ne,de=3*C*q*q,Be=3*Y*te*te,Fe=3*X*ne*ne,Le=6*C*C*q,we=6*Y*Y*te,Te=6*X*X*ne,fe=4.0767416621*_e-3.3077115913*be+.2309699292*Ae-1,Me=4.0767416621*de-3.3077115913*Be+.2309699292*Fe,Ee=4.0767416621*Le-3.3077115913*we+.2309699292*Te,$e=Me/(Me*Me-.5*fe*Ee),He=-fe*$e,Ge=-1.2684380046*_e+2.6097574011*be-.3413193965*Ae-1,Re=-1.2684380046*de+2.6097574011*Be-.3413193965*Fe,Xe=-1.2684380046*Le+2.6097574011*we-.3413193965*Te,Ue=Re/(Re*Re-.5*Ge*Xe),Mt=-Ge*Ue,Rt=-.0041960863*_e-.7034186147*be+1.707614701*Ae-1,_t=-.0041960863*de-.7034186147*Be+1.707614701*Fe,Xt=-.0041960863*Le-.7034186147*we+1.707614701*Te,jt=_t/(_t*_t-.5*Rt*Xt),si=-Rt*jt;He=$e>=0?He:1e6,Mt=Ue>=0?Mt:1e6,si=jt>=0?si:1e6,_+=Math.min(He,Math.min(Mt,si))}}}return _}function v0(i,n,o=null){o||(o=_0(i,n));let h=o[0],p=o[1];return[p/h,p/(1-h)]}function Hx(i,n,o){let h=_0(n,o),p=bz(n,o,i,1,i,h),b=v0(n,o,h),_=.11516993+1/(7.4477897+4.1590124*o+n*(-2.19557347+1.75198401*o+n*(-2.13704948-10.02301043*o+n*(-4.24894561+5.38770819*o+4.69891013*n)))),c=.11239642+1/(1.6132032-.68124379*o+n*(.40370612+.90148123*o+n*(-.27087943+.6122399*o+n*(.00299215-.45399568*o-.14661872*n)))),M=p/Math.min(i*b[0],(1-i)*b[1]),B=i*_,O=(1-i)*c,R=.9*M*Math.sqrt(Math.sqrt(1/(1/(B*B*B*B)+1/(O*O*O*O))));return B=i*.4,O=(1-i)*.8,[Math.sqrt(1/(1/(B*B)+1/(O*O))),R,p]}function jv(i){const n=i.l!==void 0?i.l:0,o=i.a!==void 0?i.a:0,h=i.b!==void 0?i.b:0,p={mode:"okhsl",l:Og(n)};i.alpha!==void 0&&(p.alpha=i.alpha);let b=Math.sqrt(o*o+h*h);if(!b)return p.s=0,p;let[_,c,M]=Hx(n,o/b,h/b),B;if(b<c){let O=0,R=.8*_,C=1-R/c;B=(b-O)/(R+C*(b-O))*.8}else{let O=c,R=.2*c*c*1.25*1.25/_,C=1-R/(M-c);B=.8+.2*((b-O)/(R+C*(b-O)))}return B&&(p.s=B,p.h=hr(Math.atan2(h,o)*180/Math.PI)),p}function Vv(i){let n=i.h!==void 0?i.h:0,o=i.s!==void 0?i.s:0,h=i.l!==void 0?i.l:0;const p={mode:"oklab",l:gf(h)};if(i.alpha!==void 0&&(p.alpha=i.alpha),!o||h===1)return p.a=p.b=0,p;let b=Math.cos(n/180*Math.PI),_=Math.sin(n/180*Math.PI),[c,M,B]=Hx(p.l,b,_),O,R,C,Y;o<.8?(O=1.25*o,R=0,C=.8*c,Y=1-C/M):(O=5*(o-.8),R=M,C=.2*M*M*1.25*1.25/c,Y=1-C/(B-M));let X=R+O*C/(1-Y*O);return p.a=X*b,p.b=X*_,p}const xz={...Ix,mode:"okhsl",channels:["h","s","l","alpha"],parse:["--okhsl"],serialize:"--okhsl",fromMode:{oklab:jv,rgb:i=>jv(Vf(i))},toMode:{oklab:Vv,rgb:i=>$f(Vv(i))}};function $v(i){let n=i.l!==void 0?i.l:0,o=i.a!==void 0?i.a:0,h=i.b!==void 0?i.b:0,p=Math.sqrt(o*o+h*h),b=p?o/p:1,_=p?h/p:1,[c,M]=v0(b,_),B=.5,O=1-B/c,R=M/(p+n*M),C=R*n,Y=R*p,X=gf(C),Z=Y*X/C,se=Sh({l:X,a:b*Z,b:_*Z}),q=Math.cbrt(1/Math.max(se.r,se.g,se.b,0));n=n/q,p=p/q*Og(n)/n,n=Og(n);const te={mode:"okhsv",s:p?(B+M)*Y/(M*B+M*O*Y):0,v:n?n/C:0};return te.s&&(te.h=hr(Math.atan2(h,o)*180/Math.PI)),i.alpha!==void 0&&(te.alpha=i.alpha),te}function Uv(i){const n={mode:"oklab"};i.alpha!==void 0&&(n.alpha=i.alpha);const o=i.h!==void 0?i.h:0,h=i.s!==void 0?i.s:0,p=i.v!==void 0?i.v:0,b=Math.cos(o/180*Math.PI),_=Math.sin(o/180*Math.PI),[c,M]=v0(b,_),B=.5,O=1-B/c,R=1-h*B/(B+M-M*O*h),C=h*M*B/(B+M-M*O*h),Y=gf(R),X=C*Y/R,Z=Sh({l:Y,a:b*X,b:_*X}),se=Math.cbrt(1/Math.max(Z.r,Z.g,Z.b,0)),q=gf(p*R),te=C*q/R;return n.l=q*se,n.a=te*b*se,n.b=te*_*se,n}const wz={...Px,mode:"okhsv",channels:["h","s","v","alpha"],parse:["--okhsv"],serialize:"--okhsv",fromMode:{oklab:$v,rgb:i=>$v(Vf(i))},toMode:{oklab:Uv,rgb:i=>$f(Uv(i))}};function Tz(i,n){if(!n||n[0]!=="oklab")return;const o={mode:"oklab"},[,h,p,b,_]=n;if(!(h.type===et.Hue||p.type===et.Hue||b.type===et.Hue))return h.type!==et.None&&(o.l=Math.min(Math.max(0,h.type===et.Number?h.value:h.value/100),1)),p.type!==et.None&&(o.a=p.type===et.Number?p.value:p.value*.4/100),b.type!==et.None&&(o.b=b.type===et.Number?b.value:b.value*.4/100),_.type!==et.None&&(o.alpha=Math.min(1,Math.max(0,_.type===et.Number?_.value:_.value/100))),o}const Sz={...g0,mode:"oklab",toMode:{lrgb:Sh,rgb:$f},fromMode:{lrgb:Wx,rgb:Vf},ranges:{l:[0,1],a:[-.4,.4],b:[-.4,.4]},parse:[Tz],serialize:i=>`oklab(${i.l!==void 0?i.l:"none"} ${i.a!==void 0?i.a:"none"} ${i.b!==void 0?i.b:"none"}${i.alpha<1?` / ${i.alpha}`:""})`};function kz(i,n){if(!n||n[0]!=="oklch")return;const o={mode:"oklch"},[,h,p,b,_]=n;if(h.type!==et.None){if(h.type===et.Hue)return;o.l=Math.min(Math.max(0,h.type===et.Number?h.value:h.value/100),1)}if(p.type!==et.None&&(o.c=Math.max(0,p.type===et.Number?p.value:p.value*.4/100)),b.type!==et.None){if(b.type===et.Percentage)return;o.h=b.value}return _.type!==et.None&&(o.alpha=Math.min(1,Math.max(0,_.type===et.Number?_.value:_.value/100))),o}const Az={...y0,mode:"oklch",toMode:{oklab:i=>uo(i,"oklab"),rgb:i=>$f(uo(i,"oklab"))},fromMode:{rgb:i=>co(Vf(i),"oklch"),oklab:i=>co(i,"oklch")},parse:[kz],serialize:i=>`oklch(${i.l!==void 0?i.l:"none"} ${i.c!==void 0?i.c:"none"} ${i.h!==void 0?i.h:"none"}${i.alpha<1?` / ${i.alpha}`:""})`,ranges:{l:[0,1],c:[0,.4],h:[0,360]}},Wv=i=>{let{r:n,g:o,b:h,alpha:p}=Dc(i),b={mode:"xyz65",x:.486570948648216*n+.265667693169093*o+.1982172852343625*h,y:.2289745640697487*n+.6917385218365062*o+.079286914093745*h,z:0*n+.0451133818589026*o+1.043944368900976*h};return p!==void 0&&(b.alpha=p),b},Hv=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p=Lc({r:i*2.4934969119414263-n*.9313836179191242-.402710784450717*o,g:i*-.8294889695615749+n*1.7626640603183465+.0236246858419436*o,b:i*.0358458302437845-n*.0761723892680418+.9568845240076871*o},"p3");return h!==void 0&&(p.alpha=h),p},Mz={...zc,mode:"p3",parse:["display-p3"],serialize:"display-p3",fromMode:{rgb:i=>Hv(ul(i)),xyz65:Hv},toMode:{rgb:i=>hl(Wv(i)),xyz65:Wv}},eg=i=>{let n=Math.abs(i);return n>=1/512?Math.sign(i)*Math.pow(n,1/1.8):16*i},qv=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p={mode:"prophoto",r:eg(i*1.3457868816471585-n*.2555720873797946-.0511018649755453*o),g:eg(i*-.5446307051249019+n*1.5082477428451466+.0205274474364214*o),b:eg(i*0+n*0+1.2119675456389452*o)};return h!==void 0&&(p.alpha=h),p},tg=(i=0)=>{let n=Math.abs(i);return n>=16/512?Math.sign(i)*Math.pow(n,1.8):i/16},Gv=i=>{let n=tg(i.r),o=tg(i.g),h=tg(i.b),p={mode:"xyz50",x:.7977666449006423*n+.1351812974005331*o+.0313477341283922*h,y:.2880748288194013*n+.7118352342418731*o+899369387256e-16*h,z:0*n+0*o+.8251046025104602*h};return i.alpha!==void 0&&(p.alpha=i.alpha),p},Iz={...zc,mode:"prophoto",parse:["prophoto-rgb"],serialize:"prophoto-rgb",fromMode:{xyz50:qv,rgb:i=>qv(Th(i))},toMode:{xyz50:Gv,rgb:i=>wh(Gv(i))}},Zv=1.09929682680944,Ez=.018053968510807,ig=i=>{const n=Math.abs(i);return n>Ez?(Math.sign(i)||1)*(Zv*Math.pow(n,.45)-(Zv-1)):4.5*i},Xv=({x:i,y:n,z:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);let p={mode:"rec2020",r:ig(i*1.7166511879712683-n*.3556707837763925-.2533662813736599*o),g:ig(i*-.6666843518324893+n*1.6164812366349395+.0157685458139111*o),b:ig(i*.0176398574453108-n*.0427706132578085+.9421031212354739*o)};return h!==void 0&&(p.alpha=h),p},Yv=1.09929682680944,Cz=.018053968510807,ng=(i=0)=>{let n=Math.abs(i);return n<Cz*4.5?i/4.5:(Math.sign(i)||1)*Math.pow((n+Yv-1)/Yv,1/.45)},Kv=i=>{let n=ng(i.r),o=ng(i.g),h=ng(i.b),p={mode:"xyz65",x:.6369580483012911*n+.1446169035862083*o+.1688809751641721*h,y:.262700212011267*n+.6779980715188708*o+.059301716469862*h,z:0*n+.0280726930490874*o+1.0609850577107909*h};return i.alpha!==void 0&&(p.alpha=i.alpha),p},Pz={...zc,mode:"rec2020",fromMode:{xyz65:Xv,rgb:i=>Xv(ul(i))},toMode:{xyz65:Kv,rgb:i=>hl(Kv(i))},parse:["rec2020"],serialize:"rec2020"},il=.0037930732552754493,qx=Math.cbrt(il),rg=i=>Math.cbrt(i)-qx,zz=i=>{const{r:n,g:o,b:h,alpha:p}=Dc(i),b=rg(.3*n+.622*o+.078*h+il),_=rg(.23*n+.692*o+.078*h+il),c=rg(.2434226892454782*n+.2047674442449682*o+.5518098665095535*h+il),M={mode:"xyb",x:(b-_)/2,y:(b+_)/2,b:c-(b+_)/2};return p!==void 0&&(M.alpha=p),M},ag=i=>Math.pow(i+qx,3),Dz=({x:i,y:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);const p=ag(i+n)-il,b=ag(n-i)-il,_=ag(o+n)-il,c=Lc({r:11.031566904639861*p-9.866943908131562*b-.16462299650829934*_,g:-3.2541473810744237*p+4.418770377582723*b-.16462299650829934*_,b:-3.6588512867136815*p+2.7129230459360922*b+1.9459282407775895*_});return h!==void 0&&(c.alpha=h),c},Lz={mode:"xyb",channels:["x","y","b","alpha"],parse:["--xyb"],serialize:"--xyb",toMode:{rgb:Dz},fromMode:{rgb:zz},ranges:{x:[-.0154,.0281],y:[0,.8453],b:[-.2778,.388]},interpolate:{x:gt,y:gt,b:gt,alpha:{use:gt,fixup:Un}}},Rz={mode:"xyz50",parse:["xyz-d50"],serialize:"xyz-d50",toMode:{rgb:wh,lab:m0},fromMode:{rgb:Th,lab:p0},channels:["x","y","z","alpha"],ranges:{x:[0,.964],y:[0,.999],z:[0,.825]},interpolate:{x:gt,y:gt,z:gt,alpha:{use:gt,fixup:Un}}},Bz=i=>{let{x:n,y:o,z:h,alpha:p}=i;n===void 0&&(n=0),o===void 0&&(o=0),h===void 0&&(h=0);let b={mode:"xyz50",x:1.0479298208405488*n+.0229467933410191*o-.0501922295431356*h,y:.0296278156881593*n+.990434484573249*o-.0170738250293851*h,z:-.0092430581525912*n+.0150551448965779*o+.7518742899580008*h};return p!==void 0&&(b.alpha=p),b},Oz=i=>{let{x:n,y:o,z:h,alpha:p}=i;n===void 0&&(n=0),o===void 0&&(o=0),h===void 0&&(h=0);let b={mode:"xyz65",x:.9554734527042182*n-.0230985368742614*o+.0632593086610217*h,y:-.0283697069632081*n+1.0099954580058226*o+.021041398966943*h,z:.0123140016883199*n-.0205076964334779*o+1.3303659366080753*h};return p!==void 0&&(b.alpha=p),b},Fz={mode:"xyz65",toMode:{rgb:hl,xyz50:Bz},fromMode:{rgb:ul,xyz50:Oz},ranges:{x:[0,.95],y:[0,1],z:[0,1.088]},channels:["x","y","z","alpha"],parse:["xyz","xyz-d65"],serialize:"xyz-d65",interpolate:{x:gt,y:gt,z:gt,alpha:{use:gt,fixup:Un}}},Nz=({r:i,g:n,b:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);const p={mode:"yiq",y:.29889531*i+.58662247*n+.11448223*o,i:.59597799*i-.2741761*n-.32180189*o,q:.21147017*i-.52261711*n+.31114694*o};return h!==void 0&&(p.alpha=h),p},jz=({y:i,i:n,q:o,alpha:h})=>{i===void 0&&(i=0),n===void 0&&(n=0),o===void 0&&(o=0);const p={mode:"rgb",r:i+.95608445*n+.6208885*o,g:i-.27137664*n-.6486059*o,b:i-1.10561724*n+1.70250126*o};return h!==void 0&&(p.alpha=h),p},Vz={mode:"yiq",toMode:{rgb:jz},fromMode:{rgb:Nz},channels:["y","i","q","alpha"],parse:["--yiq"],serialize:"--yiq",ranges:{i:[-.595,.595],q:[-.522,.522]},interpolate:{y:gt,i:gt,q:gt,alpha:{use:gt,fixup:Un}}};qi(IP);qi(RP);qi(BP);qi(OP);qi(jP);qi(Ix);qi(Px);qi(YP);qi(KP);qi(tz);qi(iz);qi(g0);qi(rz);qi(y0);qi(sz);qi(gz);qi(yz);qi(_z);qi(xz);qi(wz);qi(Sz);qi(Az);qi(Mz);qi(Iz);qi(Pz);qi(zc);qi(Lz);qi(Rz);qi(Fz);qi(Vz);[...Db(100,1e3,100)];var $z=Ht('<div class="legend-item svelte-szvm2v"><svg width="100" height="10"><rect width="150" opacity="0.8" height="10" stroke="#282828" stroke-width="0.3"></rect></svg></div>'),Uz=Ht('<div class="legend md:mx-0 mx-2"><h4 class=" inline-flex font-khand-bold items-center py-2 text-lg tracking-normal text-zinc-700">Higher chance of water accumulation <!></h4> <div class="legend-items svelte-szvm2v"></div></div>');function Wz(i){const n=[{color:"#ffffff"},{color:"#abced0"},{color:"#519ea2"}];var o=Uz(),h=pt(o),p=Wt(pt(h));eA(p,{class:"size-5 ml-2"}),ut(h);var b=Wt(h,2);vc(b,5,()=>n,_c,(_,c)=>{var M=$z(),B=pt(M),O=pt(B);ut(B),ut(M),Mi(()=>Ti(O,"fill",De(c).color)),rt(_,M)}),ut(b),ut(o),rt(i,o)}const Hz=""+new URL("../assets/Layer 20.DxOYi3UK.png",import.meta.url).href,qz="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAAtCAYAAADxwQZkAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAADmhJREFUeJzFWnuMFdUdPufM495dlocosIqoRRAFURFQ/6iPmGqrrUpFxQiUtCpasa3RQH2gxhqtprGxNKTiIzRRE22iTVtqNdqKWuMDFCREqm0Tq1hFBRTC7r13Zs7p9/3mDg7D3N0Fdu2QYWbvncf5fef7fb/vd3a1GthN78G1bsBG0cu2J4Pcm2e2Os8214fzAd/6E4RiwLrFeX5zuaMr/Jw/DujWXyAUA261568tA4C7LfluQLf+AKEsWJM7GrU7ENmWDzzb80CUsaPft30FoVXgXu6oc0f98AM3jz9p+qTvtLVVD/N9/wDt+RV83MB3XdYmH3fXGs/Nmnvjn1a98XasdgVDqQECYl9AKAKQBV3c5fN7714wbuZ3T7+1GgZHK62dVr512sRa4VRpp7RxyjYqxgsSZ+32rq6uu8ccef4jaleGKDUAQOwtCEUA8kH7uV0+W7XyN5cddmjnFbg8kBgQPD62iN0o54BCgmfg3ASRdomnXOwTlCRRzy66+f55v330aTJlwIDYGxBaAZAFHuSP61596PqDOve/yLk015280VjEj+gTLQ9yDc8hcK2DpDnxeK4HdijQw6xdtPihM5Y/8lQeiP8rCNn1RfpnQe+yr3rhwR8fdujoWYgGASMFbALeK5l5p/xEq3qAdDBOeziPfC3B4dwADBcFip/r0IIyqxfeuGTm8odX1NXugrnP256AkC9xWa7nZz/MHcM/P3H3zOlTJ1xH2jvnJwg6dpxIUEJr6xlF2uOfZipQI/AzgsYjyAYDICJlDMBRvnZWJ9atHHHot2ar8srxlYJQlgL54Cs8Ll40Z+KPrphxnzE6cML/AGlgETIAUSbhM7SiJspzCQQ1ABOurBZAwBvtJwAFgMnPht83Gl0PdY6dcav6UizT+78iEMqqQJ76lQyE4fsNaYMOPBaGwQgIHAbPXIAIOpdWALBfacSK2RVasDLIG3CUHzVoENj0I0oGtMKESANen5gtW7bNGn/cnBdUP+pDbyDkUyAPQD4FMgYIEKtfXHb9IWNGnaWy0Ykg8j/THKxFuFZ+1q4bz/ETq8NI0kPehJRA7OkLG4EyYSzpwg8c1dRuPOv8609Y9eY7keqnitETCD0BkKVBHoDKTQu/N+knV130Ky0mAPR2HGPM6CkGRks68IERpV9yH+mC7/wYmJhUGH0r6SBCCb0wvlU2NtiaQWpTq3cvGT1h9m2qnzxEKxB6AyCvAbIPGzYYafDo8mo16OSUOZcwDZI06IYvA+RE4ruU+BAJnunIQ8SpOBI00QB5L1CxnhQTyoYJIwKgUVZxd23l39edMHPObZsKQOwVGGUglDnBskqwE4Rzzj6lc8k91/2ioz0Ya12CmcOYjEcgmP6s9xilZSYkzedalwogw8O/uGm5PcsqoeUWBEuxVJQV+AajBTJiRH+VWLvh2hvuP/PR3/21VgLEHoFRBKGVFc4DsIsQPv2HpRdPmTLxB0ZF7aS/cxF2mkEqYV4XNFhBE6RTVU/dEy7yYhYFLTLYCByNlNYpgZQGOnEg+igbnaQHhoBFtkHf/e+16zfOPfO8he+2AKJPYJQteuRnPy+CeR0I77nr2qkXX/jNW6ptHQejCmD+YwszhNc1tLVxM3TWRc50w7AaOFWJtKoFpH6ig9hZP4J2REYngZEyiCBFK8RSS+z0COIhDJ/jpdWERsp1B2kZ9RtRrP/yyuvrbz1/9m0bc2CUaUUpGGULIa2c4E4AXnl++ZUTxh9yudae52RWkN4uAvuxO5zDC8AGpyWQJVEcohL6a0ehJM2ZIAgCAoojqkMMBfRjoxsVCChcI9LCxXh+ANcIgPBMHD2xEo6MIkgkDQjhaK4qtUacPLf6zXduOufCGzIwim15KRBliyFFAML8/uxTyy6Zduy4RVSw5q2WKWCTBsYCPcBsOZUw6RPRP6kQNAtWNJ/soOozzwlGekXYSFzQ8HTM94HujapTQZSmAq02XSTuM45O08g8IXgtfgMckZGzqpAmNo7i5KUPPvj459NPvXKt6oNwFkFoBYBowPIHbj/tG6efdPXg9up45KSSWaexsRHOoAVgguJRsQqg7Nm4aQDxtYCjY6n4CIwBWuVFwjzY6gTnOu2qrKcbIdwlTj0yI0yDS8uooWbQdcFuGxfBUhqjmmkjZkwaLyEeJsKs2b69+96xR1+4QvVQTosrQi2N0DGTjxj2+MN33drRMWjsoPb2wx2rAEUOCm7jOic9cbaGgLs9zjYCjFkiecTs+U4Y4IiBiDvY4IslgkG0zm9II0VmpCVDeTqqNIeIW2ik2Ed4Mu9ME2GBlI4AJyylcmtaUWi3TVtMsrqkBoK6l957/+Nrp596+X9KWLFbNchXgcwDVLkv+/Xik087ZeqssOIPHzJ46JGYJdCAdI7AhAQVK0YOEAQnc6AkFwBEM/8NRE/WCuTtDMh5ErSil9BW8KF2iLVWXG8JPAqgCIvHBRh8zxKKFEH55JZqQSBBK/HVSBXN7hSg6CrUOTLO1knLT3DNhq4dO+47dNLsp1ShehTLYdEIVbP9mRX3zx01csSEIPSG7T982JG+p9uF9rYOXWSPHKeiCEASKH72DnFBCJRskIonzpGVghXgy9lILNlANySBZ1NkEE8iGSA9hyduiiM2oitgE7MH7TaISG1w6aINGy/orGKKNmgvtiJVP1SeV2/U6g8cfNTcx1SuAStWhDIWtPH46ouPXeP54RBMSPXgzv2mep5uk3UCUNuxPCTdeEjM2UGxDAiCFfvDVEA+W6SGsEGETTpkrhMwkUnkhKxiRUC/EDoXRIzaCmNEVVP/pE26LtE0mHw2QYE4eE0oPbXzYrDKRoyNbXwXJmcTGPoFVXXbjujKw4+Zuz5jQxkIYREA7qtefvynnmcG+UHQceDIoVNSpRcTDC1AjGAC/ALwRWawXabqQweMwUwxQRR8AQOFOzSSCuIhrNgINtm6VhH7KAwgMAE9REyxFIYYMgTEcGGD4zbyOYI3HsGnJnjiK0SAKRN1/JzQbhOEuo1rm0GLrfgAAuavHnX4zIWZPuRXif0CCJUmCNwrK55ceskhY0YeO6ijY9TgjkFjKGgM2iaxFRGAUFLg8B8SlSlPH0Cfy3VE6oLLcq9pfQUEukpEk/ieqldcuvhAOtM7xBYpYgwo79I+mz6BK1JKdIbANCrSfZIrqj2SJsP4eLikCi5hoybyU6cu2CTaxJugI92bPtlyzeQTv/9eKxCydNiFCZfOmzHumqvnzD9gxP4TfV8PElMsaUCDlECAvYhaYGiCXOpRjHSCzGMZlMkGr6WhoNBZj+IpxoczKWsGkc/VJav9OO2eCRg9g/Vc836VdliG+sElOvlEt0VOVyMIoyMzxGgpyUp859cwps+j2LyljV8Di1wcJ0+OOeLc3/eUDmFeFJt75flnls2ffPRRF0t5ZPJbBYoDZItDuiyG3knHTEO20r6KwrQS0A4j5REgTZCsN2vpMln+QAmuGYidBLmhCQDOcn0Rfkpr3pOuRqULMCa9lP/Qa2gH0DQvqYL7sjbppSXVa6YndsPUUl/Uk+A1qGe39tjmu/Wjx579yzIQPLWrP6jmjuFxx0zY749PLFna3t52EMuAi2u0y1LmEsvfIfDl0kUJGegKpXfEEXQPUymmkWFJZOVKO0mOIHG0zpazW0kZ08xtGCnNnkLYwyD5DAIpLRd1Id1FdGmmWCbZwfJevoK2OkZqJVsiG671PJguNDMY5j8OOvzcO1W6ZLWbWyxbMcr24MDO/dufXXHf4lEjh56IV8QoiIl0xun6gE2VP6HdY1n0KG7UD0kHJ4vNsoYmxknMtFQAWWUw8AaG5VNzFvlxuszWLKWGK/BZXWOTZQmK9vAvCo2uheIgJVEqALlBzxDzTvjruosbm1G1NoAFdWNo8OK/jR4/48EiCD0tnWXnWTPl33X7gimzLjjjqraq3wlBjMDfRCIDnVNAElF9aXKkhaZApkopfXK6vAh36UVWXs5rOBA0UuwwwQaUVfQTCVOK34sWKvoCEVWx0onTIUCIUVrRnTou3rCSBi7tRGVhF6JloySpb8QYP/S4gqW9LzZv3XbHpGnz3s6ng1J96B7Vly119tsls2zJwpNP+frUbw8eMvRrmCqYFzg6x5IlIdu0JwadyRLhsG0uFyIq0Jmts5Q6EU9x/IQSmdzepeRXVHGY9WoijDptNtIVaAlIsxrIhDJ+YR/fybYblQTNBwZRixpd6+v16LVarfbWypfWrFxw3dLP8cgkA0GVsKHVL1SKv2LbufZw/HETOhbMv+D4ESOGjQhDU/E9L+xoD4ZXK+GQ9vbqAZVKZVgYmP04TE4MSpmRnHZCFxA9gsVLV5WhuFFszY441jsAoAdHHnm+V4Wy83cTOvDMYC7nw1tUs5U4ad+tQ6NQQ3J622KrtzQa9v2t2+pvbdjw7kvz5t+5TtFCKhU3g+duiyCofFBq9xWl3X7HWLi+2IwVAVado4aHP7zsvHHTjj/iqP9+9NlHEyccNnnw4MqIrh3R5jXr/vX6LXcsX/PpZ5/Havdtl3HiOcHPFl867bPNm7d9+ukX299Y+8/NL7687vNmUEkz0LgZdH7PPt8JQB6E/GCLS2sZGPljHoS818jOi8/LB1H2Zzlln+WDL56X3Z8BUASiuGfXlILQCog8GPm/Pcj//UErJhSZln9fn5a+egAg/5ziH3okJXtcuGZnJ1n28GIQpsWuS449pkOLAPLH/OetxlYGgCoEV2SFVS0AKHto/mX5IIp072vgZQwoBlF2Xjaenu7PB5UHok9/AtQTzcqo3Bvle0uBngIpftbbfcX7i0vtZcDkr9u59eVFrYLqLeDeRC0fwL5sRTaVgaJKjr0OrmwrE9E9Oe9t25d0aHXep3Tbk0H29d7eUqw/Zr9sa5VWvW77AsJX+cy+bHsN7v8ApRADr8Sux0oAAAAASUVORK5CYII=",Gz=""+new URL("../assets/Layer 22.pilv1rDh.png",import.meta.url).href;var Zz=Ht('<div id="g-diagram-Artboard_84" class="g-artboard relative svelte-182pi3y" style=""><div style="padding: 0 0 85.5528% 0;" class="svelte-182pi3y"></div> <div id="g-diagram-Artboard_84-img" class="g-aiImg svelte-182pi3y"></div> <img class="absolute top-0 left-0 w-[8%] animate-cloud-1 svelte-182pi3y" alt=""> <img class="absolute top-2 left-10 w-[8%] animate-cloud-2 svelte-182pi3y" alt=""> <img class="absolute top-6 left-0 w-[8%] animate-cloud-3 svelte-182pi3y" alt=""> <div id="g-ai0-2" class="g-Layer_1 g-aiAbs svelte-182pi3y" style="top:22.2277%;right:-1.3684%;width:62.3443%;"><p class="svelte-182pi3y">Water runs through natural channels in the land...</p></div> <div id="g-ai0-3" class="g-Layer_1 g-aiAbs svelte-182pi3y" style="top:75.4315%;right:23.9912%;width:55.459%;"><p class="g-pstyle1 svelte-182pi3y">...towards the lowest points where it is bound to collect</p></div></div>'),Xz=Ht('<div id="g-diagram-box" class="svelte-182pi3y"><!></div>');function Yz(i,n){un(n,!1);let o=tt(n,"assetsPath",8,"./"),h=Hi(null),p=tt(n,"onAiMounted",8,()=>{});ph(()=>{p()()}),cn();var b=Xz(),_=pt(b);{var c=M=>{var B=Zz(),O=Wt(pt(B),2);const R=ur(()=>`background-image: url(${o().replace(new RegExp("/([^/.]+)$"),"/$1/")||"/"}ai2html/diagram-Artboard_84.webp);`);var C=Wt(O,2);Ti(C,"src",Hz);var Y=Wt(C,2);Ti(Y,"src",qz);var X=Wt(Y,2);Ti(X,"src",Gz),yc(4),ut(B),Mi(()=>Ti(O,"style",De(R))),rt(M,B)};Vi(_,M=>{De(h)&&De(h)>=0&&M(c)})}ut(b),NT(b,"clientWidth",M=>di(h,M)),rt(i,b),hn()}var Kz=Ht('<button class=" py-2 px-4 text-center text-sm md:text-base transition-colors w-full duration-200 hover:bg-zinc-100 hover:text-black"> </button>'),Jz=Ht(`<div class="flex flex-col h-full p-4 bg-white rounded-t-xl"><div class="grid grid-cols-1 md:grid-cols-8 gap-2"><div class="col-span-1 md:col-span-4"><h2 class="mb-2 font-khand-bold text-xl text-black/80 md:text-3xl uppercase bg-white">The way of water</h2> <p class="text-sm leading-relaxed text-gray-600 md:text-base">Natural water channels crisscross Telangana's landscape - the city's
        original drainage system. When these old waterways get blocked or built
        over, that's usually where you'll spot flooding during rains.</p></div> <div class="col-span-1 mx-auto md:max-w-full max-w-[20rem] md:col-span-4 w-full px-2 items-center"><!></div></div> <div class="flex pt-2 h-full gap-2"><div class="w-1/3 h-full md:w-2/3 flex items-start flex-col justify-between"><p class="text-xs md:text-base font-medium text-zinc-500">Some of the same places are often mentioned in the news.</p> <button class="text-xs -ml-2 px-2 py-2 hover:text-black md:text-sm underline underline-offset-8 text-zinc-500">Methodology</button></div> <div class="flex flex-col divide-y w-full max-h-[8rem] md:max-h-[9rem] divide-zinc-100 items-center overflow-y-auto"></div></div></div>`);function Qz(i,n){un(n,!1),Ma();const o=Hi();let h=tt(n,"pois",8);const p=cl(),b=["Ecospace","Kendriya Vihar","Manyata Tech Park","Nayandahalli"];function _(Z,se){const q=b.indexOf(Z),te=b.indexOf(se);return q!==-1&&te!==-1?q-te:q!==-1?-1:te!==-1?1:Z.localeCompare(se)}ei(()=>Ai(h()),()=>{di(o,Object.keys(h()).sort(_))}),Or(),cn();var c=Jz(),M=pt(c),B=Wt(pt(M),2),O=pt(B);hT(O,()=>Yz,(Z,se)=>{se(Z,{})}),ut(B),ut(M);var R=Wt(M,2),C=pt(R),Y=Wt(pt(C),2);ut(C);var X=Wt(C,2);vc(X,5,()=>De(o),_c,(Z,se)=>{var q=Kz(),te=pt(q,!0);ut(q),Mi(()=>no(te,De(se))),Ct("click",q,()=>{rh(ao,De(se)),p("selectedPOI",De(se))}),rt(Z,q)}),ut(X),Tr(X,Z=>Im==null?void 0:Im(Z)),ut(R),ut(c),Ct("click",Y,()=>{p("showMethodology")}),rt(i,c),hn()}const e6=""+new URL("../assets/HansIndia.BEnVVKQ2.png",import.meta.url).href,t6=Object.freeze(Object.defineProperty({__proto__:null,default:e6},Symbol.toStringTag,{value:"Module"})),i6=""+new URL("../assets/TelanganaToday.C86c_dWF.jpg",import.meta.url).href,n6=Object.freeze(Object.defineProperty({__proto__:null,default:i6},Symbol.toStringTag,{value:"Module"})),r6=""+new URL("../assets/bangaloremirror.indiatimes.com.RVn6--4E.png",import.meta.url).href,a6=Object.freeze(Object.defineProperty({__proto__:null,default:r6},Symbol.toStringTag,{value:"Module"})),s6="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEHklEQVR4nNVWW2xUVRRd+5z7mjudqWNbKrEUDIRKNcFREBAVLUFLSBSjUWKiAdQY/4x+GAkfBP+MJpIQY6wENCb6I6ANQeSjYEqakKjUkjTG1KDYRulDZzozd+7jnO3HndKmTyzFxP13XnvtvdY++xzK7b4DN9LEDfX+XwAYC+aJCCAAYL3QALHrKGAVAUSmBSmh9QIBEEFFHPqibolc1AgVqss/cTFHtrsQACQ49MlNO8/usTZuJzelh/o5P+KfOhJ2fUWWA+brEJkIKhSpTPLV9+0tz5Gb8k+0lT54XdQ1uK+8azSvZ98DiesAYGbWzvP7ZNNaAP7JQ17bG+QkKZUBIDK3QCvQvCkSkot5s+UZ895WAKqv2z96QGTq1S89wTefMOvwu9Nku9B6fgAEFVL1zXbr7njsn/6Yi3lK3oRywTu8FwAlUiDCPEUWgouj1obHZMNKAPqPS9EPZ8hJQkcgQVUZANAaYMzrJhO0Itu1Nj0Vj4Oudi78BSkr61pBq9j7dAAkICRIQAgIOXkVgCD2S7JpjVy5BgAHnrpwBjTdTgCTKRKSAx+BByEAApic5OQTDADWxu3xSPV1q0s95LhXr+7MACTYGxW1txp3PiCXNbNXUD9/H/V0giiWCwCIEAWifpmRfTieCM9/zWFAljNGyZSEx0/6Jev+J6r2H3N27qN0rf3oLve1D62WHRyWQVe3CfZL5t2bqSoDZvYK0cVOMi3wDO4rAEJwuWRkWxIvvU3pWu+jPd7hvQwGYK5tBckxxQgqIjdtZDfHMUUXO/nKbzDtuQC0Jsuxtr0IKaMfz4Zd7Qj98NyXXBoNutrButKHCRwFckmTsWpd3JOjnk4OJuQ3nRkxrVTXKBubAYTd38IvwbTKn77lHz+oc1fIciotngTCwLzv8bg/69xQdKGDnOSkB2BqBgStKV1DhgkApTyAuEB1bpAMa1yk0Bf1S417tsQT4bnjengAhjkLPzEAgwQKf3MUAqDqWoDAABFNPCwk+yXzwSdFzWIAnBsMOz6DYc1UPBMAmCENPdyvB/oAmKs3USIJVpXSJAIJSAOFnFyRtbe+EAte/uI91d83zt6sGQBScrkYnDwEQK5abz70tM4PIyhDKUQh+yXOD1Pj7YmX36FEFUD+ibag43NyU9BqjvgB+WZ2EZjJtPSvvbqYM5s3mNkWclw9NEAESqTE4tvslh2JXftFXQOi0D92sHz0AJl2pbTmMhr/eBFxuSRX3GU9stNat5XLRR4dgVMl0jUQggMv6j7rnzqies+T44Jodm2nA0DlxgEQ1bVy+WpRvxSmzV6BR/5Ul3v14O/QmhJJMF+j9ykAAIQAAyrkwIcKwRy3VTJtGCZAc6o6yaY8OHFTlAa55gSWeSzqaw18ZoCKw39Bwuz2///8/gP6eMZ+vF0j7wAAAABJRU5ErkJggg==",o6=Object.freeze(Object.defineProperty({__proto__:null,default:s6},Symbol.toStringTag,{value:"Module"})),l6=""+new URL("../assets/timesofindia.indiatimes.com.-R40g9bv.png",import.meta.url).href,c6=Object.freeze(Object.defineProperty({__proto__:null,default:l6},Symbol.toStringTag,{value:"Module"})),u6=""+new URL("../assets/www.deccanchronicle.com.BrrKx9PX.png",import.meta.url).href,h6=Object.freeze(Object.defineProperty({__proto__:null,default:u6},Symbol.toStringTag,{value:"Module"})),d6="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAE3klEQVR4nO2WS2yVRRTHfzPz3WcftL3gxVKgFZACjbwWYhCUaCAVMTGoSDAxmqiJCSExRuPCxLgxMSx0BUJcQIwmkCAxETAqWiSAWCgVQktoaWl5pPTNbe/je8y4+O7tgz4SZOHC/jczmTlz5n/O/M/MwBSm8B9DDPeEnNxSCIwxGKNHjY304cNgjLkvm/siLKX6NwsndghQMmM2K9duASNx7BRCCALBKMFQHkIIMul+brT8TXtzLYn+bgDmLniMymUb0S44ThIhBFIGiESjXL7wE9cazrD08U2Ulq8kk05itIsxEAoX4DgJ6k8fovtOqwWAY6dx0imee/VjYvE4WsP1q5dpbjiB6zjMr1rL5jc/p735IkcPfsK5Pw6RTiWxMwNUv/IBM2aW4XnQ29XFL9/vJDnQB0B/720WVBWwaduHBIJhlAVXL53l18Nf4tgpAD+ddibJjdZ6+nuaCAbjFE8v5/C+9zh64DMa63/m9M9fk+i/RUXlMtZU7+BudzsNdcdpvXIWKyDQGgqL5nO2Zj+H933EwN0uhBD0dd/i2pVTuM4g+YWzyS+YzoGvdlB74gC2nQZjrKHDUFYQO5PEzgxiBYZF6beCmh/3MrNsHtpTvPzWLtqaa2lrvojWDk4mgbIAJFJJfJ36IlMqhJ0aQGsHZYFU4axfMDCsfO26SGkhlZVbC4DRXlbJ0HKlltttF8gvCvH089uHCAoZyPYF2tPZSvHXaK0RVmBElfnOs1UwovSEP2kYrzz8sfbmOpQVpa8ryaLlLw4TzK0REqUUSlkoZSGE8NtxPGYxee3fCzuTIhwJ0X2nhfxp04mXzcd1Mn6GBDiZJJ7n4XkunudgjCGdSgzZjBOaNXZoUgRwXU1qsI9QCIpjs/E8FyEVrg0VC1ezceun+OkUGO0SzivCUhkcJ4MYm4r7I2CMwXUyBEMGqSAYjmKMzt6SEAxHKHkoPppAtIjBxG3f7oEzYDwsyyIYiuC5/pEIIdFaEwhC06Xf+W7Xu8Dw1R0K57Om+nUWVG1Ajz2D+9OAFbTQRjCt+GHSKY/ezlaUsiB7r0tlIYS/eU71ygr417cx42VgMgLD5jnixbFS7PQAsXgpd3vb6bh5DSsQHvVAGUP20RpVbhPhHgJCIHIbi+FWZqN5dOk6wpECQhE4c3y3Py0lZhx1jQxEjJwfbTtMQCoL7dpo7QIMtQLQ2mNW+ULis+awaMVmGi+c4cSRvX6E2sW4TjZajVQSISW5vAkhcF17KEtG6+y4hJEi9BybaH6MUKQQT0PJjDlDTkvnVrJt+x4eqVxDe3M9+794jUR/T5Z4iGC4ANf1nRqtMSa3gQEM0bxipLRwXZDZmLNE/HQUxWbx5Ia3Wf/S+xQWRdEe2HaGxro/sQKKioWr6Ovu4Pypb/nth530dHYwZ14Vy1dvZd0L71Aci+G5kOhPcvLYHv6q+YbWq+dYsmI9q555gyee3YKUIKTgZksTNUd2c+7kQXrutOUIlLJkZTV2Jo3r+reWQBCKFGK0R193Ox23GujtvAn45VVWvpiKyqdIJwf9NVIihCJ/WgmtjSe53nSexcvXE4vPY3Cgl9wvKBjMwwooLtcdo7fzxiTaGQdSqdGCenCIoVbKiUrStzFGj/kPTvSP9G2N/1JOQFhrDeM+fFOYwv8M/wDEIiYcLEpe3QAAAABJRU5ErkJggg==",f6=Object.freeze(Object.defineProperty({__proto__:null,default:d6},Symbol.toStringTag,{value:"Module"})),p6=""+new URL("../assets/www.hindustantimes.com.DDwj_hdt.png",import.meta.url).href,m6=Object.freeze(Object.defineProperty({__proto__:null,default:p6},Symbol.toStringTag,{value:"Module"})),g6=""+new URL("../assets/www.moneycontrol.com.CrAVhKu1.png",import.meta.url).href,y6=Object.freeze(Object.defineProperty({__proto__:null,default:g6},Symbol.toStringTag,{value:"Module"})),_6=""+new URL("../assets/www.newindianexpress.com.C8Fg5Ukv.png",import.meta.url).href,v6=Object.freeze(Object.defineProperty({__proto__:null,default:_6},Symbol.toStringTag,{value:"Module"})),b6=""+new URL("../assets/www.thehindu.com.v50iOG2k.png",import.meta.url).href,x6=Object.freeze(Object.defineProperty({__proto__:null,default:b6},Symbol.toStringTag,{value:"Module"})),w6="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3R0RVh0WE1MOmNvbS5hZG9iZS54bXAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjBlNjJkOGQzLTljOTktNDU5ZS1hNzZjLWQ0NGEyZjQzMWU3NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3N0UzM0I0N0IxQjQxMUVEOUREM0Y1NjlBNzMzNDc2QiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3N0UzM0I0NkIxQjQxMUVEOUREM0Y1NjlBNzMzNDc2QiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjBlNjJkOGQzLTljOTktNDU5ZS1hNzZjLWQ0NGEyZjQzMWU3NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowZTYyZDhkMy05Yzk5LTQ1OWUtYTc2Yy1kNDRhMmY0MzFlNzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4OFa6mAAAEyElEQVR4nO2XS2xVVRSGv7XP7rm3r3tv7a1VSksRAVsK1gbRKI2RiQMfmKhxYhyBzIwxISYa4gDixBjUKNHEgYmPiQ4IGnBkGsRojFYg2oiWKlDgpk+g93keezngUgFboqbaiSs5yTlnn531/2v//15ni6qymGEWNfv/AAB7+cO19CAiiwtAVTFm4QsmcyQV4D+zxmwFyuUyW7ZuJYgiTYjUpCA7AWdrRKQShrqss5MXd+yQxsZGVdWFWxLnHKrK5Jkzta3Wrs/CXTXQ0gJ9gGeMEcBbtXx5/VguJ6o6O2chrksVENPQUPJ8f9SoJo0x0yvh9mYoT4nk/DBsbBepC8bGJmhtHV8Y6hfjClVVwjCuxHEchGF8IgxHfgrDoeYouvkG1Z4p1fOlXK51IZPDVS64KhIAAeAgXyfiGru7hwHPhaEgolwcc4Aa8BzEVVZGq+8AxPNiMWZOYc+6IAhDPv7wwyRxbANj8tnmZj+CIAWZSLXcXlu7ZGV//6hNJoMFo8/cNiQql/3BPXse/UH14CiMroDVvmriTKGQ63PuMQ9qijA1A2eH4AvArINNP8JACEEXbByH4R64P21Mc9vmzR819/YeQ3W2cpfiiiWIo0iMtVrO5/0j27d/sN+51/bCMxthUxqWDsPAg/DEAdjlQ/0GeOoATE7D1CvwyVuwPg9Tj8A2RMx+1V8SqdTYqxs2tNDbe2wu+14BwPM8ABo8Lz3ueQO90DUk0hfDhSYgDeLBhTycKsDYbXBnF9w5CT9HcGIVrC3BhQhySWv9RKWSrNxzz56W++4LgD+xh/mbkT/pXG6/c7sfcO65eudSsXNR5Fx4nXPt/c493ubcLcec+7bdua5bnXton3O72pzr6XZu04hz378bhs9mIbXp0KEDEwMDdwCK6p/yzQcgboTrv4HPxmDkYXi+CNMJaPwNBt+HF47CwEk43AYrO2D9Z/BOFm5aCfceh0Ml1fLb1m7ZNz395cn33ntaATHGXZ1oPhvG51XPAexVffkO2FaEShFmlkL3k/DSOJw+AG8WIR6HbwHOwHAjLDkFw4+J7EhGUVPW85a09Pd/KoA6JyKiXKaDOV2gYegPHTzYkYNhB9wAnQGUA5jpgHU+1BetHRsROboElgVQnIDxDGTqIHUWTraLrGqNojVRU9NIQ0/PEWvtnE1uTgBXf3P5xEtK/mVgYPnWnTt/zSYS9bWq6QAqJZhRIIAgBimJaEsUXR8XCv4EjCYrlcxtd9+df3n37sirtvZ5d0IXRebyXU4v3oNzxvN9NzE4uO7g55/nV4gsL6iGAVR8aIugFIIWYSyA4k2wJoCZcyJlq5pp9rwW4vg4VT3M+4dhrHXWWqy1GGtjz1r1rFVjbQxourv7eB+sFWMKGHOh05i2vDGj08b82mXMqhpjjDXGpI3xzhtzfLUxXQYiWy43i3OzxK/VC64Z5UpFv4Ov6pyrr1XNzEAYg8YgU5CvgTqFmgKUPGiYMGYyAJnOZIac5wWXmP99AFUFL+vrO/36G2+UEp4XJSHwYSYPBQcuCYdTkK6BhtPwdRZuzIucTEdRS1NHh2+qGx78NRH+q/GPl0BVJYoirTpaALTqFuEPpyuogFTHRETwrJ1lvegVWPSDyf8AFh3A71ZKZHCYQCk/AAAAAElFTkSuQmCC",T6=Object.freeze(Object.defineProperty({__proto__:null,default:w6},Symbol.toStringTag,{value:"Module"})),S6=""+new URL("../assets/www.youtube.com.CUYxzsz0.png",import.meta.url).href,k6=Object.freeze(Object.defineProperty({__proto__:null,default:S6},Symbol.toStringTag,{value:"Module"})),A6={"https://www.thehindu.com/news/national/telangana/an-hours-rain-floods-the-city-creates-mayhem/article68190809.ece":{url:"https://www.thehindu.com/news/national/telangana/an-hours-rain-floods-the-city-creates-mayhem/article68190809.ece",title:"An hour’s rain floods Hyderabad, creates mayhem",description:"Automatic weather station at Lingampally MMTS recorded the highest rainfall at nearly 7 centimetres.",image:"https://th-i.thgim.com/public/incoming/57omkj/article68193160.ece/alternates/LANDSCAPE_1200/DSC5388.jpg",favicon:"/src/lib/assets/favicons/www.thehindu.com.png",siteName:"The Hindu"},"https://www.deccanchronicle.com/southern-states/telangana/heavy-rainfall-drenches-hyderabad-following-early-morning-cloudburst-1817655":{url:"https://www.deccanchronicle.com/southern-states/telangana/heavy-rainfall-drenches-hyderabad-following-early-morning-cloudburst-1817655",title:"Hyderabad: Heavy rains drench city areas",description:"The unexpected deluge led to concerns over potential flooding and waterlogging in several neighborhoods, prompting netizens to share their experiences and issue warnings.",image:"https://www.deccanchronicle.com/h-upload/2024/08/20/1832219-aa-2866524.webp",favicon:"/src/lib/assets/favicons/www.deccanchronicle.com.png",siteName:"Deccan Chronicle"},"https://timesofindia.indiatimes.com/city/hyderabad/2020-rerun-hyd-wakes-up-to-deluge-many-streets-sink/articleshow/84458414.cms":{url:"https://timesofindia.indiatimes.com/city/hyderabad/2020-rerun-hyd-wakes-up-to-deluge-many-streets-sink/articleshow/84458414.cms",title:"Hyderabad wakes up to deluge, many streets sink",description:"The city woke up to a deluge on Thursday morning following 100-200 mm of rainfall in many areas, bringing life to a crippling halt.",image:"https://static.toiimg.com/thumb/msid-114404506,width-1070,height-580,imgsize-105126,resizemode-75,overlay-toi_sw,pt-32,y_pad-40/photo.jpg",favicon:"/src/lib/assets/favicons/timesofindia.indiatimes.com.png",siteName:"The Times of India"},"https://www.thehindu.com/news/cities/Hyderabad/watch-remembering-the-destructive-hyderabad-flood-of-september-1908/article68817255.ece":{url:"https://www.thehindu.com/news/cities/Hyderabad/watch-remembering-the-destructive-hyderabad-flood-of-september-1908/article68817255.ece",title:"The flood that remade Hyderabad and forcing a rethink now",description:"On September 28, 1908 a huge wave of water towering over 46 feet swept both the banks of the River Musi in Hyderabad. ",image:"https://www.siasat.com/wp-content/uploads/2020/09/Floods-Musi-River.jpg",favicon:"/src/lib/assets/favicons/www.thehindu.com.png",siteName:"The Hindu"},"https://www.thehindu.com/news/cities/Hyderabad/a-choked-gurram-cheruvu-leaves-old-city-flooded/article32887896.ece":{url:"https://www.thehindu.com/news/cities/Hyderabad/a-choked-gurram-cheruvu-leaves-old-city-flooded/article32887896.ece",title:"A choked Gurram Cheruvu leaves Old City flooded",description:"There is no outflow channel for the Gurram Cheruvu that breached the bund and inundated Hafiz Baba Nagar, according to findings of Irrigation department officials who visited the lake in Balapur.",image:"https://th-i.thgim.com/public/news/cities/Hyderabad/m2sgu6/article32887915.ece/alternates/LANDSCAPE_1200/20204",favicon:"/src/lib/assets/favicons/www.thehindu.com.png",siteName:"The Hindu"},"https://www.thehansindia.com/news/cities/hyderabad/hyderabad-gurram-cheruvu-breach-triggers-flood-of-woes-652074":{url:"https://www.thehansindia.com/news/cities/hyderabad/hyderabad-gurram-cheruvu-breach-triggers-flood-of-woes-652074",title:"Gurram Cheruvu breach triggers flood of woes",description:"The floods triggered by the breach of Gurram Cheruvu lake in Chandrayangutta area of Old City on Saturday night unleashed unprecedented havoc as houses were submerged and cars and other vehicles were washed away like toys.",image:"https://assets.thehansindia.com/h-upload/2020/10/19/1006491-flood.webp",favicon:"/src/lib/assets/favicons/HansIndia.png",siteName:"Hans India"},"https://telanganatoday.com/hyderabads-old-city-flooded-yet-again":{url:"https://telanganatoday.com/hyderabads-old-city-flooded-yet-again",title:"Hyderabad’s Old city flooded yet again",description:"Omer colony, Hafeezbabanagar C Block, Gulshan Iqbal colony and Lalithabagh worst-hit due to discharges of water from Gurram Cheruvu tank",image:"https://image.telanganatoday.com/wp-content/uploads/2020/10/Hafeezbabanagar_V_jpg--816x480-4g.webp?sw=1536&dsz=816x480&iw=659&p=false&r=1.25",favicon:"/src/lib/assets/favicons/TelanganaToday.jpg",siteName:"Telangana Today"},"https://www.newindianexpress.com/hyderabad/2017/Oct/11/traffic-thrown-out-of-gear-in-madhapur-techies-bear-the-brunt-1670596.html":{url:"https://www.newindianexpress.com/hyderabad/2017/Oct/11/traffic-thrown-out-of-gear-in-madhapur-techies-bear-the-brunt-1670596.html",title:"Traffic thrown out of gear in Madhapur, techies bear the brunt",description:"While it was a day-long waterlogging at the busy Biodiversity junction during last week’s intense rainfall, this week it was the heavy traffic jam at Madhapur that left techies and commuters fuming over the poorly designed drainage pipelines and traffic management.",image:"https://media.assettype.com/TNIE%2Fimport%2F2017%2F10%2F11%2Foriginal%2FTraffic_throw.jpg?w=1024&auto=format%2Ccompress&fit=max",favicon:"/src/lib/assets/favicons/www.newindianexpress.com.png",siteName:"The New Indian Express"},"https://timesofindia.indiatimes.com/city/hyderabad/hyderabad-flash-floods-damage-to-hundreds-of-homes/articleshow/78656057.cms":{url:"https://timesofindia.indiatimes.com/city/hyderabad/hyderabad-flash-floods-damage-to-hundreds-of-homes/articleshow/78656057.cms",title:"Why floods occur in Hyderabad",description:"Hyderabad witnessed the highest rainfall ever on Tuesday according to the IMD. Torrential rains brought normal life to a halt as many parts of the city were flooded.",image:"https://static.toiimg.com/thumb/imgsize=123456,msid-78658071,width-600,resizemode-4/78658071.jpg",favicon:"/src/lib/assets/favicons/timesofindia.indiatimes.com.png",siteName:"The Times of India"},"https://www.thehindu.com/news/national/telangana/heavy-rain-floods-city-roads-creates-traffic-mayhem/article67102423.ece":{url:"https://www.thehindu.com/news/national/telangana/heavy-rain-floods-city-roads-creates-traffic-mayhem/article67102423.ece",title:"Heavy rain floods city roads, creates traffic mayhem",description:"Skies poured down on the city for hours on Thursday, turning streets into streams, residential areas into lakes and roads into virtual mayhem.",image:"https://th-i.thgim.com/public/incoming/yzgmn5/article67102915.ece/alternates/LANDSCAPE_1200/20hyngg_heavy%20rains%2020.jpg",favicon:"/src/lib/assets/favicons/www.thehindu.com.png",siteName:"The Hindu"},"https://www.thehindu.com/news/cities/Hyderabad/non-stop-rain-causes-water-stagnation-and-traffic-disruption-in-hyderabad/article68590479.ece":{url:"https://www.thehindu.com/news/cities/Hyderabad/non-stop-rain-causes-water-stagnation-and-traffic-disruption-in-hyderabad/article68590479.ece",title:"Non-stop rain causes water stagnation and traffic disruption in Hyderabad",description:"Hyderabad received continuous rains throughout Saturday and caused water stagnation and significant traffic congestion in the city.",image:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIAHEAjQMBIgACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAAFAAIDBAYBB//EADsQAAIBAwMCBQMCBAQEBwAAAAECAwAEEQUSITFBBhNRYXEUIoEykUKhscEjUnLRM+Hw8QcVJDVDU4L/xAAZAQADAQEBAAAAAAAAAAAAAAAAAQIDBAX/xAAkEQACAgICAgICAwAAAAAAAAAAAQIRAyESMQQiQVETcTJh0f/aAAwDAQACEQMRAD8Azd5MgzDaJeRWchX7BLs3Mc7sk8Ht70T8GxXEWpuIoLnEkir/AJ1wDn9Q49f2oVeeJgGgkgvEvHdyojZOB857fHtUkNxrEkZj+olig3EhRIQq57ADt7VePI4raMpY7NZq/iDTRaugkZ/NidozgkEZ2/xY5yD2rPJrFub6NZ7RJ7SONo0EjEEE8jgDsc1W/wDKxDatPNDNONwAwpAJJ6Cr2kQaLJJGfOSeVv8A4VBBUkdD3+filNueyoY6VLY2TTp9S2yWltFFGuSQmUG3jk571ptM8PSbo/rNdjSEweWYvqFUheOP1Z6Z9Km+2zhlk87yYliIMh+6ONscHHTI+a878Ra1Y3Mgu2jS8nESx+c8YCybTycHp+rtmp8eWLLL1l/g8mKeKNyies2fhTw3aR+XBqTiLJJQXvBB7df+dS2+teFre5a3hMTtbx8O6FyVHGEyPjn+teIWF5DOIXtoIIpDIsTKq8gHJ/fjrR663T6olpbP9pCpgLkKfU9+uP3rpljS6dmPNt9UbaTxHNrmofTafawQW4G5dyDJOepI9gent+SS/USBY7nyhuxny8/cB1znj0H5rO2xh8P39np0k7m6uyT5TAE7QOee3PPNWtVe9kjE1rA8iSMEAAIZFJxu5GCO/BzQuNUDTbNKztIRuGcZxkc+tD77TzcyM/myocDiJtp+3JHPbqaswvxncxPvxVdpZhc3AYZi2p5frnnd/aqdJCS2CZdNk1nT4hqsccU8c29/JIIJHI5+DQjxMNIlQ2yy3E1ycI0zg4i4zwSO+7t3HtWgmuZbWK2jjRXaaXY+4HgcDPHsKC3fhqW61K8ukvXg87bwtn5ykKAMYB3Cj+NSatA05JpOjJ6LFfapfPZWN2Y5CcyJINinHByo4yc1fHhfWILiVwsDSDqyytnCnvn0qxb6NLaX6XRsp98R3yeXarHxyQ2xiG7k4x/SjvneI001p40017WVCFkecCQAk9UPcZ5+K59o1S+LAFxpGtMzyvBu+8EKkzHtnoSfWgtzofiG7fL2YIX9GyRRx+Tk9DW5sNev4YFjubOGRzn/ABEmTB9OM+lX7KVoLeIXEcSsIkUZkweFGevuTQ9hxSMfo/hmC3jQuill6ELkj81o7OxiVg20lh/EcGp92OBj+tOSQk8HilEtlptiwlXXKkYNB9K8MajcQJLoOsJpa4MTxG3Ejuwc/cDkHGCvHTii4IZcHoetU73WNS0mye30m3tWSXc0huA329OmD3qcq5UmtFQbW0wB4t8M6xdRaZbS6z9bHGsv1F052oXD/aAmT93UD4rIEbNNu7JLFprlpf18sUJIOD7Ej+Ron4j8R6lq15bxXTQQqrMzGHIUnG7JOTlQRx8Corm526YbHSWcm4KxzsVGGUrnIPrluvbmrUElUTPk27ewJo0rhZI8KWSdXQr03AMMn2rQ6ZqlrDcxiGGG7vpJNhWZGKt3z+rHXHatP4c8NeEIdLit9Uu7g3zkGUx7gFPH2j7eR79KpW2lWcWoTSWiOkZb/CMgG8IemeOvSnP2STEkrbRLeXDXd1De3VrHBLF9u2AYUj+L5J6Vf8PN9ZdXF9HPK1u52rEWbClCwIIyemfb4rPXvh+eO1VrbXLwTLGS4u7fare4wcL/ADor4QjtdHWPTY5pppbpDds5GVU/aMZ9+tPpoF0zXBschcUi5II45qLzO2TSDN/mqrEMdtkik4OOoodqthLexuIL26tGddpaCQrxVyUtvzxiumQgDqfjmpY0YG5F/os80aW7ahFKoxJcMzFMZzgAjrn1p1rrWof+ns7nRNNZd6lZZYWkZMntlhjHY4NbeWON/wBQB9jVea0hdGUou0+g/T8elG/sdL6M6+l3lvY2kWl2bzotuTKDIQxY+nUnnJrln4pNgrwXcCxTK2GSS62YP7UfjFzbMipMWgRs5wSyL3I9aJLpVvqsSXclvbagr8xz+XGwK4BGCTS2AORumQM/yodpd5dtrt/bXLxNDGqmHyXDgAkg7iOh4HHvRFenFNtIEjuWddq7hg8VCZYRHsMYoTqt2lpGA9vcyq7uGYYyo459xk9qivL54ruUR5ICgjt2/FUp727vLj6ZIFkflldgQq9OMnOP+1SpTb3HX2W4RS72D7Sxs5rSW68ldse4rLKAchRyai0zThaMLue3xbJiQQrgGTGNy892CgfvWt0KwsLGWRdakuZ0K7Vt4lAHJ5L9MnsOlRa9q1hHqktvaWKRadBEPMnm3FmcjhVGcDH2+tacX2Y810iKb/xA0hkAXwtH5kgPlFIlGzrjf6dume/tXdKnOnSJqDRyTJExkVEAz14ABOOOMD2pl1ZXcEaTWOmNcKSSWWHzFH9v3qvb61m5Ftc2ZhkkcKvBUrjO7I9yR+Aaz5S5VR0fhh+L8nJfr5C134vu9e0K9sJIWt55sIJJIhGoQ4zyGPPX+VS+FfCpnv4zIxUQxYG3nYDgfHIH8qrGKMsOwzkj1o9YaNf6hZR3VjPHCAGXYJWUnnrwD6HHSnFOzKVJFzWtIj0yBZUuC2TjDJ6/B9j+1CMkfrOAenvXdQsdY0i3DaxdNPAxCRL9U8n3dc4IHYEfmq3nmQbl+5j1JHFW3slbHEFlIlIIOPtHSu5A4Ax8Uh79a4aLHQ4AYqOSVI1LOwAHXNMknRTsBy+M7c1CLXzmEk3PA+0dEP5p2FEU+qG2UXNpG8rI2cbSAw7gHt81Tn8TeCwqjUjfW0uc+VFCARwvUbT6Y4461dmicI/VM9+uffFALnS4JpSzxDd6suc0uTQnBPs0K57fnFP5Hf7aZHudwqLk5wABya1mneEnlj8zUpWhz0jTGR8nkVBRiL2z8+UMcHjHYVZ0aG0tLuNrlCY8/wCJgckehPpRq9l8MWmt2+hC5e41CY7Cke4snu2AQPzj1odqcC2eozW6OzIp+1mxlh+PzRXyF/AdbUfCTrNdCxaN1yzqsbx7zz0AI3Z+PmsLpOnX3iLWUWWEIJJCywuSViTOf5DsKLhhjt/vSgZoX3wEowB5BK/0p2xcUFm8J6nBIXiQHcBv8iULu6+u3gVhblzPrEgjZ2EUuXYtuBZeBtPfoOfata+r6otpNAL+5YSIUy8m7GR15yf6UL0jQJzGGt4i0a8DJ5J9SanLnjCNzdIUMW9Fi2uHDZkiQr3Izk/g1be/LRmIiJowMKHTp+RzSuLGezVTNDtBOBz3qEjjtUwyQyR5Qdo0cWnsnubxr/y45njbYcqu/wBsd/mknlohzLHtXrtbJ/l1quVU9VBpyhVG0JkfHSqEyX6qHssjgdDwP60yZzI/25ROyg8/k/7YrhPHTA7cU3fjGWI+DVCJI0Vf0DH4rrOM7HOB0yO9Vmbp/idfWmeYw3P1Ax/+R3p2BLKzpwuPLPcnNDpWQSlZCEYDqylt37VJPduFJhXBVdwJ9P3qBpJBwp3AE8gDr6VLY0g3faLqsdtHnS55IpV3PJFhj/pKg5Hr07062j1VbeU2cuoW0kabFEolEYZhgEqeoHJ+QB3rTW3jaB42M9uiOFyD5u0E59xx39elZfxV4m1C/nggt5IFsdm+dkBbeTnCr3G3AJyOc9eK0UvWjKUfa0BbVbHwpaS2+lstzqM2RPeyDLTN1IA7KD1/nk9H2P1BjD3MskshA3PIdzH81RhBWTKJIx4zI/XHpjoBRCIYH86zcrNVGi5lVGArD3zSU1Dupb8CgZV1u8+lsmlLsozjC9TkYot4V1a3ijaylmbemDGDjLKRnj1xg0E1VDPb7VbbzzWXureC41HZeNJGBFvDowGCuT3I9fWubysEc2PhIam4bR6jreo2zWwVptrMwChsChQfnmsGUstLljuI55b0JKocSbWwMZyBuP7+tam2v11BPq0ieFZSWEbnJHyffr+anxPHjgx8Yt1/Y5ScnsK+auOtISAnpn3qqHGPeu7sV1klgufVqjZtv3EnHoByahDHqWxTt2M/fkHrQKiRsY5Xk+p5qDziMrFFyDwTzn1pofL/AGqPcnsKhMqHcY5QMNgHdnj+1AHJFYkyScrt5HTJ7f8AXvVKaWNZCMhsnOTkD0/tT5fucKp3FSGbjn0xUD5gby5LgIR6JuqWUgqy7jySPg1woDzgH5pbq5nmqAeFA9qcDio91ImkBJurhkHrURamkigRI5B+KB6rYx3cjblUHnk8UZyMcVHIN2MKCR6ik0AEj02P6jesKhjjIAwF49K0MC+XGBuGAOwqugA7j4AqYEE9KSHSSol3DG7Ix7nFIyKi5dvzjP8AKoSfvyecVyQ5wSw/IqgHmcgKzAgdhjk00zsTgbVBPLN2qCSSOMs0h655PWhsXkXsYjupg8qscbjtIXJwQO/zVwhy/RnOaiP1DU3c7EYmMdTjaX/5UEvL+4dhBBIyORl5N20RoOrVoG0qRg300gkUf5v96znjLyrJUsLdg7ud80iqV3AAYXnsCSffj0rqkoxXqYRbk9lnw/riO88LuWdFykzj7nUHnPp1z/epJr2NcfePLyduOMnvyaz/AIZUpdtNg7AuzOPjpRa9ZkKi3yEyThABzn3rz8r3Z07o2APNItUZaubu1WMkDV0tUe7iuE0ASZppNM3Vzfzn0oAlBrpIx3qJW4Oa7u70DHgjuK7xnpUW6kWx8UgJd3rUZOXz2FNTezEsft7Cnl8DimAH1EiWJXEyl1kZJYV/gJAK59c8/t8VU5x246Y6/in6lpzte/XWjGKXGG2jr+Oh/wC9VJtUaBMX1rtI4EkC4Xr3GPT3r0/D8jDGPCejz/JwZXLlFhO21CWHA3kqP/sYmstqV42s6tIVjB3YUH/KBRW6vtNfTm+jnuJLyRgscbIqqfXOGJ/pTdM0z6WMNIMSZ5z3rHy547rGa+NCdXMv6ZYLb2wRMBupNRSWyuzM8jNlicHnHxVtyyABO3UelclEbEOpxu5IFedLZ2JBg9a4etKlWhIh0pGlSoA41N7H4pUqAHH+1LsKVKgZw109KVKkA8dB8UxqVKgCP+Ef6qEXf/Ab5NcpVL7G+jP6R/7uf9LVrpv0x/IpUq0kSiKb/jH/AE1BP+ofFKlWRZ//2Q==",favicon:"/src/lib/assets/favicons/www.thehindu.com.png",siteName:"The Hindu"},"https://timesofindia.indiatimes.com/city/hyderabad/begumpet-residents-flood-ready-plan-fails/articleshow/79105817.cms":{url:"https://timesofindia.indiatimes.com/city/hyderabad/begumpet-residents-flood-ready-plan-fails/articleshow/79105817.cms",title:"Begumpet residents’ flood-ready plan fails",description:"Residents of low-lying areas in Begumpet, who suffer with every downpour, had a nightmare when incessant rains lashed the city in October.",image:"https://static.toiimg.com/thumb/imgsize-23456,msid-79110040,width-600,resizemode-4/79110040.jpg",favicon:"/src/lib/assets/favicons/timesofindia.indiatimes.com.png",siteName:"The Times of India"},"https://telanganatoday.com/hyderabad-drenched-after-overnight-downpour-gachibowli-records-97-mm-of-rainfall":{url:"https://telanganatoday.com/hyderabad-drenched-after-overnight-downpour-gachibowli-records-97-mm-of-rainfall",title:"Gachibowli records 97 mm of rainfall",description:"Overnight rains lashed Hyderabad, with Gachibowli recording a significant 97 mm of rainfall, marking the highest in the city, as per the Telangana Development Planning Society’s data.",image:"https://image.telanganatoday.com/wp-content/uploads/2024/09/Hyderabad-Rains_V_jpg--816x480-4g.webp?sw=1536&dsz=816x480&iw=659&p=false&r=1.25",favicon:"/src/lib/assets/favicons/TelanganaToday.jpg",siteName:"Telangana Today"},"https://www.deccanchronicle.com/videos/kukatpally-roads-were-flooded-following-heavy-rains-in-hyderabad-1820660":{url:"https://www.deccanchronicle.com/videos/kukatpally-roads-were-flooded-following-heavy-rains-in-hyderabad-1820660",title:"Kukatpally roads were flooded following heavy rains in Hyderabad",description:"",image:"https://aniportalimages.s3.amazonaws.com/media/details/ANI-20230906065552.jpg",favicon:"/src/lib/assets/favicons/www.deccanchronicle.com.png",siteName:"Deccan Chronicle"},"https://www.thehansindia.com/news/cities/hyderabad/secunderabad-flood-fear-stalks-dwellers-near-hasmathpet-lake-690729":{url:"https://www.thehansindia.com/news/cities/hyderabad/secunderabad-flood-fear-stalks-dwellers-near-hasmathpet-lake-690729",title:"Secunderabad: Flood fear stalks dwellers near Hasmathpet lake",description:"Residents in and around Hasmathpet lake are in deep concern as the monsoon is approaching and yet Secunderabad Cantonment Board (SCB) authorities have not taken any measures to prevent flooding in the nearby areas, even though it is a low-lying area.",image:"https://assets.thehansindia.com/h-upload/2021/06/13/1081976-gg.webp ",favicon:"/src/lib/assets/favicons/HansIndia.png",siteName:"Hans India"},"https://timesofindia.indiatimes.com/city/hyderabad/imd-issues-yellow-alert-for-next-2-days-in-hyderabad/articleshow/112553832.cms":{url:"https://timesofindia.indiatimes.com/city/hyderabad/imd-issues-yellow-alert-for-next-2-days-in-hyderabad/articleshow/112553832.cms",title:"Rain pounds Hyderabad, IMD issues yellow alert for next 2 days",description:"After enduring 15 days of sultry conditions, Hyderabad saw a sudden and intense downpour on Thursday evening.",image:"https://static.toiimg.com/thumb/msid-112553830,imgsize-62288,width-400,height-225,resizemode-72/112553830.jpg",favicon:"/src/lib/assets/favicons/timesofindia.indiatimes.com.png",siteName:"The Times of India"}," ":{url:" ",title:" ",description:"",image:" ",favicon:"/src/lib/assets/favicons/",siteName:" "}};var M6=Ht('<div class="block flex-shrink-0"><img alt="" class="size-28 object-cover rounded-sm bg-zinc-100"></div>'),I6=Ht('<p class="text-sm text-zinc-500 line-clamp-2 mt-1"> </p>'),E6=Ht('<img alt="" class="w-4 h-4 rounded-sm">'),C6=Ht('<div class="flex gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-start justify-between gap-2"><h3 class=" font-medium text-zinc-800 leading-relaxed line-clamp-2 md:text-base text-sm"> </h3> <!></div> <!> <div class="flex items-center gap-2 mt-2"><!> <p class="text-xs text-zinc-400 truncate"> </p></div></div></div>'),P6=Ht('<div class="text-sm text-zinc-600 break-all"> </div>'),z6=Ht('<a target="_blank" rel="noopener noreferrer" class="block border rounded-lg hover:bg-zinc-50 transition-colors duration-100"><div class="p-3"><!></div></a>');function D6(i,n){un(n,!1);const o=Hi(),h=Hi(),p=Object.assign({"/src/lib/assets/favicons/HansIndia.png":t6,"/src/lib/assets/favicons/TelanganaToday.jpg":n6,"/src/lib/assets/favicons/bangaloremirror.indiatimes.com.png":a6,"/src/lib/assets/favicons/scroll.in.png":o6,"/src/lib/assets/favicons/timesofindia.indiatimes.com.png":c6,"/src/lib/assets/favicons/www.deccanchronicle.com.png":h6,"/src/lib/assets/favicons/www.deccanherald.com.png":f6,"/src/lib/assets/favicons/www.hindustantimes.com.png":m6,"/src/lib/assets/favicons/www.moneycontrol.com.png":y6,"/src/lib/assets/favicons/www.newindianexpress.com.png":v6,"/src/lib/assets/favicons/www.thehindu.com.png":x6,"/src/lib/assets/favicons/www.thenewsminute.com.png":T6,"/src/lib/assets/favicons/www.youtube.com.png":k6});let b=tt(n,"url",8);ei(()=>Ai(b()),()=>{di(o,A6[b()])}),ei(()=>De(o),()=>{var R,C;di(h,(R=De(o))!=null&&R.favicon?(C=p[De(o).favicon])==null?void 0:C.default:null)}),Or(),cn();var _=z6(),c=pt(_),M=pt(c);{var B=R=>{var C=C6(),Y=pt(C);{var X=we=>{var Te=M6(),fe=pt(Te);ut(Te),Mi(()=>Ti(fe,"src",De(o).image)),rt(we,Te)};Vi(Y,we=>{De(o).image&&we(X)})}var Z=Wt(Y,2),se=pt(Z),q=pt(se),te=pt(q,!0);ut(q);var ne=Wt(q,2);iA(ne,{class:"size-4 flex-shrink-0 text-zinc-400"}),ut(se);var _e=Wt(se,2);{var be=we=>{var Te=I6(),fe=pt(Te,!0);ut(Te),Mi(()=>no(fe,De(o).description)),rt(we,Te)};Vi(_e,we=>{De(o).description&&we(be)})}var Ae=Wt(_e,2),de=pt(Ae);{var Be=we=>{var Te=E6();Mi(()=>Ti(Te,"src",De(h))),rt(we,Te)};Vi(de,we=>{De(h)&&we(Be)})}var Fe=Wt(de,2),Le=pt(Fe,!0);ut(Fe),ut(Ae),ut(Z),ut(C),Mi(()=>{no(te,De(o).title),no(Le,De(o).siteName||new URL(b()).hostname)}),rt(R,C)},O=R=>{var C=P6(),Y=pt(C,!0);ut(C),Mi(()=>no(Y,b())),rt(R,C)};Vi(M,R=>{De(o)?R(B):R(O,!1)})}ut(c),ut(_),Mi(()=>Ti(_,"href",b())),rt(i,_),hn()}const L6=""+new URL("../assets/frog.CB-X4g8D.png",import.meta.url).href;var R6=Ht("<li><!></li>"),B6=Ht('<div class="flex mt-4 md:flex-row flex-col gap-4 mb-6"><div class=" md:mb-0 flex items-start"><p class=" rounded-lg font-bold text-zinc-600 whitespace-nowrap"> </p></div> <div><ul class="space-y-3 w-full"></ul></div></div>'),O6=Ht(`<div class="h-full flex flex-col"><div class="flex mx-4 py-4 justify-between border-b border-zinc-200 items-center"><div><h2 class="font-bold text-2xl text-zinc-900"> </h2> <p class="text-zinc-500"> </p></div> <button class=" text-center text-sm w-[7rem] transition-all duration-100 bg-zinc-100 hover:bg-zinc-800 hover:text-white font-bold text-zinc-600 px-4 py-4 rounded-md flex items-center justify-center gap-2"><!> Back</button></div> <div class="px-4 pt-2"><h3 class="font-bold pb-2 text-lg text-zinc-900 border-b border-zinc-200">In the news</h3> <!></div> <div class="flex-1 pb-8 m-2 flex items-center justify-center h-full text-center text-zinc-400"><div class="flex gap-y-2 items-center justify-center flex-col"><img class="size-24 md:size-28 opacity-60 grayscale-[30%]" alt="Frog rowing a boat"> <p class="font-medium text-sm">That's all we've collected for now</p> <div class=" text-center text-xs text-zinc-600">Found another mention? <a class="text-zinc-600 border hover:bg-zinc-200 border-zinc-200 bg-zinc-100 px-2 py-1 rounded-sm transition-colors duration-100" target="_blank">Contribute</a> to the map.</div></div></div></div>`);function F6(i,n){un(n,!1);const o=Ma(),h=()=>kn(ao,"$selectedPOI",o);let p=tt(n,"pois",8);console.log(p());const b=cl();cn();var _=O6(),c=pt(_),M=pt(c),B=pt(M),O=pt(B,!0);ut(B);var R=Wt(B,2),C=pt(R,!0);ut(R),ut(M);var Y=Wt(M,2),X=pt(Y);Jk(X,{class:"size-4"}),yc(),ut(Y),ut(c);var Z=Wt(c,2),se=Wt(pt(Z),2);{var q=de=>{var Be=vi(),Fe=ni(Be);vc(Fe,1,()=>Object.entries(p()[h()].links).sort((Le,we)=>Number(we[0])-Number(Le[0])),_c,(Le,we)=>{let Te=()=>De(we)[0],fe=()=>De(we)[1];var Me=B6(),Ee=pt(Me),$e=pt(Ee),He=pt($e,!0);ut($e),ut(Ee);var Ge=Wt(Ee,2),Re=pt(Ge);vc(Re,5,fe,_c,(Xe,Ue)=>{var Mt=R6(),Rt=pt(Mt);D6(Rt,{get url(){return De(Ue)}}),ut(Mt),rt(Xe,Mt)}),ut(Re),ut(Ge),ut(Me),Mi(()=>no(He,Te())),rt(Le,Me)}),rt(de,Be)};Vi(se,de=>{var Be;h()&&((Be=p()[h()])!=null&&Be.links)&&de(q)})}ut(Z);var te=Wt(Z,2),ne=pt(te),_e=pt(ne);Ti(_e,"src",L6);var be=Wt(_e,4),Ae=Wt(pt(be));yc(),ut(be),ut(ne),ut(te),ut(_),Mi(()=>{no(O,h()),no(C,p()[h()].neighborhood),Ti(Ae,"href",`https://github.com/diagram-chasing/blr-water-log/issues/new?assignees=&labels=data%2Cflooding-incident&projects=&template=add-flooding-incident.yml&title=Add+Flooding+Incident%3A+${h()??""}`)}),Ct("click",Y,()=>{b("back")}),rt(i,_),hn()}var N6=Ht(`<div class="h-full flex flex-col"><div class="flex mx-4 py-4 justify-between border-b border-zinc-200 items-center"><div><h2 class="font-bold text-2xl text-zinc-900">Methodology</h2> <p class="text-zinc-500">How we built this map</p></div> <button class="text-center text-sm w-[7rem] transition-all duration-100 bg-zinc-100 hover:bg-zinc-800 hover:text-white font-bold text-zinc-900 px-4 py-4 rounded-lg flex items-center justify-center gap-2">Back <!></button></div> <div class="px-4 py-6 flex-1 text-sm text-zinc-600 flex flex-col"><div class="flex-1"><p class="max-w-[30rem]">Using a 30m digital elevation model from <a href="https://spacedata.copernicus.eu/collections/copernicus-digital-elevation-model" target="_blank" rel="noopener noreferrer" class="svelte-znp55x">Copernicus</a>, we analyzed the city's terrain to understand it's water flow
        patterns. We used WhiteboxTools, a geospatial analysis library, to map
        water accumulation, and identify major streams across the landscape. To
        produce the graduated layer you see on the map, we smoothened these
        accumulation values and reclassified them into distinct categories.</p></div></div></div>`);function j6(i,n){un(n,!1);const o=cl();cn();var h=N6(),p=pt(h),b=Wt(pt(p),2),_=Wt(pt(b));Qk(_,{class:"size-4"}),ut(b),ut(p),yc(2),ut(h),Ct("click",b,()=>o("back")),rt(i,h),hn()}var V6=Ht('<!> <div class="mx-auto my-2 h-1.5 w-12 flex-shrink-0 rounded-full bg-zinc-300"></div>',1),$6=Ht('<div class="absolute top-28 right-1/2 translate-x-1/2 transform -translate-x-1/2"><p class="text-white uppercase text-xl font-bold">tap to close</p></div>'),U6=Ht('<div class="h-full"><!></div>'),W6=Ht('<div class="h-full"><!></div>'),H6=Ht('<div class="h-full"><!></div>'),q6=Ht('<div class="bg-white overflow-x-hidden overflow-y-auto rounded-t-[20px] flex-1 relative"><div class="relative h-full"><!></div></div>'),G6=Ht("<!> <!> <!>",1),Z6=Ht("<!> <!>",1),X6=Ht('<!> <div class="fixed w-full md:w-fit bottom-0 -left-5 md:left-1/2 transform md:-translate-x-1/2 z-50"><div class="w-full max-w-[19rem] md:max-w-sm mx-auto"><div class="flex gap-2 w-full items-center"><div class="px-4 w-full py-2 z-10 justify-center items-center flex gap-1 border-zinc-300 border bg-white rounded-lg md:shadow-lg"><!> <input type="range" min="0" max="0.8" step="0.1" class="w-full h-2 rounded-lg appearance-none cursor-pointer relative [&amp;::-webkit-slider-runnable-track]:h-2 [&amp;::-webkit-slider-runnable-track]:rounded-lg [&amp;::-webkit-slider-thumb]:appearance-none [&amp;::-webkit-slider-thumb]:w-[20px] [&amp;::-webkit-slider-thumb]:h-[20px] [&amp;::-webkit-slider-thumb]:rounded-full [&amp;::-webkit-slider-thumb]:bg-[#74B1B5] [&amp;::-webkit-slider-thumb]:shadow-md [&amp;::-webkit-slider-thumb]:transition-colors [&amp;::-webkit-slider-thumb]:mt-[-4px] hover:[&amp;::-webkit-slider-thumb]:brightness-95 [&amp;::-moz-range-thumb]:w-[20px] [&amp;::-moz-range-thumb]:h-[20px] [&amp;::-moz-range-thumb]:rounded-full [&amp;::-moz-range-thumb]:bg-[#74B1B5] [&amp;::-moz-range-thumb]:border-none [&amp;::-moz-range-thumb]:shadow-md [&amp;::-moz-range-thumb]:transition-colors hover:[&amp;::-moz-range-thumb]:brightness-95 [&amp;::-moz-range-progress]:bg-[#74B1B5] [&amp;::-moz-range-track]:bg-zinc-200 svelte-1gwje1d"></div> <button class="px-4 hover:bg-zinc-100 py-2 my-2 z-10 md:my-4 justify-center items-center flex gap-1 border-zinc-300 border bg-white rounded-lg md:shadow-lg"><!></button></div> <!></div></div>',1);function Y6(i,n){un(n,!1);const o=Ma(),h=()=>kn(ao,"$selectedPOI",o),p=()=>kn(MC,"$smScreen",o);let b=tt(n,"pois",8),_=tt(n,"isLocating",8,!1);const c=cl();let M=Hi("default"),B=Hi("default"),O=Hi(!1),R=Hi(!1),C=Hi(.8);function Y(He,Ge){const Re={default:0,methodology:-1,poi:1};return Re[Ge]>Re[He]?1:-1}function X(He,{duration:Ge,direction:Re=1,delay:Xe=0}){return{delay:Xe,duration:Ge,css:(Ue,Mt)=>`
        position: absolute;
        width: 100%;
        transform: translateX(${K_(Re*Mt)*100}%);
        opacity: ${K_(Ue)};
      `}}function Z(He){const Ge=parseFloat(He.target.value);c("opacityChange",Ge)}function se(){di(M,"default"),rh(ao,null),di(R,!1),di(O,!1)}function q(He){di(B,De(M)),di(M,He),di(O,!0)}function te(He){He==="poi"&&rh(ao,null),q("default")}ei(()=>(h(),De(M),De(R),p()),()=>{h()&&De(M)==="default"&&(q("poi"),!De(R)&&!p()&&(di(R,!0),setTimeout(()=>di(R,!1),12e3)))}),Or(),cn();var ne=X6(),_e=ni(ne);db(_e,{$$events:{showMethodology:()=>q("methodology")}});var be=Wt(_e,2),Ae=pt(be),de=pt(Ae),Be=pt(de),Fe=pt(Be);aA(Fe,{class:"size-6 stroke-[#74B1B5]"});var Le=Wt(Fe,2);ET(Le),ut(Be);var we=Wt(Be,2),Te=pt(we);{var fe=He=>{nA(He,{class:"size-6 stroke-[#74B1B5] animate-spin"})},Me=He=>{rA(He,{class:"size-6 stroke-[#74B1B5]"})};Vi(Te,He=>{_()?He(fe):He(Me,!1)})}ut(we),ut(de);var Ee=Wt(de,2),$e=ur(()=>h()!==null||De(O));y3(Ee,{onClose:se,get open(){return De($e)},closeOnOutsideClick:!0,children:(He,Ge)=>{var Re=Z6(),Xe=ni(Re);T3(Xe,{class:"bg-white shadow-2xl shadow-black w-full max-w-[44rem] rounded-t-2xl rounded-b-none md:px-6 py-2",children:(Mt,Rt)=>{var _t=V6(),Xt=ni(_t);Wz(Xt),yc(2),rt(Mt,_t)},$$slots:{default:!0}});var Ue=Wt(Xe,2);S3(Ue,{children:(Mt,Rt)=>{var _t=G6(),Xt=ni(_t);x3(Xt,{class:"fixed isolate inset-0 z-100 bg-black/40"});var jt=Wt(Xt,2);{var si=qt=>{var bi=$6();$n(3,bi,()=>sf),Ct("click",bi,()=>di(R,!1)),rt(qt,bi)};Vi(jt,qt=>{De(R)&&qt(si)})}var fi=Wt(jt,2);b3(fi,{class:"bg-zinc-100 overflow-x-hidden overflow-y-clip max-w-2xl md:mx-auto mx-2 z-50 flex flex-col h-[35rem] md:h-1/2 rounded-t-[20px] absolute bottom-0 left-0 right-0",children:(qt,bi)=>{var Yt=q6(),Bi=pt(Yt),Qi=pt(Bi);{var hi=ke=>{var dn=U6(),Ii=pt(dn);F6(Ii,{get pois(){return b()},$$events:{back:()=>te("poi")}}),ut(dn),$n(3,dn,()=>X,()=>({duration:400,direction:Y(De(B),"poi")})),rt(ke,dn)},xi=ke=>{var dn=vi(),Ii=ni(dn);{var Kt=dr=>{var bn=W6(),Jn=pt(bn);j6(Jn,{$$events:{back:()=>te("methodology")}}),ut(bn),$n(3,bn,()=>X,()=>({duration:400,direction:Y(De(B),"methodology")})),rt(dr,bn)},Ei=dr=>{var bn=H6(),Jn=pt(bn);Qz(Jn,{get pois(){return b()},$$events:{showMethodology:()=>q("methodology"),selectPoi:()=>q("poi")}}),ut(bn),$n(3,bn,()=>X,()=>({duration:400,direction:Y(De(B),"default")})),rt(dr,bn)};Vi(Ii,dr=>{De(M)==="methodology"?dr(Kt):dr(Ei,!1)},!0)}rt(ke,dn)};Vi(Qi,ke=>{De(M)==="poi"&&h()?ke(hi):ke(xi,!1)})}ut(Bi),ut(Yt),rt(qt,Yt)},$$slots:{default:!0}}),rt(Mt,_t)},$$slots:{default:!0}}),rt(He,Re)},$$slots:{default:!0}}),ut(Ae),ut(be),Mi(()=>Ti(Le,"style",`--range-progress: ${De(C)*120}%;`)),OT(Le,()=>De(C),He=>di(C,He)),Ct("input",Le,Z),Ct("click",we,()=>c("locate")),rt(i,ne),hn()}var K6=Ht('<meta name="description"> <meta name="keywords"> <meta name="author"> <meta name="robots" content="index, follow"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="language" content="English"> <meta name="revisit-after" content="7 days"> <meta name="distribution" content="global"> <meta http-equiv="content-type" content="text/html; charset=utf-8">',1);function J6(i,n){un(n,!1);let o=tt(n,"description",8,"Default description of your website"),h=tt(n,"keywords",8,"svelte, seo, web development"),p=tt(n,"author",8,"Your Name");ph(()=>{}),cn(),wT(b=>{var _=K6(),c=ni(_),M=Wt(c,2),B=Wt(M,2);yc(12),Mi(()=>{Ti(c,"content",o()),Ti(M,"content",h()),Ti(B,"content",p())}),rt(b,_)}),hn()}const Q6=""+new URL("../assets/submerged.zgDpJ5-g.webp",import.meta.url).href;var eD=Ht('<div class="p-4 relative"><div class="absolute inset-0 bg-white/80"></div> <div class="relative"><div class="text-3xl font-khand-bold font-medium text-center text-zinc-900">Oops!</div> <div class="font-medium text-center text-zinc-900 font-supreme py-3"><!></div></div></div>');function tD(i,n){let o=tt(n,"open",12,!1),h=tt(n,"message",8,"Are you sure you want to do that?");WC(i,{classes:{dialog:"w-[25rem] mx-2  bg-white rounded-lg shadow-xl border border-zinc-300",backdrop:"dark:bg-black/40 bg-black/40"},get open(){return o()},set open(p){o(p)},children:(p,b)=>{var _=eD();Ti(_,"style",`background-image: url(${Q6});
  background-size: cover;
  background-position: bottom;
  background-repeat: no-repeat;`);var c=Wt(pt(_),2),M=Wt(pt(c),2),B=pt(M);AT(B,h),ut(M),ut(c),ut(_),rt(p,_)},$$slots:{default:!0},$$legacy:!0})}var iD=Ht('<main data-vaul-drawer-wrapper=""><!> <div class="map-container svelte-1l78r9"></div> <!> <!> <!></main>');function fD(i,n){un(n,!1);let o=tt(n,"data",8),h=Hi(),p,b=Hi(!1),_=Hi(""),c=Hi(!1);ph(()=>(p=new Xk,p.init(De(h)),()=>{p.cleanup()}));let M={title:"BLR Water Log",description:"Where does Bangalore's water flow and accumulate?",date:"2024-11-18",categories:["gis","map","blr","flood","bangalore","water"],author:["Aman Bhargava","Vivek Matthew"].join(", "),ogImage:"/sharecard.jpg"};function B(q){p&&p.setLayerOpacity(q)}async function O(){if(!De(c))try{di(c,!0);const q=await p.locate();q.type==="error"&&q.message&&(di(_,q.message),di(b,!0))}catch(q){console.error("Location error:",q),di(_,"Something went wrong while trying to locate you"),di(b,!0)}finally{di(c,!1)}}cn();var R=iD(),C=pt(R);J6(C,$r(M));var Y=Wt(C,2);Rr(Y,q=>di(h,q),()=>De(h));var X=Wt(Y,2);db(X,{});var Z=Wt(X,2);Y6(Z,{get pois(){return o().pois},get isLocating(){return De(c)},$$events:{opacityChange:q=>B(q.detail),locate:O}});var se=Wt(Z,2);tD(se,{get message(){return De(_)},get open(){return De(b)},set open(q){di(b,q)},$$legacy:!0}),ut(R),rt(i,R),hn()}export{fD as component,hD as universal};
